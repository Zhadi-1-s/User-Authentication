"use strict";(self.webpackChunkUserAuthentication=self.webpackChunkUserAuthentication||[]).push([[179],{2011:(wt,Pe,B)=>{B.d(Pe,{Dh:()=>ve,GT:()=>ce,cc:()=>Re,hO:()=>$e,on:()=>q,pX:()=>ue,xv:()=>Ie});var _=B(4650),z=B(9260),L=B(4976);wt=B.hmd(wt);const re=["ngOnDestroy"],ue=(Me,Le,je,Ae={})=>new Proxy(Me,{get:(Se,ke)=>je.runOutsideAngular(()=>{var He;if(Me[ke])return!(null===(He=Ae?.spy)||void 0===He)&&He.get&&Ae.spy.get(ke,Me[ke]),Me[ke];if(re.indexOf(ke)>-1)return()=>{};const Fe=Le.toPromise().then(ae=>{const tt=ae&&ae[ke];return"function"==typeof tt?tt.bind(ae):tt&&tt.then?tt.then(St=>je.run(()=>St)):je.run(()=>tt)});return new Proxy(()=>{},{get:(ae,tt)=>Fe[tt],apply:(ae,tt,St)=>Fe.then(st=>{var Kt;const dt=st&&st(...St);return!(null===(Kt=Ae?.spy)||void 0===Kt)&&Kt.apply&&Ae.spy.apply(ke,St,dt),dt})})})}),ce=(Me,Le)=>{Le.forEach(je=>{Object.getOwnPropertyNames(je.prototype||je).forEach(Ae=>{Object.defineProperty(Me.prototype,Ae,Object.getOwnPropertyDescriptor(je.prototype||je,Ae))})})};class Ce{constructor(Le){return Le}}const ve=new _.OlP("angularfire2.app.options"),Ie=new _.OlP("angularfire2.app.name");function q(Me,Le,je){const Se="object"==typeof je&&je||{};Se.name=Se.name||"string"==typeof je&&je||"[DEFAULT]";const He=z.Z.apps.filter(Fe=>Fe&&Fe.name===Se.name)[0]||Le.runOutsideAngular(()=>z.Z.initializeApp(Me,Se));try{JSON.stringify(Me)!==JSON.stringify(He.options)&&W("error",`${He.name} Firebase App already initialized with different options${wt.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new Ce(He)}const W=(Me,...Le)=>{(0,_.X6Q)()&&typeof console<"u"&&console[Me](...Le)},J={provide:Ce,useFactory:q,deps:[ve,_.R0b,[new _.FiY,Ie]]};let $e=(()=>{class Me{constructor(je){z.Z.registerVersion("angularfire",L.q4.full,"core"),z.Z.registerVersion("angularfire",L.q4.full,"app-compat"),z.Z.registerVersion("angular",_.q4F.full,je.toString())}static initializeApp(je,Ae){return{ngModule:Me,providers:[{provide:ve,useValue:je},{provide:Ie,useValue:Ae}]}}}return Me.\u0275fac=function(je){return new(je||Me)(_.LFG(_.Lbi))},Me.\u0275mod=_.oAB({type:Me}),Me.\u0275inj=_.cJS({providers:[J]}),Me})();function Re(Me,Le,je,Ae,Se){const[,ke,He]=globalThis.\u0275AngularfireInstanceCache.find(Fe=>Fe[0]===Me)||[];if(ke)return function qe(Me,Le){try{return Me.toString()===Le.toString()}catch{return Me===Le}}(Se,He)||(we("error",`${Le} was already initialized on the ${je} Firebase App with different settings.${ot?" You may need to reload as Firebase is not HMR aware.":""}`),we("warn",{is:Se,was:He})),ke;{const Fe=Ae();return globalThis.\u0275AngularfireInstanceCache.push([Me,Fe,Se]),Fe}}const ot=!!wt.hot,we=(Me,...Le)=>{(0,_.X6Q)()&&typeof console<"u"&&console[Me](...Le)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},4976:(wt,Pe,B)=>{B.d(Pe,{q4:()=>Vi,iC:()=>Ji,fc:()=>fh,HU:()=>At,vb:()=>Da,JM:()=>Ec});var _=B(4650),z=B(259),L=B(5861),re=B(6881),ue=B(2090),ce=B(4859),Ce=B(1877);const ve=(E,D)=>D.some(A=>E instanceof A);let Ie,q;const $e=new WeakMap,Re=new WeakMap,qe=new WeakMap,ot=new WeakMap,we=new WeakMap;let je={get(E,D,A){if(E instanceof IDBTransaction){if("done"===D)return Re.get(E);if("objectStoreNames"===D)return E.objectStoreNames||qe.get(E);if("store"===D)return A.objectStoreNames[1]?void 0:A.objectStore(A.objectStoreNames[0])}return He(E[D])},set:(E,D,A)=>(E[D]=A,!0),has:(E,D)=>E instanceof IDBTransaction&&("done"===D||"store"===D)||D in E};function ke(E){return"function"==typeof E?function Se(E){return E!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function J(){return q||(q=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(E)?function(...D){return E.apply(Fe(this),D),He($e.get(this))}:function(...D){return He(E.apply(Fe(this),D))}:function(D,...A){const V=E.call(Fe(this),D,...A);return qe.set(V,D.sort?D.sort():[D]),He(V)}}(E):(E instanceof IDBTransaction&&function Le(E){if(Re.has(E))return;const D=new Promise((A,V)=>{const K=()=>{E.removeEventListener("complete",ee),E.removeEventListener("error",se),E.removeEventListener("abort",se)},ee=()=>{A(),K()},se=()=>{V(E.error||new DOMException("AbortError","AbortError")),K()};E.addEventListener("complete",ee),E.addEventListener("error",se),E.addEventListener("abort",se)});Re.set(E,D)}(E),ve(E,function W(){return Ie||(Ie=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(E,je):E)}function He(E){if(E instanceof IDBRequest)return function Me(E){const D=new Promise((A,V)=>{const K=()=>{E.removeEventListener("success",ee),E.removeEventListener("error",se)},ee=()=>{A(He(E.result)),K()},se=()=>{V(E.error),K()};E.addEventListener("success",ee),E.addEventListener("error",se)});return D.then(A=>{A instanceof IDBCursor&&$e.set(A,E)}).catch(()=>{}),we.set(D,E),D}(E);if(ot.has(E))return ot.get(E);const D=ke(E);return D!==E&&(ot.set(E,D),we.set(D,E)),D}const Fe=E=>we.get(E),St=["get","getKey","getAll","getAllKeys","count"],st=["put","add","delete","clear"],Kt=new Map;function dt(E,D){if(!(E instanceof IDBDatabase)||D in E||"string"!=typeof D)return;if(Kt.get(D))return Kt.get(D);const A=D.replace(/FromIndex$/,""),V=D!==A,K=st.includes(A);if(!(A in(V?IDBIndex:IDBObjectStore).prototype)||!K&&!St.includes(A))return;const ee=function(){var se=(0,L.Z)(function*(We,...Ge){const pt=this.transaction(We,K?"readwrite":"readonly");let kt=pt.store;return V&&(kt=kt.index(Ge.shift())),(yield Promise.all([kt[A](...Ge),K&&pt.done]))[0]});return function(Ge){return se.apply(this,arguments)}}();return Kt.set(D,ee),ee}!function Ae(E){je=E(je)}(E=>({...E,get:(D,A,V)=>dt(D,A)||E.get(D,A,V),has:(D,A)=>!!dt(D,A)||E.has(D,A)}));const Is="@firebase/installations",Er="0.6.4",li=1e4,os=`w:${Er}`,le="FIS_v2",pe="https://firebaseinstallations.googleapis.com/v1",ye=36e5,at=new ue.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function ct(E){return E instanceof ue.ZR&&E.code.includes("request-failed")}function un({projectId:E}){return`${pe}/projects/${E}/installations`}function Tt(E){return{token:E.token,requestStatus:2,expiresIn:ir(E.expiresIn),creationTime:Date.now()}}function nn(E,D){return Rn.apply(this,arguments)}function Rn(){return(Rn=(0,L.Z)(function*(E,D){const V=(yield D.json()).error;return at.create("request-failed",{requestName:E,serverCode:V.code,serverMessage:V.message,serverStatus:V.status})})).apply(this,arguments)}function fn({apiKey:E}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":E})}function xn(E){return On.apply(this,arguments)}function On(){return(On=(0,L.Z)(function*(E){const D=yield E();return D.status>=500&&D.status<600?E():D})).apply(this,arguments)}function ir(E){return Number(E.replace("s","000"))}function gt(){return(gt=(0,L.Z)(function*({appConfig:E,heartbeatServiceProvider:D},{fid:A}){const V=un(E),K=fn(E),ee=D.getImmediate({optional:!0});if(ee){const pt=yield ee.getHeartbeatsHeader();pt&&K.append("x-firebase-client",pt)}const We={method:"POST",headers:K,body:JSON.stringify({fid:A,authVersion:le,appId:E.appId,sdkVersion:os})},Ge=yield xn(()=>fetch(V,We));if(Ge.ok){const pt=yield Ge.json();return{fid:pt.fid||A,registrationStatus:2,refreshToken:pt.refreshToken,authToken:Tt(pt.authToken)}}throw yield nn("Create Installation",Ge)})).apply(this,arguments)}function jn(E){return new Promise(D=>{setTimeout(D,E)})}const Wn=/^[cdef][\w-]{21}$/,Hr="";function Xr(){try{const E=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(E),E[0]=112+E[0]%16;const A=function cn(E){return function as(E){return btoa(String.fromCharCode(...E)).replace(/\+/g,"-").replace(/\//g,"_")}(E).substr(0,22)}(E);return Wn.test(A)?A:Hr}catch{return Hr}}function Zt(E){return`${E.appName}!${E.appId}`}const ft=new Map;function Ft(E,D){const A=Zt(E);Ln(A,D),function Jr(E,D){const A=function dr(){return!$n&&"BroadcastChannel"in self&&($n=new BroadcastChannel("[Firebase] FID Change"),$n.onmessage=E=>{Ln(E.data.key,E.data.fid)}),$n}();A&&A.postMessage({key:E,fid:D}),function Yt(){0===ft.size&&$n&&($n.close(),$n=null)}()}(A,D)}function Ln(E,D){const A=ft.get(E);if(A)for(const V of A)V(D)}let $n=null;const Di="firebase-installations-database",Jt=1,di="firebase-installations-store";let jt=null;function Kn(){return jt||(jt=function ae(E,D,{blocked:A,upgrade:V,blocking:K,terminated:ee}={}){const se=indexedDB.open(E,D),We=He(se);return V&&se.addEventListener("upgradeneeded",Ge=>{V(He(se.result),Ge.oldVersion,Ge.newVersion,He(se.transaction))}),A&&se.addEventListener("blocked",()=>A()),We.then(Ge=>{ee&&Ge.addEventListener("close",()=>ee()),K&&Ge.addEventListener("versionchange",()=>K())}).catch(()=>{}),We}(Di,Jt,{upgrade:(E,D)=>{0===D&&E.createObjectStore(di)}})),jt}function Fn(E,D){return Or.apply(this,arguments)}function Or(){return(Or=(0,L.Z)(function*(E,D){const A=Zt(E),K=(yield Kn()).transaction(di,"readwrite"),ee=K.objectStore(di),se=yield ee.get(A);return yield ee.put(D,A),yield K.done,(!se||se.fid!==D.fid)&&Ft(E,D.fid),D})).apply(this,arguments)}function Zn(E){return ei.apply(this,arguments)}function ei(){return(ei=(0,L.Z)(function*(E){const D=Zt(E),V=(yield Kn()).transaction(di,"readwrite");yield V.objectStore(di).delete(D),yield V.done})).apply(this,arguments)}function zr(E,D){return ti.apply(this,arguments)}function ti(){return(ti=(0,L.Z)(function*(E,D){const A=Zt(E),K=(yield Kn()).transaction(di,"readwrite"),ee=K.objectStore(di),se=yield ee.get(A),We=D(se);return void 0===We?yield ee.delete(A):yield ee.put(We,A),yield K.done,We&&(!se||se.fid!==We.fid)&&Ft(E,We.fid),We})).apply(this,arguments)}function G(E){return H.apply(this,arguments)}function H(){return H=(0,L.Z)(function*(E){let D;const A=yield zr(E.appConfig,V=>{const K=function O(E){return Dt(E||{fid:Xr(),registrationStatus:0})}(V),ee=function F(E,D){if(0===D.registrationStatus){if(!navigator.onLine)return{installationEntry:D,registrationPromise:Promise.reject(at.create("app-offline"))};const A={fid:D.fid,registrationStatus:1,registrationTime:Date.now()},V=function N(E,D){return Z.apply(this,arguments)}(E,A);return{installationEntry:A,registrationPromise:V}}return 1===D.registrationStatus?{installationEntry:D,registrationPromise:De(E)}:{installationEntry:D}}(E,K);return D=ee.registrationPromise,ee.installationEntry});return A.fid===Hr?{installationEntry:yield D}:{installationEntry:A,registrationPromise:D}}),H.apply(this,arguments)}function Z(){return Z=(0,L.Z)(function*(E,D){try{const A=yield function Bn(E,D){return gt.apply(this,arguments)}(E,D);return Fn(E.appConfig,A)}catch(A){throw ct(A)&&409===A.customData.serverCode?yield Zn(E.appConfig):yield Fn(E.appConfig,{fid:D.fid,registrationStatus:0}),A}}),Z.apply(this,arguments)}function De(E){return nt.apply(this,arguments)}function nt(){return(nt=(0,L.Z)(function*(E){let D=yield Rt(E.appConfig);for(;1===D.registrationStatus;)yield jn(100),D=yield Rt(E.appConfig);if(0===D.registrationStatus){const{installationEntry:A,registrationPromise:V}=yield G(E);return V||A}return D})).apply(this,arguments)}function Rt(E){return zr(E,D=>{if(!D)throw at.create("installation-not-found");return Dt(D)})}function Dt(E){return function Qt(E){return 1===E.registrationStatus&&E.registrationTime+li<Date.now()}(E)?{fid:E.fid,registrationStatus:0}:E}function bn(){return(bn=(0,L.Z)(function*({appConfig:E,heartbeatServiceProvider:D},A){const V=function $t(E,{fid:D}){return`${un(E)}/${D}/authTokens:generate`}(E,A),K=function rr(E,{refreshToken:D}){const A=fn(E);return A.append("Authorization",function Ti(E){return`${le} ${E}`}(D)),A}(E,A),ee=D.getImmediate({optional:!0});if(ee){const pt=yield ee.getHeartbeatsHeader();pt&&K.append("x-firebase-client",pt)}const We={method:"POST",headers:K,body:JSON.stringify({installation:{sdkVersion:os,appId:E.appId}})},Ge=yield xn(()=>fetch(V,We));if(Ge.ok)return Tt(yield Ge.json());throw yield nn("Generate Auth Token",Ge)})).apply(this,arguments)}function Ir(E){return Cs.apply(this,arguments)}function Cs(){return Cs=(0,L.Z)(function*(E,D=!1){let A;const V=yield zr(E.appConfig,ee=>{if(!en(ee))throw at.create("not-registered");const se=ee.authToken;if(!D&&function vt(E){return 2===E.requestStatus&&!function mn(E){const D=Date.now();return D<E.creationTime||E.creationTime+E.expiresIn<D+ye}(E)}(se))return ee;if(1===se.requestStatus)return A=function me(E,D){return ie.apply(this,arguments)}(E,D),ee;{if(!navigator.onLine)throw at.create("app-offline");const We=function sn(E){const D={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},E),{authToken:D})}(ee);return A=function _t(E,D){return xt.apply(this,arguments)}(E,We),We}});return A?yield A:V.authToken}),Cs.apply(this,arguments)}function ie(){return(ie=(0,L.Z)(function*(E,D){let A=yield Ue(E.appConfig);for(;1===A.authToken.requestStatus;)yield jn(100),A=yield Ue(E.appConfig);const V=A.authToken;return 0===V.requestStatus?Ir(E,D):V})).apply(this,arguments)}function Ue(E){return zr(E,D=>{if(!en(D))throw at.create("not-registered");return function Gr(E){return 1===E.requestStatus&&E.requestTime+li<Date.now()}(D.authToken)?Object.assign(Object.assign({},D),{authToken:{requestStatus:0}}):D})}function xt(){return xt=(0,L.Z)(function*(E,D){try{const A=yield function Pt(E,D){return bn.apply(this,arguments)}(E,D),V=Object.assign(Object.assign({},D),{authToken:A});return yield Fn(E.appConfig,V),A}catch(A){if(!ct(A)||401!==A.customData.serverCode&&404!==A.customData.serverCode){const V=Object.assign(Object.assign({},D),{authToken:{requestStatus:0}});yield Fn(E.appConfig,V)}else yield Zn(E.appConfig);throw A}}),xt.apply(this,arguments)}function en(E){return void 0!==E&&2===E.registrationStatus}function Zu(){return(Zu=(0,L.Z)(function*(E){const D=E,{installationEntry:A,registrationPromise:V}=yield G(D);return V?V.catch(console.error):Ir(D).catch(console.error),A.fid})).apply(this,arguments)}function Io(){return Io=(0,L.Z)(function*(E,D=!1){const A=E;return yield function Tr(E){return Je.apply(this,arguments)}(A),(yield Ir(A,D)).token}),Io.apply(this,arguments)}function Je(){return(Je=(0,L.Z)(function*(E){const{registrationPromise:D}=yield G(E);D&&(yield D)})).apply(this,arguments)}function $s(E){return at.create("missing-app-config-values",{valueName:E})}const zt="installations",Mi=E=>{const D=E.getProvider("app").getImmediate(),A=function Xa(E){if(!E||!E.options)throw $s("App Configuration");if(!E.name)throw $s("App Name");const D=["projectId","apiKey","appId"];for(const A of D)if(!E.options[A])throw $s(A);return{appName:E.name,projectId:E.options.projectId,apiKey:E.options.apiKey,appId:E.options.appId}}(D);return{app:D,appConfig:A,heartbeatServiceProvider:(0,re._getProvider)(D,"heartbeat"),_delete:()=>Promise.resolve()}},Ja=E=>{const D=E.getProvider("app").getImmediate(),A=(0,re._getProvider)(D,zt).getImmediate();return{getId:()=>function Cr(E){return Zu.apply(this,arguments)}(A),getToken:K=>function Zf(E){return Io.apply(this,arguments)}(A,K)}};(function Hs(){(0,re._registerComponent)(new ce.wA(zt,Mi,"PUBLIC")),(0,re._registerComponent)(new ce.wA("installations-internal",Ja,"PRIVATE"))})(),(0,re.registerVersion)(Is,Er),(0,re.registerVersion)(Is,Er,"esm2017");const hr="@firebase/remote-config",Wr=new ue.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class fm{constructor(D,A,V,K){this.client=D,this.storage=A,this.storageCache=V,this.logger=K}isCachedDataFresh(D,A){if(!A)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const V=Date.now()-A,K=V<=D;return this.logger.debug(`Config fetch cache check. Cache age millis: ${V}. Cache max age millis (minimumFetchIntervalMillis setting): ${D}. Is cache hit: ${K}.`),K}fetch(D){var A=this;return(0,L.Z)(function*(){const[V,K]=yield Promise.all([A.storage.getLastSuccessfulFetchTimestampMillis(),A.storage.getLastSuccessfulFetchResponse()]);if(K&&A.isCachedDataFresh(D.cacheMaxAgeMillis,V))return K;D.eTag=K&&K.eTag;const ee=yield A.client.fetch(D),se=[A.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===ee.status&&se.push(A.storage.setLastSuccessfulFetchResponse(ee)),yield Promise.all(se),ee})()}}function Ad(E=navigator){return E.languages&&E.languages[0]||E.language}class Yf{constructor(D,A,V,K,ee,se){this.firebaseInstallations=D,this.sdkVersion=A,this.namespace=V,this.projectId=K,this.apiKey=ee,this.appId=se}fetch(D){var A=this;return(0,L.Z)(function*(){const[V,K]=yield Promise.all([A.firebaseInstallations.getId(),A.firebaseInstallations.getToken()]),se=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${A.projectId}/namespaces/${A.namespace}:fetch?key=${A.apiKey}`,We={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":D.eTag||"*"},Ge={sdk_version:A.sdkVersion,app_instance_id:V,app_instance_id_token:K,app_id:A.appId,language_code:Ad()},pt={method:"POST",headers:We,body:JSON.stringify(Ge)},kt=fetch(se,pt),Ot=new Promise((Rr,fs)=>{D.signal.addEventListener(()=>{const ps=new Error("The operation was aborted.");ps.name="AbortError",fs(ps)})});let Vr;try{yield Promise.race([kt,Ot]),Vr=yield kt}catch(Rr){let fs="fetch-client-network";throw"AbortError"===Rr?.name&&(fs="fetch-timeout"),Wr.create(fs,{originalErrorMessage:Rr?.message})}let Tn=Vr.status;const Gt=Vr.headers.get("ETag")||void 0;let hs,bu;if(200===Vr.status){let Rr;try{Rr=yield Vr.json()}catch(fs){throw Wr.create("fetch-client-parse",{originalErrorMessage:fs?.message})}hs=Rr.entries,bu=Rr.state}if("INSTANCE_STATE_UNSPECIFIED"===bu?Tn=500:"NO_CHANGE"===bu?Tn=304:("NO_TEMPLATE"===bu||"EMPTY_CONFIG"===bu)&&(hs={}),304!==Tn&&200!==Tn)throw Wr.create("fetch-status",{httpStatus:Tn});return{status:Tn,eTag:Gt,config:hs}})()}}class xd{constructor(D,A){this.client=D,this.storage=A}fetch(D){var A=this;return(0,L.Z)(function*(){const V=(yield A.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return A.attemptFetch(D,V)})()}attemptFetch(D,{throttleEndTimeMillis:A,backoffCount:V}){var K=this;return(0,L.Z)(function*(){yield function Rd(E,D){return new Promise((A,V)=>{const K=Math.max(D-Date.now(),0),ee=setTimeout(A,K);E.addEventListener(()=>{clearTimeout(ee),V(Wr.create("fetch-throttle",{throttleEndTimeMillis:D}))})})}(D.signal,A);try{const ee=yield K.client.fetch(D);return yield K.storage.deleteThrottleMetadata(),ee}catch(ee){if(!function pm(E){if(!(E instanceof ue.ZR&&E.customData))return!1;const D=Number(E.customData.httpStatus);return 429===D||500===D||503===D||504===D}(ee))throw ee;const se={throttleEndTimeMillis:Date.now()+(0,ue.$s)(V),backoffCount:V+1};return yield K.storage.setThrottleMetadata(se),K.attemptFetch(D,se)}})()}}class Qf{constructor(D,A,V,K,ee){this.app=D,this._client=A,this._storageCache=V,this._storage=K,this._logger=ee,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function Ws(E,D){const A=E.target.error||void 0;return Wr.create(D,{originalErrorMessage:A&&A?.message})}const sa="app_namespace_store";class Md{constructor(D,A,V,K=function Jf(){return new Promise((E,D)=>{try{const A=indexedDB.open("firebase_remote_config",1);A.onerror=V=>{D(Ws(V,"storage-open"))},A.onsuccess=V=>{E(V.target.result)},A.onupgradeneeded=V=>{0===V.oldVersion&&V.target.result.createObjectStore(sa,{keyPath:"compositeKey"})}}catch(A){D(Wr.create("storage-open",{originalErrorMessage:A?.message}))}})}()){this.appId=D,this.appName=A,this.namespace=V,this.openDbPromise=K}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(D){return this.set("last_fetch_status",D)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(D){return this.set("last_successful_fetch_timestamp_millis",D)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(D){return this.set("last_successful_fetch_response",D)}getActiveConfig(){return this.get("active_config")}setActiveConfig(D){return this.set("active_config",D)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(D){return this.set("active_config_etag",D)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(D){return this.set("throttle_metadata",D)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(D){var A=this;return(0,L.Z)(function*(){const V=yield A.openDbPromise;return new Promise((K,ee)=>{const We=V.transaction([sa],"readonly").objectStore(sa),Ge=A.createCompositeKey(D);try{const pt=We.get(Ge);pt.onerror=kt=>{ee(Ws(kt,"storage-get"))},pt.onsuccess=kt=>{const Ot=kt.target.result;K(Ot?Ot.value:void 0)}}catch(pt){ee(Wr.create("storage-get",{originalErrorMessage:pt?.message}))}})})()}set(D,A){var V=this;return(0,L.Z)(function*(){const K=yield V.openDbPromise;return new Promise((ee,se)=>{const Ge=K.transaction([sa],"readwrite").objectStore(sa),pt=V.createCompositeKey(D);try{const kt=Ge.put({compositeKey:pt,value:A});kt.onerror=Ot=>{se(Ws(Ot,"storage-set"))},kt.onsuccess=()=>{ee()}}catch(kt){se(Wr.create("storage-set",{originalErrorMessage:kt?.message}))}})})()}delete(D){var A=this;return(0,L.Z)(function*(){const V=yield A.openDbPromise;return new Promise((K,ee)=>{const We=V.transaction([sa],"readwrite").objectStore(sa),Ge=A.createCompositeKey(D);try{const pt=We.delete(Ge);pt.onerror=kt=>{ee(Ws(kt,"storage-delete"))},pt.onsuccess=()=>{K()}}catch(pt){ee(Wr.create("storage-delete",{originalErrorMessage:pt?.message}))}})})()}createCompositeKey(D){return[this.appId,this.appName,this.namespace,D].join()}}class So{constructor(D){this.storage=D}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var D=this;return(0,L.Z)(function*(){const A=D.storage.getLastFetchStatus(),V=D.storage.getLastSuccessfulFetchTimestampMillis(),K=D.storage.getActiveConfig(),ee=yield A;ee&&(D.lastFetchStatus=ee);const se=yield V;se&&(D.lastSuccessfulFetchTimestampMillis=se);const We=yield K;We&&(D.activeConfig=We)})()}setLastFetchStatus(D){return this.lastFetchStatus=D,this.storage.setLastFetchStatus(D)}setLastSuccessfulFetchTimestampMillis(D){return this.lastSuccessfulFetchTimestampMillis=D,this.storage.setLastSuccessfulFetchTimestampMillis(D)}setActiveConfig(D){return this.activeConfig=D,this.storage.setActiveConfig(D)}}function Od(){return Xu.apply(this,arguments)}function Xu(){return(Xu=(0,L.Z)(function*(){if(!(0,ue.hl)())return!1;try{return yield(0,ue.eu)()}catch{return!1}})).apply(this,arguments)}!function aa(){(0,re._registerComponent)(new ce.wA("remote-config",function E(D,{instanceIdentifier:A}){const V=D.getProvider("app").getImmediate(),K=D.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Wr.create("registration-window");if(!(0,ue.hl)())throw Wr.create("indexed-db-unavailable");const{projectId:ee,apiKey:se,appId:We}=V.options;if(!ee)throw Wr.create("registration-project-id");if(!se)throw Wr.create("registration-api-key");if(!We)throw Wr.create("registration-app-id");const Ge=new Md(We,V.name,A=A||"firebase"),pt=new So(Ge),kt=new Ce.Yd(hr);kt.logLevel=Ce.in.ERROR;const Ot=new Yf(K,re.SDK_VERSION,A,ee,se,We),Vr=new xd(Ot,Ge),Tn=new fm(Vr,Ge,pt,kt),Gt=new Qf(V,Tn,pt,Ge,kt);return function ni(E){const D=(0,ue.m9)(E);D._initializePromise||(D._initializePromise=D._storageCache.loadFromStorage().then(()=>{D._isInitializationComplete=!0}))}(Gt),Gt},"PUBLIC").setMultipleInstances(!0)),(0,re.registerVersion)(hr,"0.4.4"),(0,re.registerVersion)(hr,"0.4.4","esm2017")}();const ep=(E,D)=>D.some(A=>E instanceof A);let qs,ul;const ua=new WeakMap,Ao=new WeakMap,Un=new WeakMap,ru=new WeakMap,ec=new WeakMap;let xo={get(E,D,A){if(E instanceof IDBTransaction){if("done"===D)return Ao.get(E);if("objectStoreNames"===D)return E.objectStoreNames||Un.get(E);if("store"===D)return A.objectStoreNames[1]?void 0:A.objectStore(A.objectStoreNames[0])}return ri(E[D])},set:(E,D,A)=>(E[D]=A,!0),has:(E,D)=>E instanceof IDBTransaction&&("done"===D||"store"===D)||D in E};function tc(E){return"function"==typeof E?function np(E){return E!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function tp(){return ul||(ul=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(E)?function(...D){return E.apply(br(this),D),ri(ua.get(this))}:function(...D){return ri(E.apply(br(this),D))}:function(D,...A){const V=E.call(br(this),D,...A);return Un.set(V,D.sort?D.sort():[D]),ri(V)}}(E):(E instanceof IDBTransaction&&function Ro(E){if(Ao.has(E))return;const D=new Promise((A,V)=>{const K=()=>{E.removeEventListener("complete",ee),E.removeEventListener("error",se),E.removeEventListener("abort",se)},ee=()=>{A(),K()},se=()=>{V(E.error||new DOMException("AbortError","AbortError")),K()};E.addEventListener("complete",ee),E.addEventListener("error",se),E.addEventListener("abort",se)});Ao.set(E,D)}(E),ep(E,function Ju(){return qs||(qs=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(E,xo):E)}function ri(E){if(E instanceof IDBRequest)return function fr(E){const D=new Promise((A,V)=>{const K=()=>{E.removeEventListener("success",ee),E.removeEventListener("error",se)},ee=()=>{A(ri(E.result)),K()},se=()=>{V(E.error),K()};E.addEventListener("success",ee),E.addEventListener("error",se)});return D.then(A=>{A instanceof IDBCursor&&ua.set(A,E)}).catch(()=>{}),ec.set(D,E),D}(E);if(ru.has(E))return ru.get(E);const D=tc(E);return D!==E&&(ru.set(E,D),ec.set(D,E)),D}const br=E=>ec.get(E);function iu(E,D,{blocked:A,upgrade:V,blocking:K,terminated:ee}={}){const se=indexedDB.open(E,D),We=ri(se);return V&&se.addEventListener("upgradeneeded",Ge=>{V(ri(se.result),Ge.oldVersion,Ge.newVersion,ri(se.transaction))}),A&&se.addEventListener("blocked",()=>A()),We.then(Ge=>{ee&&Ge.addEventListener("close",()=>ee()),K&&Ge.addEventListener("versionchange",()=>K())}).catch(()=>{}),We}function Ks(E,{blocked:D}={}){const A=indexedDB.deleteDatabase(E);return D&&A.addEventListener("blocked",()=>D()),ri(A).then(()=>{})}const Ld=["get","getKey","getAll","getAllKeys","count"],Ds=["put","add","delete","clear"],su=new Map;function ca(E,D){if(!(E instanceof IDBDatabase)||D in E||"string"!=typeof D)return;if(su.get(D))return su.get(D);const A=D.replace(/FromIndex$/,""),V=D!==A,K=Ds.includes(A);if(!(A in(V?IDBIndex:IDBObjectStore).prototype)||!K&&!Ld.includes(A))return;const ee=function(){var se=(0,L.Z)(function*(We,...Ge){const pt=this.transaction(We,K?"readwrite":"readonly");let kt=pt.store;return V&&(kt=kt.index(Ge.shift())),(yield Promise.all([kt[A](...Ge),K&&pt.done]))[0]});return function(Ge){return se.apply(this,arguments)}}();return su.set(D,ee),ee}!function Fr(E){xo=E(xo)}(E=>({...E,get:(D,A,V)=>ca(D,A)||E.get(D,A,V),has:(D,A)=>!!ca(D,A)||E.has(D,A)}));const Mt="/firebase-messaging-sw.js",nc="/firebase-cloud-messaging-push-scope",rp="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",cl="https://fcmregistrations.googleapis.com/v1",ll="google.c.a.c_id",dl="google.c.a.c_l",Fd="google.c.a.ts",Ud="google.c.a.e";var _e=(()=>{return(E=_e||(_e={})).PUSH_RECEIVED="push-received",E.NOTIFICATION_CLICKED="notification-clicked",_e;var E})();function Vt(E){const D=new Uint8Array(E);return btoa(String.fromCharCode(...D)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function hl(E){const A=(E+"=".repeat((4-E.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),V=atob(A),K=new Uint8Array(V.length);for(let ee=0;ee<V.length;++ee)K[ee]=V.charCodeAt(ee);return K}const ou="fcm_token_details_db",Yn=5,Vd="fcm_token_object_Store";function Li(){return Li=(0,L.Z)(function*(E){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(ee=>ee.name).includes(ou))return null;let D=null;return(yield iu(ou,Yn,{upgrade:(V=(0,L.Z)(function*(K,ee,se,We){var Ge;if(ee<2||!K.objectStoreNames.contains(Vd))return;const pt=We.objectStore(Vd),kt=yield pt.index("fcmSenderId").get(E);if(yield pt.clear(),kt)if(2===ee){const Ot=kt;if(!Ot.auth||!Ot.p256dh||!Ot.endpoint)return;D={token:Ot.fcmToken,createTime:null!==(Ge=Ot.createTime)&&void 0!==Ge?Ge:Date.now(),subscriptionOptions:{auth:Ot.auth,p256dh:Ot.p256dh,endpoint:Ot.endpoint,swScope:Ot.swScope,vapidKey:"string"==typeof Ot.vapidKey?Ot.vapidKey:Vt(Ot.vapidKey)}}}else if(3===ee){const Ot=kt;D={token:Ot.fcmToken,createTime:Ot.createTime,subscriptionOptions:{auth:Vt(Ot.auth),p256dh:Vt(Ot.p256dh),endpoint:Ot.endpoint,swScope:Ot.swScope,vapidKey:Vt(Ot.vapidKey)}}}else if(4===ee){const Ot=kt;D={token:Ot.fcmToken,createTime:Ot.createTime,subscriptionOptions:{auth:Vt(Ot.auth),p256dh:Vt(Ot.p256dh),endpoint:Ot.endpoint,swScope:Ot.swScope,vapidKey:Vt(Ot.vapidKey)}}}}),function(ee,se,We,Ge){return V.apply(this,arguments)})})).close(),yield Ks(ou),yield Ks("fcm_vapid_details_db"),yield Ks("undefined"),function rc(E){if(!E||!E.subscriptionOptions)return!1;const{subscriptionOptions:D}=E;return"number"==typeof E.createTime&&E.createTime>0&&"string"==typeof E.token&&E.token.length>0&&"string"==typeof D.auth&&D.auth.length>0&&"string"==typeof D.p256dh&&D.p256dh.length>0&&"string"==typeof D.endpoint&&D.endpoint.length>0&&"string"==typeof D.swScope&&D.swScope.length>0&&"string"==typeof D.vapidKey&&D.vapidKey.length>0}(D)?D:null;var V}),Li.apply(this,arguments)}const Bd="firebase-messaging-database",jd=1,Zs="firebase-messaging-store";let da=null;function Ur(){return da||(da=iu(Bd,jd,{upgrade:(E,D)=>{0===D&&E.createObjectStore(Zs)}})),da}function fi(E){return Ys.apply(this,arguments)}function Ys(){return Ys=(0,L.Z)(function*(E){const D=Hd(E),V=yield(yield Ur()).transaction(Zs).objectStore(Zs).get(D);if(V)return V;{const K=yield function la(E){return Li.apply(this,arguments)}(E.appConfig.senderId);if(K)return yield bs(E,K),K}}),Ys.apply(this,arguments)}function bs(E,D){return cs.apply(this,arguments)}function cs(){return(cs=(0,L.Z)(function*(E,D){const A=Hd(E),K=(yield Ur()).transaction(Zs,"readwrite");return yield K.objectStore(Zs).put(D,A),yield K.done,D})).apply(this,arguments)}function Po(){return(Po=(0,L.Z)(function*(E){const D=Hd(E),V=(yield Ur()).transaction(Zs,"readwrite");yield V.objectStore(Zs).delete(D),yield V.done})).apply(this,arguments)}function Hd({appConfig:E}){return E.appId}const Qn=new ue.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function ic(E,D){return au.apply(this,arguments)}function au(){return(au=(0,L.Z)(function*(E,D){const A=yield uu(E),V=oc(D),K={method:"POST",headers:A,body:JSON.stringify(V)};let ee;try{ee=yield(yield fetch(fl(E.appConfig),K)).json()}catch(se){throw Qn.create("token-subscribe-failed",{errorInfo:se?.toString()})}if(ee.error)throw Qn.create("token-subscribe-failed",{errorInfo:ee.error.message});if(!ee.token)throw Qn.create("token-subscribe-no-token");return ee.token})).apply(this,arguments)}function sc(){return(sc=(0,L.Z)(function*(E,D){const A=yield uu(E),V=oc(D.subscriptionOptions),K={method:"PATCH",headers:A,body:JSON.stringify(V)};let ee;try{ee=yield(yield fetch(`${fl(E.appConfig)}/${D.token}`,K)).json()}catch(se){throw Qn.create("token-update-failed",{errorInfo:se?.toString()})}if(ee.error)throw Qn.create("token-update-failed",{errorInfo:ee.error.message});if(!ee.token)throw Qn.create("token-update-no-token");return ee.token})).apply(this,arguments)}function Gd(E,D){return ha.apply(this,arguments)}function ha(){return(ha=(0,L.Z)(function*(E,D){const V={method:"DELETE",headers:yield uu(E)};try{const ee=yield(yield fetch(`${fl(E.appConfig)}/${D}`,V)).json();if(ee.error)throw Qn.create("token-unsubscribe-failed",{errorInfo:ee.error.message})}catch(K){throw Qn.create("token-unsubscribe-failed",{errorInfo:K?.toString()})}})).apply(this,arguments)}function fl({projectId:E}){return`${cl}/projects/${E}/registrations`}function uu(E){return pl.apply(this,arguments)}function pl(){return(pl=(0,L.Z)(function*({appConfig:E,installations:D}){const A=yield D.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":E.apiKey,"x-goog-firebase-installations-auth":`FIS ${A}`})})).apply(this,arguments)}function oc({p256dh:E,auth:D,endpoint:A,vapidKey:V}){const K={web:{endpoint:A,auth:D,p256dh:E}};return V!==rp&&(K.web.applicationPubKey=V),K}const Wd=6048e5;function qd(){return qd=(0,L.Z)(function*(E){const D=yield function _m(E,D){return Zd.apply(this,arguments)}(E.swRegistration,E.vapidKey),A={vapidKey:E.vapidKey,swScope:E.swRegistration.scope,endpoint:D.endpoint,auth:Vt(D.getKey("auth")),p256dh:Vt(D.getKey("p256dh"))},V=yield fi(E.firebaseDependencies);if(V){if(function ym(E,D){return D.vapidKey===E.vapidKey&&D.endpoint===E.endpoint&&D.auth===E.auth&&D.p256dh===E.p256dh}(V.subscriptionOptions,A))return Date.now()>=V.createTime+Wd?function Nn(E,D){return Kd.apply(this,arguments)}(E,{token:V.token,createTime:Date.now(),subscriptionOptions:A}):V.token;try{yield Gd(E.firebaseDependencies,V.token)}catch(K){console.warn(K)}return fa(E.firebaseDependencies,A)}return fa(E.firebaseDependencies,A)}),qd.apply(this,arguments)}function ls(){return ls=(0,L.Z)(function*(E){const D=yield fi(E.firebaseDependencies);D&&(yield Gd(E.firebaseDependencies,D.token),yield function $d(E){return Po.apply(this,arguments)}(E.firebaseDependencies));const A=yield E.swRegistration.pushManager.getSubscription();return!A||A.unsubscribe()}),ls.apply(this,arguments)}function Kd(){return Kd=(0,L.Z)(function*(E,D){try{const A=yield function zd(E,D){return sc.apply(this,arguments)}(E.firebaseDependencies,D),V=Object.assign(Object.assign({},D),{token:A,createTime:Date.now()});return yield bs(E.firebaseDependencies,V),A}catch(A){throw yield function qr(E){return ls.apply(this,arguments)}(E),A}}),Kd.apply(this,arguments)}function fa(E,D){return ml.apply(this,arguments)}function ml(){return(ml=(0,L.Z)(function*(E,D){const V={token:yield ic(E,D),createTime:Date.now(),subscriptionOptions:D};return yield bs(E,V),V.token})).apply(this,arguments)}function Zd(){return(Zd=(0,L.Z)(function*(E,D){return(yield E.pushManager.getSubscription())||E.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:hl(D)})})).apply(this,arguments)}function ac(E){const D={from:E.from,collapseKey:E.collapse_key,messageId:E.fcmMessageId};return function _l(E,D){if(!D.notification)return;E.notification={};const A=D.notification.title;A&&(E.notification.title=A);const V=D.notification.body;V&&(E.notification.body=V);const K=D.notification.image;K&&(E.notification.image=K);const ee=D.notification.icon;ee&&(E.notification.icon=ee)}(D,E),function Yd(E,D){D.data&&(E.data=D.data)}(D,E),function Qd(E,D){var A,V,K,ee,se;if(!(D.fcmOptions||null!==(A=D.notification)&&void 0!==A&&A.click_action))return;E.fcmOptions={};const We=null!==(K=null===(V=D.fcmOptions)||void 0===V?void 0:V.link)&&void 0!==K?K:null===(ee=D.notification)||void 0===ee?void 0:ee.click_action;We&&(E.fcmOptions.link=We);const Ge=null===(se=D.fcmOptions)||void 0===se?void 0:se.analytics_label;Ge&&(E.fcmOptions.analyticsLabel=Ge)}(D,E),D}function pa(E,D){const A=[];for(let V=0;V<E.length;V++)A.push(E.charAt(V)),V<D.length&&A.push(D.charAt(V));return A.join("")}function Ss(E){return Qn.create("missing-app-config-values",{valueName:E})}pa("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),pa("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class vm{constructor(D,A,V){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const K=function cu(E){if(!E||!E.options)throw Ss("App Configuration Object");if(!E.name)throw Ss("App Name");const D=["projectId","apiKey","appId","messagingSenderId"],{options:A}=E;for(const V of D)if(!A[V])throw Ss(V);return{appName:E.name,projectId:A.projectId,apiKey:A.apiKey,appId:A.appId,senderId:A.messagingSenderId}}(D);this.firebaseDependencies={app:D,appConfig:K,installations:A,analyticsProvider:V}}_delete(){return Promise.resolve()}}function ip(E){return cc.apply(this,arguments)}function cc(){return(cc=(0,L.Z)(function*(E){try{E.swRegistration=yield navigator.serviceWorker.register(Mt,{scope:nc}),E.swRegistration.update().catch(()=>{})}catch(D){throw Qn.create("failed-service-worker-registration",{browserErrorMessage:D?.message})}})).apply(this,arguments)}function As(){return(As=(0,L.Z)(function*(E,D){if(!D&&!E.swRegistration&&(yield ip(E)),D||!E.swRegistration){if(!(D instanceof ServiceWorkerRegistration))throw Qn.create("invalid-sw-registration");E.swRegistration=D}})).apply(this,arguments)}function lu(){return(lu=(0,L.Z)(function*(E,D){D?E.vapidKey=D:E.vapidKey||(E.vapidKey=rp)})).apply(this,arguments)}function ga(){return ga=(0,L.Z)(function*(E,D){if(!navigator)throw Qn.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw Qn.create("permission-blocked");return yield function yl(E,D){return lu.apply(this,arguments)}(E,D?.vapidKey),yield function Xd(E,D){return As.apply(this,arguments)}(E,D?.serviceWorkerRegistration),function gl(E){return qd.apply(this,arguments)}(E)}),ga.apply(this,arguments)}function Qs(){return(Qs=(0,L.Z)(function*(E,D,A){const V=function No(E){switch(E){case _e.NOTIFICATION_CLICKED:return"notification_open";case _e.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(D);(yield E.firebaseDependencies.analyticsProvider.get()).logEvent(V,{message_id:A[ll],message_name:A[dl],message_time:A[Fd],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function Mo(){return Mo=(0,L.Z)(function*(E,D){const A=D.data;if(!A.isFirebaseMessaging)return;E.onMessageHandler&&A.messageType===_e.PUSH_RECEIVED&&("function"==typeof E.onMessageHandler?E.onMessageHandler(ac(A)):E.onMessageHandler.next(ac(A)));const V=A.data;(function uc(E){return"object"==typeof E&&!!E&&ll in E})(V)&&"1"===V[Ud]&&(yield function Jd(E,D,A){return Qs.apply(this,arguments)}(E,A.messageType,V))}),Mo.apply(this,arguments)}const _a="@firebase/messaging",hu=E=>{const D=new vm(E.getProvider("app").getImmediate(),E.getProvider("installations-internal").getImmediate(),E.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",A=>function ma(E,D){return Mo.apply(this,arguments)}(D,A)),D},vl=E=>{const D=E.getProvider("messaging").getImmediate();return{getToken:V=>function lc(E,D){return ga.apply(this,arguments)}(D,V)}};function sp(){return wl.apply(this,arguments)}function wl(){return(wl=(0,L.Z)(function*(){try{yield(0,ue.eu)()}catch{return!1}return typeof window<"u"&&(0,ue.hl)()&&(0,ue.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function fu(){(0,re._registerComponent)(new ce.wA("messaging",hu,"PUBLIC")),(0,re._registerComponent)(new ce.wA("messaging-internal",vl,"PRIVATE")),(0,re.registerVersion)(_a,"0.12.4"),(0,re.registerVersion)(_a,"0.12.4","esm2017")}();const Xs="analytics",hc="firebase_id",nh="origin",pu=6e4,rh="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",fc="https://www.googletagmanager.com/gtag/js",pr=new Ce.Yd("@firebase/analytics"),Vn=new ue.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function op(E){if(!E.startsWith(fc)){const D=Vn.create("invalid-gtag-resource",{gtagURL:E});return pr.warn(D.message),""}return E}function Js(E){return Promise.all(E.map(D=>D.catch(A=>A)))}function eo(){return(eo=(0,L.Z)(function*(E,D,A,V,K,ee){const se=V[K];try{if(se)yield D[se];else{const Ge=(yield Js(A)).find(pt=>pt.measurementId===K);Ge&&(yield D[Ge.appId])}}catch(We){pr.error(We)}E("config",K,ee)})).apply(this,arguments)}function ko(){return(ko=(0,L.Z)(function*(E,D,A,V,K){try{let ee=[];if(K&&K.send_to){let se=K.send_to;Array.isArray(se)||(se=[se]);const We=yield Js(A);for(const Ge of se){const pt=We.find(Ot=>Ot.measurementId===Ge),kt=pt&&D[pt.appId];if(!kt){ee=[];break}ee.push(kt)}}0===ee.length&&(ee=Object.values(D)),yield Promise.all(ee),E("event",V,K||{})}catch(ee){pr.error(ee)}})).apply(this,arguments)}const gc=30,Lo=new class ih{constructor(D={},A=1e3){this.throttleMetadata=D,this.intervalMillis=A}getThrottleMetadata(D){return this.throttleMetadata[D]}setThrottleMetadata(D,A){this.throttleMetadata[D]=A}deleteThrottleMetadata(D){delete this.throttleMetadata[D]}};function up(E){return new Headers({Accept:"application/json","x-goog-api-key":E})}function an(){return(an=(0,L.Z)(function*(E){var D;const{appId:A,apiKey:V}=E,K={method:"GET",headers:up(V)},ee=rh.replace("{app-id}",A),se=yield fetch(ee,K);if(200!==se.status&&304!==se.status){let We="";try{const Ge=yield se.json();null!==(D=Ge.error)&&void 0!==D&&D.message&&(We=Ge.error.message)}catch{}throw Vn.create("config-fetch-failed",{httpStatus:se.status,responseMessage:We})}return se.json()})).apply(this,arguments)}function oh(){return(oh=(0,L.Z)(function*(E,D=Lo,A){const{appId:V,apiKey:K,measurementId:ee}=E.options;if(!V)throw Vn.create("no-app-id");if(!K){if(ee)return{measurementId:ee,appId:V};throw Vn.create("no-api-key")}const se=D.getThrottleMetadata(V)||{backoffCount:0,throttleEndTimeMillis:Date.now()},We=new by;return setTimeout((0,L.Z)(function*(){We.abort()}),void 0!==A?A:pu),Sl({appId:V,apiKey:K,measurementId:ee},se,We,D)})).apply(this,arguments)}function Sl(E,D,A){return Al.apply(this,arguments)}function Al(){return Al=(0,L.Z)(function*(E,{throttleEndTimeMillis:D,backoffCount:A},V,K=Lo){var ee;const{appId:se,measurementId:We}=E;try{yield function cp(E,D){return new Promise((A,V)=>{const K=Math.max(D-Date.now(),0),ee=setTimeout(A,K);E.addEventListener(()=>{clearTimeout(ee),V(Vn.create("fetch-throttle",{throttleEndTimeMillis:D}))})})}(V,D)}catch(Ge){if(We)return pr.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${We} provided in the "measurementId" field in the local Firebase config. [${Ge?.message}]`),{appId:se,measurementId:We};throw Ge}try{const Ge=yield function sh(E){return an.apply(this,arguments)}(E);return K.deleteThrottleMetadata(se),Ge}catch(Ge){const pt=Ge;if(!function Dy(E){if(!(E instanceof ue.ZR&&E.customData))return!1;const D=Number(E.customData.httpStatus);return 429===D||500===D||503===D||504===D}(pt)){if(K.deleteThrottleMetadata(se),We)return pr.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${We} provided in the "measurementId" field in the local Firebase config. [${pt?.message}]`),{appId:se,measurementId:We};throw Ge}const kt=503===Number(null===(ee=pt?.customData)||void 0===ee?void 0:ee.httpStatus)?(0,ue.$s)(A,K.intervalMillis,gc):(0,ue.$s)(A,K.intervalMillis),Ot={throttleEndTimeMillis:Date.now()+kt,backoffCount:A+1};return K.setThrottleMetadata(se,Ot),pr.debug(`Calling attemptFetch again in ${kt} millis`),Sl(E,Ot,V,K)}}),Al.apply(this,arguments)}class by{constructor(){this.listeners=[]}addEventListener(D){this.listeners.push(D)}abort(){this.listeners.forEach(D=>D())}}let Fo,Pl;function lp(){return(lp=(0,L.Z)(function*(E,D,A,V,K){if(K&&K.global)E("event",A,V);else{const ee=yield D;E("event",A,Object.assign(Object.assign({},V),{send_to:ee}))}})).apply(this,arguments)}function ln(){return(ln=(0,L.Z)(function*(){if(!(0,ue.hl)())return pr.warn(Vn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,ue.eu)()}catch(E){return pr.warn(Vn.create("indexeddb-unavailable",{errorInfo:E?.toString()}).message),!1}return!0})).apply(this,arguments)}function ut(){return ut=(0,L.Z)(function*(E,D,A,V,K,ee,se){var We;const Ge=function bl(E){return oh.apply(this,arguments)}(E);Ge.then(Tn=>{A[Tn.measurementId]=Tn.appId,E.options.measurementId&&Tn.measurementId!==E.options.measurementId&&pr.warn(`The measurement ID in the local Firebase config (${E.options.measurementId}) does not match the measurement ID fetched from the server (${Tn.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(Tn=>pr.error(Tn)),D.push(Ge);const pt=function Fi(){return ln.apply(this,arguments)}().then(Tn=>{if(Tn)return V.getId()}),[kt,Ot]=yield Promise.all([Ge,pt]);(function wa(E){const D=window.document.getElementsByTagName("script");for(const A of Object.values(D))if(A.src&&A.src.includes(fc)&&A.src.includes(E))return A;return null})(ee)||function va(E,D){const A=function pc(E,D){let A;return window.trustedTypes&&(A=window.trustedTypes.createPolicy(E,D)),A}("firebase-js-sdk-policy",{createScriptURL:op}),V=document.createElement("script"),K=`${fc}?l=${E}&id=${D}`;V.src=A?A?.createScriptURL(K):K,V.async=!0,document.head.appendChild(V)}(ee,kt.measurementId),Pl&&(K("consent","default",Pl),function yc(E){Pl=E}(void 0)),K("js",new Date);const Vr=null!==(We=se?.config)&&void 0!==We?We:{};return Vr[nh]="firebase",Vr.update=!0,null!=Ot&&(Vr[hc]=Ot),K("config",kt.measurementId,Vr),Fo&&(K("set",Fo),function Nl(E){Fo=E}(void 0)),kt.measurementId}),ut.apply(this,arguments)}class Yi{constructor(D){this.app=D}_delete(){return delete sr[this.app.options.appId],Promise.resolve()}}let sr={},uh=[];const _u={};let ch,Ui,ii="dataLayer",Ml="gtag",no=!1;function Vo(E,D,A){!function Uo(){const E=[];if((0,ue.ru)()&&E.push("This is a browser extension environment."),(0,ue.zI)()||E.push("Cookies are not available."),E.length>0){const D=E.map((V,K)=>`(${K+1}) ${V}`).join(" "),A=Vn.create("invalid-analytics-context",{errorInfo:D});pr.warn(A.message)}}();const V=E.options.appId;if(!V)throw Vn.create("no-app-id");if(!E.options.apiKey){if(!E.options.measurementId)throw Vn.create("no-api-key");pr.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${E.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=sr[V])throw Vn.create("already-exists",{id:V});if(!no){!function Cl(E){let D=[];Array.isArray(window[E])?D=window[E]:window[E]=D}(ii);const{wrappedGtag:ee,gtagCore:se}=function Oo(E,D,A,V,K){let ee=function(...se){window[V].push(arguments)};return window[K]&&"function"==typeof window[K]&&(ee=window[K]),window[K]=function gu(E,D,A,V){function ee(){return ee=(0,L.Z)(function*(se,...We){try{if("event"===se){const[Ge,pt]=We;yield function ap(E,D,A,V,K){return ko.apply(this,arguments)}(E,D,A,Ge,pt)}else if("config"===se){const[Ge,pt]=We;yield function Tl(E,D,A,V,K,ee){return eo.apply(this,arguments)}(E,D,A,V,Ge,pt)}else if("consent"===se){const[Ge]=We;E("consent","update",Ge)}else if("get"===se){const[Ge,pt,kt]=We;E("get",Ge,pt,kt)}else if("set"===se){const[Ge]=We;E("set",Ge)}else E(se,...We)}catch(Ge){pr.error(Ge)}}),ee.apply(this,arguments)}return function K(se){return ee.apply(this,arguments)}}(ee,E,D,A),{gtagCore:ee,wrappedGtag:window[K]}}(sr,uh,_u,ii,Ml);Ui=ee,ch=se,no=!0}return sr[V]=function Zi(E,D,A,V,K,ee,se){return ut.apply(this,arguments)}(E,uh,_u,D,ch,ii,A),new Yi(E)}function dh(){return Qi.apply(this,arguments)}function Qi(){return(Qi=(0,L.Z)(function*(){if((0,ue.ru)()||!(0,ue.zI)()||!(0,ue.hl)())return!1;try{return yield(0,ue.eu)()}catch{return!1}})).apply(this,arguments)}const Eu="@firebase/analytics";!function Fl(){(0,re._registerComponent)(new ce.wA(Xs,(D,{options:A})=>Vo(D.getProvider("app").getImmediate(),D.getProvider("installations-internal").getImmediate(),A),"PUBLIC")),(0,re._registerComponent)(new ce.wA("analytics-internal",function E(D){try{const A=D.getProvider(Xs).getImmediate();return{logEvent:(V,K,ee)=>function dp(E,D,A,V){E=(0,ue.m9)(E),function Sy(E,D,A,V,K){return lp.apply(this,arguments)}(Ui,sr[E.app.options.appId],D,A,V).catch(K=>pr.error(K))}(A,V,K,ee)}}catch(A){throw Vn.create("interop-component-reg-failed",{reason:A})}},"PRIVATE")),(0,re.registerVersion)(Eu,"0.10.0"),(0,re.registerVersion)(Eu,"0.10.0","esm2017")}();var Ul=B(4408),Si=B(7565);const Sr=new class Vl extends Si.v{}(class Iu extends Ul.o{constructor(D,A){super(D,A),this.scheduler=D,this.work=A}schedule(D,A=0){return A>0?super.schedule(D,A):(this.delay=A,this.state=D,this.scheduler.flush(this),this)}execute(D,A){return A>0||this.closed?super.execute(D,A):this._execute(D,A)}requestAsyncId(D,A,V=0){return null!=V&&V>0||null==V&&this.delay>0?super.requestAsyncId(D,A,V):(D.flush(this),0)}});var hp=B(4986),Mn=B(8505),ro=B(5363),Ia=B(9468);const Vi=new _.GfV("7.6.1"),Jn="__angularfire_symbol__analyticsIsSupportedValue",Tu="__angularfire_symbol__analyticsIsSupported",wc="__angularfire_symbol__remoteConfigIsSupportedValue",Ca="__angularfire_symbol__remoteConfigIsSupported",Xi="__angularfire_symbol__messagingIsSupportedValue",io="__angularfire_symbol__messagingIsSupported";function Ec(E,D,A){if(D){if(1===D.length)return D[0];const ee=D.filter(se=>se.app===A);if(1===ee.length)return ee[0]}return A.container.getProvider(E).getImmediate({optional:!0})}globalThis[Tu]||(globalThis[Tu]=dh().then(E=>globalThis[Jn]=E).catch(()=>globalThis[Jn]=!1)),globalThis[io]||(globalThis[io]=sp().then(E=>globalThis[Xi]=E).catch(()=>globalThis[Xi]=!1)),globalThis[Ca]||(globalThis[Ca]=Od().then(E=>globalThis[wc]=E).catch(()=>globalThis[wc]=!1));const Da=(E,D)=>{const A=D?[D]:(0,z.C6)(),V=[];return A.forEach(K=>{K.container.getProvider(E).instances.forEach(se=>{V.includes(se)||V.push(se)})}),V};function jo(){}class Bl{constructor(D,A=Sr){this.zone=D,this.delegate=A}now(){return this.delegate.now()}schedule(D,A,V){const K=this.zone;return this.delegate.schedule(function(se){K.runGuarded(()=>{D.apply(this,[se])})},A,V)}}class Du{constructor(D){this.zone=D,this.task=null}call(D,A){const V=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",jo,{},jo,jo)),A.pipe((0,Mn.b)({next:V,complete:V,error:V})).subscribe(D).add(V)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let At=(()=>{class E{constructor(A){this.ngZone=A,this.outsideAngular=A.runOutsideAngular(()=>new Bl(Zone.current)),this.insideAngular=A.run(()=>new Bl(Zone.current,hp.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return E.\u0275fac=function(A){return new(A||E)(_.LFG(_.R0b))},E.\u0275prov=_.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})();function gi(){const E=globalThis.\u0275AngularFireScheduler;if(!E)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return E}function fh(E){return E.pipe((0,ro.Q)(gi().outsideAngular))}function Ji(E){return gi(),function gh(E){return function(A){return(A=A.lift(new Du(E.ngZone))).pipe((0,Ia.R)(E.outsideAngular),(0,ro.Q)(E.insideAngular))}}(gi())(E)}},1389:(wt,Pe,B)=>{B.d(Pe,{$:()=>Mt,A:()=>W,D:()=>Re,I:()=>Hn,J:()=>Mi,L:()=>us,N:()=>zr,P:()=>Zi,Q:()=>Md,R:()=>_c,U:()=>kd,V:()=>Od,W:()=>Xu,X:()=>Ts,Y:()=>Ju,Z:()=>tp,_:()=>ec,a:()=>pi,a0:()=>rp,a1:()=>ll,a2:()=>gm,a3:()=>Vd,a4:()=>Li,a5:()=>Bd,a6:()=>Zs,a7:()=>Ur,a8:()=>Ys,a9:()=>cs,aA:()=>ae,aB:()=>wc,aC:()=>Zn,aD:()=>ti,aE:()=>ro,aF:()=>wu,aG:()=>vu,aH:()=>_n,aL:()=>ds,aO:()=>qs,aa:()=>$d,ab:()=>Hd,ac:()=>mm,ad:()=>zd,ae:()=>Gd,af:()=>fl,ai:()=>Wd,aj:()=>qd,ak:()=>qr,an:()=>np,ao:()=>_l,aq:()=>lu,ar:()=>_a,as:()=>St,at:()=>Dt,au:()=>De,av:()=>Ae,aw:()=>Vr,ax:()=>Ar,ay:()=>Qt,az:()=>Se,b:()=>dc,c:()=>Ui,d:()=>Vo,e:()=>lh,f:()=>Eu,g:()=>Vl,h:()=>Ul,i:()=>Dl,j:()=>hp,k:()=>Rr,l:()=>mu,m:()=>pp,p:()=>ve,r:()=>ah,s:()=>to,u:()=>Fi});var _=B(5861),z=B(2090),L=B(6881),re=B(7582),ue=B(1877),ce=B(4859);const ve={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},W={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const Re=function J(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}},qe=function $e(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ot=new z.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Me=new ue.Yd("@firebase/auth");function je(w,...f){Me.logLevel<=ue.in.ERROR&&Me.error(`Auth (${L.SDK_VERSION}): ${w}`,...f)}function Ae(w,...f){throw Fe(w,...f)}function Se(w,...f){return Fe(w,...f)}function ke(w,f,m){const I=Object.assign(Object.assign({},qe()),{[f]:m});return new z.LL("auth","Firebase",I).create(f,{appName:w.name})}function He(w,f,m){if(!(f instanceof m))throw m.name!==f.constructor.name&&Ae(w,"argument-error"),ke(w,"argument-error",`Type of ${f.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Fe(w,...f){if("string"!=typeof w){const m=f[0],I=[...f.slice(1)];return I[0]&&(I[0].appName=w.name),w._errorFactory.create(m,...I)}return ot.create(w,...f)}function ae(w,f,...m){if(!w)throw Fe(f,...m)}function tt(w){const f="INTERNAL ASSERTION FAILED: "+w;throw je(f),new Error(f)}function St(w,f){w||tt(f)}function st(){var w;return typeof self<"u"&&(null===(w=self.location)||void 0===w?void 0:w.href)||""}function Kt(){return"http:"===dt()||"https:"===dt()}function dt(){var w;return typeof self<"u"&&(null===(w=self.location)||void 0===w?void 0:w.protocol)||null}class li{constructor(f,m){this.shortDelay=f,this.longDelay=m,St(m>f,"Short delay should be less than long delay!"),this.isMobile=(0,z.uI)()||(0,z.b$)()}get(){return function Is(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Kt()||(0,z.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function os(w,f){St(w.emulator,"Emulator should always be set here");const{url:m}=w.emulator;return f?`${m}${f.startsWith("/")?f.slice(1):f}`:m}class le{static initialize(f,m,I){this.fetchImpl=f,m&&(this.headersImpl=m),I&&(this.responseImpl=I)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void tt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void tt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void tt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const pe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},ye=new li(3e4,6e4);function te(w,f){return w.tenantId&&!f.tenantId?Object.assign(Object.assign({},f),{tenantId:w.tenantId}):f}function xe(w,f,m,I){return Ve.apply(this,arguments)}function Ve(){return(Ve=(0,_.Z)(function*(w,f,m,I,x={}){return at(w,x,(0,_.Z)(function*(){let k={},X={};I&&("GET"===f?X=I:k={body:JSON.stringify(I)});const he=(0,z.xO)(Object.assign({key:w.config.apiKey},X)).slice(1),Be=yield w._getAdditionalHeaders();return Be["Content-Type"]="application/json",w.languageCode&&(Be["X-Firebase-Locale"]=w.languageCode),le.fetch()(nn(w,w.config.apiHost,m,he),Object.assign({method:f,headers:Be,referrerPolicy:"no-referrer"},k))}))})).apply(this,arguments)}function at(w,f,m){return ct.apply(this,arguments)}function ct(){return(ct=(0,_.Z)(function*(w,f,m){w._canInitEmulator=!1;const I=Object.assign(Object.assign({},pe),f);try{const x=new Rn(w),k=yield Promise.race([m(),x.promise]);x.clearNetworkTimeout();const X=yield k.json();if("needConfirmation"in X)throw fn(w,"account-exists-with-different-credential",X);if(k.ok&&!("errorMessage"in X))return X;{const he=k.ok?X.errorMessage:X.error.message,[Be,Ke]=he.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===Be)throw fn(w,"credential-already-in-use",X);if("EMAIL_EXISTS"===Be)throw fn(w,"email-already-in-use",X);if("USER_DISABLED"===Be)throw fn(w,"user-disabled",X);const Et=I[Be]||Be.toLowerCase().replace(/[_\s]+/g,"-");if(Ke)throw ke(w,Et,Ke);Ae(w,Et)}}catch(x){if(x instanceof z.ZR)throw x;Ae(w,"network-request-failed",{message:String(x)})}})).apply(this,arguments)}function un(w,f,m,I){return Tt.apply(this,arguments)}function Tt(){return(Tt=(0,_.Z)(function*(w,f,m,I,x={}){const k=yield xe(w,f,m,I,x);return"mfaPendingCredential"in k&&Ae(w,"multi-factor-auth-required",{_serverResponse:k}),k})).apply(this,arguments)}function nn(w,f,m,I){const x=`${f}${m}?${I}`;return w.config.emulator?os(w.config,x):`${w.config.apiScheme}://${x}`}class Rn{constructor(f){this.auth=f,this.timer=null,this.promise=new Promise((m,I)=>{this.timer=setTimeout(()=>I(Se(this.auth,"network-request-failed")),ye.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function fn(w,f,m){const I={appName:w.name};m.email&&(I.email=m.email),m.phoneNumber&&(I.phoneNumber=m.phoneNumber);const x=Se(w,f,I);return x.customData._tokenResponse=m,x}function xn(){return(xn=(0,_.Z)(function*(w,f){return xe(w,"POST","/v1/accounts:delete",f)})).apply(this,arguments)}function ir(){return(ir=(0,_.Z)(function*(w,f){return xe(w,"POST","/v1/accounts:update",f)})).apply(this,arguments)}function Bn(){return(Bn=(0,_.Z)(function*(w,f){return xe(w,"POST","/v1/accounts:lookup",f)})).apply(this,arguments)}function gt(w){if(w)try{const f=new Date(Number(w));if(!isNaN(f.getTime()))return f.toUTCString()}catch{}}function Wn(){return(Wn=(0,_.Z)(function*(w,f=!1){const m=(0,z.m9)(w),I=yield m.getIdToken(f),x=Xr(I);ae(x&&x.exp&&x.auth_time&&x.iat,m.auth,"internal-error");const k="object"==typeof x.firebase?x.firebase:void 0,X=k?.sign_in_provider;return{claims:x,token:I,authTime:gt(Hr(x.auth_time)),issuedAtTime:gt(Hr(x.iat)),expirationTime:gt(Hr(x.exp)),signInProvider:X||null,signInSecondFactor:k?.sign_in_second_factor||null}})).apply(this,arguments)}function Hr(w){return 1e3*Number(w)}function Xr(w){const[f,m,I]=w.split(".");if(void 0===f||void 0===m||void 0===I)return je("JWT malformed, contained fewer than 3 sections"),null;try{const x=(0,z.tV)(m);return x?JSON.parse(x):(je("Failed to decode base64 JWT payload"),null)}catch(x){return je("Caught error parsing JWT payload as JSON",x?.toString()),null}}function Zt(w,f){return ft.apply(this,arguments)}function ft(){return(ft=(0,_.Z)(function*(w,f,m=!1){if(m)return f;try{return yield f}catch(I){throw I instanceof z.ZR&&function Ft({code:w}){return"auth/user-disabled"===w||"auth/user-token-expired"===w}(I)&&w.auth.currentUser===w&&(yield w.auth.signOut()),I}})).apply(this,arguments)}class qn{constructor(f){this.user=f,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(f){var m;if(f){const I=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),I}{this.errorBackoff=3e4;const x=(null!==(m=this.user.stsTokenManager.expirationTime)&&void 0!==m?m:0)-Date.now()-3e5;return Math.max(0,x)}}schedule(f=!1){var m=this;if(!this.isRunning)return;const I=this.getInterval(f);this.timerId=setTimeout((0,_.Z)(function*(){yield m.iteration()}),I)}iteration(){var f=this;return(0,_.Z)(function*(){try{yield f.user.getIdToken(!0)}catch(m){return void("auth/network-request-failed"===m?.code&&f.schedule(!0))}f.schedule()})()}}class kr{constructor(f,m){this.createdAt=f,this.lastLoginAt=m,this._initializeTime()}_initializeTime(){this.lastSignInTime=gt(this.lastLoginAt),this.creationTime=gt(this.createdAt)}_copy(f){this.createdAt=f.createdAt,this.lastLoginAt=f.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Ln(w){return Jr.apply(this,arguments)}function Jr(){return Jr=(0,_.Z)(function*(w){var f;const m=w.auth,I=yield w.getIdToken(),x=yield Zt(w,function Ti(w,f){return Bn.apply(this,arguments)}(m,{idToken:I}));ae(x?.users.length,m,"internal-error");const k=x.users[0];w._notifyReloadListener(k);const X=null!==(f=k.providerUserInfo)&&void 0!==f&&f.length?function Di(w){return w.map(f=>{var{providerId:m}=f,I=(0,re._T)(f,["providerId"]);return{providerId:m,uid:I.rawId||"",displayName:I.displayName||null,email:I.email||null,phoneNumber:I.phoneNumber||null,photoURL:I.photoUrl||null}})}(k.providerUserInfo):[],he=function Yt(w,f){return[...w.filter(I=>!f.some(x=>x.providerId===I.providerId)),...f]}(w.providerData,X),Et=!!w.isAnonymous&&!(w.email&&k.passwordHash||he?.length),Wt={uid:k.localId,displayName:k.displayName||null,photoURL:k.photoUrl||null,email:k.email||null,emailVerified:k.emailVerified||!1,phoneNumber:k.phoneNumber||null,tenantId:k.tenantId||null,providerData:he,metadata:new kr(k.createdAt,k.lastLoginAt),isAnonymous:Et};Object.assign(w,Wt)}),Jr.apply(this,arguments)}function dr(){return(dr=(0,_.Z)(function*(w){const f=(0,z.m9)(w);yield Ln(f),yield f.auth._persistUserIfCurrent(f),f.auth._notifyListenersIfCurrent(f)})).apply(this,arguments)}function di(){return(di=(0,_.Z)(function*(w,f){const m=yield at(w,{},(0,_.Z)(function*(){const I=(0,z.xO)({grant_type:"refresh_token",refresh_token:f}).slice(1),{tokenApiHost:x,apiKey:k}=w.config,X=nn(w,x,"/v1/token",`key=${k}`),he=yield w._getAdditionalHeaders();return he["Content-Type"]="application/x-www-form-urlencoded",le.fetch()(X,{method:"POST",headers:he,body:I})}));return{accessToken:m.access_token,expiresIn:m.expires_in,refreshToken:m.refresh_token}})).apply(this,arguments)}class jt{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(f){ae(f.idToken,"internal-error"),ae(typeof f.idToken<"u","internal-error"),ae(typeof f.refreshToken<"u","internal-error");const m="expiresIn"in f&&typeof f.expiresIn<"u"?Number(f.expiresIn):function cn(w){const f=Xr(w);return ae(f,"internal-error"),ae(typeof f.exp<"u","internal-error"),ae(typeof f.iat<"u","internal-error"),Number(f.exp)-Number(f.iat)}(f.idToken);this.updateTokensAndExpiration(f.idToken,f.refreshToken,m)}getToken(f,m=!1){var I=this;return(0,_.Z)(function*(){return ae(!I.accessToken||I.refreshToken,f,"user-token-expired"),m||!I.accessToken||I.isExpired?I.refreshToken?(yield I.refresh(f,I.refreshToken),I.accessToken):null:I.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(f,m){var I=this;return(0,_.Z)(function*(){const{accessToken:x,refreshToken:k,expiresIn:X}=yield function Jt(w,f){return di.apply(this,arguments)}(f,m);I.updateTokensAndExpiration(x,k,Number(X))})()}updateTokensAndExpiration(f,m,I){this.refreshToken=m||null,this.accessToken=f||null,this.expirationTime=Date.now()+1e3*I}static fromJSON(f,m){const{refreshToken:I,accessToken:x,expirationTime:k}=m,X=new jt;return I&&(ae("string"==typeof I,"internal-error",{appName:f}),X.refreshToken=I),x&&(ae("string"==typeof x,"internal-error",{appName:f}),X.accessToken=x),k&&(ae("number"==typeof k,"internal-error",{appName:f}),X.expirationTime=k),X}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(f){this.accessToken=f.accessToken,this.refreshToken=f.refreshToken,this.expirationTime=f.expirationTime}_clone(){return Object.assign(new jt,this.toJSON())}_performRefresh(){return tt("not implemented")}}function Kn(w,f){ae("string"==typeof w||typeof w>"u","internal-error",{appName:f})}class Fn{constructor(f){var{uid:m,auth:I,stsTokenManager:x}=f,k=(0,re._T)(f,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new qn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=m,this.auth=I,this.stsTokenManager=x,this.accessToken=x.accessToken,this.displayName=k.displayName||null,this.email=k.email||null,this.emailVerified=k.emailVerified||!1,this.phoneNumber=k.phoneNumber||null,this.photoURL=k.photoURL||null,this.isAnonymous=k.isAnonymous||!1,this.tenantId=k.tenantId||null,this.providerData=k.providerData?[...k.providerData]:[],this.metadata=new kr(k.createdAt||void 0,k.lastLoginAt||void 0)}getIdToken(f){var m=this;return(0,_.Z)(function*(){const I=yield Zt(m,m.stsTokenManager.getToken(m.auth,f));return ae(I,m.auth,"internal-error"),m.accessToken!==I&&(m.accessToken=I,yield m.auth._persistUserIfCurrent(m),m.auth._notifyListenersIfCurrent(m)),I})()}getIdTokenResult(f){return function as(w){return Wn.apply(this,arguments)}(this,f)}reload(){return function $n(w){return dr.apply(this,arguments)}(this)}_assign(f){this!==f&&(ae(this.uid===f.uid,this.auth,"internal-error"),this.displayName=f.displayName,this.photoURL=f.photoURL,this.email=f.email,this.emailVerified=f.emailVerified,this.phoneNumber=f.phoneNumber,this.isAnonymous=f.isAnonymous,this.tenantId=f.tenantId,this.providerData=f.providerData.map(m=>Object.assign({},m)),this.metadata._copy(f.metadata),this.stsTokenManager._assign(f.stsTokenManager))}_clone(f){const m=new Fn(Object.assign(Object.assign({},this),{auth:f,stsTokenManager:this.stsTokenManager._clone()}));return m.metadata._copy(this.metadata),m}_onReload(f){ae(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=f,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(f){this.reloadListener?this.reloadListener(f):this.reloadUserInfo=f}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(f,m=!1){var I=this;return(0,_.Z)(function*(){let x=!1;f.idToken&&f.idToken!==I.stsTokenManager.accessToken&&(I.stsTokenManager.updateFromServerResponse(f),x=!0),m&&(yield Ln(I)),yield I.auth._persistUserIfCurrent(I),x&&I.auth._notifyListenersIfCurrent(I)})()}delete(){var f=this;return(0,_.Z)(function*(){const m=yield f.getIdToken();return yield Zt(f,function rr(w,f){return xn.apply(this,arguments)}(f.auth,{idToken:m})),f.stsTokenManager.clearRefreshToken(),f.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(f=>Object.assign({},f)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(f,m){var I,x,k,X,he,Be,Ke,Et;const Wt=null!==(I=m.displayName)&&void 0!==I?I:void 0,mi=null!==(x=m.email)&&void 0!==x?x:void 0,$o=null!==(k=m.phoneNumber)&&void 0!==k?k:void 0,Sa=null!==(X=m.photoURL)&&void 0!==X?X:void 0,jl=null!==(he=m.tenantId)&&void 0!==he?he:void 0,Rs=null!==(Be=m._redirectEventId)&&void 0!==Be?Be:void 0,vp=null!==(Ke=m.createdAt)&&void 0!==Ke?Ke:void 0,vh=null!==(Et=m.lastLoginAt)&&void 0!==Et?Et:void 0,{uid:$l,emailVerified:Aa,isAnonymous:wh,providerData:Eh,stsTokenManager:Dc}=m;ae($l&&Dc,f,"internal-error");const Ih=jt.fromJSON(this.name,Dc);ae("string"==typeof $l,f,"internal-error"),Kn(Wt,f.name),Kn(mi,f.name),ae("boolean"==typeof Aa,f,"internal-error"),ae("boolean"==typeof wh,f,"internal-error"),Kn($o,f.name),Kn(Sa,f.name),Kn(jl,f.name),Kn(Rs,f.name),Kn(vp,f.name),Kn(vh,f.name);const bc=new Fn({uid:$l,auth:f,email:mi,emailVerified:Aa,displayName:Wt,isAnonymous:wh,photoURL:Sa,phoneNumber:$o,tenantId:jl,stsTokenManager:Ih,createdAt:vp,lastLoginAt:vh});return Eh&&Array.isArray(Eh)&&(bc.providerData=Eh.map(Ra=>Object.assign({},Ra))),Rs&&(bc._redirectEventId=Rs),bc}static _fromIdTokenResponse(f,m,I=!1){return(0,_.Z)(function*(){const x=new jt;x.updateFromServerResponse(m);const k=new Fn({uid:m.localId,auth:f,stsTokenManager:x,isAnonymous:I});return yield Ln(k),k})()}}const Or=new Map;function Zn(w){St(w instanceof Function,"Expected a class definition");let f=Or.get(w);return f?(St(f instanceof w,"Instance stored in cache mismatched with class"),f):(f=new w,Or.set(w,f),f)}const zr=(()=>{class w{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,_.Z)(function*(){return!0})()}_set(m,I){var x=this;return(0,_.Z)(function*(){x.storage[m]=I})()}_get(m){var I=this;return(0,_.Z)(function*(){const x=I.storage[m];return void 0===x?null:x})()}_remove(m){var I=this;return(0,_.Z)(function*(){delete I.storage[m]})()}_addListener(m,I){}_removeListener(m,I){}}return w.type="NONE",w})();function ti(w,f,m){return`firebase:${w}:${f}:${m}`}class G{constructor(f,m,I){this.persistence=f,this.auth=m,this.userKey=I;const{config:x,name:k}=this.auth;this.fullUserKey=ti(this.userKey,x.apiKey,k),this.fullPersistenceKey=ti("persistence",x.apiKey,k),this.boundEventHandler=m._onStorageEvent.bind(m),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(f){return this.persistence._set(this.fullUserKey,f.toJSON())}getCurrentUser(){var f=this;return(0,_.Z)(function*(){const m=yield f.persistence._get(f.fullUserKey);return m?Fn._fromJSON(f.auth,m):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(f){var m=this;return(0,_.Z)(function*(){if(m.persistence===f)return;const I=yield m.getCurrentUser();return yield m.removeCurrentUser(),m.persistence=f,I?m.setCurrentUser(I):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(f,m,I="authUser"){return(0,_.Z)(function*(){if(!m.length)return new G(Zn(zr),f,I);const x=(yield Promise.all(m.map(function(){var Ke=(0,_.Z)(function*(Et){if(yield Et._isAvailable())return Et});return function(Et){return Ke.apply(this,arguments)}}()))).filter(Ke=>Ke);let k=x[0]||Zn(zr);const X=ti(I,f.config.apiKey,f.name);let he=null;for(const Ke of m)try{const Et=yield Ke._get(X);if(Et){const Wt=Fn._fromJSON(f,Et);Ke!==k&&(he=Wt),k=Ke;break}}catch{}const Be=x.filter(Ke=>Ke._shouldAllowMigration);return k._shouldAllowMigration&&Be.length?(k=Be[0],he&&(yield k._set(X,he.toJSON())),yield Promise.all(m.map(function(){var Ke=(0,_.Z)(function*(Et){if(Et!==k)try{yield Et._remove(X)}catch{}});return function(Et){return Ke.apply(this,arguments)}}())),new G(k,f,I)):new G(k,f,I)})()}}function H(w){const f=w.toLowerCase();if(f.includes("opera/")||f.includes("opr/")||f.includes("opios/"))return"Opera";if(Z(f))return"IEMobile";if(f.includes("msie")||f.includes("trident/"))return"IE";if(f.includes("edge/"))return"Edge";if(O(f))return"Firefox";if(f.includes("silk/"))return"Silk";if(nt(f))return"Blackberry";if(Rt(f))return"Webos";if(F(f))return"Safari";if((f.includes("chrome/")||N(f))&&!f.includes("edge/"))return"Chrome";if(De(f))return"Android";{const I=w.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===I?.length)return I[1]}return"Other"}function O(w=(0,z.z$)()){return/firefox\//i.test(w)}function F(w=(0,z.z$)()){const f=w.toLowerCase();return f.includes("safari/")&&!f.includes("chrome/")&&!f.includes("crios/")&&!f.includes("android")}function N(w=(0,z.z$)()){return/crios\//i.test(w)}function Z(w=(0,z.z$)()){return/iemobile/i.test(w)}function De(w=(0,z.z$)()){return/android/i.test(w)}function nt(w=(0,z.z$)()){return/blackberry/i.test(w)}function Rt(w=(0,z.z$)()){return/webos/i.test(w)}function Dt(w=(0,z.z$)()){return/iphone|ipad|ipod/i.test(w)||/macintosh/i.test(w)&&/mobile/i.test(w)}function Qt(w=(0,z.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(w)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(w)}function $t(w=(0,z.z$)()){return Dt(w)||De(w)||Rt(w)||nt(w)||/windows phone/i.test(w)||Z(w)}function Cs(w,f=[]){let m;switch(w){case"Browser":m=H((0,z.z$)());break;case"Worker":m=`${H((0,z.z$)())}-${w}`;break;default:m=w}const I=f.length?f.join(","):"FirebaseCore-web";return`${m}/JsCore/${L.SDK_VERSION}/${I}`}function ie(){return(ie=(0,_.Z)(function*(w){return(yield xe(w,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Ue(w,f){return _t.apply(this,arguments)}function _t(){return(_t=(0,_.Z)(function*(w,f){return xe(w,"GET","/v2/recaptchaConfig",te(w,f))})).apply(this,arguments)}function xt(w){return void 0!==w&&void 0!==w.getResponse}function en(w){return void 0!==w&&void 0!==w.enterprise}class vt{constructor(f){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===f.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=f.recaptchaKey.split("/")[3],this.emailPasswordEnabled=f.recaptchaEnforcementState.some(m=>"EMAIL_PASSWORD_PROVIDER"===m.provider&&"OFF"!==m.enforcementState)}}function sn(w){return new Promise((f,m)=>{const I=document.createElement("script");I.setAttribute("src",w),I.onload=f,I.onerror=x=>{const k=Se("internal-error");k.customData=x,m(k)},I.type="text/javascript",I.charset="UTF-8",function mn(){var w,f;return null!==(f=null===(w=document.getElementsByTagName("head"))||void 0===w?void 0:w[0])&&void 0!==f?f:document}().appendChild(I)})}function Gr(w){return`__${w}${Math.floor(1e6*Math.random())}`}const Zf="NO_RECAPTCHA";class Io{constructor(f){this.type="recaptcha-enterprise",this.auth=_n(f)}verify(f="verify",m=!1){var I=this;return(0,_.Z)(function*(){function k(){return k=(0,_.Z)(function*(he){if(!m){if(null==he.tenantId&&null!=he._agentRecaptchaConfig)return he._agentRecaptchaConfig.siteKey;if(null!=he.tenantId&&void 0!==he._tenantRecaptchaConfigs[he.tenantId])return he._tenantRecaptchaConfigs[he.tenantId].siteKey}return new Promise(function(){var Be=(0,_.Z)(function*(Ke,Et){Ue(he,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(Wt=>{if(void 0!==Wt.recaptchaKey){const mi=new vt(Wt);return null==he.tenantId?he._agentRecaptchaConfig=mi:he._tenantRecaptchaConfigs[he.tenantId]=mi,Ke(mi.siteKey)}Et(new Error("recaptcha Enterprise site key undefined"))}).catch(Wt=>{Et(Wt)})});return function(Ke,Et){return Be.apply(this,arguments)}}())}),k.apply(this,arguments)}function X(he,Be,Ke){const Et=window.grecaptcha;en(Et)?Et.enterprise.ready(()=>{Et.enterprise.execute(he,{action:f}).then(Wt=>{Be(Wt)}).catch(()=>{Be(Zf)})}):Ke(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((he,Be)=>{(function x(he){return k.apply(this,arguments)})(I.auth).then(Ke=>{if(!m&&en(window.grecaptcha))X(Ke,he,Be);else{if(typeof window>"u")return void Be(new Error("RecaptchaVerifier is only supported in browser"));sn("https://www.google.com/recaptcha/enterprise.js?render="+Ke).then(()=>{X(Ke,he,Be)}).catch(Et=>{Be(Et)})}}).catch(Ke=>{Be(Ke)})})})()}}function Tr(w,f,m){return Je.apply(this,arguments)}function Je(){return(Je=(0,_.Z)(function*(w,f,m,I=!1){const x=new Io(w);let k;try{k=yield x.verify(m)}catch{k=yield x.verify(m,!0)}const X=Object.assign({},f);return Object.assign(X,I?{captchaResp:k}:{captchaResponse:k}),Object.assign(X,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(X,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),X})).apply(this,arguments)}class Xt{constructor(f){this.auth=f,this.queue=[]}pushCallback(f,m){const I=k=>new Promise((X,he)=>{try{X(f(k))}catch(Be){he(Be)}});I.onAbort=m,this.queue.push(I);const x=this.queue.length-1;return()=>{this.queue[x]=()=>Promise.resolve()}}runMiddleware(f){var m=this;return(0,_.Z)(function*(){if(m.auth.currentUser===f)return;const I=[];try{for(const x of m.queue)yield x(f),x.onAbort&&I.push(x.onAbort)}catch(x){I.reverse();for(const k of I)try{k()}catch{}throw m.auth._errorFactory.create("login-blocked",{originalMessage:x?.message})}})()}}class Pn{constructor(f,m,I,x){this.app=f,this.heartbeatServiceProvider=m,this.appCheckServiceProvider=I,this.config=x,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new js(this),this.idTokenSubscription=new js(this),this.beforeStateQueue=new Xt(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ot,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=f.name,this.clientVersion=x.sdkClientVersion}_initializeWithPersistence(f,m){var I=this;return m&&(this._popupRedirectResolver=Zn(m)),this._initializationPromise=this.queue((0,_.Z)(function*(){var x,k;if(!I._deleted&&(I.persistenceManager=yield G.create(I,f),!I._deleted)){if(null!==(x=I._popupRedirectResolver)&&void 0!==x&&x._shouldInitProactively)try{yield I._popupRedirectResolver._initialize(I)}catch{}yield I.initializeCurrentUser(m),I.lastNotifiedUid=(null===(k=I.currentUser)||void 0===k?void 0:k.uid)||null,!I._deleted&&(I._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var f=this;return(0,_.Z)(function*(){if(f._deleted)return;const m=yield f.assertedPersistence.getCurrentUser();if(f.currentUser||m){if(f.currentUser&&m&&f.currentUser.uid===m.uid)return f._currentUser._assign(m),void(yield f.currentUser.getIdToken());yield f._updateCurrentUser(m,!0)}})()}initializeCurrentUser(f){var m=this;return(0,_.Z)(function*(){var I;const x=yield m.assertedPersistence.getCurrentUser();let k=x,X=!1;if(f&&m.config.authDomain){yield m.getOrInitRedirectPersistenceManager();const he=null===(I=m.redirectUser)||void 0===I?void 0:I._redirectEventId,Be=k?._redirectEventId,Ke=yield m.tryRedirectSignIn(f);(!he||he===Be)&&Ke?.user&&(k=Ke.user,X=!0)}if(!k)return m.directlySetCurrentUser(null);if(!k._redirectEventId){if(X)try{yield m.beforeStateQueue.runMiddleware(k)}catch(he){k=x,m._popupRedirectResolver._overrideRedirectResult(m,()=>Promise.reject(he))}return k?m.reloadAndSetCurrentUserOrClear(k):m.directlySetCurrentUser(null)}return ae(m._popupRedirectResolver,m,"argument-error"),yield m.getOrInitRedirectPersistenceManager(),m.redirectUser&&m.redirectUser._redirectEventId===k._redirectEventId?m.directlySetCurrentUser(k):m.reloadAndSetCurrentUserOrClear(k)})()}tryRedirectSignIn(f){var m=this;return(0,_.Z)(function*(){let I=null;try{I=yield m._popupRedirectResolver._completeRedirectFn(m,f,!0)}catch{yield m._setRedirectUser(null)}return I})()}reloadAndSetCurrentUserOrClear(f){var m=this;return(0,_.Z)(function*(){try{yield Ln(f)}catch(I){if("auth/network-request-failed"!==I?.code)return m.directlySetCurrentUser(null)}return m.directlySetCurrentUser(f)})()}useDeviceLanguage(){this.languageCode=function Er(){if(typeof navigator>"u")return null;const w=navigator;return w.languages&&w.languages[0]||w.language||null}()}_delete(){var f=this;return(0,_.Z)(function*(){f._deleted=!0})()}updateCurrentUser(f){var m=this;return(0,_.Z)(function*(){const I=f?(0,z.m9)(f):null;return I&&ae(I.auth.config.apiKey===m.config.apiKey,m,"invalid-user-token"),m._updateCurrentUser(I&&I._clone(m))})()}_updateCurrentUser(f,m=!1){var I=this;return(0,_.Z)(function*(){if(!I._deleted)return f&&ae(I.tenantId===f.tenantId,I,"tenant-id-mismatch"),m||(yield I.beforeStateQueue.runMiddleware(f)),I.queue((0,_.Z)(function*(){yield I.directlySetCurrentUser(f),I.notifyAuthListeners()}))})()}signOut(){var f=this;return(0,_.Z)(function*(){return yield f.beforeStateQueue.runMiddleware(null),(f.redirectPersistenceManager||f._popupRedirectResolver)&&(yield f._setRedirectUser(null)),f._updateCurrentUser(null,!0)})()}setPersistence(f){var m=this;return this.queue((0,_.Z)(function*(){yield m.assertedPersistence.setPersistence(Zn(f))}))}initializeRecaptchaConfig(){var f=this;return(0,_.Z)(function*(){const m=yield Ue(f,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),I=new vt(m);null==f.tenantId?f._agentRecaptchaConfig=I:f._tenantRecaptchaConfigs[f.tenantId]=I,I.emailPasswordEnabled&&new Io(f).verify()})()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(f){this._errorFactory=new z.LL("auth","Firebase",f())}onAuthStateChanged(f,m,I){return this.registerStateListener(this.authStateSubscription,f,m,I)}beforeAuthStateChanged(f,m){return this.beforeStateQueue.pushCallback(f,m)}onIdTokenChanged(f,m,I){return this.registerStateListener(this.idTokenSubscription,f,m,I)}toJSON(){var f;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(f=this._currentUser)||void 0===f?void 0:f.toJSON()}}_setRedirectUser(f,m){var I=this;return(0,_.Z)(function*(){const x=yield I.getOrInitRedirectPersistenceManager(m);return null===f?x.removeCurrentUser():x.setCurrentUser(f)})()}getOrInitRedirectPersistenceManager(f){var m=this;return(0,_.Z)(function*(){if(!m.redirectPersistenceManager){const I=f&&Zn(f)||m._popupRedirectResolver;ae(I,m,"argument-error"),m.redirectPersistenceManager=yield G.create(m,[Zn(I._redirectPersistence)],"redirectUser"),m.redirectUser=yield m.redirectPersistenceManager.getCurrentUser()}return m.redirectPersistenceManager})()}_redirectUserForId(f){var m=this;return(0,_.Z)(function*(){var I,x;return m._isInitialized&&(yield m.queue((0,_.Z)(function*(){}))),(null===(I=m._currentUser)||void 0===I?void 0:I._redirectEventId)===f?m._currentUser:(null===(x=m.redirectUser)||void 0===x?void 0:x._redirectEventId)===f?m.redirectUser:null})()}_persistUserIfCurrent(f){var m=this;return(0,_.Z)(function*(){if(f===m.currentUser)return m.queue((0,_.Z)(function*(){return m.directlySetCurrentUser(f)}))})()}_notifyListenersIfCurrent(f){f===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var f,m;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const I=null!==(m=null===(f=this.currentUser)||void 0===f?void 0:f.uid)&&void 0!==m?m:null;this.lastNotifiedUid!==I&&(this.lastNotifiedUid=I,this.authStateSubscription.next(this.currentUser))}registerStateListener(f,m,I,x){if(this._deleted)return()=>{};const k="function"==typeof m?m:m.next.bind(m),X=this._isInitialized?Promise.resolve():this._initializationPromise;return ae(X,this,"internal-error"),X.then(()=>k(this.currentUser)),"function"==typeof m?f.addObserver(m,I,x):f.addObserver(m)}directlySetCurrentUser(f){var m=this;return(0,_.Z)(function*(){m.currentUser&&m.currentUser!==f&&m._currentUser._stopProactiveRefresh(),f&&m.isProactiveRefreshEnabled&&f._startProactiveRefresh(),m.currentUser=f,f?yield m.assertedPersistence.setCurrentUser(f):yield m.assertedPersistence.removeCurrentUser()})()}queue(f){return this.operations=this.operations.then(f,f),this.operations}get assertedPersistence(){return ae(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(f){!f||this.frameworks.includes(f)||(this.frameworks.push(f),this.frameworks.sort(),this.clientVersion=Cs(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var f=this;return(0,_.Z)(function*(){var m;const I={"X-Client-Version":f.clientVersion};f.app.options.appId&&(I["X-Firebase-gmpid"]=f.app.options.appId);const x=yield null===(m=f.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===m?void 0:m.getHeartbeatsHeader();x&&(I["X-Firebase-Client"]=x);const k=yield f._getAppCheckToken();return k&&(I["X-Firebase-AppCheck"]=k),I})()}_getAppCheckToken(){var f=this;return(0,_.Z)(function*(){var m;const I=yield null===(m=f.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===m?void 0:m.getToken();return I?.error&&function Le(w,...f){Me.logLevel<=ue.in.WARN&&Me.warn(`Auth (${L.SDK_VERSION}): ${w}`,...f)}(`Error while retrieving App Check token: ${I.error}`),I?.token})()}}function _n(w){return(0,z.m9)(w)}class js{constructor(f){this.auth=f,this.observer=null,this.addObserver=(0,z.ne)(m=>this.observer=m)}get next(){return ae(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Hn(w,f,m){const I=_n(w);ae(I._canInitEmulator,I,"emulator-config-failed"),ae(/^https?:\/\//.test(f),I,"invalid-emulator-scheme");const x=!!m?.disableWarnings,k=Xa(f),{host:X,port:he}=function $s(w){const f=Xa(w),m=/(\/\/)?([^?#/]+)/.exec(w.substr(f.length));if(!m)return{host:"",port:null};const I=m[2].split("@").pop()||"",x=/^(\[[^\]]+\])(:|$)/.exec(I);if(x){const k=x[1];return{host:k,port:zt(I.substr(k.length+1))}}{const[k,X]=I.split(":");return{host:k,port:zt(X)}}}(f);I.config.emulator={url:`${k}//${X}${null===he?"":`:${he}`}/`},I.settings.appVerificationDisabledForTesting=!0,I.emulatorConfig=Object.freeze({host:X,port:he,protocol:k.replace(":",""),options:Object.freeze({disableWarnings:x})}),x||function Yu(){function w(){const f=document.createElement("p"),m=f.style;f.innerText="Running in emulator mode. Do not use with production credentials.",m.position="fixed",m.width="100%",m.backgroundColor="#ffffff",m.border=".1em solid #000000",m.color="#b50000",m.bottom="0px",m.left="0px",m.margin="0px",m.zIndex="10000",m.textAlign="center",f.classList.add("firebase-emulator-warning"),document.body.appendChild(f)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",w):w())}()}function Xa(w){const f=w.indexOf(":");return f<0?"":w.substr(0,f+1)}function zt(w){if(!w)return null;const f=Number(w);return isNaN(f)?null:f}class Mi{constructor(f,m){this.providerId=f,this.signInMethod=m}toJSON(){return tt("not implemented")}_getIdTokenResponse(f){return tt("not implemented")}_linkToIdToken(f,m){return tt("not implemented")}_getReauthenticationResolver(f){return tt("not implemented")}}function Ja(w,f){return Hs.apply(this,arguments)}function Hs(){return(Hs=(0,_.Z)(function*(w,f){return xe(w,"POST","/v1/accounts:resetPassword",te(w,f))})).apply(this,arguments)}function hr(w,f){return Co.apply(this,arguments)}function Co(){return(Co=(0,_.Z)(function*(w,f){return xe(w,"POST","/v1/accounts:update",f)})).apply(this,arguments)}function ki(){return(ki=(0,_.Z)(function*(w,f){return xe(w,"POST","/v1/accounts:update",te(w,f))})).apply(this,arguments)}function ra(w,f){return Wr.apply(this,arguments)}function Wr(){return(Wr=(0,_.Z)(function*(w,f){return un(w,"POST","/v1/accounts:signInWithPassword",te(w,f))})).apply(this,arguments)}function Cn(w,f){return Oi.apply(this,arguments)}function Oi(){return(Oi=(0,_.Z)(function*(w,f){return xe(w,"POST","/v1/accounts:sendOobCode",te(w,f))})).apply(this,arguments)}function eu(){return(eu=(0,_.Z)(function*(w,f){return Cn(w,f)})).apply(this,arguments)}function ia(w,f){return zs.apply(this,arguments)}function zs(){return(zs=(0,_.Z)(function*(w,f){return Cn(w,f)})).apply(this,arguments)}function Do(w,f){return Lr.apply(this,arguments)}function Lr(){return(Lr=(0,_.Z)(function*(w,f){return Cn(w,f)})).apply(this,arguments)}function ni(){return(ni=(0,_.Z)(function*(w,f){return Cn(w,f)})).apply(this,arguments)}function bo(){return(bo=(0,_.Z)(function*(w,f){return un(w,"POST","/v1/accounts:signInWithEmailLink",te(w,f))})).apply(this,arguments)}function tu(){return(tu=(0,_.Z)(function*(w,f){return un(w,"POST","/v1/accounts:signInWithEmailLink",te(w,f))})).apply(this,arguments)}class hi extends Mi{constructor(f,m,I,x=null){super("password",I),this._email=f,this._password=m,this._tenantId=x}static _fromEmailAndPassword(f,m){return new hi(f,m,"password")}static _fromEmailAndCode(f,m,I=null){return new hi(f,m,"emailLink",I)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(f){const m="string"==typeof f?JSON.parse(f):f;if(m?.email&&m?.password){if("password"===m.signInMethod)return this._fromEmailAndPassword(m.email,m.password);if("emailLink"===m.signInMethod)return this._fromEmailAndCode(m.email,m.password,m.tenantId)}return null}_getIdTokenResponse(f){var m=this;return(0,_.Z)(function*(){var I;switch(m.signInMethod){case"password":const x={returnSecureToken:!0,email:m._email,password:m._password,clientType:"CLIENT_TYPE_WEB"};if(null!==(I=f._getRecaptchaConfig())&&void 0!==I&&I.emailPasswordEnabled){const k=yield Tr(f,x,"signInWithPassword");return ra(f,k)}return ra(f,x).catch(function(){var k=(0,_.Z)(function*(X){if("auth/missing-recaptcha-token"===X.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const he=yield Tr(f,x,"signInWithPassword");return ra(f,he)}return Promise.reject(X)});return function(X){return k.apply(this,arguments)}}());case"emailLink":return function Ki(w,f){return bo.apply(this,arguments)}(f,{email:m._email,oobCode:m._password});default:Ae(f,"internal-error")}})()}_linkToIdToken(f,m){var I=this;return(0,_.Z)(function*(){switch(I.signInMethod){case"password":return hr(f,{idToken:m,returnSecureToken:!0,email:I._email,password:I._password});case"emailLink":return function Qu(w,f){return tu.apply(this,arguments)}(f,{idToken:m,email:I._email,oobCode:I._password});default:Ae(f,"internal-error")}})()}_getReauthenticationResolver(f){return this._getIdTokenResponse(f)}}function Gs(w,f){return nu.apply(this,arguments)}function nu(){return(nu=(0,_.Z)(function*(w,f){return un(w,"POST","/v1/accounts:signInWithIdp",te(w,f))})).apply(this,arguments)}class us extends Mi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(f){const m=new us(f.providerId,f.signInMethod);return f.idToken||f.accessToken?(f.idToken&&(m.idToken=f.idToken),f.accessToken&&(m.accessToken=f.accessToken),f.nonce&&!f.pendingToken&&(m.nonce=f.nonce),f.pendingToken&&(m.pendingToken=f.pendingToken)):f.oauthToken&&f.oauthTokenSecret?(m.accessToken=f.oauthToken,m.secret=f.oauthTokenSecret):Ae("argument-error"),m}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(f){const m="string"==typeof f?JSON.parse(f):f,{providerId:I,signInMethod:x}=m,k=(0,re._T)(m,["providerId","signInMethod"]);if(!I||!x)return null;const X=new us(I,x);return X.idToken=k.idToken||void 0,X.accessToken=k.accessToken||void 0,X.secret=k.secret,X.nonce=k.nonce,X.pendingToken=k.pendingToken||null,X}_getIdTokenResponse(f){return Gs(f,this.buildRequest())}_linkToIdToken(f,m){const I=this.buildRequest();return I.idToken=m,Gs(f,I)}_getReauthenticationResolver(f){const m=this.buildRequest();return m.autoCreate=!1,Gs(f,m)}buildRequest(){const f={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)f.pendingToken=this.pendingToken;else{const m={};this.idToken&&(m.id_token=this.idToken),this.accessToken&&(m.access_token=this.accessToken),this.secret&&(m.oauth_token_secret=this.secret),m.providerId=this.providerId,this.nonce&&!this.pendingToken&&(m.nonce=this.nonce),f.postBody=(0,z.xO)(m)}return f}}function Ad(){return(Ad=(0,_.Z)(function*(w,f){return xe(w,"POST","/v1/accounts:sendVerificationCode",te(w,f))})).apply(this,arguments)}function Rd(){return(Rd=(0,_.Z)(function*(w,f){return un(w,"POST","/v1/accounts:signInWithPhoneNumber",te(w,f))})).apply(this,arguments)}function xd(){return(xd=(0,_.Z)(function*(w,f){const m=yield un(w,"POST","/v1/accounts:signInWithPhoneNumber",te(w,f));if(m.temporaryProof)throw fn(w,"account-exists-with-different-credential",m);return m})).apply(this,arguments)}const Pd={USER_NOT_FOUND:"user-not-found"};function Qf(){return(Qf=(0,_.Z)(function*(w,f){return un(w,"POST","/v1/accounts:signInWithPhoneNumber",te(w,Object.assign(Object.assign({},f),{operation:"REAUTH"})),Pd)})).apply(this,arguments)}class Ws extends Mi{constructor(f){super("phone","phone"),this.params=f}static _fromVerification(f,m){return new Ws({verificationId:f,verificationCode:m})}static _fromTokenResponse(f,m){return new Ws({phoneNumber:f,temporaryProof:m})}_getIdTokenResponse(f){return function Yf(w,f){return Rd.apply(this,arguments)}(f,this._makeVerificationRequest())}_linkToIdToken(f,m){return function pm(w,f){return xd.apply(this,arguments)}(f,Object.assign({idToken:m},this._makeVerificationRequest()))}_getReauthenticationResolver(f){return function Nd(w,f){return Qf.apply(this,arguments)}(f,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:f,phoneNumber:m,verificationId:I,verificationCode:x}=this.params;return f&&m?{temporaryProof:f,phoneNumber:m}:{sessionInfo:I,code:x}}toJSON(){const f={providerId:this.providerId};return this.params.phoneNumber&&(f.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(f.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(f.verificationCode=this.params.verificationCode),this.params.verificationId&&(f.verificationId=this.params.verificationId),f}static fromJSON(f){"string"==typeof f&&(f=JSON.parse(f));const{verificationId:m,verificationCode:I,phoneNumber:x,temporaryProof:k}=f;return I||m||x||k?new Ws({verificationId:m,verificationCode:I,phoneNumber:x,temporaryProof:k}):null}}class oa{constructor(f){var m,I,x,k,X,he;const Be=(0,z.zd)((0,z.pd)(f)),Ke=null!==(m=Be.apiKey)&&void 0!==m?m:null,Et=null!==(I=Be.oobCode)&&void 0!==I?I:null,Wt=function sa(w){switch(w){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(x=Be.mode)&&void 0!==x?x:null);ae(Ke&&Et&&Wt,"argument-error"),this.apiKey=Ke,this.operation=Wt,this.code=Et,this.continueUrl=null!==(k=Be.continueUrl)&&void 0!==k?k:null,this.languageCode=null!==(X=Be.languageCode)&&void 0!==X?X:null,this.tenantId=null!==(he=Be.tenantId)&&void 0!==he?he:null}static parseLink(f){const m=function Xf(w){const f=(0,z.zd)((0,z.pd)(w)).link,m=f?(0,z.zd)((0,z.pd)(f)).deep_link_id:null,I=(0,z.zd)((0,z.pd)(w)).deep_link_id;return(I?(0,z.zd)((0,z.pd)(I)).link:null)||I||m||f||w}(f);try{return new oa(m)}catch{return null}}}let Md=(()=>{class w{constructor(){this.providerId=w.PROVIDER_ID}static credential(m,I){return hi._fromEmailAndPassword(m,I)}static credentialWithLink(m,I){const x=oa.parseLink(I);return ae(x,"argument-error"),hi._fromEmailAndCode(m,x.code,x.tenantId)}}return w.PROVIDER_ID="password",w.EMAIL_PASSWORD_SIGN_IN_METHOD="password",w.EMAIL_LINK_SIGN_IN_METHOD="emailLink",w})();class So{constructor(f){this.providerId=f,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(f){this.defaultLanguageCode=f}setCustomParameters(f){return this.customParameters=f,this}getCustomParameters(){return this.customParameters}}class aa extends So{constructor(){super(...arguments),this.scopes=[]}addScope(f){return this.scopes.includes(f)||this.scopes.push(f),this}getScopes(){return[...this.scopes]}}class Ts extends aa{static credentialFromJSON(f){const m="string"==typeof f?JSON.parse(f):f;return ae("providerId"in m&&"signInMethod"in m,"argument-error"),us._fromParams(m)}credential(f){return this._credential(Object.assign(Object.assign({},f),{nonce:f.rawNonce}))}_credential(f){return ae(f.idToken||f.accessToken,"argument-error"),us._fromParams(Object.assign(Object.assign({},f),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(f){return Ts.oauthCredentialFromTaggedObject(f)}static credentialFromError(f){return Ts.oauthCredentialFromTaggedObject(f.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:f}){if(!f)return null;const{oauthIdToken:m,oauthAccessToken:I,oauthTokenSecret:x,pendingToken:k,nonce:X,providerId:he}=f;if(!I&&!x&&!m&&!k||!he)return null;try{return new Ts(he)._credential({idToken:m,accessToken:I,nonce:X,pendingToken:k})}catch{return null}}}let kd=(()=>{class w extends aa{constructor(){super("facebook.com")}static credential(m){return us._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.FACEBOOK_SIGN_IN_METHOD,accessToken:m})}static credentialFromResult(m){return w.credentialFromTaggedObject(m)}static credentialFromError(m){return w.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m||!("oauthAccessToken"in m)||!m.oauthAccessToken)return null;try{return w.credential(m.oauthAccessToken)}catch{return null}}}return w.FACEBOOK_SIGN_IN_METHOD="facebook.com",w.PROVIDER_ID="facebook.com",w})(),Od=(()=>{class w extends aa{constructor(){super("google.com"),this.addScope("profile")}static credential(m,I){return us._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.GOOGLE_SIGN_IN_METHOD,idToken:m,accessToken:I})}static credentialFromResult(m){return w.credentialFromTaggedObject(m)}static credentialFromError(m){return w.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{oauthIdToken:I,oauthAccessToken:x}=m;if(!I&&!x)return null;try{return w.credential(I,x)}catch{return null}}}return w.GOOGLE_SIGN_IN_METHOD="google.com",w.PROVIDER_ID="google.com",w})(),Xu=(()=>{class w extends aa{constructor(){super("github.com")}static credential(m){return us._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.GITHUB_SIGN_IN_METHOD,accessToken:m})}static credentialFromResult(m){return w.credentialFromTaggedObject(m)}static credentialFromError(m){return w.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m||!("oauthAccessToken"in m)||!m.oauthAccessToken)return null;try{return w.credential(m.oauthAccessToken)}catch{return null}}}return w.GITHUB_SIGN_IN_METHOD="github.com",w.PROVIDER_ID="github.com",w})();class qs extends Mi{constructor(f,m){super(f,f),this.pendingToken=m}_getIdTokenResponse(f){return Gs(f,this.buildRequest())}_linkToIdToken(f,m){const I=this.buildRequest();return I.idToken=m,Gs(f,I)}_getReauthenticationResolver(f){const m=this.buildRequest();return m.autoCreate=!1,Gs(f,m)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(f){const m="string"==typeof f?JSON.parse(f):f,{providerId:I,signInMethod:x,pendingToken:k}=m;return I&&x&&k&&I===x?new qs(I,k):null}static _create(f,m){return new qs(f,m)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Ju extends So{constructor(f){ae(f.startsWith("saml."),"argument-error"),super(f)}static credentialFromResult(f){return Ju.samlCredentialFromTaggedObject(f)}static credentialFromError(f){return Ju.samlCredentialFromTaggedObject(f.customData||{})}static credentialFromJSON(f){const m=qs.fromJSON(f);return ae(m,"argument-error"),m}static samlCredentialFromTaggedObject({_tokenResponse:f}){if(!f)return null;const{pendingToken:m,providerId:I}=f;if(!m||!I)return null;try{return qs._create(I,m)}catch{return null}}}let tp=(()=>{class w extends aa{constructor(){super("twitter.com")}static credential(m,I){return us._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.TWITTER_SIGN_IN_METHOD,oauthToken:m,oauthTokenSecret:I})}static credentialFromResult(m){return w.credentialFromTaggedObject(m)}static credentialFromError(m){return w.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{oauthAccessToken:I,oauthTokenSecret:x}=m;if(!I||!x)return null;try{return w.credential(I,x)}catch{return null}}}return w.TWITTER_SIGN_IN_METHOD="twitter.com",w.PROVIDER_ID="twitter.com",w})();function ua(w,f){return Ao.apply(this,arguments)}function Ao(){return(Ao=(0,_.Z)(function*(w,f){return un(w,"POST","/v1/accounts:signUp",te(w,f))})).apply(this,arguments)}class Un{constructor(f){this.user=f.user,this.providerId=f.providerId,this._tokenResponse=f._tokenResponse,this.operationType=f.operationType}static _fromIdTokenResponse(f,m,I,x=!1){return(0,_.Z)(function*(){const k=yield Fn._fromIdTokenResponse(f,I,x),X=ru(I);return new Un({user:k,providerId:X,_tokenResponse:I,operationType:m})})()}static _forOperation(f,m,I){return(0,_.Z)(function*(){yield f._updateTokensIfNecessary(I,!0);const x=ru(I);return new Un({user:f,providerId:x,_tokenResponse:I,operationType:m})})()}}function ru(w){return w.providerId?w.providerId:"phoneNumber"in w?"phone":null}function ec(w){return fr.apply(this,arguments)}function fr(){return(fr=(0,_.Z)(function*(w){var f;const m=_n(w);if(yield m._initializationPromise,null!==(f=m.currentUser)&&void 0!==f&&f.isAnonymous)return new Un({user:m.currentUser,providerId:null,operationType:"signIn"});const I=yield ua(m,{returnSecureToken:!0}),x=yield Un._fromIdTokenResponse(m,"signIn",I,!0);return yield m._updateCurrentUser(x.user),x})).apply(this,arguments)}class Ro extends z.ZR{constructor(f,m,I,x){var k;super(m.code,m.message),this.operationType=I,this.user=x,Object.setPrototypeOf(this,Ro.prototype),this.customData={appName:f.name,tenantId:null!==(k=f.tenantId)&&void 0!==k?k:void 0,_serverResponse:m.customData._serverResponse,operationType:I}}static _fromErrorAndOperation(f,m,I,x){return new Ro(f,m,I,x)}}function xo(w,f,m,I){return("reauthenticate"===f?m._getReauthenticationResolver(w):m._getIdTokenResponse(w)).catch(k=>{throw"auth/multi-factor-auth-required"===k.code?Ro._fromErrorAndOperation(w,k,f,I):k})}function Fr(w){return new Set(w.map(({providerId:f})=>f).filter(f=>!!f))}function np(w,f){return tc.apply(this,arguments)}function tc(){return tc=(0,_.Z)(function*(w,f){const m=(0,z.m9)(w);yield iu(!0,m,f);const{providerUserInfo:I}=yield function On(w,f){return ir.apply(this,arguments)}(m.auth,{idToken:yield m.getIdToken(),deleteProvider:[f]}),x=Fr(I||[]);return m.providerData=m.providerData.filter(k=>x.has(k.providerId)),x.has("phone")||(m.phoneNumber=null),yield m.auth._persistUserIfCurrent(m),m}),tc.apply(this,arguments)}function ri(w,f){return br.apply(this,arguments)}function br(){return(br=(0,_.Z)(function*(w,f,m=!1){const I=yield Zt(w,f._linkToIdToken(w.auth,yield w.getIdToken()),m);return Un._forOperation(w,"link",I)})).apply(this,arguments)}function iu(w,f,m){return Ks.apply(this,arguments)}function Ks(){return(Ks=(0,_.Z)(function*(w,f,m){yield Ln(f);const x=!1===w?"provider-already-linked":"no-such-provider";ae(Fr(f.providerData).has(m)===w,f.auth,x)})).apply(this,arguments)}function Ld(w,f){return Ds.apply(this,arguments)}function Ds(){return(Ds=(0,_.Z)(function*(w,f,m=!1){const{auth:I}=w,x="reauthenticate";try{const k=yield Zt(w,xo(I,x,f,w),m);ae(k.idToken,I,"internal-error");const X=Xr(k.idToken);ae(X,I,"internal-error");const{sub:he}=X;return ae(w.uid===he,I,"user-mismatch"),Un._forOperation(w,x,k)}catch(k){throw"auth/user-not-found"===k?.code&&Ae(I,"user-mismatch"),k}})).apply(this,arguments)}function su(w,f){return ca.apply(this,arguments)}function ca(){return(ca=(0,_.Z)(function*(w,f,m=!1){const I="signIn",x=yield xo(w,I,f),k=yield Un._fromIdTokenResponse(w,I,x);return m||(yield w._updateCurrentUser(k.user)),k})).apply(this,arguments)}function Mt(w,f){return nc.apply(this,arguments)}function nc(){return(nc=(0,_.Z)(function*(w,f){return su(_n(w),f)})).apply(this,arguments)}function rp(w,f){return cl.apply(this,arguments)}function cl(){return(cl=(0,_.Z)(function*(w,f){const m=(0,z.m9)(w);return yield iu(!1,m,f.providerId),ri(m,f)})).apply(this,arguments)}function ll(w,f){return dl.apply(this,arguments)}function dl(){return(dl=(0,_.Z)(function*(w,f){return Ld((0,z.m9)(w),f)})).apply(this,arguments)}function Ud(){return(Ud=(0,_.Z)(function*(w,f){return un(w,"POST","/v1/accounts:signInWithCustomToken",te(w,f))})).apply(this,arguments)}function gm(w,f){return _e.apply(this,arguments)}function _e(){return _e=(0,_.Z)(function*(w,f){const m=_n(w),I=yield function Fd(w,f){return Ud.apply(this,arguments)}(m,{token:f,returnSecureToken:!0}),x=yield Un._fromIdTokenResponse(m,"signIn",I);return yield m._updateCurrentUser(x.user),x}),_e.apply(this,arguments)}class Vt{constructor(f,m){this.factorId=f,this.uid=m.mfaEnrollmentId,this.enrollmentTime=new Date(m.enrolledAt).toUTCString(),this.displayName=m.displayName}static _fromServerResponse(f,m){return"phoneInfo"in m?hl._fromServerResponse(f,m):"totpInfo"in m?ou._fromServerResponse(f,m):Ae(f,"internal-error")}}class hl extends Vt{constructor(f){super("phone",f),this.phoneNumber=f.phoneInfo}static _fromServerResponse(f,m){return new hl(m)}}class ou extends Vt{constructor(f){super("totp",f)}static _fromServerResponse(f,m){return new ou(m)}}function Yn(w,f,m){var I;ae((null===(I=m.url)||void 0===I?void 0:I.length)>0,w,"invalid-continue-uri"),ae(typeof m.dynamicLinkDomain>"u"||m.dynamicLinkDomain.length>0,w,"invalid-dynamic-link-domain"),f.continueUrl=m.url,f.dynamicLinkDomain=m.dynamicLinkDomain,f.canHandleCodeInApp=m.handleCodeInApp,m.iOS&&(ae(m.iOS.bundleId.length>0,w,"missing-ios-bundle-id"),f.iOSBundleId=m.iOS.bundleId),m.android&&(ae(m.android.packageName.length>0,w,"missing-android-pkg-name"),f.androidInstallApp=m.android.installApp,f.androidMinimumVersionCode=m.android.minimumVersion,f.androidPackageName=m.android.packageName)}function Vd(w,f,m){return la.apply(this,arguments)}function la(){return la=(0,_.Z)(function*(w,f,m){var I;const x=_n(w),k={requestType:"PASSWORD_RESET",email:f,clientType:"CLIENT_TYPE_WEB"};if(null!==(I=x._getRecaptchaConfig())&&void 0!==I&&I.emailPasswordEnabled){const X=yield Tr(x,k,"getOobCode",!0);m&&Yn(x,X,m),yield ia(x,X)}else m&&Yn(x,k,m),yield ia(x,k).catch(function(){var X=(0,_.Z)(function*(he){if("auth/missing-recaptcha-token"!==he.code)return Promise.reject(he);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const Be=yield Tr(x,k,"getOobCode",!0);m&&Yn(x,Be,m),yield ia(x,Be)}});return function(he){return X.apply(this,arguments)}}())}),la.apply(this,arguments)}function Li(w,f,m){return rc.apply(this,arguments)}function rc(){return(rc=(0,_.Z)(function*(w,f,m){yield Ja((0,z.m9)(w),{oobCode:f,newPassword:m})})).apply(this,arguments)}function Bd(w,f){return jd.apply(this,arguments)}function jd(){return jd=(0,_.Z)(function*(w,f){yield function To(w,f){return ki.apply(this,arguments)}((0,z.m9)(w),{oobCode:f})}),jd.apply(this,arguments)}function Zs(w,f){return da.apply(this,arguments)}function da(){return(da=(0,_.Z)(function*(w,f){const m=(0,z.m9)(w),I=yield Ja(m,{oobCode:f}),x=I.requestType;switch(ae(x,m,"internal-error"),x){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ae(I.newEmail,m,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ae(I.mfaInfo,m,"internal-error");default:ae(I.email,m,"internal-error")}let k=null;return I.mfaInfo&&(k=Vt._fromServerResponse(_n(m),I.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===I.requestType?I.newEmail:I.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===I.requestType?I.email:I.newEmail)||null,multiFactorInfo:k},operation:x}})).apply(this,arguments)}function Ur(w,f){return fi.apply(this,arguments)}function fi(){return(fi=(0,_.Z)(function*(w,f){const{data:m}=yield Zs((0,z.m9)(w),f);return m.email})).apply(this,arguments)}function Ys(w,f,m){return bs.apply(this,arguments)}function bs(){return bs=(0,_.Z)(function*(w,f,m){var I;const x=_n(w),k={returnSecureToken:!0,email:f,password:m,clientType:"CLIENT_TYPE_WEB"};let X;if(null!==(I=x._getRecaptchaConfig())&&void 0!==I&&I.emailPasswordEnabled){const Ke=yield Tr(x,k,"signUpPassword");X=ua(x,Ke)}else X=ua(x,k).catch(function(){var Ke=(0,_.Z)(function*(Et){if("auth/missing-recaptcha-token"===Et.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const Wt=yield Tr(x,k,"signUpPassword");return ua(x,Wt)}return Promise.reject(Et)});return function(Et){return Ke.apply(this,arguments)}}());const he=yield X.catch(Ke=>Promise.reject(Ke)),Be=yield Un._fromIdTokenResponse(x,"signIn",he);return yield x._updateCurrentUser(Be.user),Be}),bs.apply(this,arguments)}function cs(w,f,m){return Mt((0,z.m9)(w),Md.credential(f,m))}function $d(w,f,m){return Po.apply(this,arguments)}function Po(){return Po=(0,_.Z)(function*(w,f,m){var I;const x=_n(w),k={requestType:"EMAIL_SIGNIN",email:f,clientType:"CLIENT_TYPE_WEB"};function X(he,Be){ae(Be.handleCodeInApp,x,"argument-error"),Be&&Yn(x,he,Be)}if(null!==(I=x._getRecaptchaConfig())&&void 0!==I&&I.emailPasswordEnabled){const he=yield Tr(x,k,"getOobCode",!0);X(he,m),yield Do(x,he)}else X(k,m),yield Do(x,k).catch(function(){var he=(0,_.Z)(function*(Be){if("auth/missing-recaptcha-token"!==Be.code)return Promise.reject(Be);{console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const Ke=yield Tr(x,k,"getOobCode",!0);X(Ke,m),yield Do(x,Ke)}});return function(Be){return he.apply(this,arguments)}}())}),Po.apply(this,arguments)}function Hd(w,f){return"EMAIL_SIGNIN"===oa.parseLink(f)?.operation}function mm(w,f,m){return Qn.apply(this,arguments)}function Qn(){return(Qn=(0,_.Z)(function*(w,f,m){const I=(0,z.m9)(w),x=Md.credentialWithLink(f,m||st());return ae(x._tenantId===(I.tenantId||null),I,"tenant-id-mismatch"),Mt(I,x)})).apply(this,arguments)}function au(){return(au=(0,_.Z)(function*(w,f){return xe(w,"POST","/v1/accounts:createAuthUri",te(w,f))})).apply(this,arguments)}function zd(w,f){return sc.apply(this,arguments)}function sc(){return sc=(0,_.Z)(function*(w,f){const I={identifier:f,continueUri:Kt()?st():"http://localhost"},{signinMethods:x}=yield function ic(w,f){return au.apply(this,arguments)}((0,z.m9)(w),I);return x||[]}),sc.apply(this,arguments)}function Gd(w,f){return ha.apply(this,arguments)}function ha(){return ha=(0,_.Z)(function*(w,f){const m=(0,z.m9)(w),x={requestType:"VERIFY_EMAIL",idToken:yield w.getIdToken()};f&&Yn(m.auth,x,f);const{email:k}=yield function al(w,f){return eu.apply(this,arguments)}(m.auth,x);k!==w.email&&(yield w.reload())}),ha.apply(this,arguments)}function fl(w,f,m){return uu.apply(this,arguments)}function uu(){return uu=(0,_.Z)(function*(w,f,m){const I=(0,z.m9)(w),k={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield w.getIdToken(),newEmail:f};m&&Yn(I.auth,k,m);const{email:X}=yield function Sd(w,f){return ni.apply(this,arguments)}(I.auth,k);X!==w.email&&(yield w.reload())}),uu.apply(this,arguments)}function oc(){return(oc=(0,_.Z)(function*(w,f){return xe(w,"POST","/v1/accounts:update",f)})).apply(this,arguments)}function Wd(w,f){return gl.apply(this,arguments)}function gl(){return gl=(0,_.Z)(function*(w,{displayName:f,photoURL:m}){if(void 0===f&&void 0===m)return;const I=(0,z.m9)(w),k={idToken:yield I.getIdToken(),displayName:f,photoUrl:m,returnSecureToken:!0},X=yield Zt(I,function pl(w,f){return oc.apply(this,arguments)}(I.auth,k));I.displayName=X.displayName||null,I.photoURL=X.photoUrl||null;const he=I.providerData.find(({providerId:Be})=>"password"===Be);he&&(he.displayName=I.displayName,he.photoURL=I.photoURL),yield I._updateTokensIfNecessary(X)}),gl.apply(this,arguments)}function qd(w,f){return ls((0,z.m9)(w),f,null)}function qr(w,f){return ls((0,z.m9)(w),null,f)}function ls(w,f,m){return Nn.apply(this,arguments)}function Nn(){return(Nn=(0,_.Z)(function*(w,f,m){const{auth:I}=w,k={idToken:yield w.getIdToken(),returnSecureToken:!0};f&&(k.email=f),m&&(k.password=m);const X=yield Zt(w,hr(I,k));yield w._updateTokensIfNecessary(X,!0)})).apply(this,arguments)}class fa{constructor(f,m,I={}){this.isNewUser=f,this.providerId=m,this.profile=I}}class ml extends fa{constructor(f,m,I,x){super(f,m,I),this.username=x}}class _m extends fa{constructor(f,m){super(f,"facebook.com",m)}}class Zd extends ml{constructor(f,m){super(f,"github.com",m,"string"==typeof m?.login?m?.login:null)}}class ym extends fa{constructor(f,m){super(f,"google.com",m)}}class ac extends ml{constructor(f,m,I){super(f,"twitter.com",m,I)}}function _l(w){const{user:f,_tokenResponse:m}=w;return f.isAnonymous&&!m?{providerId:null,isNewUser:!1,profile:null}:function Kd(w){var f,m;if(!w)return null;const{providerId:I}=w,x=w.rawUserInfo?JSON.parse(w.rawUserInfo):{},k=w.isNewUser||"identitytoolkit#SignupNewUserResponse"===w.kind;if(!I&&w?.idToken){const X=null===(m=null===(f=Xr(w.idToken))||void 0===f?void 0:f.firebase)||void 0===m?void 0:m.sign_in_provider;if(X)return new fa(k,"anonymous"!==X&&"custom"!==X?X:null)}if(!I)return null;switch(I){case"facebook.com":return new _m(k,x);case"github.com":return new Zd(k,x);case"google.com":return new ym(k,x);case"twitter.com":return new ac(k,x,w.screenName||null);case"custom":case"anonymous":return new fa(k,null);default:return new fa(k,I,x)}}(m)}class As{constructor(f,m,I){this.type=f,this.credential=m,this.auth=I}static _fromIdtoken(f,m){return new As("enroll",f,m)}static _fromMfaPendingCredential(f){return new As("signin",f)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(f){var m,I;if(f?.multiFactorSession){if(null!==(m=f.multiFactorSession)&&void 0!==m&&m.pendingCredential)return As._fromMfaPendingCredential(f.multiFactorSession.pendingCredential);if(null!==(I=f.multiFactorSession)&&void 0!==I&&I.idToken)return As._fromIdtoken(f.multiFactorSession.idToken)}return null}}class yl{constructor(f,m,I){this.session=f,this.hints=m,this.signInResolver=I}static _fromError(f,m){const I=_n(f),x=m.customData._serverResponse,k=(x.mfaInfo||[]).map(he=>Vt._fromServerResponse(I,he));ae(x.mfaPendingCredential,I,"internal-error");const X=As._fromMfaPendingCredential(x.mfaPendingCredential);return new yl(X,k,function(){var he=(0,_.Z)(function*(Be){const Ke=yield Be._process(I,X);delete x.mfaInfo,delete x.mfaPendingCredential;const Et=Object.assign(Object.assign({},x),{idToken:Ke.idToken,refreshToken:Ke.refreshToken});switch(m.operationType){case"signIn":const Wt=yield Un._fromIdTokenResponse(I,m.operationType,Et);return yield I._updateCurrentUser(Wt.user),Wt;case"reauthenticate":return ae(m.user,I,"internal-error"),Un._forOperation(m.user,m.operationType,Et);default:Ae(I,"internal-error")}});return function(Be){return he.apply(this,arguments)}}())}resolveSignIn(f){var m=this;return(0,_.Z)(function*(){return m.signInResolver(f)})()}}function lu(w,f){var m;const I=(0,z.m9)(w),x=f;return ae(f.customData.operationType,I,"argument-error"),ae(null===(m=x.customData._serverResponse)||void 0===m?void 0:m.mfaPendingCredential,I,"argument-error"),yl._fromError(I,x)}class ma{constructor(f){this.user=f,this.enrolledFactors=[],f._onReload(m=>{m.mfaInfo&&(this.enrolledFactors=m.mfaInfo.map(I=>Vt._fromServerResponse(f.auth,I)))})}static _fromUser(f){return new ma(f)}getSession(){var f=this;return(0,_.Z)(function*(){return As._fromIdtoken(yield f.user.getIdToken(),f.user.auth)})()}enroll(f,m){var I=this;return(0,_.Z)(function*(){const x=f,k=yield I.getSession(),X=yield Zt(I.user,x._process(I.user.auth,k,m));return yield I.user._updateTokensIfNecessary(X),I.user.reload()})()}unenroll(f){var m=this;return(0,_.Z)(function*(){const I="string"==typeof f?f:f.uid,x=yield m.user.getIdToken();try{const k=yield Zt(m.user,function No(w,f){return xe(w,"POST","/v2/accounts/mfaEnrollment:withdraw",te(w,f))}(m.user.auth,{idToken:x,mfaEnrollmentId:I}));m.enrolledFactors=m.enrolledFactors.filter(({uid:X})=>X!==I),yield m.user._updateTokensIfNecessary(k),yield m.user.reload()}catch(k){throw k}})()}}const Mo=new WeakMap;function _a(w){const f=(0,z.m9)(w);return Mo.has(f)||Mo.set(f,ma._fromUser(f)),Mo.get(f)}const du="__sak";class hu{constructor(f,m){this.storageRetriever=f,this.type=m}_isAvailable(){try{return this.storage?(this.storage.setItem(du,"1"),this.storage.removeItem(du),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(f,m){return this.storage.setItem(f,JSON.stringify(m)),Promise.resolve()}_get(f){const m=this.storage.getItem(f);return Promise.resolve(m?JSON.parse(m):null)}_remove(f){return this.storage.removeItem(f),Promise.resolve()}get storage(){return this.storageRetriever()}}const dc=(()=>{class w extends hu{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(m,I)=>this.onStorageEvent(m,I),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function vl(){const w=(0,z.z$)();return F(w)||Dt(w)}()&&function Ir(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=$t(),this._shouldAllowMigration=!0}forAllChangedKeys(m){for(const I of Object.keys(this.listeners)){const x=this.storage.getItem(I),k=this.localCache[I];x!==k&&m(I,k,x)}}onStorageEvent(m,I=!1){if(!m.key)return void this.forAllChangedKeys((he,Be,Ke)=>{this.notifyListeners(he,Ke)});const x=m.key;if(I?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const he=this.storage.getItem(x);if(m.newValue!==he)null!==m.newValue?this.storage.setItem(x,m.newValue):this.storage.removeItem(x);else if(this.localCache[x]===m.newValue&&!I)return}const k=()=>{const he=this.storage.getItem(x);!I&&this.localCache[x]===he||this.notifyListeners(x,he)},X=this.storage.getItem(x);!function bn(){return(0,z.w1)()&&10===document.documentMode}()||X===m.newValue||m.newValue===m.oldValue?k():setTimeout(k,10)}notifyListeners(m,I){this.localCache[m]=I;const x=this.listeners[m];if(x)for(const k of Array.from(x))k(I&&JSON.parse(I))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((m,I,x)=>{this.onStorageEvent(new StorageEvent("storage",{key:m,oldValue:I,newValue:x}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(m,I){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[m]||(this.listeners[m]=new Set,this.localCache[m]=this.storage.getItem(m)),this.listeners[m].add(I)}_removeListener(m,I){this.listeners[m]&&(this.listeners[m].delete(I),0===this.listeners[m].size&&delete this.listeners[m]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(m,I){var x=()=>super._set,k=this;return(0,_.Z)(function*(){yield x().call(k,m,I),k.localCache[m]=JSON.stringify(I)})()}_get(m){var I=()=>super._get,x=this;return(0,_.Z)(function*(){const k=yield I().call(x,m);return x.localCache[m]=JSON.stringify(k),k})()}_remove(m){var I=()=>super._remove,x=this;return(0,_.Z)(function*(){yield I().call(x,m),delete x.localCache[m]})()}}return w.type="LOCAL",w})(),pi=(()=>{class w extends hu{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(m,I){}_removeListener(m,I){}}return w.type="SESSION",w})();let Il=(()=>{class w{constructor(m){this.eventTarget=m,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(m){const I=this.receivers.find(k=>k.isListeningto(m));if(I)return I;const x=new w(m);return this.receivers.push(x),x}isListeningto(m){return this.eventTarget===m}handleEvent(m){var I=this;return(0,_.Z)(function*(){const x=m,{eventId:k,eventType:X,data:he}=x.data,Be=I.handlersMap[X];if(!Be?.size)return;x.ports[0].postMessage({status:"ack",eventId:k,eventType:X});const Ke=Array.from(Be).map(function(){var Wt=(0,_.Z)(function*(mi){return mi(x.origin,he)});return function(mi){return Wt.apply(this,arguments)}}()),Et=yield function eh(w){return Promise.all(w.map(function(){var f=(0,_.Z)(function*(m){try{return{fulfilled:!0,value:yield m}}catch(I){return{fulfilled:!1,reason:I}}});return function(m){return f.apply(this,arguments)}}()))}(Ke);x.ports[0].postMessage({status:"done",eventId:k,eventType:X,response:Et})})()}_subscribe(m,I){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[m]||(this.handlersMap[m]=new Set),this.handlersMap[m].add(I)}_unsubscribe(m,I){this.handlersMap[m]&&I&&this.handlersMap[m].delete(I),(!I||0===this.handlersMap[m].size)&&delete this.handlersMap[m],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return w.receivers=[],w})();function ds(w="",f=10){let m="";for(let I=0;I<f;I++)m+=Math.floor(10*Math.random());return w+m}class th{constructor(f){this.target=f,this.handlers=new Set}removeMessageHandler(f){f.messageChannel&&(f.messageChannel.port1.removeEventListener("message",f.onMessage),f.messageChannel.port1.close()),this.handlers.delete(f)}_send(f,m,I=50){var x=this;return(0,_.Z)(function*(){const k=typeof MessageChannel<"u"?new MessageChannel:null;if(!k)throw new Error("connection_unavailable");let X,he;return new Promise((Be,Ke)=>{const Et=ds("",20);k.port1.start();const Wt=setTimeout(()=>{Ke(new Error("unsupported_event"))},I);he={messageChannel:k,onMessage(mi){const $o=mi;if($o.data.eventId===Et)switch($o.data.status){case"ack":clearTimeout(Wt),X=setTimeout(()=>{Ke(new Error("timeout"))},3e3);break;case"done":clearTimeout(X),Be($o.data.response);break;default:clearTimeout(Wt),clearTimeout(X),Ke(new Error("invalid_response"))}}},x.handlers.add(he),k.port1.addEventListener("message",he.onMessage),x.target.postMessage({eventType:f,eventId:Et,data:m},[k.port2])}).finally(()=>{he&&x.removeMessageHandler(he)})})()}}function Xn(){return window}function hc(){return typeof Xn().WorkerGlobalScope<"u"&&"function"==typeof Xn().importScripts}function pu(){return(pu=(0,_.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const pr="firebaseLocalStorageDb",ya=1,Vn="firebaseLocalStorage",op="fbase_key";class Js{constructor(f){this.request=f}toPromise(){return new Promise((f,m)=>{this.request.addEventListener("success",()=>{f(this.request.result)}),this.request.addEventListener("error",()=>{m(this.request.error)})})}}function pc(w,f){return w.transaction([Vn],f?"readwrite":"readonly").objectStore(Vn)}function Cl(){const w=indexedDB.open(pr,ya);return new Promise((f,m)=>{w.addEventListener("error",()=>{m(w.error)}),w.addEventListener("upgradeneeded",()=>{const I=w.result;try{I.createObjectStore(Vn,{keyPath:op})}catch(x){m(x)}}),w.addEventListener("success",(0,_.Z)(function*(){const I=w.result;I.objectStoreNames.contains(Vn)?f(I):(I.close(),yield function va(){const w=indexedDB.deleteDatabase(pr);return new Js(w).toPromise()}(),f(yield Cl()))}))})}function Tl(w,f,m){return eo.apply(this,arguments)}function eo(){return(eo=(0,_.Z)(function*(w,f,m){const I=pc(w,!0).put({[op]:f,value:m});return new Js(I).toPromise()})).apply(this,arguments)}function ko(){return(ko=(0,_.Z)(function*(w,f){const m=pc(w,!1).get(f),I=yield new Js(m).toPromise();return void 0===I?null:I.value})).apply(this,arguments)}function gu(w,f){const m=pc(w,!0).delete(f);return new Js(m).toPromise()}const Dl=(()=>{class w{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var m=this;return(0,_.Z)(function*(){return m.db||(m.db=yield Cl()),m.db})()}_withRetries(m){var I=this;return(0,_.Z)(function*(){let x=0;for(;;)try{const k=yield I._openDb();return yield m(k)}catch(k){if(x++>3)throw k;I.db&&(I.db.close(),I.db=void 0)}})()}initializeServiceWorkerMessaging(){var m=this;return(0,_.Z)(function*(){return hc()?m.initializeReceiver():m.initializeSender()})()}initializeReceiver(){var m=this;return(0,_.Z)(function*(){m.receiver=Il._getInstance(function fc(){return hc()?self:null}()),m.receiver._subscribe("keyChanged",function(){var I=(0,_.Z)(function*(x,k){return{keyProcessed:(yield m._poll()).includes(k.key)}});return function(x,k){return I.apply(this,arguments)}}()),m.receiver._subscribe("ping",function(){var I=(0,_.Z)(function*(x,k){return["keyChanged"]});return function(x,k){return I.apply(this,arguments)}}())})()}initializeSender(){var m=this;return(0,_.Z)(function*(){var I,x;if(m.activeServiceWorker=yield function nh(){return pu.apply(this,arguments)}(),!m.activeServiceWorker)return;m.sender=new th(m.activeServiceWorker);const k=yield m.sender._send("ping",{},800);k&&null!==(I=k[0])&&void 0!==I&&I.fulfilled&&null!==(x=k[0])&&void 0!==x&&x.value.includes("keyChanged")&&(m.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(m){var I=this;return(0,_.Z)(function*(){if(I.sender&&I.activeServiceWorker&&function rh(){var w;return(null===(w=navigator?.serviceWorker)||void 0===w?void 0:w.controller)||null}()===I.activeServiceWorker)try{yield I.sender._send("keyChanged",{key:m},I.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,_.Z)(function*(){try{if(!indexedDB)return!1;const m=yield Cl();return yield Tl(m,du,"1"),yield gu(m,du),!0}catch{}return!1})()}_withPendingWrite(m){var I=this;return(0,_.Z)(function*(){I.pendingWrites++;try{yield m()}finally{I.pendingWrites--}})()}_set(m,I){var x=this;return(0,_.Z)(function*(){return x._withPendingWrite((0,_.Z)(function*(){return yield x._withRetries(k=>Tl(k,m,I)),x.localCache[m]=I,x.notifyServiceWorker(m)}))})()}_get(m){var I=this;return(0,_.Z)(function*(){const x=yield I._withRetries(k=>function ap(w,f){return ko.apply(this,arguments)}(k,m));return I.localCache[m]=x,x})()}_remove(m){var I=this;return(0,_.Z)(function*(){return I._withPendingWrite((0,_.Z)(function*(){return yield I._withRetries(x=>gu(x,m)),delete I.localCache[m],I.notifyServiceWorker(m)}))})()}_poll(){var m=this;return(0,_.Z)(function*(){const I=yield m._withRetries(X=>{const he=pc(X,!1).getAll();return new Js(he).toPromise()});if(!I)return[];if(0!==m.pendingWrites)return[];const x=[],k=new Set;for(const{fbase_key:X,value:he}of I)k.add(X),JSON.stringify(m.localCache[X])!==JSON.stringify(he)&&(m.notifyListeners(X,he),x.push(X));for(const X of Object.keys(m.localCache))m.localCache[X]&&!k.has(X)&&(m.notifyListeners(X,null),x.push(X));return x})()}notifyListeners(m,I){this.localCache[m]=I;const x=this.listeners[m];if(x)for(const k of Array.from(x))k(I)}startPolling(){var m=this;this.stopPolling(),this.pollTimer=setInterval((0,_.Z)(function*(){return m._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(m,I){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[m]||(this.listeners[m]=new Set,this._get(m)),this.listeners[m].add(I)}_removeListener(m,I){this.listeners[m]&&(this.listeners[m].delete(I),0===this.listeners[m].size&&delete this.listeners[m]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return w.type="LOCAL",w})(),bl=1e12;class oh{constructor(f){this.auth=f,this.counter=bl,this._widgets=new Map}render(f,m){const I=this.counter;return this._widgets.set(I,new Sl(f,this.auth.name,m||{})),this.counter++,I}reset(f){var m;const I=f||bl;null===(m=this._widgets.get(I))||void 0===m||m.delete(),this._widgets.delete(I)}getResponse(f){var m;return(null===(m=this._widgets.get(f||bl))||void 0===m?void 0:m.getResponse())||""}execute(f){var m=this;return(0,_.Z)(function*(){var I;return null===(I=m._widgets.get(f||bl))||void 0===I||I.execute(),""})()}}class Sl{constructor(f,m,I){this.params=I,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const x="string"==typeof f?document.getElementById(f):f;ae(x,"argument-error",{appName:m}),this.container=x,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Al(w){const f=[],m="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let I=0;I<w;I++)f.push(m.charAt(Math.floor(Math.random()*m.length)));return f.join("")}(50);const{callback:f,"expired-callback":m}=this.params;if(f)try{f(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,m)try{m()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const cp=Gr("rcb"),Dy=new li(3e4,6e4);class Fo{constructor(){var f;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(f=Xn().grecaptcha)||void 0===f||!f.render)}load(f,m=""){return ae(function Sy(w){return w.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(w)}(m),f,"argument-error"),this.shouldResolveImmediately(m)&&xt(Xn().grecaptcha)?Promise.resolve(Xn().grecaptcha):new Promise((I,x)=>{const k=Xn().setTimeout(()=>{x(Se(f,"network-request-failed"))},Dy.get());Xn()[cp]=()=>{Xn().clearTimeout(k),delete Xn()[cp];const he=Xn().grecaptcha;if(!he||!xt(he))return void x(Se(f,"internal-error"));const Be=he.render;he.render=(Ke,Et)=>{const Wt=Be(Ke,Et);return this.counter++,Wt},this.hostLanguage=m,I(he)},sn(`https://www.google.com/recaptcha/api.js??${(0,z.xO)({onload:cp,render:"explicit",hl:m})}`).catch(()=>{clearTimeout(k),x(Se(f,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(f){var m;return!(null===(m=Xn().grecaptcha)||void 0===m||!m.render)&&(f===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class lp{load(f){return(0,_.Z)(function*(){return new oh(f)})()}clearedOneInstance(){}}const gr="recaptcha",mc={theme:"light",type:"image"};class _c{constructor(f,m=Object.assign({},mc),I){this.parameters=m,this.type=gr,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=_n(I),this.isInvisible="invisible"===this.parameters.size,ae(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const x="string"==typeof f?document.getElementById(f):f;ae(x,this.auth,"argument-error"),this.container=x,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new lp:new Fo,this.validateStartingState()}verify(){var f=this;return(0,_.Z)(function*(){f.assertNotDestroyed();const m=yield f.render(),I=f.getAssertedRecaptcha();return I.getResponse(m)||new Promise(k=>{const X=he=>{he&&(f.tokenChangeListeners.delete(X),k(he))};f.tokenChangeListeners.add(X),f.isInvisible&&I.execute(m)})})()}render(){try{this.assertNotDestroyed()}catch(f){return Promise.reject(f)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(f=>{throw this.renderPromise=null,f})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(f=>{this.container.removeChild(f)})}validateStartingState(){ae(!this.parameters.sitekey,this.auth,"argument-error"),ae(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ae(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(f){return m=>{if(this.tokenChangeListeners.forEach(I=>I(m)),"function"==typeof f)f(m);else if("string"==typeof f){const I=Xn()[f];"function"==typeof I&&I(m)}}}assertNotDestroyed(){ae(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var f=this;return(0,_.Z)(function*(){if(yield f.init(),!f.widgetId){let m=f.container;if(!f.isInvisible){const I=document.createElement("div");m.appendChild(I),m=I}f.widgetId=f.getAssertedRecaptcha().render(m,f.parameters)}return f.widgetId})()}init(){var f=this;return(0,_.Z)(function*(){ae(Kt()&&!hc(),f.auth,"internal-error"),yield function Rl(){let w=null;return new Promise(f=>{"complete"!==document.readyState?(w=()=>f(),window.addEventListener("load",w)):f()}).catch(f=>{throw w&&window.removeEventListener("load",w),f})}(),f.recaptcha=yield f._recaptchaLoader.load(f.auth,f.auth.languageCode||void 0);const m=yield function me(w){return ie.apply(this,arguments)}(f.auth);ae(m,f.auth,"internal-error"),f.parameters.sitekey=m})()}getAssertedRecaptcha(){return ae(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class bi{constructor(f,m){this.verificationId=f,this.onConfirmation=m}confirm(f){const m=Ws._fromVerification(this.verificationId,f);return this.onConfirmation(m)}}function to(w,f,m){return xl.apply(this,arguments)}function xl(){return(xl=(0,_.Z)(function*(w,f,m){const I=_n(w),x=yield yc(I,f,(0,z.m9)(m));return new bi(x,k=>Mt(I,k))})).apply(this,arguments)}function mu(w,f,m){return Ea.apply(this,arguments)}function Ea(){return(Ea=(0,_.Z)(function*(w,f,m){const I=(0,z.m9)(w);yield iu(!1,I,"phone");const x=yield yc(I.auth,f,(0,z.m9)(m));return new bi(x,k=>rp(I,k))})).apply(this,arguments)}function ah(w,f,m){return Pl.apply(this,arguments)}function Pl(){return(Pl=(0,_.Z)(function*(w,f,m){const I=(0,z.m9)(w),x=yield yc(I.auth,f,(0,z.m9)(m));return new bi(x,k=>ll(I,k))})).apply(this,arguments)}function yc(w,f,m){return Nl.apply(this,arguments)}function Nl(){return Nl=(0,_.Z)(function*(w,f,m){var I;const x=yield m.verify();try{let k;if(ae("string"==typeof x,w,"argument-error"),ae(m.type===gr,w,"argument-error"),k="string"==typeof f?{phoneNumber:f}:f,"session"in k){const X=k.session;if("phoneNumber"in k)return ae("enroll"===X.type,w,"internal-error"),(yield function lc(w,f){return xe(w,"POST","/v2/accounts/mfaEnrollment:start",te(w,f))}(w,{idToken:X.credential,phoneEnrollmentInfo:{phoneNumber:k.phoneNumber,recaptchaToken:x}})).phoneSessionInfo.sessionInfo;{ae("signin"===X.type,w,"internal-error");const he=(null===(I=k.multiFactorHint)||void 0===I?void 0:I.uid)||k.multiFactorUid;return ae(he,w,"missing-multi-factor-info"),(yield function ih(w,f){return xe(w,"POST","/v2/accounts/mfaSignIn:start",te(w,f))}(w,{mfaPendingCredential:X.credential,mfaEnrollmentId:he,phoneSignInInfo:{recaptchaToken:x}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:X}=yield function fm(w,f){return Ad.apply(this,arguments)}(w,{phoneNumber:k.phoneNumber,recaptchaToken:x});return X}}finally{m._reset()}}),Nl.apply(this,arguments)}function Fi(w,f){return ln.apply(this,arguments)}function ln(){return(ln=(0,_.Z)(function*(w,f){yield ri((0,z.m9)(w),f)})).apply(this,arguments)}let Zi=(()=>{class w{constructor(m){this.providerId=w.PROVIDER_ID,this.auth=_n(m)}verifyPhoneNumber(m,I){return yc(this.auth,m,(0,z.m9)(I))}static credential(m,I){return Ws._fromVerification(m,I)}static credentialFromResult(m){return w.credentialFromTaggedObject(m)}static credentialFromError(m){return w.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{phoneNumber:I,temporaryProof:x}=m;return I&&x?Ws._fromTokenResponse(I,x):null}}return w.PROVIDER_ID="phone",w.PHONE_SIGN_IN_METHOD="phone",w})();function ut(w,f){return f?Zn(f):(ae(w._popupRedirectResolver,w,"argument-error"),w._popupRedirectResolver)}class Yi extends Mi{constructor(f){super("custom","custom"),this.params=f}_getIdTokenResponse(f){return Gs(f,this._buildIdpRequest())}_linkToIdToken(f,m){return Gs(f,this._buildIdpRequest(m))}_getReauthenticationResolver(f){return Gs(f,this._buildIdpRequest())}_buildIdpRequest(f){const m={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return f&&(m.idToken=f),m}}function sr(w){return su(w.auth,new Yi(w),w.bypassAuthState)}function uh(w){const{auth:f,user:m}=w;return ae(m,f,"internal-error"),Ld(m,new Yi(w),w.bypassAuthState)}function _u(w){return ii.apply(this,arguments)}function ii(){return(ii=(0,_.Z)(function*(w){const{auth:f,user:m}=w;return ae(m,f,"internal-error"),ri(m,new Yi(w),w.bypassAuthState)})).apply(this,arguments)}class Ml{constructor(f,m,I,x,k=!1){this.auth=f,this.resolver=I,this.user=x,this.bypassAuthState=k,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(m)?m:[m]}execute(){var f=this;return new Promise(function(){var m=(0,_.Z)(function*(I,x){f.pendingPromise={resolve:I,reject:x};try{f.eventManager=yield f.resolver._initialize(f.auth),yield f.onExecution(),f.eventManager.registerConsumer(f)}catch(k){f.reject(k)}});return function(I,x){return m.apply(this,arguments)}}())}onAuthEvent(f){var m=this;return(0,_.Z)(function*(){const{urlResponse:I,sessionId:x,postBody:k,tenantId:X,error:he,type:Be}=f;if(he)return void m.reject(he);const Ke={auth:m.auth,requestUri:I,sessionId:x,tenantId:X||void 0,postBody:k||void 0,user:m.user,bypassAuthState:m.bypassAuthState};try{m.resolve(yield m.getIdpTask(Be)(Ke))}catch(Et){m.reject(Et)}})()}onError(f){this.reject(f)}getIdpTask(f){switch(f){case"signInViaPopup":case"signInViaRedirect":return sr;case"linkViaPopup":case"linkViaRedirect":return _u;case"reauthViaPopup":case"reauthViaRedirect":return uh;default:Ae(this.auth,"internal-error")}}resolve(f){St(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(f),this.unregisterAndCleanUp()}reject(f){St(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(f),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ch=new li(2e3,1e4);function Ui(w,f,m){return no.apply(this,arguments)}function no(){return(no=(0,_.Z)(function*(w,f,m){const I=_n(w);He(w,f,So);const x=ut(I,m);return new kl(I,"signInViaPopup",f,x).executeNotNull()})).apply(this,arguments)}function lh(w,f,m){return Uo.apply(this,arguments)}function Uo(){return(Uo=(0,_.Z)(function*(w,f,m){const I=(0,z.m9)(w);He(I.auth,f,So);const x=ut(I.auth,m);return new kl(I.auth,"reauthViaPopup",f,x,I).executeNotNull()})).apply(this,arguments)}function Vo(w,f,m){return yt.apply(this,arguments)}function yt(){return(yt=(0,_.Z)(function*(w,f,m){const I=(0,z.m9)(w);He(I.auth,f,So);const x=ut(I.auth,m);return new kl(I.auth,"linkViaPopup",f,x,I).executeNotNull()})).apply(this,arguments)}let kl=(()=>{class w extends Ml{constructor(m,I,x,k,X){super(m,I,k,X),this.provider=x,this.authWindow=null,this.pollId=null,w.currentPopupAction&&w.currentPopupAction.cancel(),w.currentPopupAction=this}executeNotNull(){var m=this;return(0,_.Z)(function*(){const I=yield m.execute();return ae(I,m.auth,"internal-error"),I})()}onExecution(){var m=this;return(0,_.Z)(function*(){St(1===m.filter.length,"Popup operations only handle one event");const I=ds();m.authWindow=yield m.resolver._openPopup(m.auth,m.provider,m.filter[0],I),m.authWindow.associatedEvent=I,m.resolver._originValidation(m.auth).catch(x=>{m.reject(x)}),m.resolver._isIframeWebStorageSupported(m.auth,x=>{x||m.reject(Se(m.auth,"web-storage-unsupported"))}),m.pollUserCancellation()})()}get eventId(){var m;return(null===(m=this.authWindow)||void 0===m?void 0:m.associatedEvent)||null}cancel(){this.reject(Se(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,w.currentPopupAction=null}pollUserCancellation(){const m=()=>{var I,x;this.pollId=null!==(x=null===(I=this.authWindow)||void 0===I?void 0:I.window)&&void 0!==x&&x.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Se(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(m,ch.get())};m()}}return w.currentPopupAction=null,w})();const dh="pendingRedirect",Qi=new Map;class Ol extends Ml{constructor(f,m,I=!1){super(f,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],m,void 0,I),this.eventId=null}execute(){var f=()=>super.execute,m=this;return(0,_.Z)(function*(){let I=Qi.get(m.auth._key());if(!I){try{const k=(yield function mr(w,f){return yu.apply(this,arguments)}(m.resolver,m.auth))?yield f().call(m):null;I=()=>Promise.resolve(k)}catch(x){I=()=>Promise.reject(x)}Qi.set(m.auth._key(),I)}return m.bypassAuthState||Qi.set(m.auth._key(),()=>Promise.resolve(null)),I()})()}onAuthEvent(f){var m=()=>super.onAuthEvent,I=this;return(0,_.Z)(function*(){if("signInViaRedirect"===f.type)return m().call(I,f);if("unknown"!==f.type){if(f.eventId){const x=yield I.auth._redirectUserForId(f.eventId);if(x)return I.user=x,m().call(I,f);I.resolve(null)}}else I.resolve(null)})()}onExecution(){return(0,_.Z)(function*(){})()}cleanUp(){}}function yu(){return(yu=(0,_.Z)(function*(w,f){const m=vc(f),I=dp(w);if(!(yield I._isAvailable()))return!1;const x="true"===(yield I._get(m));return yield I._remove(m),x})).apply(this,arguments)}function Ll(w,f){return Bo.apply(this,arguments)}function Bo(){return(Bo=(0,_.Z)(function*(w,f){return dp(w)._set(vc(f),"true")})).apply(this,arguments)}function vu(){Qi.clear()}function wu(w,f){Qi.set(w._key(),f)}function dp(w){return Zn(w._redirectPersistence)}function vc(w){return ti(dh,w.config.apiKey,w.name)}function Eu(w,f,m){return function hh(w,f,m){return Fl.apply(this,arguments)}(w,f,m)}function Fl(){return(Fl=(0,_.Z)(function*(w,f,m){const I=_n(w);He(w,f,So),yield I._initializationPromise;const x=ut(I,m);return yield Ll(x,I),x._openRedirect(I,f,"signInViaRedirect")})).apply(this,arguments)}function Ul(w,f,m){return function Iu(w,f,m){return Si.apply(this,arguments)}(w,f,m)}function Si(){return(Si=(0,_.Z)(function*(w,f,m){const I=(0,z.m9)(w);He(I.auth,f,So),yield I.auth._initializationPromise;const x=ut(I.auth,m);yield Ll(x,I.auth);const k=yield Vi(I);return x._openRedirect(I.auth,f,"reauthViaRedirect",k)})).apply(this,arguments)}function Vl(w,f,m){return function Sr(w,f,m){return Cu.apply(this,arguments)}(w,f,m)}function Cu(){return(Cu=(0,_.Z)(function*(w,f,m){const I=(0,z.m9)(w);He(I.auth,f,So),yield I.auth._initializationPromise;const x=ut(I.auth,m);yield iu(!1,I,f.providerId),yield Ll(x,I.auth);const k=yield Vi(I);return x._openRedirect(I.auth,f,"linkViaRedirect",k)})).apply(this,arguments)}function hp(w,f){return Mn.apply(this,arguments)}function Mn(){return(Mn=(0,_.Z)(function*(w,f){return yield _n(w)._initializationPromise,ro(w,f,!1)})).apply(this,arguments)}function ro(w,f){return Ia.apply(this,arguments)}function Ia(){return(Ia=(0,_.Z)(function*(w,f,m=!1){const I=_n(w),x=ut(I,f),X=yield new Ol(I,x,m).execute();return X&&!m&&(delete X.user._redirectEventId,yield I._persistUserIfCurrent(X.user),yield I._setRedirectUser(null,f)),X})).apply(this,arguments)}function Vi(w){return Jn.apply(this,arguments)}function Jn(){return(Jn=(0,_.Z)(function*(w){const f=ds(`${w.uid}:::`);return w._redirectEventId=f,yield w.auth._setRedirectUser(w),yield w.auth._persistUserIfCurrent(w),f})).apply(this,arguments)}class wc{constructor(f){this.auth=f,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(f){this.consumers.add(f),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,f)&&(this.sendToConsumer(this.queuedRedirectEvent,f),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(f){this.consumers.delete(f)}onEvent(f){if(this.hasEventBeenHandled(f))return!1;let m=!1;return this.consumers.forEach(I=>{this.isEventForConsumer(f,I)&&(m=!0,this.sendToConsumer(f,I),this.saveEventToCache(f))}),this.hasHandledPotentialRedirect||!function io(w){switch(w.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Xi(w);default:return!1}}(f)||(this.hasHandledPotentialRedirect=!0,m||(this.queuedRedirectEvent=f,m=!0)),m}sendToConsumer(f,m){var I;if(f.error&&!Xi(f)){const x=(null===(I=f.error.code)||void 0===I?void 0:I.split("auth/")[1])||"internal-error";m.onError(Se(this.auth,x))}else m.onAuthEvent(f)}isEventForConsumer(f,m){const I=null===m.eventId||!!f.eventId&&f.eventId===m.eventId;return m.filter.includes(f.type)&&I}hasEventBeenHandled(f){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ca(f))}saveEventToCache(f){this.cachedEventUids.add(Ca(f)),this.lastProcessedEventTime=Date.now()}}function Ca(w){return[w.type,w.eventId,w.sessionId,w.tenantId].filter(f=>f).join("-")}function Xi({type:w,error:f}){return"unknown"===w&&"auth/no-auth-event"===f?.code}function Ar(w){return so.apply(this,arguments)}function so(){return(so=(0,_.Z)(function*(w,f={}){return xe(w,"GET","/v1/projects",f)})).apply(this,arguments)}const Ay=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ta=/^https?/;function Da(){return(Da=(0,_.Z)(function*(w){if(w.config.emulator)return;const{authorizedDomains:f}=yield Ar(w);for(const m of f)try{if(jo(m))return}catch{}Ae(w,"unauthorized-domain")})).apply(this,arguments)}function jo(w){const f=st(),{protocol:m,hostname:I}=new URL(f);if(w.startsWith("chrome-extension://")){const X=new URL(w);return""===X.hostname&&""===I?"chrome-extension:"===m&&w.replace("chrome-extension://","")===f.replace("chrome-extension://",""):"chrome-extension:"===m&&X.hostname===I}if(!Ta.test(m))return!1;if(Ay.test(w))return I===w;const x=w.replace(/\./g,"\\.");return new RegExp("^(.+\\."+x+"|"+x+")$","i").test(I)}const Bl=new li(3e4,6e4);function Du(){const w=Xn().___jsl;if(w?.H)for(const f of Object.keys(w.H))if(w.H[f].r=w.H[f].r||[],w.H[f].L=w.H[f].L||[],w.H[f].r=[...w.H[f].L],w.CP)for(let m=0;m<w.CP.length;m++)w.CP[m]=null}let gi=null;const Bi=new li(5e3,15e3),fh="__/auth/iframe",ph="emulator/auth/iframe",Ji={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},gh=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mh(w){const f=w.config;ae(f.authDomain,w,"auth-domain-config-required");const m=f.emulator?os(f,ph):`https://${w.config.authDomain}/${fh}`,I={apiKey:f.apiKey,appName:w.name,v:L.SDK_VERSION},x=gh.get(w.config.apiHost);x&&(I.eid=x);const k=w._getFrameworks();return k.length&&(I.fw=k.join(",")),`${m}?${(0,z.xO)(I).slice(1)}`}function E(){return E=(0,_.Z)(function*(w){const f=yield function fp(w){return gi=gi||function At(w){return new Promise((f,m)=>{var I,x,k;function X(){Du(),gapi.load("gapi.iframes",{callback:()=>{f(gapi.iframes.getContext())},ontimeout:()=>{Du(),m(Se(w,"network-request-failed"))},timeout:Bl.get()})}if(null!==(x=null===(I=Xn().gapi)||void 0===I?void 0:I.iframes)&&void 0!==x&&x.Iframe)f(gapi.iframes.getContext());else{if(null===(k=Xn().gapi)||void 0===k||!k.load){const he=Gr("iframefcb");return Xn()[he]=()=>{gapi.load?X():m(Se(w,"network-request-failed"))},sn(`https://apis.google.com/js/api.js?onload=${he}`).catch(Be=>m(Be))}X()}}).catch(f=>{throw gi=null,f})}(w),gi}(w),m=Xn().gapi;return ae(m,w,"internal-error"),f.open({where:document.body,url:mh(w),messageHandlersFilter:m.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ji,dontclear:!0},I=>new Promise(function(){var x=(0,_.Z)(function*(k,X){yield I.restyle({setHideOnLeave:!1});const he=Se(w,"network-request-failed"),Be=Xn().setTimeout(()=>{X(he)},Bi.get());function Ke(){Xn().clearTimeout(Be),k(I)}I.ping(Ke).then(Ke,()=>{X(he)})});return function(k,X){return x.apply(this,arguments)}}()))}),E.apply(this,arguments)}const D={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},A=500,V=600,K="_blank",ee="http://localhost";class se{constructor(f){this.window=f,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const pt="__/auth/handler",kt="emulator/auth/handler",Ot=encodeURIComponent("fac");function Vr(w,f,m,I,x,k){return Tn.apply(this,arguments)}function Tn(){return(Tn=(0,_.Z)(function*(w,f,m,I,x,k){ae(w.config.authDomain,w,"auth-domain-config-required"),ae(w.config.apiKey,w,"invalid-api-key");const X={apiKey:w.config.apiKey,appName:w.name,authType:m,redirectUrl:I,v:L.SDK_VERSION,eventId:x};if(f instanceof So){f.setDefaultLanguage(w.languageCode),X.providerId=f.providerId||"",(0,z.xb)(f.getCustomParameters())||(X.customParameters=JSON.stringify(f.getCustomParameters()));for(const[Et,Wt]of Object.entries(k||{}))X[Et]=Wt}if(f instanceof aa){const Et=f.getScopes().filter(Wt=>""!==Wt);Et.length>0&&(X.scopes=Et.join(","))}w.tenantId&&(X.tid=w.tenantId);const he=X;for(const Et of Object.keys(he))void 0===he[Et]&&delete he[Et];const Be=yield w._getAppCheckToken(),Ke=Be?`#${Ot}=${encodeURIComponent(Be)}`:"";return`${function Gt({config:w}){return w.emulator?os(w,kt):`https://${w.authDomain}/${pt}`}(w)}?${(0,z.xO)(he).slice(1)}${Ke}`})).apply(this,arguments)}const hs="webStorageSupport",Rr=class bu{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=pi,this._completeRedirectFn=ro,this._overrideRedirectResult=wu}_openPopup(f,m,I,x){var k=this;return(0,_.Z)(function*(){var X;St(null===(X=k.eventManagers[f._key()])||void 0===X?void 0:X.manager,"_initialize() not called before _openPopup()");const he=yield Vr(f,m,I,st(),x);return function We(w,f,m,I=A,x=V){const k=Math.max((window.screen.availHeight-x)/2,0).toString(),X=Math.max((window.screen.availWidth-I)/2,0).toString();let he="";const Be=Object.assign(Object.assign({},D),{width:I.toString(),height:x.toString(),top:k,left:X}),Ke=(0,z.z$)().toLowerCase();m&&(he=N(Ke)?K:m),O(Ke)&&(f=f||ee,Be.scrollbars="yes");const Et=Object.entries(Be).reduce((mi,[$o,Sa])=>`${mi}${$o}=${Sa},`,"");if(function Pt(w=(0,z.z$)()){var f;return Dt(w)&&!(null===(f=window.navigator)||void 0===f||!f.standalone)}(Ke)&&"_self"!==he)return function Ge(w,f){const m=document.createElement("a");m.href=w,m.target=f;const I=document.createEvent("MouseEvent");I.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),m.dispatchEvent(I)}(f||"",he),new se(null);const Wt=window.open(f||"",he,Et);ae(Wt,w,"popup-blocked");try{Wt.focus()}catch{}return new se(Wt)}(f,he,ds())})()}_openRedirect(f,m,I,x){var k=this;return(0,_.Z)(function*(){return yield k._originValidation(f),function Xs(w){Xn().location.href=w}(yield Vr(f,m,I,st(),x)),new Promise(()=>{})})()}_initialize(f){const m=f._key();if(this.eventManagers[m]){const{manager:x,promise:k}=this.eventManagers[m];return x?Promise.resolve(x):(St(k,"If manager is not set, promise should be"),k)}const I=this.initAndGetManager(f);return this.eventManagers[m]={promise:I},I.catch(()=>{delete this.eventManagers[m]}),I}initAndGetManager(f){var m=this;return(0,_.Z)(function*(){const I=yield function _h(w){return E.apply(this,arguments)}(f),x=new wc(f);return I.register("authEvent",k=>(ae(k?.authEvent,f,"invalid-auth-event"),{status:x.onEvent(k.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),m.eventManagers[f._key()]={manager:x},m.iframes[f._key()]=I,x})()}_isIframeWebStorageSupported(f,m){this.iframes[f._key()].send(hs,{type:hs},x=>{var k;const X=null===(k=x?.[0])||void 0===k?void 0:k[hs];void 0!==X&&m(!!X),Ae(f,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(f){const m=f._key();return this.originValidationPromises[m]||(this.originValidationPromises[m]=function Ec(w){return Da.apply(this,arguments)}(f)),this.originValidationPromises[m]}get _shouldInitProactively(){return $t()||F()||Dt()}};class fs{constructor(f){this.factorId=f}_process(f,m,I){switch(m.type){case"enroll":return this._finalizeEnroll(f,m.credential,I);case"signin":return this._finalizeSignIn(f,m.credential);default:return tt("unexpected MultiFactorSessionType")}}}class ps extends fs{constructor(f){super("phone"),this.credential=f}static _fromCredential(f){return new ps(f)}_finalizeEnroll(f,m,I){return function ga(w,f){return xe(w,"POST","/v2/accounts/mfaEnrollment:finalize",te(w,f))}(f,{idToken:m,displayName:I,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(f,m){return function Lo(w,f){return xe(w,"POST","/v2/accounts/mfaSignIn:finalize",te(w,f))}(f,{mfaPendingCredential:m,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let pp=(()=>{class w{constructor(){}static assertion(m){return ps._fromCredential(m)}}return w.FACTOR_ID="phone",w})();var Au="@firebase/auth";class ba{constructor(f){this.auth=f,this.internalListeners=new Map}getUid(){var f;return this.assertAuthConfigured(),(null===(f=this.auth.currentUser)||void 0===f?void 0:f.uid)||null}getToken(f){var m=this;return(0,_.Z)(function*(){return m.assertAuthConfigured(),yield m.auth._initializationPromise,m.auth.currentUser?{accessToken:yield m.auth.currentUser.getIdToken(f)}:null})()}addAuthTokenListener(f){if(this.assertAuthConfigured(),this.internalListeners.has(f))return;const m=this.auth.onIdTokenChanged(I=>{f(I?.stsTokenManager.accessToken||null)});this.internalListeners.set(f,m),this.updateProactiveRefresh()}removeAuthTokenListener(f){this.assertAuthConfigured();const m=this.internalListeners.get(f);m&&(this.internalListeners.delete(f),m(),this.updateProactiveRefresh())}assertAuthConfigured(){ae(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}(0,z.Pz)("authIdTokenMaxAge"),function mp(w){(0,L._registerComponent)(new ce.wA("auth",(f,{options:m})=>{const I=f.getProvider("app").getImmediate(),x=f.getProvider("heartbeat"),k=f.getProvider("app-check-internal"),{apiKey:X,authDomain:he}=I.options;ae(X&&!X.includes(":"),"invalid-api-key",{appName:I.name});const Be={apiKey:X,authDomain:he,clientPlatform:w,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Cs(w)},Ke=new Pn(I,x,k,Be);return function Qa(w,f){const m=f?.persistence||[],I=(Array.isArray(m)?m:[m]).map(Zn);f?.errorMap&&w._updateErrorMap(f.errorMap),w._initializeWithPersistence(I,f?.popupRedirectResolver)}(Ke,m),Ke},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((f,m,I)=>{f.getProvider("auth-internal").initialize()})),(0,L._registerComponent)(new ce.wA("auth-internal",f=>{const m=_n(f.getProvider("auth").getImmediate());return new ba(m)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,L.registerVersion)(Au,"0.23.2",function Tc(w){switch(w){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(w)),(0,L.registerVersion)(Au,"0.23.2","esm2017")}("Browser")},2090:(wt,Pe,B)=>{B.d(Pe,{$s:()=>Zn,BH:()=>ke,DV:()=>ir,Dv:()=>Ln,G6:()=>os,GJ:()=>xn,L:()=>Ie,LL:()=>Ve,Pz:()=>Se,Sg:()=>He,UG:()=>tt,UI:()=>Bn,US:()=>ce,Wj:()=>dr,Wl:()=>Tt,Yr:()=>li,ZB:()=>J,ZR:()=>xe,aH:()=>Ae,b$:()=>Kt,cI:()=>un,dS:()=>Di,eu:()=>pe,g5:()=>L,gK:()=>Jr,gQ:()=>cn,h$:()=>ve,hl:()=>le,hu:()=>z,jU:()=>St,lb:()=>Yt,m9:()=>ti,ne:()=>Zt,p$:()=>W,pd:()=>Xr,r3:()=>On,ru:()=>st,tV:()=>q,uI:()=>ae,ug:()=>Jt,vZ:()=>gt,w1:()=>Is,w9:()=>rr,xO:()=>Wn,xb:()=>Ti,z$:()=>Fe,zI:()=>ye,zd:()=>Hr});const _={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},z=function(G,H){if(!G)throw L(H)},L=function(G){return new Error("Firebase Database ("+_.SDK_VERSION+") INTERNAL ASSERT FAILED: "+G)},re=function(G){const H=[];let O=0;for(let F=0;F<G.length;F++){let N=G.charCodeAt(F);N<128?H[O++]=N:N<2048?(H[O++]=N>>6|192,H[O++]=63&N|128):55296==(64512&N)&&F+1<G.length&&56320==(64512&G.charCodeAt(F+1))?(N=65536+((1023&N)<<10)+(1023&G.charCodeAt(++F)),H[O++]=N>>18|240,H[O++]=N>>12&63|128,H[O++]=N>>6&63|128,H[O++]=63&N|128):(H[O++]=N>>12|224,H[O++]=N>>6&63|128,H[O++]=63&N|128)}return H},ce={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(G,H){if(!Array.isArray(G))throw Error("encodeByteArray takes an array as a parameter");this.init_();const O=H?this.byteToCharMapWebSafe_:this.byteToCharMap_,F=[];for(let N=0;N<G.length;N+=3){const Z=G[N],De=N+1<G.length,nt=De?G[N+1]:0,Rt=N+2<G.length,Dt=Rt?G[N+2]:0;let bn=(15&nt)<<2|Dt>>6,$t=63&Dt;Rt||($t=64,De||(bn=64)),F.push(O[Z>>2],O[(3&Z)<<4|nt>>4],O[bn],O[$t])}return F.join("")},encodeString(G,H){return this.HAS_NATIVE_SUPPORT&&!H?btoa(G):this.encodeByteArray(re(G),H)},decodeString(G,H){return this.HAS_NATIVE_SUPPORT&&!H?atob(G):function(G){const H=[];let O=0,F=0;for(;O<G.length;){const N=G[O++];if(N<128)H[F++]=String.fromCharCode(N);else if(N>191&&N<224){const Z=G[O++];H[F++]=String.fromCharCode((31&N)<<6|63&Z)}else if(N>239&&N<365){const Rt=((7&N)<<18|(63&G[O++])<<12|(63&G[O++])<<6|63&G[O++])-65536;H[F++]=String.fromCharCode(55296+(Rt>>10)),H[F++]=String.fromCharCode(56320+(1023&Rt))}else{const Z=G[O++],De=G[O++];H[F++]=String.fromCharCode((15&N)<<12|(63&Z)<<6|63&De)}}return H.join("")}(this.decodeStringToByteArray(G,H))},decodeStringToByteArray(G,H){this.init_();const O=H?this.charToByteMapWebSafe_:this.charToByteMap_,F=[];for(let N=0;N<G.length;){const Z=O[G.charAt(N++)],nt=N<G.length?O[G.charAt(N)]:0;++N;const Dt=N<G.length?O[G.charAt(N)]:64;++N;const Pt=N<G.length?O[G.charAt(N)]:64;if(++N,null==Z||null==nt||null==Dt||null==Pt)throw new Ce;F.push(Z<<2|nt>>4),64!==Dt&&(F.push(nt<<4&240|Dt>>2),64!==Pt&&F.push(Dt<<6&192|Pt))}return F},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let G=0;G<this.ENCODED_VALS.length;G++)this.byteToCharMap_[G]=this.ENCODED_VALS.charAt(G),this.charToByteMap_[this.byteToCharMap_[G]]=G,this.byteToCharMapWebSafe_[G]=this.ENCODED_VALS_WEBSAFE.charAt(G),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[G]]=G,G>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(G)]=G,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(G)]=G)}}};class Ce extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ve=function(G){const H=re(G);return ce.encodeByteArray(H,!0)},Ie=function(G){return ve(G).replace(/\./g,"")},q=function(G){try{return ce.decodeString(G,!0)}catch(H){console.error("base64Decode failed: ",H)}return null};function W(G){return J(void 0,G)}function J(G,H){if(!(H instanceof Object))return H;switch(H.constructor){case Date:return new Date(H.getTime());case Object:void 0===G&&(G={});break;case Array:G=[];break;default:return H}for(const O in H)!H.hasOwnProperty(O)||!$e(O)||(G[O]=J(G[O],H[O]));return G}function $e(G){return"__proto__"!==G}const Me=()=>{try{return function Re(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const G=process.env.__FIREBASE_DEFAULTS__;return G?JSON.parse(G):void 0})()||(()=>{if(typeof document>"u")return;let G;try{G=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const H=G&&q(G[1]);return H&&JSON.parse(H)})()}catch(G){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${G}`)}},Ae=()=>{var G;return null===(G=Me())||void 0===G?void 0:G.config},Se=G=>{var H;return null===(H=Me())||void 0===H?void 0:H[`_${G}`]};class ke{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((H,O)=>{this.resolve=H,this.reject=O})}wrapCallback(H){return(O,F)=>{O?this.reject(O):this.resolve(F),"function"==typeof H&&(this.promise.catch(()=>{}),1===H.length?H(O):H(O,F))}}}function He(G,H){if(G.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const F=H||"demo-project",N=G.iat||0,Z=G.sub||G.user_id;if(!Z)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const De=Object.assign({iss:`https://securetoken.google.com/${F}`,aud:F,iat:N,exp:N+3600,auth_time:N,sub:Z,user_id:Z,firebase:{sign_in_provider:"custom",identities:{}}},G);return[Ie(JSON.stringify({alg:"none",type:"JWT"})),Ie(JSON.stringify(De)),""].join(".")}function Fe(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function ae(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fe())}function tt(){var G;const H=null===(G=Me())||void 0===G?void 0:G.forceEnvironment;if("node"===H)return!0;if("browser"===H)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function St(){return"object"==typeof self&&self.self===self}function st(){const G="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof G&&void 0!==G.id}function Kt(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Is(){const G=Fe();return G.indexOf("MSIE ")>=0||G.indexOf("Trident/")>=0}function li(){return!0===_.NODE_CLIENT||!0===_.NODE_ADMIN}function os(){return!tt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function le(){try{return"object"==typeof indexedDB}catch{return!1}}function pe(){return new Promise((G,H)=>{try{let O=!0;const F="validate-browser-context-for-indexeddb-analytics-module",N=self.indexedDB.open(F);N.onsuccess=()=>{N.result.close(),O||self.indexedDB.deleteDatabase(F),G(!0)},N.onupgradeneeded=()=>{O=!1},N.onerror=()=>{var Z;H((null===(Z=N.error)||void 0===Z?void 0:Z.message)||"")}}catch(O){H(O)}})}function ye(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class xe extends Error{constructor(H,O,F){super(O),this.code=H,this.customData=F,this.name="FirebaseError",Object.setPrototypeOf(this,xe.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ve.prototype.create)}}class Ve{constructor(H,O,F){this.service=H,this.serviceName=O,this.errors=F}create(H,...O){const F=O[0]||{},N=`${this.service}/${H}`,Z=this.errors[H],De=Z?function at(G,H){return G.replace(ct,(O,F)=>{const N=H[F];return null!=N?String(N):`<${F}?>`})}(Z,F):"Error";return new xe(N,`${this.serviceName}: ${De} (${N}).`,F)}}const ct=/\{\$([^}]+)}/g;function un(G){return JSON.parse(G)}function Tt(G){return JSON.stringify(G)}const nn=function(G){let H={},O={},F={},N="";try{const Z=G.split(".");H=un(q(Z[0])||""),O=un(q(Z[1])||""),N=Z[2],F=O.d||{},delete O.d}catch{}return{header:H,claims:O,data:F,signature:N}},rr=function(G){const O=nn(G).claims;return!!O&&"object"==typeof O&&O.hasOwnProperty("iat")},xn=function(G){const H=nn(G).claims;return"object"==typeof H&&!0===H.admin};function On(G,H){return Object.prototype.hasOwnProperty.call(G,H)}function ir(G,H){if(Object.prototype.hasOwnProperty.call(G,H))return G[H]}function Ti(G){for(const H in G)if(Object.prototype.hasOwnProperty.call(G,H))return!1;return!0}function Bn(G,H,O){const F={};for(const N in G)Object.prototype.hasOwnProperty.call(G,N)&&(F[N]=H.call(O,G[N],N,G));return F}function gt(G,H){if(G===H)return!0;const O=Object.keys(G),F=Object.keys(H);for(const N of O){if(!F.includes(N))return!1;const Z=G[N],De=H[N];if(jn(Z)&&jn(De)){if(!gt(Z,De))return!1}else if(Z!==De)return!1}for(const N of F)if(!O.includes(N))return!1;return!0}function jn(G){return null!==G&&"object"==typeof G}function Wn(G){const H=[];for(const[O,F]of Object.entries(G))Array.isArray(F)?F.forEach(N=>{H.push(encodeURIComponent(O)+"="+encodeURIComponent(N))}):H.push(encodeURIComponent(O)+"="+encodeURIComponent(F));return H.length?"&"+H.join("&"):""}function Hr(G){const H={};return G.replace(/^\?/,"").split("&").forEach(F=>{if(F){const[N,Z]=F.split("=");H[decodeURIComponent(N)]=decodeURIComponent(Z)}}),H}function Xr(G){const H=G.indexOf("?");if(!H)return"";const O=G.indexOf("#",H);return G.substring(H,O>0?O:void 0)}class cn{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let H=1;H<this.blockSize;++H)this.pad_[H]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(H,O){O||(O=0);const F=this.W_;if("string"==typeof H)for(let Pt=0;Pt<16;Pt++)F[Pt]=H.charCodeAt(O)<<24|H.charCodeAt(O+1)<<16|H.charCodeAt(O+2)<<8|H.charCodeAt(O+3),O+=4;else for(let Pt=0;Pt<16;Pt++)F[Pt]=H[O]<<24|H[O+1]<<16|H[O+2]<<8|H[O+3],O+=4;for(let Pt=16;Pt<80;Pt++){const bn=F[Pt-3]^F[Pt-8]^F[Pt-14]^F[Pt-16];F[Pt]=4294967295&(bn<<1|bn>>>31)}let Dt,Qt,N=this.chain_[0],Z=this.chain_[1],De=this.chain_[2],nt=this.chain_[3],Rt=this.chain_[4];for(let Pt=0;Pt<80;Pt++){Pt<40?Pt<20?(Dt=nt^Z&(De^nt),Qt=1518500249):(Dt=Z^De^nt,Qt=1859775393):Pt<60?(Dt=Z&De|nt&(Z|De),Qt=2400959708):(Dt=Z^De^nt,Qt=3395469782);const bn=(N<<5|N>>>27)+Dt+Rt+Qt+F[Pt]&4294967295;Rt=nt,nt=De,De=4294967295&(Z<<30|Z>>>2),Z=N,N=bn}this.chain_[0]=this.chain_[0]+N&4294967295,this.chain_[1]=this.chain_[1]+Z&4294967295,this.chain_[2]=this.chain_[2]+De&4294967295,this.chain_[3]=this.chain_[3]+nt&4294967295,this.chain_[4]=this.chain_[4]+Rt&4294967295}update(H,O){if(null==H)return;void 0===O&&(O=H.length);const F=O-this.blockSize;let N=0;const Z=this.buf_;let De=this.inbuf_;for(;N<O;){if(0===De)for(;N<=F;)this.compress_(H,N),N+=this.blockSize;if("string"==typeof H){for(;N<O;)if(Z[De]=H.charCodeAt(N),++De,++N,De===this.blockSize){this.compress_(Z),De=0;break}}else for(;N<O;)if(Z[De]=H[N],++De,++N,De===this.blockSize){this.compress_(Z),De=0;break}}this.inbuf_=De,this.total_+=O}digest(){const H=[];let O=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let N=this.blockSize-1;N>=56;N--)this.buf_[N]=255&O,O/=256;this.compress_(this.buf_);let F=0;for(let N=0;N<5;N++)for(let Z=24;Z>=0;Z-=8)H[F]=this.chain_[N]>>Z&255,++F;return H}}function Zt(G,H){const O=new ft(G,H);return O.subscribe.bind(O)}class ft{constructor(H,O){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=O,this.task.then(()=>{H(this)}).catch(F=>{this.error(F)})}next(H){this.forEachObserver(O=>{O.next(H)})}error(H){this.forEachObserver(O=>{O.error(H)}),this.close(H)}complete(){this.forEachObserver(H=>{H.complete()}),this.close()}subscribe(H,O,F){let N;if(void 0===H&&void 0===O&&void 0===F)throw new Error("Missing Observer.");N=function qn(G,H){if("object"!=typeof G||null===G)return!1;for(const O of H)if(O in G&&"function"==typeof G[O])return!0;return!1}(H,["next","error","complete"])?H:{next:H,error:O,complete:F},void 0===N.next&&(N.next=kr),void 0===N.error&&(N.error=kr),void 0===N.complete&&(N.complete=kr);const Z=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?N.error(this.finalError):N.complete()}catch{}}),this.observers.push(N),Z}unsubscribeOne(H){void 0===this.observers||void 0===this.observers[H]||(delete this.observers[H],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(H){if(!this.finalized)for(let O=0;O<this.observers.length;O++)this.sendOne(O,H)}sendOne(H,O){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[H])try{O(this.observers[H])}catch(F){typeof console<"u"&&console.error&&console.error(F)}})}close(H){this.finalized||(this.finalized=!0,void 0!==H&&(this.finalError=H),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function kr(){}const Ln=function(G,H,O,F){let N;if(F<H?N="at least "+H:F>O&&(N=0===O?"none":"no more than "+O),N)throw new Error(G+" failed: Was called with "+F+(1===F?" argument.":" arguments.")+" Expects "+N+".")};function Jr(G,H){return`${G} failed: ${H} argument `}function dr(G,H,O,F){if((!F||O)&&"function"!=typeof O)throw new Error(Jr(G,H)+"must be a valid function.")}function Yt(G,H,O,F){if((!F||O)&&("object"!=typeof O||null===O))throw new Error(Jr(G,H)+"must be a valid context object.")}const Di=function(G){const H=[];let O=0;for(let F=0;F<G.length;F++){let N=G.charCodeAt(F);if(N>=55296&&N<=56319){const Z=N-55296;F++,z(F<G.length,"Surrogate pair missing trail surrogate."),N=65536+(Z<<10)+(G.charCodeAt(F)-56320)}N<128?H[O++]=N:N<2048?(H[O++]=N>>6|192,H[O++]=63&N|128):N<65536?(H[O++]=N>>12|224,H[O++]=N>>6&63|128,H[O++]=63&N|128):(H[O++]=N>>18|240,H[O++]=N>>12&63|128,H[O++]=N>>6&63|128,H[O++]=63&N|128)}return H},Jt=function(G){let H=0;for(let O=0;O<G.length;O++){const F=G.charCodeAt(O);F<128?H++:F<2048?H+=2:F>=55296&&F<=56319?(H+=4,O++):H+=3}return H},jt=1e3,Kn=2,Fn=144e5,Or=.5;function Zn(G,H=jt,O=Kn){const F=H*Math.pow(O,G),N=Math.round(Or*F*(Math.random()-.5)*2);return Math.min(Fn,F+N)}function ti(G){return G&&G._delegate?G._delegate:G}},1887:(wt,Pe,B)=>{var _=B(4650);let z=null;function L(){return z}class ue{}const ce=new _.OlP("DocumentToken");let Ce=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return function ve(){return(0,_.LFG)(q)}()},providedIn:"platform"}),n})();const Ie=new _.OlP("Location Initialized");let q=(()=>{class n extends Ce{constructor(t){super(),this._doc=t,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return L().getBaseHref(this._doc)}onPopState(t){const r=L().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=L().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){W()?this._history.pushState(t,r,i):this._location.hash=i}replaceState(t,r,i){W()?this._history.replaceState(t,r,i):this._location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ce))},n.\u0275prov=_.Yz7({token:n,factory:function(){return function J(){return new q((0,_.LFG)(ce))}()},providedIn:"platform"}),n})();function W(){return!!window.history.pushState}function $e(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function Re(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function qe(n){return n&&"?"!==n[0]?"?"+n:n}let ot=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return(0,_.f3M)(Me)},providedIn:"root"}),n})();const we=new _.OlP("appBaseHref");let Me=(()=>{class n extends ot{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??(0,_.f3M)(ce).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return $e(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+qe(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,a){const c=this.prepareExternalUrl(i+qe(a));this._platformLocation.pushState(t,r,c)}replaceState(t,r,i,a){const c=this.prepareExternalUrl(i+qe(a));this._platformLocation.replaceState(t,r,c)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Ce),_.LFG(we,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Le=(()=>{class n extends ot{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=$e(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,a){let c=this.prepareExternalUrl(i+qe(a));0==c.length&&(c=this._platformLocation.pathname),this._platformLocation.pushState(t,r,c)}replaceState(t,r,i,a){let c=this.prepareExternalUrl(i+qe(a));0==c.length&&(c=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,c)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Ce),_.LFG(we,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})(),je=(()=>{class n{constructor(t){this._subject=new _.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const r=this._locationStrategy.getBaseHref();this._basePath=function He(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(Re(ke(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+qe(r))}normalize(t){return n.stripTrailingSlash(function Se(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,ke(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+qe(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+qe(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}}return n.normalizeQueryParams=qe,n.joinWithSlash=$e,n.stripTrailingSlash=Re,n.\u0275fac=function(t){return new(t||n)(_.LFG(ot))},n.\u0275prov=_.Yz7({token:n,factory:function(){return function Ae(){return new je((0,_.LFG)(ot))}()},providedIn:"root"}),n})();function ke(n){return n.replace(/\/index.html$/,"")}let $s=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new zt,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Yu("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Yu("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(_.s_b),_.Y36(_.Rgc))},n.\u0275dir=_.lG2({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class zt{constructor(){this.$implicit=null,this.ngIf=null}}function Yu(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${(0,_.AaK)(e)}'.`)}let sa=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({}),n})();const oa="server";function aa(n){return n===oa}let Xu=(()=>{class n{}return n.\u0275prov=(0,_.Yz7)({token:n,providedIn:"root",factory:()=>new ep((0,_.LFG)(ce),window)}),n})();class ep{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function ul(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const a=i.shadowRoot;if(a){const c=a.getElementById(e)||a.querySelector(`[name="${e}"]`);if(c)return c}i=r.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo(r-a[0],i-a[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=qs(this.window.history)||qs(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function qs(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class Qd extends ue{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class uc extends Qd{static makeCurrent(){!function re(n){z||(z=n)}(new uc)}onAndCancel(e,t,r){return e.addEventListener(t,r,!1),()=>{e.removeEventListener(t,r,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function cu(){return pa=pa||document.querySelector("base"),pa?pa.getAttribute("href"):null}();return null==t?null:function vm(n){Ss=Ss||document.createElement("a"),Ss.setAttribute("href",n);const e=Ss.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){pa=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function Io(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,a]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(a)}return null}(document.cookie,e)}}let Ss,pa=null;const ip=new _.OlP("TRANSITION_ID"),Xd=[{provide:_.ip1,useFactory:function cc(n,e,t){return()=>{t.get(_.CZH).donePromise.then(()=>{const r=L(),i=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let a=0;a<i.length;a++)r.remove(i[a])})}},deps:[ip,ce,_.zs3],multi:!0}];let yl=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const lu=new _.OlP("EventManagerPlugins");let lc=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}addGlobalEventListener(t,r,i){return this._findPluginFor(r).addGlobalEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){const r=this._eventNameToPlugin.get(t);if(r)return r;const i=this._plugins;for(let a=0;a<i.length;a++){const c=i[a];if(c.supports(t))return this._eventNameToPlugin.set(t,c),c}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(lu),_.LFG(_.R0b))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();class ga{constructor(e){this._doc=e}addGlobalEventListener(e,t,r){const i=L().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${t}`);return this.addEventListener(i,t,r)}}let Jd=(()=>{class n{constructor(){this.usageCount=new Map}addStyles(t){for(const r of t)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(t){for(const r of t)0===this.changeUsageCount(r,-1)&&this.onStyleRemoved(r)}onStyleRemoved(t){}onStyleAdded(t){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(t,r){const i=this.usageCount;let a=i.get(t)??0;return a+=r,a>0?i.set(t,a):i.delete(t),a}ngOnDestroy(){for(const t of this.getAllStyles())this.onStyleRemoved(t);this.usageCount.clear()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})(),Qs=(()=>{class n extends Jd{constructor(t){super(),this.doc=t,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(t){for(const r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){const r=this.styleRef;r.get(t)?.forEach(a=>a.remove()),r.delete(t)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}addStyleToHost(t,r){const i=this.doc.createElement("style");i.textContent=r,t.appendChild(i);const a=this.styleRef.get(r);a?a.push(i):this.styleRef.set(r,[i])}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ce))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const No={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},ma=/%COMP%/g,fu=new _.OlP("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function dc(n,e){return e.flat(100).map(t=>t.replace(ma,n))}function El(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let pi=(()=>{class n{constructor(t,r,i,a){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestory=a,this.rendererByCompId=new Map,this.defaultRenderer=new eh(t)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;const i=this.getOrCreateRenderer(t,r);return i instanceof hc?i.applyToHost(t):i instanceof Xs&&i.applyStyles(),i}getOrCreateRenderer(t,r){const i=this.rendererByCompId;let a=i.get(r.id);if(!a){const c=this.eventManager,h=this.sharedStylesHost,g=this.removeStylesOnCompDestory;switch(r.encapsulation){case _.ifc.Emulated:a=new hc(c,h,r,this.appId,g);break;case _.ifc.ShadowDom:return new Xn(c,h,t,r);default:a=new Xs(c,h,r,g)}a.onDestroy=()=>i.delete(r.id),i.set(r.id,a)}return a}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(lc),_.LFG(Qs),_.LFG(_.AFp),_.LFG(fu))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();class eh{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(No[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(th(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(th(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const a=No[i];a?e.setAttributeNS(a,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=No[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(_.JOm.DashCase|_.JOm.Important)?e.style.setProperty(t,r,i&_.JOm.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&_.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,El(r)):this.eventManager.addEventListener(e,t,El(r))}}function th(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class Xn extends eh{constructor(e,t,r,i){super(e),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const a=dc(i.id,i.styles);for(const c of a){const h=document.createElement("style");h.textContent=c,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Xs extends eh{constructor(e,t,r,i,a=r.id){super(e),this.sharedStylesHost=t,this.removeStylesOnCompDestory=i,this.rendererUsageCount=0,this.styles=dc(a,r.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class hc extends Xs{constructor(e,t,r,i,a){const c=i+"-"+r.id;super(e,t,r,a,c),this.contentAttr=function sp(n){return"_ngcontent-%COMP%".replace(ma,n)}(c),this.hostAttr=function wl(n){return"_nghost-%COMP%".replace(ma,n)}(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}let nh=(()=>{class n extends ga{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ce))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const pu=["alt","control","meta","shift"],rh={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},fc={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let pr=(()=>{class n extends ga{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i){const a=n.parseEventName(r),c=n.eventCallback(a.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>L().onAndCancel(t,a.domEventName,c))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const a=n._normalizeKey(r.pop());let c="",h=r.indexOf("code");if(h>-1&&(r.splice(h,1),c="code."),pu.forEach(v=>{const T=r.indexOf(v);T>-1&&(r.splice(T,1),c+=v+".")}),c+=a,0!=r.length||0===a.length)return null;const g={};return g.domEventName=i,g.fullKey=c,g}static matchEventFullKeyCode(t,r){let i=rh[t.key]||t.key,a="";return r.indexOf("code.")>-1&&(i=t.code,a="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),pu.forEach(c=>{c!==i&&(0,fc[c])(t)&&(a+=c+".")}),a+=i,a===r)}static eventCallback(t,r,i){return a=>{n.matchEventFullKeyCode(a,t)&&i.runGuarded(()=>r(a))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ce))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const ap=(0,_.eFA)(_._c5,"browser",[{provide:_.Lbi,useValue:"browser"},{provide:_.g9A,useValue:function va(){uc.makeCurrent()},multi:!0},{provide:ce,useFactory:function Tl(){return(0,_.RDi)(document),document},deps:[]}]),ko=new _.OlP(""),gu=[{provide:_.rWj,useClass:class As{addToWindow(e){_.dqk.getAngularTestability=(r,i=!0)=>{const a=e.findTestabilityInTree(r,i);if(null==a)throw new Error("Could not find testability for element.");return a},_.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),_.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),_.dqk.frameworkStabilizers||(_.dqk.frameworkStabilizers=[]),_.dqk.frameworkStabilizers.push(r=>{const i=_.dqk.getAllAngularTestabilities();let a=i.length,c=!1;const h=function(g){c=c||g,a--,0==a&&r(c)};i.forEach(function(g){g.whenStable(h)})})}findTestabilityInTree(e,t,r){return null==t?null:e.getTestability(t)??(r?L().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:_.lri,useClass:_.dDg,deps:[_.R0b,_.eoX,_.rWj]},{provide:_.dDg,useClass:_.dDg,deps:[_.R0b,_.eoX,_.rWj]}],Oo=[{provide:_.zSh,useValue:"root"},{provide:_.qLn,useFactory:function Cl(){return new _.qLn},deps:[]},{provide:lu,useClass:nh,multi:!0,deps:[ce,_.R0b,_.Lbi]},{provide:lu,useClass:pr,multi:!0,deps:[ce]},{provide:pi,useClass:pi,deps:[lc,Qs,_.AFp,fu]},{provide:_.FYo,useExisting:pi},{provide:Jd,useExisting:Qs},{provide:Qs,useClass:Qs,deps:[ce]},{provide:lc,useClass:lc,deps:[lu,_.R0b]},{provide:class tp{},useClass:yl,deps:[]},[]];let wa=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:_.AFp,useValue:t.appId},{provide:ip,useExisting:_.AFp},Xd]}}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ko,12))},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[...Oo,...gu],imports:[sa,_.hGG]}),n})(),up=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ce))},n.\u0275prov=_.Yz7({token:n,factory:function(t){let r=null;return r=t?new t:function Lo(){return new up((0,_.LFG)(ce))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;var ln=B(8996),Zi=B(7669);function ut(...n){const e=(0,Zi.yG)(n);return(0,ln.D)(n,e)}var Yi=B(7579);class sr extends Yi.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}const _u=(0,B(3888).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});var ii=B(9751);const{isArray:Ml}=Array,{getPrototypeOf:ch,prototype:Ui,keys:no}=Object;var Vo=B(4671),yt=B(4004);const{isArray:kl}=Array;var mr=B(5403),yu=B(9672);function Ll(...n){const e=(0,Zi.yG)(n),t=(0,Zi.jO)(n),{args:r,keys:i}=function lh(n){if(1===n.length){const e=n[0];if(Ml(e))return{args:e,keys:null};if(function Uo(n){return n&&"object"==typeof n&&ch(n)===Ui}(e)){const t=no(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}(n);if(0===r.length)return(0,ln.D)([],e);const a=new ii.y(function Bo(n,e,t=Vo.y){return r=>{vu(e,()=>{const{length:i}=n,a=new Array(i);let c=i,h=i;for(let g=0;g<i;g++)vu(e,()=>{const v=(0,ln.D)(n[g],e);let T=!1;v.subscribe((0,mr.x)(r,S=>{a[g]=S,T||(T=!0,h--),h||r.next(t(a.slice()))},()=>{--c||r.complete()}))},r)},r)}}(r,e,i?c=>function Ol(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}(i,c):Vo.y));return t?a.pipe(function Qi(n){return(0,yt.U)(e=>function dh(n,e){return kl(e)?n(...e):n(e)}(n,e))}(t)):a}function vu(n,e,t){n?(0,yu.f)(t,n,e):e()}var wu=B(8189);function vc(...n){return function dp(){return(0,wu.J)(1)}()((0,ln.D)(n,(0,Zi.yG)(n)))}var Eu=B(8421);function hh(n){return new ii.y(e=>{(0,Eu.Xf)(n()).subscribe(e)})}var Fl=B(9635),Ul=B(576);function Iu(n,e){const t=(0,Ul.m)(n)?n:()=>n,r=i=>i.error(t());return new ii.y(e?i=>e.schedule(r,0,i):r)}var Si=B(515),Vl=B(727),Sr=B(4482);function Cu(){return(0,Sr.e)((n,e)=>{let t=null;n._refCount++;const r=(0,mr.x)(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const i=n._connection,a=t;t=null,i&&(!a||i===a)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}class hp extends ii.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,Sr.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Vl.w0;const t=this.getSubject();e.add(this.source.subscribe((0,mr.x)(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Vl.w0.EMPTY)}return e}refCount(){return Cu()(this)}}function Mn(n,e){return(0,Sr.e)((t,r)=>{let i=null,a=0,c=!1;const h=()=>c&&!i&&r.complete();t.subscribe((0,mr.x)(r,g=>{i?.unsubscribe();let v=0;const T=a++;(0,Eu.Xf)(n(g,T)).subscribe(i=(0,mr.x)(r,S=>r.next(e?e(g,S,T,v++):S),()=>{i=null,h()}))},()=>{c=!0,h()}))})}function ro(n){return n<=0?()=>Si.E:(0,Sr.e)((e,t)=>{let r=0;e.subscribe((0,mr.x)(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Ia(...n){const e=(0,Zi.yG)(n);return(0,Sr.e)((t,r)=>{(e?vc(n,t,e):vc(n,t)).subscribe(r)})}function Vi(n,e){return(0,Sr.e)((t,r)=>{let i=0;t.subscribe((0,mr.x)(r,a=>n.call(e,a,i++)&&r.next(a)))})}var Jn=B(5577);function Tu(n){return(0,Sr.e)((e,t)=>{let r=!1;e.subscribe((0,mr.x)(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function wc(n=Ca){return(0,Sr.e)((e,t)=>{let r=!1;e.subscribe((0,mr.x)(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function Ca(){return new _u}function Xi(n,e){const t=arguments.length>=2;return r=>r.pipe(n?Vi((i,a)=>n(i,a,r)):Vo.y,ro(1),t?Tu(e):wc(()=>new _u))}function io(n,e){return(0,Ul.m)(e)?(0,Jn.z)(n,e,1):(0,Jn.z)(n,1)}var Ar=B(8505);function so(n){return(0,Sr.e)((e,t)=>{let a,r=null,i=!1;r=e.subscribe((0,mr.x)(t,void 0,void 0,c=>{a=(0,Eu.Xf)(n(c,so(n)(e))),r?(r.unsubscribe(),r=null,a.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,a.subscribe(t))})}function Ta(n,e){return(0,Sr.e)(function Ay(n,e,t,r,i){return(a,c)=>{let h=t,g=e,v=0;a.subscribe((0,mr.x)(c,T=>{const S=v++;g=h?n(g,T,S):(h=!0,T),r&&c.next(g)},i&&(()=>{h&&c.next(g),c.complete()})))}}(n,e,arguments.length>=2,!0))}function Ec(n){return n<=0?()=>Si.E:(0,Sr.e)((e,t)=>{let r=[];e.subscribe((0,mr.x)(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(const i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Da(n,e){const t=arguments.length>=2;return r=>r.pipe(n?Vi((i,a)=>n(i,a,r)):Vo.y,Ec(1),t?Tu(e):wc(()=>new _u))}function Du(n){return(0,Sr.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const At="primary",gi=Symbol("RouteTitle");class fp{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Bi(n){return new fp(n)}function fh(n,e,t){const r=t.path.split("/");if(r.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||r.length<n.length))return null;const i={};for(let a=0;a<r.length;a++){const c=r[a],h=n[a];if(c.startsWith(":"))i[c.substring(1)]=h;else if(c!==h.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Ji(n,e){const t=n?Object.keys(n):void 0,r=e?Object.keys(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let a=0;a<t.length;a++)if(i=t[a],!gh(n[i],e[i]))return!1;return!0}function gh(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),r=[...e].sort();return t.every((i,a)=>r[a]===i)}return n===e}function mh(n){return Array.prototype.concat.apply([],n)}function _h(n){return n.length>0?n[n.length-1]:null}function D(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function A(n){return(0,_.CqO)(n)?n:(0,_.QGY)(n)?(0,ln.D)(Promise.resolve(n)):ut(n)}const V=!1,K={exact:function Ge(n,e,t){if(!Rr(n.segments,e.segments)||!Vr(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!n.children[r]||!Ge(n.children[r],e.children[r],t))return!1;return!0},subset:kt},ee={exact:function We(n,e){return Ji(n,e)},subset:function pt(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>gh(n[t],e[t]))},ignored:()=>!0};function se(n,e,t){return K[t.paths](n.root,e.root,t.matrixParams)&&ee[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function kt(n,e,t){return Ot(n,e,e.segments,t)}function Ot(n,e,t,r){if(n.segments.length>t.length){const i=n.segments.slice(0,t.length);return!(!Rr(i,t)||e.hasChildren()||!Vr(i,t,r))}if(n.segments.length===t.length){if(!Rr(n.segments,t)||!Vr(n.segments,t,r))return!1;for(const i in e.children)if(!n.children[i]||!kt(n.children[i],e.children[i],r))return!1;return!0}{const i=t.slice(0,n.segments.length),a=t.slice(n.segments.length);return!!(Rr(n.segments,i)&&Vr(n.segments,i,r)&&n.children[At])&&Ot(n.children[At],e,a,r)}}function Vr(n,e,t){return e.every((r,i)=>ee[t](n[i].parameters,r.parameters))}class Tn{constructor(e=new Gt([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Bi(this.queryParams)),this._queryParamMap}toString(){return yh.serialize(this)}}class Gt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,D(t,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ic(this)}}class hs{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Bi(this.parameters)),this._parameterMap}toString(){return wm(this)}}function Rr(n,e){return n.length===e.length&&n.every((t,r)=>t.path===e[r].path)}let ps=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return new pp},providedIn:"root"}),n})();class pp{parse(e){const t=new x(e);return new Tn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Cc(e.root,!0)}`,r=function Em(n){const e=Object.keys(n).map(t=>{const r=n[t];return Array.isArray(r)?r.map(i=>`${Au(t)}=${Au(i)}`).join("&"):`${Au(t)}=${Au(r)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${r}${"string"==typeof e.fragment?`#${function gp(n){return encodeURI(n)}(e.fragment)}`:""}`}}const yh=new pp;function Ic(n){return n.segments.map(e=>wm(e)).join("/")}function Cc(n,e){if(!n.hasChildren())return Ic(n);if(e){const t=n.children[At]?Cc(n.children[At],!1):"",r=[];return D(n.children,(i,a)=>{a!==At&&r.push(`${a}:${Cc(i,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function fs(n,e){let t=[];return D(n.children,(r,i)=>{i===At&&(t=t.concat(e(r,i)))}),D(n.children,(r,i)=>{i!==At&&(t=t.concat(e(r,i)))}),t}(n,(r,i)=>i===At?[Cc(n.children[At],!1)]:[`${i}:${Cc(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[At]?`${Ic(n)}/${t[0]}`:`${Ic(n)}/(${t.join("//")})`}}function Su(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Au(n){return Su(n).replace(/%3B/gi,";")}function ba(n){return Su(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Tc(n){return decodeURIComponent(n)}function mp(n){return Tc(n.replace(/\+/g,"%20"))}function wm(n){return`${ba(n.path)}${function _p(n){return Object.keys(n).map(e=>`;${ba(e)}=${ba(n[e])}`).join("")}(n.parameters)}`}const Ry=/^[^\/()?;=#]+/;function yp(n){const e=n.match(Ry);return e?e[0]:""}const w=/^[^=?&#]+/,m=/^[^&#]+/;class x{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Gt([],{}):new Gt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[At]=new Gt(e,t)),r}parseSegment(){const e=yp(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new _.vHH(4009,V);return this.capture(e),new hs(Tc(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=yp(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const i=yp(this.remaining);i&&(r=i,this.capture(r))}e[Tc(t)]=Tc(r)}parseQueryParam(e){const t=function f(n){const e=n.match(w);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const c=function I(n){const e=n.match(m);return e?e[0]:""}(this.remaining);c&&(r=c,this.capture(r))}const i=mp(t),a=mp(r);if(e.hasOwnProperty(i)){let c=e[i];Array.isArray(c)||(c=[c],e[i]=c),c.push(a)}else e[i]=a}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=yp(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new _.vHH(4010,V);let a;r.indexOf(":")>-1?(a=r.slice(0,r.indexOf(":")),this.capture(a),this.capture(":")):e&&(a=At);const c=this.parseChildren();t[a]=1===Object.keys(c).length?c[At]:new Gt([],c),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new _.vHH(4011,V)}}function k(n){return n.segments.length>0?new Gt([],{[At]:n}):n}function X(n){const e={};for(const r of Object.keys(n.children)){const a=X(n.children[r]);(a.segments.length>0||a.hasChildren())&&(e[r]=a)}return function he(n){if(1===n.numberOfChildren&&n.children[At]){const e=n.children[At];return new Gt(n.segments.concat(e.segments),e.children)}return n}(new Gt(n.segments,e))}function Be(n){return n instanceof Tn}const Ke=!1;function $o(n,e,t,r,i){if(0===t.length)return Rs(e.root,e.root,e.root,r,i);const a=function $l(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new vh(!0,0,n);let e=0,t=!1;const r=n.reduce((i,a,c)=>{if("object"==typeof a&&null!=a){if(a.outlets){const h={};return D(a.outlets,(g,v)=>{h[v]="string"==typeof g?g.split("/"):g}),[...i,{outlets:h}]}if(a.segmentPath)return[...i,a.segmentPath]}return"string"!=typeof a?[...i,a]:0===c?(a.split("/").forEach((h,g)=>{0==g&&"."===h||(0==g&&""===h?t=!0:".."===h?e++:""!=h&&i.push(h))}),i):[...i,a]},[]);return new vh(t,e,r)}(t);return a.toRoot()?Rs(e.root,e.root,new Gt([],{}),r,i):function c(g){const v=function Eh(n,e,t,r){if(n.isAbsolute)return new Aa(e.root,!0,0);if(-1===r)return new Aa(t,t===e.root,0);return function Dc(n,e,t){let r=n,i=e,a=t;for(;a>i;){if(a-=i,r=r.parent,!r)throw new _.vHH(4005,Ke&&"Invalid number of '../'");i=r.segments.length}return new Aa(r,!1,i-a)}(t,r+(Sa(n.commands[0])?0:1),n.numberOfDoubleDots)}(a,e,n.snapshot?._urlSegment,g),T=v.processChildren?Ra(v.segmentGroup,v.index,a.commands):bc(v.segmentGroup,v.index,a.commands);return Rs(e.root,v.segmentGroup,T,r,i)}(n.snapshot?._lastPathIndex)}function Sa(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function jl(n){return"object"==typeof n&&null!=n&&n.outlets}function Rs(n,e,t,r,i){let c,a={};r&&D(r,(g,v)=>{a[v]=Array.isArray(g)?g.map(T=>`${T}`):`${g}`}),c=n===e?t:vp(n,e,t);const h=k(X(c));return new Tn(h,a,i)}function vp(n,e,t){const r={};return D(n.children,(i,a)=>{r[a]=i===e?t:vp(i,e,t)}),new Gt(n.segments,r)}class vh{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Sa(r[0]))throw new _.vHH(4003,Ke&&"Root segment cannot have matrix parameters");const i=r.find(jl);if(i&&i!==_h(r))throw new _.vHH(4004,Ke&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Aa{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}}function bc(n,e,t){if(n||(n=new Gt([],{})),0===n.segments.length&&n.hasChildren())return Ra(n,e,t);const r=function xy(n,e,t){let r=0,i=e;const a={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return a;const c=n.segments[i],h=t[r];if(jl(h))break;const g=`${h}`,v=r<t.length-1?t[r+1]:null;if(i>0&&void 0===g)break;if(g&&v&&"object"==typeof v&&void 0===v.outlets){if(!Py(g,v,c))return a;r+=2}else{if(!Py(g,{},c))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const a=new Gt(n.segments.slice(0,r.pathIndex),{});return a.children[At]=new Gt(n.segments.slice(r.pathIndex),n.children),Ra(a,0,i)}return r.match&&0===i.length?new Gt(n.segments,{}):r.match&&!n.hasChildren()?wp(n,e,t):r.match?Ra(n,0,i):wp(n,e,t)}function Ra(n,e,t){if(0===t.length)return new Gt(n.segments,{});{const r=function Ih(n){return jl(n[0])?n[0].outlets:{[At]:n}}(t),i={};if(!r[At]&&n.children[At]&&1===n.numberOfChildren&&0===n.children[At].segments.length){const a=Ra(n.children[At],e,t);return new Gt(n.segments,a.children)}return D(r,(a,c)=>{"string"==typeof a&&(a=[a]),null!==a&&(i[c]=bc(n.children[c],e,a))}),D(n.children,(a,c)=>{void 0===r[c]&&(i[c]=a)}),new Gt(n.segments,i)}}function wp(n,e,t){const r=n.segments.slice(0,e);let i=0;for(;i<t.length;){const a=t[i];if(jl(a)){const g=Ep(a.outlets);return new Gt(r,g)}if(0===i&&Sa(t[0])){r.push(new hs(n.segments[e].path,sE(t[0]))),i++;continue}const c=jl(a)?a.outlets[At]:`${a}`,h=i<t.length-1?t[i+1]:null;c&&h&&Sa(h)?(r.push(new hs(c,sE(h))),i+=2):(r.push(new hs(c,{})),i++)}return new Gt(r,{})}function Ep(n){const e={};return D(n,(t,r)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[r]=wp(new Gt([],{}),0,t))}),e}function sE(n){const e={};return D(n,(t,r)=>e[r]=`${t}`),e}function Py(n,e,t){return n==t.path&&Ji(e,t.parameters)}const Ip="imperative";class xa{constructor(e,t){this.id=e,this.url=t}}class Ny extends xa{constructor(e,t,r="imperative",i=null){super(e,t),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Sc extends xa{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Cp extends xa{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Hl extends xa{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=16}}class Tp extends xa{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Ch extends xa{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class RD extends xa{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xD extends xa{constructor(e,t,r,i,a){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=a,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class UP extends xa{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class PD extends xa{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class My{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class ND{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class oE{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Im{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ky{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class aE{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Oy{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let MD=(()=>{class n{createUrlTree(t,r,i,a,c,h){return $o(t||r.root,i,a,c,h)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})(),OD=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(e){return MD.\u0275fac(e)},providedIn:"root"}),n})();class lE{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Ly(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){const t=Ly(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Pa(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Pa(e,this._root).map(t=>t.value)}}function Ly(n,e){if(n===e.value)return e;for(const t of e.children){const r=Ly(n,t);if(r)return r}return null}function Pa(n,e){if(n===e.value)return[e];for(const t of e.children){const r=Pa(n,t);if(r.length)return r.unshift(e),r}return[]}class xs{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Th(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class LD extends lE{constructor(e,t){super(e),this.snapshot=t,Fy(this,e)}toString(){return this.snapshot.toString()}}function FD(n,e){const t=function VP(n,e){const c=new Cm([],{},{},"",{},At,e,null,n.root,-1,{});return new hE("",new xs(c,[]))}(n,e),r=new sr([new hs("",{})]),i=new sr({}),a=new sr({}),c=new sr({}),h=new sr(""),g=new Dp(r,i,c,h,a,At,e,t.root);return g.snapshot=t.root,new LD(new xs(g,[]),t)}class Dp{constructor(e,t,r,i,a,c,h,g){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=c,this.component=h,this.title=this.data?.pipe((0,yt.U)(v=>v[gi]))??ut(void 0),this._futureSnapshot=g}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,yt.U)(e=>Bi(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,yt.U)(e=>Bi(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function UD(n,e="emptyOnly"){const t=n.pathFromRoot;let r=0;if("always"!==e)for(r=t.length-1;r>=1;){const i=t[r],a=t[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function dE(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(r))}class Cm{get title(){return this.data?.[gi]}constructor(e,t,r,i,a,c,h,g,v,T,S){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=c,this.component=h,this.routeConfig=g,this._urlSegment=v,this._lastPathIndex=T,this._resolve=S}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Bi(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Bi(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class hE extends lE{constructor(e,t){super(t),this.url=e,Fy(this,t)}toString(){return fE(this._root)}}function Fy(n,e){e.value._routerState=n,e.children.forEach(t=>Fy(n,t))}function fE(n){const e=n.children.length>0?` { ${n.children.map(fE).join(", ")} } `:"";return`${n.value}${e}`}function bp(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Ji(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),Ji(e.params,t.params)||n.params.next(t.params),function ph(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Ji(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),Ji(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function Ho(n,e){const t=Ji(n.params,e.params)&&function bu(n,e){return Rr(n,e)&&n.every((t,r)=>Ji(t.parameters,e[r].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||Ho(n.parent,e.parent))}function Dh(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=e.value;const i=function pE(n,e,t){return e.children.map(r=>{for(const i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Dh(n,r,i);return Dh(n,r)})}(n,e,t);return new xs(r,i)}{if(n.shouldAttach(e.value)){const a=n.retrieve(e.value);if(null!==a){const c=a.route;return c.value._futureSnapshot=e.value,c.children=e.children.map(h=>Dh(n,h)),c}}const r=function gE(n){return new Dp(new sr(n.url),new sr(n.params),new sr(n.queryParams),new sr(n.fragment),new sr(n.data),n.outlet,n.component,n)}(e.value),i=e.children.map(a=>Dh(n,a));return new xs(r,i)}}const mE="ngNavigationCancelingError";function VD(n,e){const{redirectTo:t,navigationBehaviorOptions:r}=Be(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=BD(!1,0,e);return i.url=t,i.navigationBehaviorOptions=r,i}function BD(n,e,t){const r=new Error("NavigationCancelingError: "+(n||""));return r[mE]=!0,r.cancellationCode=e,t&&(r.url=t),r}function Tm(n){return Dm(n)&&Be(n.url)}function Dm(n){return n&&n[mE]}class BP{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new bm,this.attachRef=null}}let bm=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){const i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){const r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new BP,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Ap=!1;let Uy=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=At,this.activateEvents=new _.vpe,this.deactivateEvents=new _.vpe,this.attachEvents=new _.vpe,this.detachEvents=new _.vpe,this.parentContexts=(0,_.f3M)(bm),this.location=(0,_.f3M)(_.s_b),this.changeDetector=(0,_.f3M)(_.sBO),this.environmentInjector=(0,_.f3M)(_.lqb)}ngOnChanges(t){if(t.name){const{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new _.vHH(4012,Ap);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new _.vHH(4012,Ap);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new _.vHH(4012,Ap);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new _.vHH(4013,Ap);this._activatedRoute=t;const i=this.location,c=t.snapshot.component,h=this.parentContexts.getOrCreateContext(this.name).children,g=new jD(t,h,i.injector);if(r&&function $D(n){return!!n.resolveComponentFactory}(r)){const v=r.resolveComponentFactory(c);this.activated=i.createComponent(v,i.length,g)}else this.activated=i.createComponent(c,{index:i.length,injector:g,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=_.lG2({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[_.TTD]}),n})();class jD{constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Dp?this.route:e===bm?this.childContexts:this.parent.get(e,t)}}let Vy=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["ng-component"]],standalone:!0,features:[_.jDz],decls:1,vars:0,template:function(t,r){1&t&&_._UZ(0,"router-outlet")},dependencies:[Uy],encapsulation:2}),n})();function By(n,e){return n.providers&&!n._injector&&(n._injector=(0,_.MMx)(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Sm(n){const e=n.children&&n.children.map(Sm),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==At&&(t.component=Vy),t}function oo(n){return n.outlet||At}function yE(n,e){const t=n.filter(r=>oo(r)===e);return t.push(...n.filter(r=>oo(r)!==e)),t}function Rp(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class vE{constructor(e,t,r,i){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i}activate(e){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),bp(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){const i=Th(t);e.children.forEach(a=>{const c=a.value.outlet;this.deactivateRoutes(a,i[c],r),delete i[c]}),D(i,(a,c)=>{this.deactivateRouteAndItsChildren(a,r)})}deactivateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(i===a)if(i.component){const c=r.getContext(i.outlet);c&&this.deactivateChildRoutes(e,t,c.children)}else this.deactivateChildRoutes(e,t,r);else a&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=Th(e);for(const c of Object.keys(a))this.deactivateRouteAndItsChildren(a[c],i);if(r&&r.outlet){const c=r.outlet.detach(),h=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:c,route:e,contexts:h})}}deactivateRouteAndOutlet(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=Th(e);for(const c of Object.keys(a))this.deactivateRouteAndItsChildren(a[c],i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,t,r){const i=Th(t);e.children.forEach(a=>{this.activateRoutes(a,i[a.value.outlet],r),this.forwardEvent(new aE(a.value.snapshot))}),e.children.length&&this.forwardEvent(new Im(e.value.snapshot))}activateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(bp(i),i===a)if(i.component){const c=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,c.children)}else this.activateChildRoutes(e,t,r);else if(i.component){const c=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const h=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),c.children.onOutletReAttached(h.contexts),c.attachRef=h.componentRef,c.route=h.route.value,c.outlet&&c.outlet.attach(h.componentRef,h.route.value),bp(h.route.value),this.activateChildRoutes(e,null,c.children)}else{const h=Rp(i.snapshot),g=h?.get(_._Vd)??null;c.attachRef=null,c.route=i,c.resolver=g,c.injector=h,c.outlet&&c.outlet.activateWith(i,c.injector),this.activateChildRoutes(e,null,c.children)}}else this.activateChildRoutes(e,null,r)}}class WD{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Hy{constructor(e,t){this.component=e,this.route=t}}function xp(n,e,t){const r=n._root;return bh(r,e?e._root:null,t,[r.value])}function zl(n,e){const t=Symbol(),r=e.get(n,t);return r===t?"function"!=typeof n||(0,_.Z0I)(n)?e.get(n):n:r}function bh(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=Th(e);return n.children.forEach(c=>{(function wE(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=n.value,c=e?e.value:null,h=t?t.getContext(n.value.outlet):null;if(c&&a.routeConfig===c.routeConfig){const g=function HP(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Rr(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Rr(n.url,e.url)||!Ji(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Ho(n,e)||!Ji(n.queryParams,e.queryParams);default:return!Ho(n,e)}}(c,a,a.routeConfig.runGuardsAndResolvers);g?i.canActivateChecks.push(new WD(r)):(a.data=c.data,a._resolvedData=c._resolvedData),bh(n,e,a.component?h?h.children:null:t,r,i),g&&h&&h.outlet&&h.outlet.isActivated&&i.canDeactivateChecks.push(new Hy(h.outlet.component,c))}else c&&Pp(e,h,i),i.canActivateChecks.push(new WD(r)),bh(n,null,a.component?h?h.children:null:t,r,i)})(c,a[c.value.outlet],t,r.concat([c.value]),i),delete a[c.value.outlet]}),D(a,(c,h)=>Pp(c,t.getContext(h),i)),i}function Pp(n,e,t){const r=Th(n),i=n.value;D(r,(a,c)=>{Pp(a,i.component?e?e.children.getContext(c):null:e,t)}),t.canDeactivateChecks.push(new Hy(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function Sh(n){return"function"==typeof n}function Ru(n){return n instanceof _u||"EmptyError"===n?.name}const Am=Symbol("INITIAL_VALUE");function Ac(){return Mn(n=>Ll(n.map(e=>e.pipe(ro(1),Ia(Am)))).pipe((0,yt.U)(e=>{for(const t of e)if(!0!==t){if(t===Am)return Am;if(!1===t||t instanceof Tn)return t}return!0}),Vi(e=>e!==Am),ro(1)))}function Yy(n){return(0,Fl.z)((0,Ar.b)(e=>{if(Be(e))throw VD(0,e)}),(0,yt.U)(e=>!0===e))}const Qy={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function TE(n,e,t,r,i){const a=Xy(n,e,t);return a.matched?function Ah(n,e,t,r){const i=e.canMatch;return i&&0!==i.length?ut(i.map(c=>{const h=zl(c,n);return A(function qy(n){return n&&Sh(n.canMatch)}(h)?h.canMatch(e,t):n.runInContext(()=>h(e,t)))})).pipe(Ac(),Yy()):ut(!0)}(r=By(e,r),e,t).pipe((0,yt.U)(c=>!0===c?a:{...Qy})):ut(a)}function Xy(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...Qy}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||fh)(t,n,e);if(!i)return{...Qy};const a={};D(i.posParams,(h,g)=>{a[g]=h.path});const c=i.consumed.length>0?{...a,...i.consumed[i.consumed.length-1].parameters}:a;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:c,positionalParamSegments:i.posParams??{}}}function Rh(n,e,t,r){if(t.length>0&&function JD(n,e,t){return t.some(r=>Jy(n,e,r)&&oo(r)!==At)}(n,t,r)){const a=new Gt(e,function DE(n,e,t,r){const i={};i[At]=r,r._sourceSegment=n,r._segmentIndexShift=e.length;for(const a of t)if(""===a.path&&oo(a)!==At){const c=new Gt([],{});c._sourceSegment=n,c._segmentIndexShift=e.length,i[oo(a)]=c}return i}(n,e,r,new Gt(t,n.children)));return a._sourceSegment=n,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:[]}}if(0===t.length&&function bE(n,e,t){return t.some(r=>Jy(n,e,r))}(n,t,r)){const a=new Gt(n.segments,function XD(n,e,t,r,i){const a={};for(const c of r)if(Jy(n,t,c)&&!i[oo(c)]){const h=new Gt([],{});h._sourceSegment=n,h._segmentIndexShift=e.length,a[oo(c)]=h}return{...i,...a}}(n,e,t,r,n.children));return a._sourceSegment=n,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:t}}const i=new Gt(n.segments,n.children);return i._sourceSegment=n,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:t}}function Jy(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function SE(n,e,t,r){return!!(oo(n)===r||r!==At&&Jy(e,t,n))&&("**"===n.path||Xy(e,n,t).matched)}function xh(n,e,t){return 0===e.length&&!n.children[t]}const Pm=!1;class xu{constructor(e){this.segmentGroup=e||null}}class Ph{constructor(e){this.urlTree=e}}function Np(n){return Iu(new xu(n))}function ev(n){return Iu(new Ph(n))}class AE{constructor(e,t,r,i,a){this.injector=e,this.configLoader=t,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0}apply(){const e=Rh(this.urlTree.root,[],[],this.config).segmentGroup,t=new Gt(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,At).pipe((0,yt.U)(a=>this.createUrlTree(X(a),this.urlTree.queryParams,this.urlTree.fragment))).pipe(so(a=>{if(a instanceof Ph)return this.allowRedirects=!1,this.match(a.urlTree);throw a instanceof xu?this.noMatchError(a):a}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,At).pipe((0,yt.U)(i=>this.createUrlTree(X(i),e.queryParams,e.fragment))).pipe(so(i=>{throw i instanceof xu?this.noMatchError(i):i}))}noMatchError(e){return new _.vHH(4002,Pm)}createUrlTree(e,t,r){const i=k(e);return new Tn(i,t,r)}expandSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,t,r).pipe((0,yt.U)(a=>new Gt([],a))):this.expandSegment(e,r,t,r.segments,i,!0)}expandChildren(e,t,r){const i=[];for(const a of Object.keys(r.children))"primary"===a?i.unshift(a):i.push(a);return(0,ln.D)(i).pipe(io(a=>{const c=r.children[a],h=yE(t,a);return this.expandSegmentGroup(e,h,c,a).pipe((0,yt.U)(g=>({segment:g,outlet:a})))}),Ta((a,c)=>(a[c.outlet]=c.segment,a),{}),Da())}expandSegment(e,t,r,i,a,c){return(0,ln.D)(r).pipe(io(h=>this.expandSegmentAgainstRoute(e,t,r,h,i,a,c).pipe(so(v=>{if(v instanceof xu)return ut(null);throw v}))),Xi(h=>!!h),so((h,g)=>{if(Ru(h))return xh(t,i,a)?ut(new Gt([],{})):Np(t);throw h}))}expandSegmentAgainstRoute(e,t,r,i,a,c,h){return SE(i,t,a,c)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,t,i,a,c):h&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,c):Np(t):Np(t)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,c){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,c):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,c)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,r,i){const a=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?ev(a):this.lineralizeSegments(r,a).pipe((0,Jn.z)(c=>{const h=new Gt(c,{});return this.expandSegment(e,h,t,c,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,c){const{matched:h,consumedSegments:g,remainingSegments:v,positionalParamSegments:T}=Xy(t,i,a);if(!h)return Np(t);const S=this.applyRedirectCommands(g,i.redirectTo,T);return i.redirectTo.startsWith("/")?ev(S):this.lineralizeSegments(i,S).pipe((0,Jn.z)(M=>this.expandSegment(e,t,r,M.concat(v),c,!1)))}matchSegmentAgainstRoute(e,t,r,i,a){return"**"===r.path?(e=By(r,e),r.loadChildren?(r._loadedRoutes?ut({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(e,r)).pipe((0,yt.U)(h=>(r._loadedRoutes=h.routes,r._loadedInjector=h.injector,new Gt(i,{})))):ut(new Gt(i,{}))):TE(t,r,i,e).pipe(Mn(({matched:c,consumedSegments:h,remainingSegments:g})=>c?this.getChildConfig(e=r._injector??e,r,i).pipe((0,Jn.z)(T=>{const S=T.injector??e,M=T.routes,{segmentGroup:$,slicedSegments:Y}=Rh(t,h,g,M),fe=new Gt($.segments,$.children);if(0===Y.length&&fe.hasChildren())return this.expandChildren(S,M,fe).pipe((0,yt.U)(Ze=>new Gt(h,Ze)));if(0===M.length&&0===Y.length)return ut(new Gt(h,{}));const ge=oo(r)===a;return this.expandSegment(S,fe,M,Y,ge?At:a,!0).pipe((0,yt.U)(it=>new Gt(h.concat(it.segments),it.children)))})):Np(t)))}getChildConfig(e,t,r){return t.children?ut({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?ut({routes:t._loadedRoutes,injector:t._loadedInjector}):function QD(n,e,t,r){const i=e.canLoad;return void 0===i||0===i.length?ut(!0):ut(i.map(c=>{const h=zl(c,n);return A(function Gy(n){return n&&Sh(n.canLoad)}(h)?h.canLoad(e,t):n.runInContext(()=>h(e,t)))})).pipe(Ac(),Yy())}(e,t,r).pipe((0,Jn.z)(i=>i?this.configLoader.loadChildren(e,t).pipe((0,Ar.b)(a=>{t._loadedRoutes=a.routes,t._loadedInjector=a.injector})):function tb(n){return Iu(BD(Pm,3))}())):ut({routes:[],injector:e})}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return ut(r);if(i.numberOfChildren>1||!i.children[At])return e.redirectTo,Iu(new _.vHH(4e3,Pm));i=i.children[At]}}applyRedirectCommands(e,t,r){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r)}applyRedirectCreateUrlTree(e,t,r,i){const a=this.createSegmentGroup(e,t.root,r,i);return new Tn(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const r={};return D(e,(i,a)=>{if("string"==typeof i&&i.startsWith(":")){const h=i.substring(1);r[a]=t[h]}else r[a]=i}),r}createSegmentGroup(e,t,r,i){const a=this.createSegments(e,t.segments,r,i);let c={};return D(t.children,(h,g)=>{c[g]=this.createSegmentGroup(e,h,r,i)}),new Gt(a,c)}createSegments(e,t,r,i){return t.map(a=>a.path.startsWith(":")?this.findPosParam(e,a,i):this.findOrReturn(a,r))}findPosParam(e,t,r){const i=r[t.path.substring(1)];if(!i)throw new _.vHH(4001,Pm);return i}findOrReturn(e,t){let r=0;for(const i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}}class tv{}class Mp{constructor(e,t,r,i,a,c,h){this.injector=e,this.rootComponentType=t,this.config=r,this.urlTree=i,this.url=a,this.paramsInheritanceStrategy=c,this.urlSerializer=h}recognize(){const e=Rh(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,At).pipe((0,yt.U)(t=>{if(null===t)return null;const r=new Cm([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},At,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new xs(r,t),a=new hE(this.url,i);return this.inheritParamsAndData(a._root),a}))}inheritParamsAndData(e){const t=e.value,r=UD(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i)}processChildren(e,t,r){return(0,ln.D)(Object.keys(r.children)).pipe(io(i=>{const a=r.children[i],c=yE(t,i);return this.processSegmentGroup(e,c,a,i)}),Ta((i,a)=>i&&a?(i.push(...a),i):null),function jo(n,e=!1){return(0,Sr.e)((t,r)=>{let i=0;t.subscribe((0,mr.x)(r,a=>{const c=n(a,i++);(c||e)&&r.next(a),!c&&r.complete()}))})}(i=>null!==i),Tu(null),Da(),(0,yt.U)(i=>{if(null===i)return null;const a=xE(i);return function ib(n){n.sort((e,t)=>e.value.outlet===At?-1:t.value.outlet===At?1:e.value.outlet.localeCompare(t.value.outlet))}(a),a}))}processSegment(e,t,r,i,a){return(0,ln.D)(t).pipe(io(c=>this.processSegmentAgainstRoute(c._injector??e,c,r,i,a)),Xi(c=>!!c),so(c=>{if(Ru(c))return xh(r,i,a)?ut([]):ut(null);throw c}))}processSegmentAgainstRoute(e,t,r,i,a){if(t.redirectTo||!SE(t,r,i,a))return ut(null);let c;if("**"===t.path){const h=i.length>0?_h(i).parameters:{},g=NE(r)+i.length;c=ut({snapshot:new Cm(i,h,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Na(t),oo(t),t.component??t._loadedComponent??null,t,PE(r),g,ME(t)),consumedSegments:[],remainingSegments:[]})}else c=TE(r,t,i,e).pipe((0,yt.U)(({matched:h,consumedSegments:g,remainingSegments:v,parameters:T})=>{if(!h)return null;const S=NE(r)+g.length;return{snapshot:new Cm(g,T,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Na(t),oo(t),t.component??t._loadedComponent??null,t,PE(r),S,ME(t)),consumedSegments:g,remainingSegments:v}}));return c.pipe(Mn(h=>{if(null===h)return ut(null);const{snapshot:g,consumedSegments:v,remainingSegments:T}=h;e=t._injector??e;const S=t._loadedInjector??e,M=function sb(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(t),{segmentGroup:$,slicedSegments:Y}=Rh(r,v,T,M.filter(ge=>void 0===ge.redirectTo));if(0===Y.length&&$.hasChildren())return this.processChildren(S,M,$).pipe((0,yt.U)(ge=>null===ge?null:[new xs(g,ge)]));if(0===M.length&&0===Y.length)return ut([new xs(g,[])]);const fe=oo(t)===a;return this.processSegment(S,M,$,Y,fe?At:a).pipe((0,yt.U)(ge=>null===ge?null:[new xs(g,ge)]))}))}}function ob(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function xE(n){const e=[],t=new Set;for(const r of n){if(!ob(r)){e.push(r);continue}const i=e.find(a=>r.value.routeConfig===a.value.routeConfig);void 0!==i?(i.children.push(...r.children),t.add(i)):e.push(r)}for(const r of t){const i=xE(r.children);e.push(new xs(r.value,i))}return e.filter(r=>!t.has(r))}function PE(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function NE(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function Na(n){return n.data||{}}function ME(n){return n.resolve||{}}function rv(n){return"string"==typeof n.title||null===n.title}function iv(n){return Mn(e=>{const t=n(e);return t?(0,ln.D)(t).pipe((0,yt.U)(()=>e)):ut(e)})}const Nh=new _.OlP("ROUTES");let ov=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,_.f3M)(_.Sil)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return ut(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const r=A(t.loadComponent()).pipe((0,yt.U)(LE),(0,Ar.b)(a=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=a}),Du(()=>{this.componentLoaders.delete(t)})),i=new hp(r,()=>new Yi.x).pipe(Cu());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return ut({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const a=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe((0,yt.U)(h=>{this.onLoadEndListener&&this.onLoadEndListener(r);let g,v,T=!1;Array.isArray(h)?v=h:(g=h.create(t).injector,v=mh(g.get(Nh,[],_.XFs.Self|_.XFs.Optional)));return{routes:v.map(Sm),injector:g}}),Du(()=>{this.childrenLoaders.delete(r)})),c=new hp(a,()=>new Yi.x).pipe(Cu());return this.childrenLoaders.set(r,c),c}loadModuleFactoryOrRoutes(t){return A(t()).pipe((0,yt.U)(LE),(0,Jn.z)(r=>r instanceof _.YKP||Array.isArray(r)?ut(r):(0,ln.D)(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function LE(n){return function zo(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let Mm=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Yi.x,this.configLoader=(0,_.f3M)(ov),this.environmentInjector=(0,_.f3M)(_.lqb),this.urlSerializer=(0,_.f3M)(ps),this.rootContexts=(0,_.f3M)(bm),this.navigationId=0,this.afterPreactivation=()=>ut(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=i=>this.events.next(new ND(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new My(i))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:r})}setupNavigations(t){return this.transitions=new sr({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Ip,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Vi(r=>0!==r.id),(0,yt.U)(r=>({...r,extractedUrl:t.urlHandlingStrategy.extract(r.rawUrl)})),Mn(r=>{let i=!1,a=!1;return ut(r).pipe((0,Ar.b)(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Mn(c=>{const h=t.browserUrlTree.toString(),g=!t.navigated||c.extractedUrl.toString()!==h||h!==t.currentUrlTree.toString();if(!g&&"reload"!==(c.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const T="";return this.events.next(new Hl(c.id,t.serializeUrl(r.rawUrl),T,0)),t.rawUrlTree=c.rawUrl,c.resolve(null),Si.E}if(t.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return FE(c.source)&&(t.browserUrlTree=c.extractedUrl),ut(c).pipe(Mn(T=>{const S=this.transitions?.getValue();return this.events.next(new Ny(T.id,this.urlSerializer.serialize(T.extractedUrl),T.source,T.restoredState)),S!==this.transitions?.getValue()?Si.E:Promise.resolve(T)}),function RE(n,e,t,r){return Mn(i=>function nb(n,e,t,r,i){return new AE(n,e,t,r,i).apply()}(n,e,t,i.extractedUrl,r).pipe((0,yt.U)(a=>({...i,urlAfterRedirects:a}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),(0,Ar.b)(T=>{this.currentNavigation={...this.currentNavigation,finalUrl:T.urlAfterRedirects},r.urlAfterRedirects=T.urlAfterRedirects}),function ub(n,e,t,r,i){return(0,Jn.z)(a=>function nv(n,e,t,r,i,a,c="emptyOnly"){return new Mp(n,e,t,r,i,c,a).recognize().pipe(Mn(h=>null===h?function rb(n){return new ii.y(e=>e.error(n))}(new tv):ut(h)))}(n,e,t,a.urlAfterRedirects,r.serialize(a.urlAfterRedirects),r,i).pipe((0,yt.U)(c=>({...a,targetSnapshot:c}))))}(this.environmentInjector,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),(0,Ar.b)(T=>{if(r.targetSnapshot=T.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!T.extras.skipLocationChange){const M=t.urlHandlingStrategy.merge(T.urlAfterRedirects,T.rawUrl);t.setBrowserUrl(M,T)}t.browserUrlTree=T.urlAfterRedirects}const S=new Ch(T.id,this.urlSerializer.serialize(T.extractedUrl),this.urlSerializer.serialize(T.urlAfterRedirects),T.targetSnapshot);this.events.next(S)}));if(g&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:T,extractedUrl:S,source:M,restoredState:$,extras:Y}=c,fe=new Ny(T,this.urlSerializer.serialize(S),M,$);this.events.next(fe);const ge=FD(S,this.rootComponentType).snapshot;return ut(r={...c,targetSnapshot:ge,urlAfterRedirects:S,extras:{...Y,skipLocationChange:!1,replaceUrl:!1}})}{const T="";return this.events.next(new Hl(c.id,t.serializeUrl(r.extractedUrl),T,1)),t.rawUrlTree=c.rawUrl,c.resolve(null),Si.E}}),(0,Ar.b)(c=>{const h=new RD(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(h)}),(0,yt.U)(c=>r={...c,guards:xp(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),function Rm(n,e){return(0,Jn.z)(t=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:a,canDeactivateChecks:c}}=t;return 0===c.length&&0===a.length?ut({...t,guardsResult:!0}):function ZD(n,e,t,r){return(0,ln.D)(n).pipe((0,Jn.z)(i=>function YD(n,e,t,r,i){const a=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return a&&0!==a.length?ut(a.map(h=>{const g=Rp(e)??i,v=zl(h,g);return A(function qD(n){return n&&Sh(n.canDeactivate)}(v)?v.canDeactivate(n,e,t,r):g.runInContext(()=>v(n,e,t,r))).pipe(Xi())})).pipe(Ac()):ut(!0)}(i.component,i.route,t,e,r)),Xi(i=>!0!==i,!0))}(c,r,i,n).pipe((0,Jn.z)(h=>h&&function EE(n){return"boolean"==typeof n}(h)?function Ky(n,e,t,r){return(0,ln.D)(e).pipe(io(i=>vc(function Gl(n,e){return null!==n&&e&&e(new oE(n)),ut(!0)}(i.route.parent,r),function xm(n,e){return null!==n&&e&&e(new ky(n)),ut(!0)}(i.route,r),function Zy(n,e,t){const r=e[e.length-1],a=e.slice(0,e.length-1).reverse().map(c=>function zy(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(c)).filter(c=>null!==c).map(c=>hh(()=>ut(c.guards.map(g=>{const v=Rp(c.node)??t,T=zl(g,v);return A(function Wy(n){return n&&Sh(n.canActivateChild)}(T)?T.canActivateChild(r,n):v.runInContext(()=>T(r,n))).pipe(Xi())})).pipe(Ac())));return ut(a).pipe(Ac())}(n,i.path,t),function CE(n,e,t){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return ut(!0);const i=r.map(a=>hh(()=>{const c=Rp(e)??t,h=zl(a,c);return A(function zP(n){return n&&Sh(n.canActivate)}(h)?h.canActivate(e,n):c.runInContext(()=>h(e,n))).pipe(Xi())}));return ut(i).pipe(Ac())}(n,i.route,t))),Xi(i=>!0!==i,!0))}(r,a,n,e):ut(h)),(0,yt.U)(h=>({...t,guardsResult:h})))})}(this.environmentInjector,c=>this.events.next(c)),(0,Ar.b)(c=>{if(r.guardsResult=c.guardsResult,Be(c.guardsResult))throw VD(0,c.guardsResult);const h=new xD(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(h)}),Vi(c=>!!c.guardsResult||(t.restoreHistory(c),this.cancelNavigationTransition(c,"",3),!1)),iv(c=>{if(c.guards.canActivateChecks.length)return ut(c).pipe((0,Ar.b)(h=>{const g=new UP(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(g)}),Mn(h=>{let g=!1;return ut(h).pipe(function GP(n,e){return(0,Jn.z)(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return ut(t);let a=0;return(0,ln.D)(i).pipe(io(c=>function WP(n,e,t,r){const i=n.routeConfig,a=n._resolve;return void 0!==i?.title&&!rv(i)&&(a[gi]=i.title),function kE(n,e,t,r){const i=function qP(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===i.length)return ut({});const a={};return(0,ln.D)(i).pipe((0,Jn.z)(c=>function OE(n,e,t,r){const i=Rp(e)??r,a=zl(n,i);return A(a.resolve?a.resolve(e,t):i.runInContext(()=>a(e,t)))}(n[c],e,t,r).pipe(Xi(),(0,Ar.b)(h=>{a[c]=h}))),Ec(1),function Bl(n){return(0,yt.U)(()=>n)}(a),so(c=>Ru(c)?Si.E:Iu(c)))}(a,n,e,r).pipe((0,yt.U)(c=>(n._resolvedData=c,n.data=UD(n,t).resolve,i&&rv(i)&&(n.data[gi]=i.title),null)))}(c.route,r,n,e)),(0,Ar.b)(()=>a++),Ec(1),(0,Jn.z)(c=>a===i.length?ut(t):Si.E))})}(t.paramsInheritanceStrategy,this.environmentInjector),(0,Ar.b)({next:()=>g=!0,complete:()=>{g||(t.restoreHistory(h),this.cancelNavigationTransition(h,"",2))}}))}),(0,Ar.b)(h=>{const g=new PD(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(g)}))}),iv(c=>{const h=g=>{const v=[];g.routeConfig?.loadComponent&&!g.routeConfig._loadedComponent&&v.push(this.configLoader.loadComponent(g.routeConfig).pipe((0,Ar.b)(T=>{g.component=T}),(0,yt.U)(()=>{})));for(const T of g.children)v.push(...h(T));return v};return Ll(h(c.targetSnapshot.root)).pipe(Tu(),ro(1))}),iv(()=>this.afterPreactivation()),(0,yt.U)(c=>{const h=function Sp(n,e,t){const r=Dh(n,e._root,t?t._root:void 0);return new LD(r,e)}(t.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return r={...c,targetRouterState:h}}),(0,Ar.b)(c=>{t.currentUrlTree=c.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(c.urlAfterRedirects,c.rawUrl),t.routerState=c.targetRouterState,"deferred"===t.urlUpdateStrategy&&(c.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,c),t.browserUrlTree=c.urlAfterRedirects)}),((n,e,t)=>(0,yt.U)(r=>(new vE(e,r.targetRouterState,r.currentRouterState,t).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,c=>this.events.next(c)),ro(1),(0,Ar.b)({next:c=>{i=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new Sc(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{i=!0}}),Du(()=>{i||a||this.cancelNavigationTransition(r,"",1),this.currentNavigation?.id===r.id&&(this.currentNavigation=null)}),so(c=>{if(a=!0,Dm(c)){Tm(c)||(t.navigated=!0,t.restoreHistory(r,!0));const h=new Cp(r.id,this.urlSerializer.serialize(r.extractedUrl),c.message,c.cancellationCode);if(this.events.next(h),Tm(c)){const g=t.urlHandlingStrategy.merge(c.url,t.rawUrlTree),v={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||FE(r.source)};t.scheduleNavigation(g,Ip,null,v,{resolve:r.resolve,reject:r.reject,promise:r.promise})}else r.resolve(!1)}else{t.restoreHistory(r,!0);const h=new Tp(r.id,this.urlSerializer.serialize(r.extractedUrl),c,r.targetSnapshot??void 0);this.events.next(h);try{r.resolve(t.errorHandler(c))}catch(g){r.reject(g)}}return Si.E}))}))}cancelNavigationTransition(t,r,i){const a=new Cp(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(a),t.resolve(!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function FE(n){return n!==Ip}let UE=(()=>{class n{buildTitle(t){let r,i=t.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(a=>a.outlet===At);return r}getResolvedTitleForRoute(t){return t.data[gi]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return(0,_.f3M)(cb)},providedIn:"root"}),n})(),cb=(()=>{class n extends UE{constructor(t){super(),this.title=t}updateTitle(t){const r=this.buildTitle(t);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(up))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),VE=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return(0,_.f3M)(db)},providedIn:"root"}),n})();class lb{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let db=(()=>{class n extends lb{}return n.\u0275fac=function(){let e;return function(r){return(e||(e=_.n5z(n)))(r||n)}}(),n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Ht=new _.OlP("",{providedIn:"root",factory:()=>({})});let BE=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return(0,_.f3M)(jE)},providedIn:"root"}),n})(),jE=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function fb(n){throw n}function pb(n,e,t){return e.parse("/")}const $E={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},gb={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ji=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,_.f3M)(_.c2e),this.isNgZoneEnabled=!1,this.options=(0,_.f3M)(Ht,{optional:!0})||{},this.errorHandler=this.options.errorHandler||fb,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||pb,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,_.f3M)(BE),this.routeReuseStrategy=(0,_.f3M)(VE),this.urlCreationStrategy=(0,_.f3M)(OD),this.titleStrategy=(0,_.f3M)(UE),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=mh((0,_.f3M)(Nh,{optional:!0})??[]),this.navigationTransitions=(0,_.f3M)(Mm),this.urlSerializer=(0,_.f3M)(ps),this.location=(0,_.f3M)(je),this.isNgZoneEnabled=(0,_.f3M)(_.R0b)instanceof _.R0b&&_.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Tn,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=FD(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId??0},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Ip,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,r,t.state)},0)}))}navigateToSyncWithBrowser(t,r,i){const a={replaceUrl:!0},c=i?.navigationId?i:null;if(i){const g={...i};delete g.navigationId,delete g.\u0275routerPageId,0!==Object.keys(g).length&&(a.state=g)}const h=this.parseUrl(t);this.scheduleNavigation(h,r,c,a)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(Sm),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,r={}){const{relativeTo:i,queryParams:a,fragment:c,queryParamsHandling:h,preserveFragment:g}=r,v=g?this.currentUrlTree.fragment:c;let T=null;switch(h){case"merge":T={...this.currentUrlTree.queryParams,...a};break;case"preserve":T=this.currentUrlTree.queryParams;break;default:T=a||null}return null!==T&&(T=this.removeEmptyProps(T)),this.urlCreationStrategy.createUrlTree(i,this.routerState,this.currentUrlTree,t,T,v??null)}navigateByUrl(t,r={skipLocationChange:!1}){const i=Be(t)?t:this.parseUrl(t),a=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(a,Ip,null,r)}navigate(t,r={skipLocationChange:!1}){return function mb(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new _.vHH(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return r}isActive(t,r){let i;if(i=!0===r?{...$E}:!1===r?{...gb}:r,Be(t))return se(this.currentUrlTree,t,i);const a=this.parseUrl(t);return se(this.currentUrlTree,a,i)}removeEmptyProps(t){return Object.keys(t).reduce((r,i)=>{const a=t[i];return null!=a&&(r[i]=a),r},{})}scheduleNavigation(t,r,i,a,c){if(this.disposed)return Promise.resolve(!1);let h,g,v,T;return c?(h=c.resolve,g=c.reject,v=c.promise):v=new Promise((S,M)=>{h=S,g=M}),T="computed"===this.canceledNavigationResolution?i&&i.\u0275routerPageId?i.\u0275routerPageId:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:T,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:a,resolve:h,reject:g,promise:v,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),v.catch(S=>Promise.reject(S))}setBrowserUrl(t,r){const i=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){const c={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId)};this.location.replaceState(i,"",c)}else{const a={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.go(i,"",a)}}restoreHistory(t,r=!1){if("computed"===this.canceledNavigationResolution){const a=this.currentPageId-(this.browserPageId??this.currentPageId);0!==a?this.location.historyGo(a):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===a&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Wl=(()=>{class n{constructor(t,r,i,a,c,h){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=a,this.el=c,this.locationStrategy=h,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new Yi.x;const g=c.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===g||"area"===g,this.isAnchorElement?this.subscription=t.events.subscribe(v=>{v instanceof Sc&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(t){this._preserveFragment=(0,_.D6c)(t)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(t){this._skipLocationChange=(0,_.D6c)(t)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(t){this._replaceUrl=(0,_.D6c)(t)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,r,i,a,c){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||r||i||a||c||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:(0,_.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,r){const i=this.renderer,a=this.el.nativeElement;null!==r?i.setAttribute(a,t,r):i.removeAttribute(a,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(ji),_.Y36(Dp),_.$8M("tabindex"),_.Y36(_.Qsj),_.Y36(_.SBq),_.Y36(ot))},n.\u0275dir=_.lG2({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(t,r){1&t&&_.NdJ("click",function(a){return r.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),2&t&&_.uIk("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[_.TTD]}),n})();class av{}let uv=(()=>{class n{constructor(t,r,i,a,c){this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=c}setUpPreloading(){this.subscription=this.router.events.pipe(Vi(t=>t instanceof Sc),io(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const i=[];for(const a of r){a.providers&&!a._injector&&(a._injector=(0,_.MMx)(a.providers,t,`Route: ${a.path}`));const c=a._injector??t,h=a._loadedInjector??c;(a.loadChildren&&!a._loadedRoutes&&void 0===a.canLoad||a.loadComponent&&!a._loadedComponent)&&i.push(this.preloadConfig(c,a)),(a.children||a._loadedRoutes)&&i.push(this.processRoutes(h,a.children??a._loadedRoutes))}return(0,ln.D)(i).pipe((0,wu.J)())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(t,r):ut(null);const a=i.pipe((0,Jn.z)(c=>null===c?ut(void 0):(r._loadedRoutes=c.routes,r._loadedInjector=c.injector,this.processRoutes(c.injector??t,c.routes))));if(r.loadComponent&&!r._loadedComponent){const c=this.loader.loadComponent(r);return(0,ln.D)([a,c]).pipe((0,wu.J)())}return a})}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ji),_.LFG(_.Sil),_.LFG(_.lqb),_.LFG(av),_.LFG(ov))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Lp=new _.OlP("");let zE=(()=>{class n{constructor(t,r,i,a,c={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=a,this.options=c,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},c.scrollPositionRestoration=c.scrollPositionRestoration||"disabled",c.anchorScrolling=c.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Ny?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Sc&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Oy&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Oy(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(t){_.$Z()},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();var ao=(()=>((ao=ao||{})[ao.COMPLETE=0]="COMPLETE",ao[ao.FAILED=1]="FAILED",ao[ao.REDIRECTING=2]="REDIRECTING",ao))();const Fp=!1;function ql(n,e){return{\u0275kind:n,\u0275providers:e}}const lv=new _.OlP("",{providedIn:"root",factory:()=>!1});function Up(){const n=(0,_.f3M)(_.zs3);return e=>{const t=n.get(_.z2F);if(e!==t.components[0])return;const r=n.get(ji),i=n.get(GE);1===n.get(Om)&&r.initialNavigation(),n.get(WE,null,_.XFs.Optional)?.setUpPreloading(),n.get(Lp,null,_.XFs.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const GE=new _.OlP(Fp?"bootstrap done indicator":"",{factory:()=>new Yi.x}),Om=new _.OlP(Fp?"initial navigation":"",{providedIn:"root",factory:()=>1});function wb(){let n=[];return n=Fp?[{provide:_.Xts,multi:!0,useFactory:()=>{const e=(0,_.f3M)(ji);return()=>e.events.subscribe(t=>{console.group?.(`Router Event: ${t.constructor.name}`),console.log(function uE(n){if(!("type"in n))return`Unknown Router Event: ${n.constructor.name}`;switch(n.type){case 14:return`ActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state}, shouldActivate: ${n.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 2:return`NavigationCancel(id: ${n.id}, url: '${n.url}')`;case 16:return`NavigationSkipped(id: ${n.id}, url: '${n.url}')`;case 1:return`NavigationEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${n.id}, url: '${n.url}', error: ${n.error})`;case 0:return`NavigationStart(id: ${n.id}, url: '${n.url}')`;case 6:return`ResolveEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 5:return`ResolveStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 10:return`RouteConfigLoadEnd(path: ${n.route.path})`;case 9:return`RouteConfigLoadStart(path: ${n.route.path})`;case 4:return`RoutesRecognized(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 15:return`Scroll(anchor: '${n.anchor}', position: '${n.position?`${n.position[0]}, ${n.position[1]}`:null}')`}}(t)),console.log(t),console.groupEnd?.()})}}]:[],ql(1,n)}const WE=new _.OlP(Fp?"router preloader":"");function Eb(n){return ql(0,[{provide:WE,useExisting:uv},{provide:av,useExisting:n}])}const Oh=!1,Tb=new _.OlP(Oh?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),dv=[je,{provide:ps,useClass:pp},ji,bm,{provide:Dp,useFactory:function cv(n){return n.routerState.root},deps:[ji]},ov,Oh?{provide:lv,useValue:!0}:[]];function Db(){return new _.PXZ("Router",ji)}let bb=(()=>{class n{constructor(t){}static forRoot(t,r){return{ngModule:n,providers:[dv,Oh&&r?.enableTracing?wb().\u0275providers:[],{provide:Nh,multi:!0,useValue:t},{provide:Tb,useFactory:ZE,deps:[[ji,new _.FiY,new _.tp0]]},{provide:Ht,useValue:r||{}},r?.useHash?{provide:ot,useClass:Le}:{provide:ot,useClass:Me},{provide:Lp,useFactory:()=>{const n=(0,_.f3M)(Xu),e=(0,_.f3M)(_.R0b),t=(0,_.f3M)(Ht),r=(0,_.f3M)(Mm),i=(0,_.f3M)(ps);return t.scrollOffset&&n.setOffset(t.scrollOffset),new zE(i,r,n,e,t)}},r?.preloadingStrategy?Eb(r.preloadingStrategy).\u0275providers:[],{provide:_.PXZ,multi:!0,useFactory:Db},r?.initialNavigation?Ab(r):[],[{provide:YE,useFactory:Up},{provide:_.tb,multi:!0,useExisting:YE}]]}}static forChild(t){return{ngModule:n,providers:[{provide:Nh,multi:!0,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Tb,8))},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({imports:[Vy]}),n})();function ZE(n){if(Oh&&n)throw new _.vHH(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Ab(n){return["disabled"===n.initialNavigation?ql(3,[{provide:_.ip1,multi:!0,useFactory:()=>{const e=(0,_.f3M)(ji);return()=>{e.setUpLocationChangeListener()}}},{provide:Om,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?ql(2,[{provide:Om,useValue:0},{provide:_.ip1,multi:!0,deps:[_.zs3],useFactory:e=>{const t=e.get(Ie,Promise.resolve());return()=>t.then(()=>new Promise(r=>{const i=e.get(ji),a=e.get(GE);(function YP(n,e){n.events.pipe(Vi(t=>t instanceof Sc||t instanceof Cp||t instanceof Tp||t instanceof Hl),(0,yt.U)(t=>t instanceof Sc||t instanceof Hl?ao.COMPLETE:t instanceof Cp&&(0===t.code||1===t.code)?ao.REDIRECTING:ao.FAILED),Vi(t=>t!==ao.REDIRECTING),ro(1)).subscribe(()=>{e()})})(i,()=>{r(!0)}),e.get(Mm).afterPreactivation=()=>(r(!0),a.closed?ut(void 0):a),i.initialNavigation()}))}}]).\u0275providers:[]]}const YE=new _.OlP(Oh?"Router Initializer":"");var hv=B(1389),U=B(2090),Ai=B(6881),gs=B(1877),uo=B(4859),Bp=B(4986),vn=B(4976);function jp(){return(0,Sr.e)((n,e)=>{let t,r=!1;n.subscribe((0,mr.x)(e,i=>{const a=t;t=i,r&&e.next([a,i]),r=!0}))})}function fv(n,e=Vo.y){return n=n??pv,(0,Sr.e)((t,r)=>{let i,a=!0;t.subscribe((0,mr.x)(r,c=>{const h=e(c);(a||!n(i,h))&&(a=!1,i=h,r.next(c))}))})}function pv(n,e){return n===e}var rt,si=B(2011),Fm=(B(9568),B(3942)),Ee=B(5861),QE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},co={},gv=gv||{},bt=QE||self;function Um(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function $p(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var Hp="closure_uid_"+(1e9*Math.random()>>>0),XE=0;function Rb(n,e,t){return n.call.apply(n.bind,arguments)}function xb(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function $i(n,e,t){return($i=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Rb:xb).apply(null,arguments)}function zp(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function _i(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,i,a){for(var c=Array(arguments.length-2),h=2;h<arguments.length;h++)c[h-2]=arguments[h];return e.prototype[i].apply(r,c)}}function Rc(){this.s=this.s,this.o=this.o}Rc.prototype.s=!1,Rc.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function tN(n){Object.prototype.hasOwnProperty.call(n,Hp)&&n[Hp]||(n[Hp]=++XE)}(this)},Rc.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const JE=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function _v(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function eI(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(Um(r)){const i=n.length||0,a=r.length||0;n.length=i+a;for(let c=0;c<a;c++)n[i+c]=r[c]}else n.push(r)}}function Hi(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Hi.prototype.h=function(){this.defaultPrevented=!0};var Pb=function(){if(!bt.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{bt.addEventListener("test",()=>{},e),bt.removeEventListener("test",()=>{},e)}catch{}return n}();function ms(n){return/^[\s\xa0]*$/.test(n)}function Fh(){var n=bt.navigator;return n&&(n=n.userAgent)?n:""}function Ma(n){return-1!=Fh().indexOf(n)}function yv(n){return yv[" "](n),n}yv[" "]=function(){};var Vh,n,Nb=Ma("Opera"),Uh=Ma("Trident")||Ma("MSIE"),nI=Ma("Edge"),Gp=nI||Uh,rI=Ma("Gecko")&&!(-1!=Fh().toLowerCase().indexOf("webkit")&&!Ma("Edge"))&&!(Ma("Trident")||Ma("MSIE"))&&!Ma("Edge"),Mb=-1!=Fh().toLowerCase().indexOf("webkit")&&!Ma("Edge");function Wp(){var n=bt.document;return n?n.documentMode:void 0}e:{var Bh="",iI=(n=Fh(),rI?/rv:([^\);]+)(\)|;)/.exec(n):nI?/Edge\/([\d\.]+)/.exec(n):Uh?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):Mb?/WebKit\/(\S+)/.exec(n):Nb?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(iI&&(Bh=iI?iI[1]:""),Uh){var qp=Wp();if(null!=qp&&qp>parseFloat(Bh)){Vh=String(qp);break e}}Vh=Bh}var oI=bt.document&&Uh&&(Wp()||parseInt(Vh,10))||void 0;function jh(n,e){if(Hi.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(rI){e:{try{yv(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:aI[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&jh.$.h.call(this)}}_i(jh,Hi);var aI={2:"touch",3:"pen",4:"mouse"};jh.prototype.h=function(){jh.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Kl="closure_listenable_"+(1e6*Math.random()|0),Pu=0;function Vm(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=i,this.key=++Pu,this.fa=this.ia=!1}function Zl(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function Yl(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function wv(n){const e={};for(const t in n)e[t]=n[t];return e}const Ev="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function uI(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let a=0;a<Ev.length;a++)t=Ev[a],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function Bm(n){this.src=n,this.g={},this.h=0}function Ql(n,e){var t=e.type;if(t in n.g){var a,r=n.g[t],i=JE(r,e);(a=0<=i)&&Array.prototype.splice.call(r,i,1),a&&(Zl(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function Iv(n,e,t,r){for(var i=0;i<n.length;++i){var a=n[i];if(!a.fa&&a.listener==e&&a.capture==!!t&&a.la==r)return i}return-1}Bm.prototype.add=function(n,e,t,r,i){var a=n.toString();(n=this.g[a])||(n=this.g[a]=[],this.h++);var c=Iv(n,e,r,i);return-1<c?(e=n[c],t||(e.ia=!1)):((e=new Vm(e,this.src,a,!!r,i)).ia=t,n.push(e)),e};var cI="closure_lm_"+(1e6*Math.random()|0),Cv={};function lI(n,e,t,r,i){if(r&&r.once)return hI(n,e,t,r,i);if(Array.isArray(e)){for(var a=0;a<e.length;a++)lI(n,e[a],t,r,i);return null}return t=Sv(t),n&&n[Kl]?n.O(e,t,$p(r)?!!r.capture:!!r,i):dI(n,e,t,!1,r,i)}function dI(n,e,t,r,i,a){if(!e)throw Error("Invalid event type");var c=$p(i)?!!i.capture:!!i,h=bv(n);if(h||(n[cI]=h=new Bm(n)),(t=h.add(e,t,r,c,a)).proxy)return t;if(r=function Ob(){const e=pI;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)Pb||(i=c),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(Dv(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function hI(n,e,t,r,i){if(Array.isArray(e)){for(var a=0;a<e.length;a++)hI(n,e[a],t,r,i);return null}return t=Sv(t),n&&n[Kl]?n.P(e,t,$p(r)?!!r.capture:!!r,i):dI(n,e,t,!0,r,i)}function fI(n,e,t,r,i){if(Array.isArray(e))for(var a=0;a<e.length;a++)fI(n,e[a],t,r,i);else r=$p(r)?!!r.capture:!!r,t=Sv(t),n&&n[Kl]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=Iv(a=n.g[e],t,r,i))&&(Zl(a[t]),Array.prototype.splice.call(a,t,1),0==a.length&&(delete n.g[e],n.h--))):n&&(n=bv(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Iv(e,t,r,i)),(t=-1<n?e[n]:null)&&Tv(t))}function Tv(n){if("number"!=typeof n&&n&&!n.fa){var e=n.src;if(e&&e[Kl])Ql(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(Dv(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=bv(e))?(Ql(t,n),0==t.h&&(t.src=null,e[cI]=null)):Zl(n)}}}function Dv(n){return n in Cv?Cv[n]:Cv[n]="on"+n}function pI(n,e){if(n.fa)n=!0;else{e=new jh(e,this);var t=n.listener,r=n.la||n.src;n.ia&&Tv(n),n=t.call(r,e)}return n}function bv(n){return(n=n[cI])instanceof Bm?n:null}var Kp="__closure_events_fn_"+(1e9*Math.random()>>>0);function Sv(n){return"function"==typeof n?n:(n[Kp]||(n[Kp]=function(e){return n.handleEvent(e)}),n[Kp])}function yi(){Rc.call(this),this.i=new Bm(this),this.S=this,this.J=null}function Ri(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,"string"==typeof e)e=new Hi(e,n);else if(e instanceof Hi)e.target=e.target||n;else{var i=e;uI(e=new Hi(r,n),i)}if(i=!0,t)for(var a=t.length-1;0<=a;a--){var c=e.g=t[a];i=jm(c,r,!0,e)&&i}if(i=jm(c=e.g=n,r,!0,e)&&i,i=jm(c,r,!1,e)&&i,t)for(a=0;a<t.length;a++)i=jm(c=e.g=t[a],r,!1,e)&&i}function jm(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,a=0;a<e.length;++a){var c=e[a];if(c&&!c.fa&&c.capture==t){var h=c.listener,g=c.la||c.src;c.ia&&Ql(n.i,c),i=!1!==h.call(g,r)&&i}}return i&&!r.defaultPrevented}_i(yi,Rc),yi.prototype[Kl]=!0,yi.prototype.removeEventListener=function(n,e,t,r){fI(this,n,e,t,r)},yi.prototype.N=function(){if(yi.$.N.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)Zl(t[r]);delete n.g[e],n.h--}}this.J=null},yi.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},yi.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var Av=bt.JSON.stringify;function Fb(){var n=xv;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var Rv=new class Lb{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new Ub,n=>n.reset());class Ub{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function nN(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function mI(n){bt.setTimeout(()=>{throw n},0)}let $m,xc=!1,xv=new class gI{constructor(){this.h=this.g=null}add(e,t){const r=Rv.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},_I=()=>{const n=bt.Promise.resolve(void 0);$m=()=>{n.then(Pv)}};var Pv=()=>{for(var n;n=Fb();){try{n.h.call(n.g)}catch(t){mI(t)}var e=Rv;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}xc=!1};function Hm(n,e){yi.call(this),this.h=n||1,this.g=e||bt,this.j=$i(this.qb,this),this.l=Date.now()}function lo(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}function Xl(n,e,t){if("function"==typeof n)t&&(n=$i(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=$i(n.handleEvent,n)}return 2147483647<Number(e)?-1:bt.setTimeout(n,e||0)}function xi(n){n.g=Xl(()=>{n.g=null,n.i&&(n.i=!1,xi(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}_i(Hm,yi),(rt=Hm.prototype).ga=!1,rt.T=null,rt.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Ri(this,"tick"),this.ga&&(lo(this),this.start()))}},rt.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},rt.N=function(){Hm.$.N.call(this),lo(this),delete this.g};class Jl extends Rc{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:xi(this)}N(){super.N(),this.g&&(bt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pc(n){Rc.call(this),this.h=n,this.g={}}_i(Pc,Rc);var Ps=[];function zm(n,e,t,r){Array.isArray(t)||(t&&(Ps[0]=t.toString()),t=Ps);for(var i=0;i<t.length;i++){var a=lI(e,t[i],r||n.handleEvent,!1,n.h||n);if(!a)break;n.g[a.key]=a}}function ed(n){Yl(n.g,function(e,t){this.g.hasOwnProperty(t)&&Tv(e)},n),n.g={}}function Nu(){this.g=!0}function Go(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function Gh(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var c=1;c<i.length;c++)i[c]=""}}}return Av(t)}catch{return e}}(n,t)+(r?" "+r:"")})}Pc.prototype.N=function(){Pc.$.N.call(this),ed(this)},Pc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Nu.prototype.Ea=function(){this.g=!1},Nu.prototype.info=function(){};var ho={},td=null;function Zp(){return td=td||new yi}function Nv(n){Hi.call(this,ho.Ta,n)}function Wh(n){const e=Zp();Ri(e,new Nv(e))}function Mv(n,e){Hi.call(this,ho.STAT_EVENT,n),this.stat=e}function zi(n){const e=Zp();Ri(e,new Mv(e,n))}function kv(n,e){Hi.call(this,ho.Ua,n),this.size=e}function qh(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return bt.setTimeout(function(){n()},e)}ho.Ta="serverreachability",_i(Nv,Hi),ho.STAT_EVENT="statevent",_i(Mv,Hi),ho.Ua="timingevent",_i(kv,Hi);var Yp={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Ov={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Lv(){}function Fv(){}Lv.prototype.h=null;var Jp,Qp={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Gm(){Hi.call(this,"d")}function Xp(){Hi.call(this,"c")}function Wm(){}function Nc(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new Pc(this),this.P=Uv,this.V=new Hm(n=Gp?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new eg}function eg(){this.i=null,this.g="",this.h=!1}_i(Gm,Hi),_i(Xp,Hi),_i(Wm,Lv),Wm.prototype.g=function(){return new XMLHttpRequest},Wm.prototype.i=function(){return{}},Jp=new Wm;var Uv=45e3,Vv={},Kh={};function tg(n,e,t){n.L=1,n.v=og(Wo(e)),n.s=t,n.S=!0,Bv(n,null)}function Bv(n,e){n.G=Date.now(),Zh(n),n.A=Wo(n.v);var t=n.A,r=n.W;Array.isArray(r)||(r=[String(r)]),Hb(t.i,"t",r),n.C=0,t=n.l.J,n.h=new eg,n.g=LI(n.l,t?e:null,!n.s),0<n.O&&(n.M=new Jl($i(n.Pa,n,n.g),n.O)),zm(n.U,n.g,"readystatechange",n.nb),e=n.I?wv(n.I):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.A,n.u,n.s,e)):(n.u="GET",n.g.ha(n.A,n.u,null,e)),Wh(),function $h(n,e,t,r,i,a){n.info(function(){if(n.g)if(a)for(var c="",h=a.split("&"),g=0;g<h.length;g++){var v=h[g].split("=");if(1<v.length){var T=v[0];v=v[1];var S=T.split("_");c=2<=S.length&&"type"==S[1]?c+(T+"=")+v+"&":c+(T+"=redacted&")}}else c=null;else c=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+c})}(n.j,n.u,n.A,n.m,n.W,n.s)}function jv(n){return!!n.g&&"GET"==n.u&&2!=n.L&&n.l.Ha}function qm(n,e,t){let i,r=!0;for(;!n.J&&n.C<t.length;){if(i=vI(n,t),i==Kh){4==e&&(n.o=4,zi(14),r=!1),Go(n.j,n.m,null,"[Incomplete Response]");break}if(i==Vv){n.o=4,zi(15),Go(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}Go(n.j,n.m,i,null),Zm(n,i)}jv(n)&&i!=Kh&&i!=Vv&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,zi(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ba&&(n.ba=!0,(e=n.l).g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),a_(e),e.M=!0,zi(11))):(Go(n.j,n.m,t,"[Invalid Chunked Response]"),Mc(n),rg(n))}function vI(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?Kh:(t=Number(e.substring(t,r)),isNaN(t)?Vv:(r+=1)+t>e.length?Kh:(e=e.slice(r,r+t),n.C=r+t,e))}function Zh(n){n.Y=Date.now()+n.P,Km(n,n.P)}function Km(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=qh($i(n.lb,n),e)}function ng(n){n.B&&(bt.clearTimeout(n.B),n.B=null)}function rg(n){0==n.l.H||n.J||e0(n.l,n)}function Mc(n){ng(n);var e=n.M;e&&"function"==typeof e.sa&&e.sa(),n.M=null,lo(n.V),ed(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function Zm(n,e){try{var t=n.l;if(0!=t.H&&(t.g==n||Wv(t.i,n)))if(!n.K&&Wv(t.i,n)&&3==t.H){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<n.G))break e;fg(t),dg(t)}o_(t),zi(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&0==t.A&&!t.v&&(t.v=qh($i(t.ib,t),6e3));if(1>=Gv(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else Oc(t,11)}else if((n.K||t.g==n)&&fg(t),!ms(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let v=i[e];if(t.V=v[0],v=v[1],2==t.H)if("c"==v[0]){t.K=v[1],t.pa=v[2];const T=v[3];null!=T&&(t.ra=T,t.l.info("VER="+t.ra));const S=v[4];null!=S&&(t.Ga=S,t.l.info("SVER="+t.Ga));const M=v[5];null!=M&&"number"==typeof M&&0<M&&(t.L=r=1.5*M,t.l.info("backChannelRequestTimeoutMs_="+r)),r=t;const $=n.g;if($){const Y=$.g?$.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Y){var a=r.i;a.g||-1==Y.indexOf("spdy")&&-1==Y.indexOf("quic")&&-1==Y.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(qv(a,a.h),a.h=null))}if(r.F){const fe=$.g?$.g.getResponseHeader("X-HTTP-Session-Id"):null;fe&&(r.Da=fe,zn(r.I,r.F,fe))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms"));var c=n;if((r=t).wa=OI(r,r.J?r.pa:null,r.Y),c.K){Kv(r.i,c);var h=c,g=r.L;g&&h.setTimeout(g),h.B&&(ng(h),Zh(h)),r.g=c}else Xv(r);0<t.j.length&&i_(t)}else"stop"!=v[0]&&"close"!=v[0]||Oc(t,7);else 3==t.H&&("stop"==v[0]||"close"==v[0]?"stop"==v[0]?Oc(t,7):r_(t):"noop"!=v[0]&&t.h&&t.h.Aa(v),t.A=0)}Wh()}catch{}}function EI(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(Um(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function Vb(n){if(n.ta&&"function"==typeof n.ta)return n.ta();if(!n.Z||"function"!=typeof n.Z){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(Um(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}(n),r=function wI(n){if(n.Z&&"function"==typeof n.Z)return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(Um(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length,a=0;a<i;a++)e.call(void 0,r[a],t&&t[a],n)}(rt=Nc.prototype).setTimeout=function(n){this.P=n},rt.nb=function(n){n=n.target;const e=this.M;e&&3==Fa(n)?e.l():this.Pa(n)},rt.Pa=function(n){try{if(n==this.g)e:{const T=Fa(this.g);var e=this.g.Ia();if(this.g.da(),!(3>T)&&(3!=T||Gp||this.g&&(this.h.h||this.g.ja()||t_(this.g)))){this.J||4!=T||7==e||Wh(),ng(this);var t=this.g.da();this.ca=t;t:if(jv(this)){var r=t_(this.g);n="";var i=r.length,a=4==Fa(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Mc(this),rg(this);var c="";break t}this.h.i=new bt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:a&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,c=this.h.g}else c=this.g.ja();if(this.i=200==t,function Hh(n,e,t,r,i,a,c){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+a+" "+c})}(this.j,this.u,this.A,this.m,this.W,T,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var h,g=this.g;if((h=g.g?g.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ms(h)){var v=h;break t}}v=null}if(!(t=v)){this.i=!1,this.o=3,zi(12),Mc(this),rg(this);break e}Go(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Zm(this,t)}this.S?(qm(this,T,c),Gp&&this.i&&3==T&&(zm(this.U,this.V,"tick",this.mb),this.V.start())):(Go(this.j,this.m,c,null),Zm(this,c)),4==T&&Mc(this),this.i&&!this.J&&(4==T?e0(this.l,this):(this.i=!1,Zh(this)))}else(function cg(n){const e={};n=(n.g&&2<=Fa(n)&&n.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<n.length;r++){if(ms(n[r]))continue;var t=nN(n[r]);const i=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const a=e[i]||[];e[i]=a,a.push(t)}!function kb(n,e){for(const t in n)e.call(void 0,n[t],t,n)}(e,function(r){return r.join(", ")})})(this.g),400==t&&0<c.indexOf("Unknown SID")?(this.o=3,zi(12)):(this.o=0,zi(13)),Mc(this),rg(this)}}}catch{}},rt.mb=function(){if(this.g){var n=Fa(this.g),e=this.g.ja();this.C<e.length&&(ng(this),qm(this,n,e),this.i&&4!=n&&Zh(this))}},rt.cancel=function(){this.J=!0,Mc(this)},rt.lb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(function zh(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.L&&(Wh(),zi(17)),Mc(this),this.o=2,rg(this)):Km(this,this.Y-n)};var II=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Mu(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Mu){this.h=n.h,ig(this,n.j),this.s=n.s,this.g=n.g,sg(this,n.m),this.l=n.l;var e=n.i,t=new qo;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),$v(this,t),this.o=n.o}else n&&(e=String(n).match(II))?(this.h=!1,ig(this,e[1]||"",!0),this.s=Yh(e[2]||""),this.g=Yh(e[3]||"",!0),sg(this,e[4]),this.l=Yh(e[5]||"",!0),$v(this,e[6]||"",!0),this.o=Yh(e[7]||"")):(this.h=!1,this.i=new qo(null,this.h))}function Wo(n){return new Mu(n)}function ig(n,e,t){n.j=t?Yh(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function sg(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function $v(n,e,t){e instanceof qo?(n.i=e,function zb(n,e){e&&!n.j&&(ka(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(TI(this,r),Hb(this,i,t))},n)),n.j=e}(n.i,n.h)):(t||(e=Qh(e,$b)),n.i=new qo(e,n.h))}function zn(n,e,t){n.i.set(e,t)}function og(n){return zn(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Yh(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function Qh(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,CI),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function CI(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Mu.prototype.toString=function(){var n=[],e=this.j;e&&n.push(Qh(e,ag,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(Qh(e,ag,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(Qh(t,"/"==t.charAt(0)?jb:kc,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",Qh(t,Hv)),n.join("")};var ag=/[#\/\?@]/g,kc=/[#\?:]/g,jb=/[#\?]/g,$b=/[#\?@]/g,Hv=/#/g;function qo(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function ka(n){n.g||(n.g=new Map,n.h=0,n.i&&function Bb(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var a=n[t].substring(0,r);i=n[t].substring(r+1)}else a=n[t];e(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function TI(n,e){ka(n),e=ug(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function Ym(n,e){return ka(n),e=ug(n,e),n.g.has(e)}function Hb(n,e,t){TI(n,e),0<t.length&&(n.i=null,n.g.set(ug(n,e),_v(t)),n.h+=t.length)}function ug(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function zv(n){this.l=n||Wb,n=bt.PerformanceNavigationTiming?0<(n=bt.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(bt.g&&bt.g.Ka&&bt.g.Ka()&&bt.g.Ka().ec),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(rt=qo.prototype).add=function(n,e){ka(this),this.i=null,n=ug(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},rt.forEach=function(n,e){ka(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)},rt.ta=function(){ka(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let a=0;a<i.length;a++)t.push(e[r])}return t},rt.Z=function(n){ka(this);let e=[];if("string"==typeof n)Ym(this,n)&&(e=e.concat(this.g.get(ug(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},rt.set=function(n,e){return ka(this),this.i=null,Ym(this,n=ug(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},rt.get=function(n,e){return n&&0<(n=this.Z(n)).length?String(n[0]):e},rt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const a=encodeURIComponent(String(r)),c=this.Z(r);for(r=0;r<c.length;r++){var i=a;""!==c[r]&&(i+="="+encodeURIComponent(String(c[r]))),n.push(i)}}return this.i=n.join("&")};var Wb=10;function Kr(n){return!!n.h||!!n.g&&n.g.size>=n.j}function Gv(n){return n.h?1:n.g?n.g.size:0}function Wv(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function qv(n,e){n.g?n.g.add(e):n.h=e}function Kv(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function DI(n){if(null!=n.h)return n.i.concat(n.h.F);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return _v(n.i)}zv.prototype.cancel=function(){if(this.i=DI(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}};var bI=class{stringify(n){return bt.JSON.stringify(n,void 0)}parse(n){return bt.JSON.parse(n,void 0)}};function SI(){this.g=new bI}function Xh(n,e,t){const r=t||"";try{EI(n,function(i,a){let c=i;$p(i)&&(c=Av(i)),e.push(r+a+"="+encodeURIComponent(c))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Qm(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Jh(n){this.l=n.fc||null,this.j=n.ob||!1}function Xm(n,e){yi.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=Jm,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}_i(Jh,Lv),Jh.prototype.g=function(){return new Xm(this.l,this.j)},Jh.prototype.i=function(n){return function(){return n}}({}),_i(Xm,yi);var Jm=0;function Kb(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}function ef(n){n.readyState=4,n.l=null,n.j=null,n.A=null,tf(n)}function tf(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(rt=Xm.prototype).open=function(n,e){if(this.readyState!=Jm)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,tf(this)},rt.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||bt).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},rt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,ef(this)),this.readyState=Jm},rt.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,tf(this)),this.g&&(this.readyState=3,tf(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof bt.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Kb(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))},rt.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?ef(this):tf(this),3==this.readyState&&Kb(this)}},rt.Za=function(n){this.g&&(this.response=this.responseText=n,ef(this))},rt.Ya=function(n){this.g&&(this.response=n,ef(this))},rt.ka=function(){this.g&&ef(this)},rt.setRequestHeader=function(n,e){this.v.append(n,e)},rt.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},rt.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(Xm.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var Oa=bt.JSON.parse;function Pr(n){yi.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=AI,this.L=this.M=!1}_i(Pr,yi);var AI="",La=/^https?$/i,Ko=["POST","PUT"];function Zv(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,Yv(n),e_(n)}function Yv(n){n.F||(n.F=!0,Ri(n,"complete"),Ri(n,"error"))}function RI(n){if(n.h&&typeof gv<"u"&&(!n.C[1]||4!=Fa(n)||2!=n.da()))if(n.v&&4==Fa(n))Xl(n.La,0,n);else if(Ri(n,"readystatechange"),4==Fa(n)){n.h=!1;try{const c=n.da();e:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===c){var i=String(n.I).match(II)[1]||null;!i&&bt.self&&bt.self.location&&(i=bt.self.location.protocol.slice(0,-1)),r=!La.test(i?i.toLowerCase():"")}t=r}if(t)Ri(n,"complete"),Ri(n,"success");else{n.m=6;try{var a=2<Fa(n)?n.g.statusText:""}catch{a=""}n.j=a+" ["+n.da()+"]",Yv(n)}}finally{e_(n)}}}function e_(n,e){if(n.g){xI(n);const t=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||Ri(n,"ready");try{t.onreadystatechange=r}catch{}}}function xI(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(bt.clearTimeout(n.A),n.A=null)}function Fa(n){return n.g?n.g.readyState:0}function t_(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case AI:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function PI(n){let e="";return Yl(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}function n_(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=PI(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):zn(n,e,t))}function lg(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function NI(n){this.Ga=0,this.j=[],this.l=new Nu,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=lg("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=lg("baseRetryDelayMs",5e3,n),this.hb=lg("retryDelaySeedMs",1e4,n),this.eb=lg("forwardChannelMaxRetries",2,n),this.xa=lg("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.dc||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new zv(n&&n.concurrentRequestLimit),this.Ja=new SI,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function r_(n){if(hg(n),3==n.H){var e=n.W++,t=Wo(n.I);if(zn(t,"SID",n.K),zn(t,"RID",e),zn(t,"TYPE","terminate"),nd(n,t),(e=new Nc(n,n.l,e)).L=2,e.v=og(Wo(t)),t=!1,bt.navigator&&bt.navigator.sendBeacon)try{t=bt.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&bt.Image&&((new Image).src=e.v,t=!0),t||(e.g=LI(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Zh(e)}kI(n)}function dg(n){n.g&&(a_(n),n.g.cancel(),n.g=null)}function hg(n){dg(n),n.u&&(bt.clearTimeout(n.u),n.u=null),fg(n),n.i.cancel(),n.m&&("number"==typeof n.m&&bt.clearTimeout(n.m),n.m=null)}function i_(n){if(!Kr(n.i)&&!n.m){n.m=!0;var e=n.Na;$m||_I(),xc||($m(),xc=!0),xv.add(e,n),n.C=0}}function Qv(n,e){var t;t=e?e.m:n.W++;const r=Wo(n.I);zn(r,"SID",n.K),zn(r,"RID",t),zn(r,"AID",n.V),nd(n,r),n.o&&n.s&&n_(r,n.o,n.s),t=new Nc(n,n.l,t,n.C+1),null===n.o&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=s_(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),qv(n.i,t),tg(t,r,e)}function nd(n,e){n.na&&Yl(n.na,function(t,r){zn(e,r,t)}),n.h&&EI({},function(t,r){zn(e,r,t)})}function s_(n,e,t){t=Math.min(n.j.length,t);var r=n.h?$i(n.h.Va,n.h,n):null;e:{var i=n.j;let a=-1;for(;;){const c=["count="+t];-1==a?0<t?(a=i[0].g,c.push("ofs="+a)):a=0:c.push("ofs="+a);let h=!0;for(let g=0;g<t;g++){let v=i[g].g;const T=i[g].map;if(v-=a,0>v)a=Math.max(0,i[g].g-100),h=!1;else try{Xh(T,c,"req"+v+"_")}catch{r&&r(T)}}if(h){r=c.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,r}function Xv(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;$m||_I(),xc||($m(),xc=!0),xv.add(e,n),n.A=0}}function o_(n){return!(n.g||n.u||3<=n.A||(n.ba++,n.u=qh($i(n.Ma,n),t0(n,n.A)),n.A++,0))}function a_(n){null!=n.B&&(bt.clearTimeout(n.B),n.B=null)}function Jv(n){n.g=new Nc(n,n.l,"rpc",n.ba),null===n.o&&(n.g.I=n.s),n.g.O=0;var e=Wo(n.wa);zn(e,"RID","rpc"),zn(e,"SID",n.K),zn(e,"AID",n.V),zn(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&zn(e,"TO",n.qa),zn(e,"TYPE","xmlhttp"),nd(n,e),n.o&&n.s&&n_(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.v=og(Wo(e)),t.s=null,t.S=!0,Bv(t,n)}function fg(n){null!=n.v&&(bt.clearTimeout(n.v),n.v=null)}function e0(n,e){var t=null;if(n.g==e){fg(n),a_(n),n.g=null;var r=2}else{if(!Wv(n.i,e))return;t=e.F,Kv(n.i,e),r=1}if(0!=n.H)if(e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.G;var i=n.C;Ri(r=Zp(),new kv(r,t)),i_(n)}else Xv(n);else if(3==(i=e.o)||0==i&&0<e.ca||!(1==r&&function MI(n,e){return!(Gv(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.j=e.F.concat(n.j),0):1==n.H||2==n.H||n.C>=(n.cb?0:n.eb)||(n.m=qh($i(n.Na,n,e),t0(n,n.C)),n.C++,0)))}(n,e)||2==r&&o_(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:Oc(n,5);break;case 4:Oc(n,10);break;case 3:Oc(n,6);break;default:Oc(n,2)}}function t0(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function Oc(n,e){if(n.l.info("Error code "+e),2==e){var t=null;n.h&&(t=null);var r=$i(n.pb,n);t||(t=new Mu("//www.google.com/images/cleardot.gif"),bt.location&&"http"==bt.location.protocol||ig(t,"https"),og(t)),function qb(n,e){const t=new Nu;if(bt.Image){const r=new Image;r.onload=zp(Qm,t,r,"TestLoadImage: loaded",!0,e),r.onerror=zp(Qm,t,r,"TestLoadImage: error",!1,e),r.onabort=zp(Qm,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=zp(Qm,t,r,"TestLoadImage: timeout",!1,e),bt.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else zi(2);n.H=0,n.h&&n.h.za(e),kI(n),hg(n)}function kI(n){if(n.H=0,n.ma=[],n.h){const e=DI(n.i);(0!=e.length||0!=n.j.length)&&(eI(n.ma,e),eI(n.ma,n.j),n.i.i.length=0,_v(n.j),n.j.length=0),n.h.ya()}}function OI(n,e,t){var r=t instanceof Mu?Wo(t):new Mu(t);if(""!=r.g)e&&(r.g=e+"."+r.g),sg(r,r.m);else{var i=bt.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var a=new Mu(null);r&&ig(a,r),e&&(a.g=e),i&&sg(a,i),t&&(a.l=t),r=a}return e=n.Da,(t=n.F)&&e&&zn(r,t,e),zn(r,"VER",n.ra),nd(n,r),r}function LI(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Pr(t&&n.Ha&&!n.va?new Jh({ob:!0}):n.va)).Oa(n.J),e}function FI(){}function u_(){if(Uh&&!(10<=Number(oI)))throw Error("Environmental error: no available transport.")}function Ns(n,e){yi.call(this),this.g=new NI(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!ms(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ms(e)&&(this.g.F=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new nf(this)}function UI(n){Gm.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function VI(){Xp.call(this),this.status=1}function nf(n){this.g=n}function Yo(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function n0(n,e,t){t||(t=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)r[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var a=n.g[3],c=(e=n.g[0])+(a^(t=n.g[1])&((i=n.g[2])^a))+r[0]+3614090360&4294967295;c=(t=(i=(a=(e=(t=(i=(a=(e=(t=(i=(a=(e=(t=(i=(a=(e=(t=(i=(a=(e=(t=(i=(a=(e=(t=(i=(a=(e=(t=(i=(a=(e=(t=(i=(a=(e=(t=(i=(a=(e=(t=(i=(a=(e=(t=(i=(a=(e=(t=(i=(a=(e=(t=(i=(a=(e=(t=(i=(a=(e=t+(c<<7&4294967295|c>>>25))+((c=a+(i^e&(t^i))+r[1]+3905402710&4294967295)<<12&4294967295|c>>>20))+((c=i+(t^a&(e^t))+r[2]+606105819&4294967295)<<17&4294967295|c>>>15))+((c=t+(e^i&(a^e))+r[3]+3250441966&4294967295)<<22&4294967295|c>>>10))+((c=e+(a^t&(i^a))+r[4]+4118548399&4294967295)<<7&4294967295|c>>>25))+((c=a+(i^e&(t^i))+r[5]+1200080426&4294967295)<<12&4294967295|c>>>20))+((c=i+(t^a&(e^t))+r[6]+2821735955&4294967295)<<17&4294967295|c>>>15))+((c=t+(e^i&(a^e))+r[7]+4249261313&4294967295)<<22&4294967295|c>>>10))+((c=e+(a^t&(i^a))+r[8]+1770035416&4294967295)<<7&4294967295|c>>>25))+((c=a+(i^e&(t^i))+r[9]+2336552879&4294967295)<<12&4294967295|c>>>20))+((c=i+(t^a&(e^t))+r[10]+4294925233&4294967295)<<17&4294967295|c>>>15))+((c=t+(e^i&(a^e))+r[11]+2304563134&4294967295)<<22&4294967295|c>>>10))+((c=e+(a^t&(i^a))+r[12]+1804603682&4294967295)<<7&4294967295|c>>>25))+((c=a+(i^e&(t^i))+r[13]+4254626195&4294967295)<<12&4294967295|c>>>20))+((c=i+(t^a&(e^t))+r[14]+2792965006&4294967295)<<17&4294967295|c>>>15))+((c=t+(e^i&(a^e))+r[15]+1236535329&4294967295)<<22&4294967295|c>>>10))+((c=e+(i^a&(t^i))+r[1]+4129170786&4294967295)<<5&4294967295|c>>>27))+((c=a+(t^i&(e^t))+r[6]+3225465664&4294967295)<<9&4294967295|c>>>23))+((c=i+(e^t&(a^e))+r[11]+643717713&4294967295)<<14&4294967295|c>>>18))+((c=t+(a^e&(i^a))+r[0]+3921069994&4294967295)<<20&4294967295|c>>>12))+((c=e+(i^a&(t^i))+r[5]+3593408605&4294967295)<<5&4294967295|c>>>27))+((c=a+(t^i&(e^t))+r[10]+38016083&4294967295)<<9&4294967295|c>>>23))+((c=i+(e^t&(a^e))+r[15]+3634488961&4294967295)<<14&4294967295|c>>>18))+((c=t+(a^e&(i^a))+r[4]+3889429448&4294967295)<<20&4294967295|c>>>12))+((c=e+(i^a&(t^i))+r[9]+568446438&4294967295)<<5&4294967295|c>>>27))+((c=a+(t^i&(e^t))+r[14]+3275163606&4294967295)<<9&4294967295|c>>>23))+((c=i+(e^t&(a^e))+r[3]+4107603335&4294967295)<<14&4294967295|c>>>18))+((c=t+(a^e&(i^a))+r[8]+1163531501&4294967295)<<20&4294967295|c>>>12))+((c=e+(i^a&(t^i))+r[13]+2850285829&4294967295)<<5&4294967295|c>>>27))+((c=a+(t^i&(e^t))+r[2]+4243563512&4294967295)<<9&4294967295|c>>>23))+((c=i+(e^t&(a^e))+r[7]+1735328473&4294967295)<<14&4294967295|c>>>18))+((c=t+(a^e&(i^a))+r[12]+2368359562&4294967295)<<20&4294967295|c>>>12))+((c=e+(t^i^a)+r[5]+4294588738&4294967295)<<4&4294967295|c>>>28))+((c=a+(e^t^i)+r[8]+2272392833&4294967295)<<11&4294967295|c>>>21))+((c=i+(a^e^t)+r[11]+1839030562&4294967295)<<16&4294967295|c>>>16))+((c=t+(i^a^e)+r[14]+4259657740&4294967295)<<23&4294967295|c>>>9))+((c=e+(t^i^a)+r[1]+2763975236&4294967295)<<4&4294967295|c>>>28))+((c=a+(e^t^i)+r[4]+1272893353&4294967295)<<11&4294967295|c>>>21))+((c=i+(a^e^t)+r[7]+4139469664&4294967295)<<16&4294967295|c>>>16))+((c=t+(i^a^e)+r[10]+3200236656&4294967295)<<23&4294967295|c>>>9))+((c=e+(t^i^a)+r[13]+681279174&4294967295)<<4&4294967295|c>>>28))+((c=a+(e^t^i)+r[0]+3936430074&4294967295)<<11&4294967295|c>>>21))+((c=i+(a^e^t)+r[3]+3572445317&4294967295)<<16&4294967295|c>>>16))+((c=t+(i^a^e)+r[6]+76029189&4294967295)<<23&4294967295|c>>>9))+((c=e+(t^i^a)+r[9]+3654602809&4294967295)<<4&4294967295|c>>>28))+((c=a+(e^t^i)+r[12]+3873151461&4294967295)<<11&4294967295|c>>>21))+((c=i+(a^e^t)+r[15]+530742520&4294967295)<<16&4294967295|c>>>16))+((c=t+(i^a^e)+r[2]+3299628645&4294967295)<<23&4294967295|c>>>9))+((c=e+(i^(t|~a))+r[0]+4096336452&4294967295)<<6&4294967295|c>>>26))+((c=a+(t^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|c>>>22))+((c=i+(e^(a|~t))+r[14]+2878612391&4294967295)<<15&4294967295|c>>>17))+((c=t+(a^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|c>>>11))+((c=e+(i^(t|~a))+r[12]+1700485571&4294967295)<<6&4294967295|c>>>26))+((c=a+(t^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|c>>>22))+((c=i+(e^(a|~t))+r[10]+4293915773&4294967295)<<15&4294967295|c>>>17))+((c=t+(a^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|c>>>11))+((c=e+(i^(t|~a))+r[8]+1873313359&4294967295)<<6&4294967295|c>>>26))+((c=a+(t^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|c>>>22))+((c=i+(e^(a|~t))+r[6]+2734768916&4294967295)<<15&4294967295|c>>>17))+((c=t+(a^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|c>>>11))+((a=(e=t+((c=e+(i^(t|~a))+r[4]+4149444226&4294967295)<<6&4294967295|c>>>26))+((c=a+(t^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|c>>>22))^((i=a+((c=i+(e^(a|~t))+r[2]+718787259&4294967295)<<15&4294967295|c>>>17))|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(i+(c<<21&4294967295|c>>>11))&4294967295,n.g[2]=n.g[2]+i&4294967295,n.g[3]=n.g[3]+a&4294967295}function An(n,e){this.h=e;for(var t=[],r=!0,i=n.length-1;0<=i;i--){var a=0|n[i];r&&a==e||(t[i]=a,r=!1)}this.g=t}(rt=Pr.prototype).Oa=function(n){this.M=n},rt.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Jp.g(),this.C=function yI(n){return n.h||(n.h=n.i())}(this.u?this.u:Jp),this.g.onreadystatechange=$i(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(a){return void Zv(this,a)}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const a of r.keys())t.set(a,r.get(a))}r=Array.from(t.keys()).find(a=>"content-type"==a.toLowerCase()),i=bt.FormData&&n instanceof bt.FormData,!(0<=JE(Ko,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,c]of t)this.g.setRequestHeader(a,c);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{xI(this),0<this.B&&((this.L=function Zo(n){return Uh&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=$i(this.ua,this)):this.A=Xl(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(a){Zv(this,a)}},rt.ua=function(){typeof gv<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ri(this,"timeout"),this.abort(8))},rt.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Ri(this,"complete"),Ri(this,"abort"),e_(this))},rt.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),e_(this,!0)),Pr.$.N.call(this)},rt.La=function(){this.s||(this.G||this.v||this.l?RI(this):this.kb())},rt.kb=function(){RI(this)},rt.isActive=function(){return!!this.g},rt.da=function(){try{return 2<Fa(this)?this.g.status:-1}catch{return-1}},rt.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},rt.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),Oa(e)}},rt.Ia=function(){return this.m},rt.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(rt=NI.prototype).ra=8,rt.H=1,rt.Na=function(n){if(this.m)if(this.m=null,1==this.H){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const i=new Nc(this,this.l,n);let a=this.s;if(this.U&&(a?(a=wv(a),uI(a,this.U)):a=this.U),null!==this.o||this.O||(i.I=a,a=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var r=this.j[t];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=s_(this,i,e),zn(t=Wo(this.I),"RID",n),zn(t,"CVER",22),this.F&&zn(t,"X-HTTP-Session-Id",this.F),nd(this,t),a&&(this.O?e="headers="+encodeURIComponent(String(PI(a)))+"&"+e:this.o&&n_(t,this.o,a)),qv(this.i,i),this.bb&&zn(t,"TYPE","init"),this.P?(zn(t,"$req",e),zn(t,"SID","null"),i.aa=!0,tg(i,t,null)):tg(i,t,e),this.H=2}}else 3==this.H&&(n?Qv(this,n):0==this.j.length||Kr(this.i)||Qv(this))},rt.Ma=function(){if(this.u=null,Jv(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=qh($i(this.jb,this),n)}},rt.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,zi(10),dg(this),Jv(this))},rt.ib=function(){null!=this.v&&(this.v=null,dg(this),o_(this),zi(19))},rt.pb=function(n){n?(this.l.info("Successfully pinged google.com"),zi(2)):(this.l.info("Failed to ping google.com"),zi(1))},rt.isActive=function(){return!!this.h&&this.h.isActive(this)},(rt=FI.prototype).Ba=function(){},rt.Aa=function(){},rt.za=function(){},rt.ya=function(){},rt.isActive=function(){return!0},rt.Va=function(){},u_.prototype.g=function(n,e){return new Ns(n,e)},_i(Ns,yi),Ns.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;zi(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=OI(n,null,n.Y),i_(n)},Ns.prototype.close=function(){r_(this.g)},Ns.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=Av(n),n=t);e.j.push(new class{constructor(n,e){this.g=n,this.map=e}}(e.fb++,n)),3==e.H&&i_(e)},Ns.prototype.N=function(){this.g.h=null,delete this.j,r_(this.g),delete this.g,Ns.$.N.call(this)},_i(UI,Gm),_i(VI,Xp),_i(nf,FI),nf.prototype.Ba=function(){Ri(this.g,"a")},nf.prototype.Aa=function(n){Ri(this.g,new UI(n))},nf.prototype.za=function(n){Ri(this.g,new VI)},nf.prototype.ya=function(){Ri(this.g,"b")},_i(Yo,function Zb(){this.blockSize=-1}),Yo.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Yo.prototype.j=function(n,e){void 0===e&&(e=n.length);for(var t=e-this.blockSize,r=this.m,i=this.h,a=0;a<e;){if(0==i)for(;a<=t;)n0(this,n,a),a+=this.blockSize;if("string"==typeof n){for(;a<e;)if(r[i++]=n.charCodeAt(a++),i==this.blockSize){n0(this,r),i=0;break}}else for(;a<e;)if(r[i++]=n[a++],i==this.blockSize){n0(this,r),i=0;break}}this.h=i,this.i+=e},Yo.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=255&t,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};var Yb={};function r0(n){return-128<=n&&128>n?function tI(n,e){var t=Yb;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}(n,function(e){return new An([0|e],0>e?-1:0)}):new An([0|n],0>n?-1:0)}function Ua(n){if(isNaN(n)||!isFinite(n))return rd;if(0>n)return vi(Ua(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=s0;return new An(e,0)}var s0=4294967296,rd=r0(0),c_=r0(1),o0=r0(16777216);function Va(n){if(0!=n.h)return!1;for(var e=0;e<n.g.length;e++)if(0!=n.g[e])return!1;return!0}function Ms(n){return-1==n.h}function vi(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new An(t,~n.h).add(c_)}function pg(n,e){return n.add(vi(e))}function gg(n,e){for(;(65535&n[e])!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function rf(n,e){this.g=n,this.h=e}function mg(n,e){if(Va(e))throw Error("division by zero");if(Va(n))return new rf(rd,rd);if(Ms(n))return e=mg(vi(n),e),new rf(vi(e.g),vi(e.h));if(Ms(e))return e=mg(n,vi(e)),new rf(vi(e.g),e.h);if(30<n.g.length){if(Ms(n)||Ms(e))throw Error("slowDivide_ only works with positive integers.");for(var t=c_,r=e;0>=r.X(n);)t=a0(t),r=a0(r);var i=fo(t,1),a=fo(r,1);for(r=fo(r,2),t=fo(t,2);!Va(r);){var c=a.add(r);0>=c.X(n)&&(i=i.add(t),a=c),r=fo(r,1),t=fo(t,1)}return e=pg(n,i.R(e)),new rf(i,e)}for(i=rd;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,r-48),c=(a=Ua(t)).R(e);Ms(c)||0<c.X(n);)c=(a=Ua(t-=r)).R(e);Va(a)&&(a=c_),i=i.add(a),n=pg(n,c)}return new rf(i,n)}function a0(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new An(t,n.h)}function fo(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,i=[],a=0;a<r;a++)i[a]=0<e?n.D(a+t)>>>e|n.D(a+t+1)<<32-e:n.D(a+t);return new An(i,n.h)}(rt=An.prototype).ea=function(){if(Ms(this))return-vi(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:s0+r)*e,e*=s0}return n},rt.toString=function(n){if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if(Va(this))return"0";if(Ms(this))return"-"+vi(this).toString(n);for(var e=Ua(Math.pow(n,6)),t=this,r="";;){var i=mg(t,e).g,a=((0<(t=pg(t,i.R(e))).g.length?t.g[0]:t.h)>>>0).toString(n);if(Va(t=i))return a+r;for(;6>a.length;)a="0"+a;r=a+r}},rt.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h},rt.X=function(n){return Ms(n=pg(this,n))?-1:Va(n)?0:1},rt.abs=function(){return Ms(this)?vi(this):this},rt.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,i=0;i<=e;i++){var a=r+(65535&this.D(i))+(65535&n.D(i)),c=(a>>>16)+(this.D(i)>>>16)+(n.D(i)>>>16);r=c>>>16,t[i]=(c&=65535)<<16|(a&=65535)}return new An(t,-2147483648&t[t.length-1]?-1:0)},rt.R=function(n){if(Va(this)||Va(n))return rd;if(Ms(this))return Ms(n)?vi(this).R(vi(n)):vi(vi(this).R(n));if(Ms(n))return vi(this.R(vi(n)));if(0>this.X(o0)&&0>n.X(o0))return Ua(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<n.g.length;i++){var a=this.D(r)>>>16,c=65535&this.D(r),h=n.D(i)>>>16,g=65535&n.D(i);t[2*r+2*i]+=c*g,gg(t,2*r+2*i),t[2*r+2*i+1]+=a*g,gg(t,2*r+2*i+1),t[2*r+2*i+1]+=c*h,gg(t,2*r+2*i+1),t[2*r+2*i+2]+=a*h,gg(t,2*r+2*i+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new An(t,0)},rt.gb=function(n){return mg(this,n).h},rt.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new An(t,this.h&n.h)},rt.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new An(t,this.h|n.h)},rt.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new An(t,this.h^n.h)},u_.prototype.createWebChannel=u_.prototype.g,Ns.prototype.send=Ns.prototype.u,Ns.prototype.open=Ns.prototype.m,Ns.prototype.close=Ns.prototype.close,Yp.NO_ERROR=0,Yp.TIMEOUT=8,Yp.HTTP_ERROR=6,Ov.COMPLETE="complete",Fv.EventType=Qp,Qp.OPEN="a",Qp.CLOSE="b",Qp.ERROR="c",Qp.MESSAGE="d",yi.prototype.listen=yi.prototype.O,Pr.prototype.listenOnce=Pr.prototype.P,Pr.prototype.getLastError=Pr.prototype.Sa,Pr.prototype.getLastErrorCode=Pr.prototype.Ia,Pr.prototype.getStatus=Pr.prototype.da,Pr.prototype.getResponseJson=Pr.prototype.Wa,Pr.prototype.getResponseText=Pr.prototype.ja,Pr.prototype.send=Pr.prototype.ha,Pr.prototype.setWithCredentials=Pr.prototype.Oa,Yo.prototype.digest=Yo.prototype.l,Yo.prototype.reset=Yo.prototype.reset,Yo.prototype.update=Yo.prototype.j,An.prototype.add=An.prototype.add,An.prototype.multiply=An.prototype.R,An.prototype.modulo=An.prototype.gb,An.prototype.compare=An.prototype.X,An.prototype.toNumber=An.prototype.ea,An.prototype.toString=An.prototype.toString,An.prototype.getBits=An.prototype.D,An.fromNumber=Ua,An.fromString=function BI(n,e){if(0==n.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==n.charAt(0))return vi(BI(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=Ua(Math.pow(e,8)),r=rd,i=0;i<n.length;i+=8){var a=Math.min(8,n.length-i),c=parseInt(n.substring(i,i+a),e);8>a?(a=Ua(Math.pow(e,a)),r=r.R(a).add(Ua(c))):r=(r=r.R(t)).add(Ua(c))}return r};var Qb=co.createWebChannelTransport=function(){return new u_},Xb=co.getStatEventTarget=function(){return Zp()},Lc=co.ErrorCode=Yp,rN=co.EventType=Ov,u0=co.Event=ho,Jb=co.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},jI=co.FetchXmlHttpFactory=Jh,_g=co.WebChannel=Fv,iN=co.XhrIo=Pr,Nt=co.Md5=Yo,sf=co.Integer=An;const $I="@firebase/firestore";class wi{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}wi.UNAUTHENTICATED=new wi(null),wi.GOOGLE_CREDENTIALS=new wi("google-credentials-uid"),wi.FIRST_PARTY=new wi("first-party-uid"),wi.MOCK_USER=new wi("mock-user");let Qo="9.23.0";const Fc=new gs.Yd("@firebase/firestore");function af(){return Fc.logLevel}function be(n,...e){if(Fc.logLevel<=gs.in.DEBUG){const t=e.map(d_);Fc.debug(`Firestore (${Qo}): ${n}`,...t)}}function Zr(n,...e){if(Fc.logLevel<=gs.in.ERROR){const t=e.map(d_);Fc.error(`Firestore (${Qo}): ${n}`,...t)}}function ks(n,...e){if(Fc.logLevel<=gs.in.WARN){const t=e.map(d_);Fc.warn(`Firestore (${Qo}): ${n}`,...t)}}function d_(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function lt(n="Unexpected state"){const e=`FIRESTORE (${Qo}) INTERNAL ASSERTION FAILED: `+n;throw Zr(e),new Error(e)}function It(n,e){n||lt()}function Xe(n,e){return n}const de={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ne extends U.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class oi{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class zI{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class yg{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(wi.UNAUTHENTICATED))}shutdown(){}}class eS{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class tS{constructor(e){this.t=e,this.currentUser=wi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const a=v=>this.i!==i?(i=this.i,t(v)):Promise.resolve();let c=new oi;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new oi,e.enqueueRetryable(()=>a(this.currentUser))};const h=()=>{const v=c;e.enqueueRetryable((0,Ee.Z)(function*(){yield v.promise,yield a(r.currentUser)}))},g=v=>{be("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=v,this.auth.addAuthTokenListener(this.o),h()};this.t.onInit(v=>g(v)),setTimeout(()=>{if(!this.auth){const v=this.t.getImmediate({optional:!0});v?g(v):(be("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new oi)}},0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(be("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(It("string"==typeof r.accessToken),new zI(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return It(null===e||"string"==typeof e),new wi(e)}}class nS{constructor(e,t,r){this.h=e,this.l=t,this.m=r,this.type="FirstParty",this.user=wi.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class h_{constructor(e,t,r){this.h=e,this.l=t,this.m=r}getToken(){return Promise.resolve(new nS(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(wi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class c0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class GI{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const r=a=>{null!=a.error&&be("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const c=a.token!==this.T;return this.T=a.token,be("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const i=a=>{be("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.appCheck.addTokenListener(this.o)};this.I.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.I.getImmediate({optional:!0});a?i(a):be("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(It("string"==typeof t.token),this.T=t.token,new c0(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function iS(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class uf{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=iS(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%e.length))}return r}}function Ut(n,e){return n<e?-1:n>e?1:0}function cf(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function WI(n){return n+"\0"}class or{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ne(de.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ne(de.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ne(de.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ne(de.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return or.fromMillis(Date.now())}static fromDate(e){return or.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new or(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ut(this.nanoseconds,e.nanoseconds):Ut(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ct{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ct(e)}static min(){return new Ct(new or(0,0))}static max(){return new Ct(new or(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class lf{constructor(e,t,r){void 0===t?t=0:t>e.length&&lt(),void 0===r?r=e.length-t:r>e.length-t&&lt(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===lf.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof lf?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=e.get(i),c=t.get(i);if(a<c)return-1;if(a>c)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class yn extends lf{construct(e,t,r){return new yn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ne(de.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new yn(t)}static emptyPath(){return new yn([])}}const sS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _r extends lf{construct(e,t,r){return new _r(e,t,r)}static isValidIdentifier(e){return sS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_r.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new _r(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(0===r.length)throw new Ne(de.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let c=!1;for(;i<e.length;){const h=e[i];if("\\"===h){if(i+1===e.length)throw new Ne(de.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[i+1];if("\\"!==g&&"."!==g&&"`"!==g)throw new Ne(de.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=g,i+=2}else"`"===h?(c=!c,i++):"."!==h||c?(r+=h,i++):(a(),i++)}if(a(),c)throw new Ne(de.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new _r(t)}static emptyPath(){return new _r([])}}class Ye{constructor(e){this.path=e}static fromPath(e){return new Ye(yn.fromString(e))}static fromName(e){return new Ye(yn.fromString(e).popFirst(5))}static empty(){return new Ye(yn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===yn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return yn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ye(new yn(e.slice()))}}class f_{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function qI(n){return n.fields.find(e=>2===e.kind)}function df(n){return n.fields.filter(e=>2!==e.kind)}f_.UNKNOWN_ID=-1;class l0{constructor(e,t){this.fieldPath=e,this.kind=t}}class Uc{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Uc(0,_s.min())}}function ZI(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Ct.fromTimestamp(1e9===r?new or(t+1,0):new or(t,r));return new _s(i,Ye.empty(),e)}function YI(n){return new _s(n.readTime,n.key,-1)}class _s{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new _s(Ct.min(),Ye.empty(),-1)}static max(){return new _s(Ct.max(),Ye.empty(),-1)}}function id(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=Ye.comparator(n.documentKey,e.documentKey),0!==t?t:Ut(n.largestBatchId,e.largestBatchId))}const QI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class XI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Vc(n){return d0.apply(this,arguments)}function d0(){return d0=(0,Ee.Z)(function*(n){if(n.code!==de.FAILED_PRECONDITION||n.message!==QI)throw n;be("LocalStore","Unexpectedly lost primary lease")}),d0.apply(this,arguments)}class oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&lt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new oe((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof oe?t:oe.resolve(t)}catch(t){return oe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):oe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):oe.reject(t)}static resolve(e){return new oe((t,r)=>{t(e)})}static reject(e){return new oe((t,r)=>{r(e)})}static waitFor(e){return new oe((t,r)=>{let i=0,a=0,c=!1;e.forEach(h=>{++i,h.next(()=>{++a,c&&a===i&&t()},g=>r(g))}),c=!0,a===i&&t()})}static or(e){let t=oe.resolve(!1);for(const r of e)t=t.next(i=>i?oe.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,a)=>{r.push(t.call(this,i,a))}),this.waitFor(r)}static mapArray(e,t){return new oe((r,i)=>{const a=e.length,c=new Array(a);let h=0;for(let g=0;g<a;g++){const v=g;t(e[v]).next(T=>{c[v]=T,++h,h===a&&r(c)},T=>i(T))}})}static doWhile(e,t){return new oe((r,i)=>{const a=()=>{!0===e()?t().next(()=>{a()},i):r()};a()})}}class p_{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.v=new oi,this.transaction.oncomplete=()=>{this.v.resolve()},this.transaction.onabort=()=>{t.error?this.v.reject(new vg(e,t.error)):this.v.resolve()},this.transaction.onerror=r=>{const i=g_(r.target.error);this.v.reject(new vg(e,i))}}static open(e,t,r,i){try{return new p_(t,e.transaction(i,r))}catch(a){throw new vg(t,a)}}get R(){return this.v.promise}abort(e){e&&this.v.reject(e),this.aborted||(be("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new aS(t)}}class po{constructor(e,t,r){this.name=e,this.version=t,this.V=r,12.2===po.S((0,U.z$)())&&Zr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return be("SimpleDb","Removing database:",e),Bc(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,U.hl)())return!1;if(po.C())return!0;const e=(0,U.z$)(),t=po.S(e),r=0<t&&t<10,i=po.N(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.k)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static N(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}$(e){var t=this;return(0,Ee.Z)(function*(){return t.db||(be("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const a=indexedDB.open(t.name,t.version);a.onsuccess=c=>{r(c.target.result)},a.onblocked=()=>{i(new vg(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=c=>{const h=c.target.error;i("VersionError"===h.name?new Ne(de.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===h.name?new Ne(de.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+h):new vg(e,h))},a.onupgradeneeded=c=>{be("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',c.oldVersion),t.V.O(c.target.result,a.transaction,c.oldVersion,t.version).next(()=>{be("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.F&&(t.db.onversionchange=r=>t.F(r)),t.db})()}B(e){this.F=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var a=this;return(0,Ee.Z)(function*(){const c="readonly"===t;let h=0;for(;;){++h;try{a.db=yield a.$(e);const g=p_.open(a.db,e,c?"readonly":"readwrite",r),v=i(g).next(T=>(g.P(),T)).catch(T=>(g.abort(T),oe.reject(T))).toPromise();return v.catch(()=>{}),yield g.R,v}catch(g){const v=g,T="FirebaseError"!==v.name&&h<3;if(be("SimpleDb","Transaction failed with error:",v.message,"Retrying:",T),a.close(),!T)return Promise.reject(v)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class oS{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return Bc(this.L.delete())}}class vg extends Ne{constructor(e,t){super(de.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function go(n){return"IndexedDbTransactionError"===n.name}class aS{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(be("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(be("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Bc(r)}add(e){return be("SimpleDb","ADD",this.store.name,e,e),Bc(this.store.add(e))}get(e){return Bc(this.store.get(e)).next(t=>(void 0===t&&(t=null),be("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return be("SimpleDb","DELETE",this.store.name,e),Bc(this.store.delete(e))}count(){return be("SimpleDb","COUNT",this.store.name),Bc(this.store.count())}j(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),a=[];return this.W(i,(c,h)=>{a.push(h)}).next(()=>a)}{const i=this.store.getAll(r.range);return new oe((a,c)=>{i.onerror=h=>{c(h.target.error)},i.onsuccess=h=>{a(h.target.result)}})}}H(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new oe((i,a)=>{r.onerror=c=>{a(c.target.error)},r.onsuccess=c=>{i(c.target.result)}})}J(e,t){be("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.Y=!1;const i=this.cursor(r);return this.W(i,(a,c,h)=>h.delete())}X(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.W(i,t)}Z(e){const t=this.cursor({});return new oe((r,i)=>{t.onerror=a=>{const c=g_(a.target.error);i(c)},t.onsuccess=a=>{const c=a.target.result;c?e(c.primaryKey,c.value).next(h=>{h?c.continue():r()}):r()}})}W(e,t){const r=[];return new oe((i,a)=>{e.onerror=c=>{a(c.target.error)},e.onsuccess=c=>{const h=c.target.result;if(!h)return void i();const g=new oS(h),v=t(h.primaryKey,h.value,g);if(v instanceof oe){const T=v.catch(S=>(g.done(),oe.reject(S)));r.push(T)}g.isDone?i():null===g.K?h.continue():h.continue(g.K)}}).next(()=>oe.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Bc(n){return new oe((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=g_(r.target.error);t(i)}})}let JI=!1;function g_(n){const e=po.S((0,U.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Ne("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return JI||(JI=!0,setTimeout(()=>{throw r},0)),r}}return n}class uS{constructor(e,t){this.asyncQueue=e,this.tt=t,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}et(e){var t=this;be("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,Ee.Z)(function*(){t.task=null;try{be("IndexBackiller",`Documents written: ${yield t.tt.nt()}`)}catch(r){go(r)?be("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield Vc(r)}yield t.et(6e4)}))}}class eC{constructor(e,t){this.localStore=e,this.persistence=t}nt(e=50){var t=this;return(0,Ee.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.st(r,e))})()}st(e,t){const r=new Set;let i=t,a=!0;return oe.doWhile(()=>!0===a&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(c=>{if(null!==c&&!r.has(c))return be("IndexBackiller",`Processing collection: ${c}`),this.it(e,c,i).next(h=>{i-=h,r.add(c)});a=!1})).next(()=>t-i)}it(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(a=>{const c=a.changes;return this.localStore.indexManager.updateIndexEntries(e,c).next(()=>this.rt(i,a)).next(h=>(be("IndexBackiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h))).next(()=>c.size)}))}rt(e,t){let r=e;return t.changes.forEach((i,a)=>{const c=YI(a);id(c,r)>0&&(r=c)}),new _s(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}let Os=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ot(i),this.ut=i=>r.writeSequenceNumber(i))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}return n.ct=-1,n})();function sd(n){return null==n}function wg(n){return 0===n&&1/n==-1/0}function h0(n){return"number"==typeof n&&Number.isInteger(n)&&!wg(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Pi(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=tC(e)),e=cS(n.get(t),e);return tC(e)}function cS(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=a}}return t}function tC(n){return n+"\x01\x01"}function Ba(n){const e=n.length;if(It(e>=2),2===e)return It("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),yn.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const c=n.indexOf("\x01",a);switch((c<0||c>t)&&lt(),n.charAt(c+1)){case"\x01":const h=n.substring(a,c);let g;0===i.length?g=h:(i+=h,g=i,i=""),r.push(g);break;case"\x10":i+=n.substring(a,c),i+="\0";break;case"\x11":i+=n.substring(a,c+1);break;default:lt()}a=c+2}return new yn(r)}const m_=["userId","batchId"];function __(n,e){return[n,Pi(e)]}function f0(n,e,t){return[n,Pi(e),t]}const lS={},dS=["prefixPath","collectionGroup","readTime","documentId"],hS=["prefixPath","collectionGroup","documentId"],fS=["collectionGroup","readTime","prefixPath","documentId"],pS=["canonicalId","targetId"],gS=["targetId","path"],mS=["path","targetId"],_S=["collectionId","parent"],nC=["indexId","uid"],rC=["uid","sequenceNumber"],yS=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],vS=["indexId","uid","orderedDocumentKey"],iC=["userId","collectionPath","documentId"],wS=["userId","collectionPath","largestBatchId"],ES=["userId","collectionGroup","largestBatchId"],sC=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],p0=[...sC,"documentOverlays"],y_=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],g0=y_,m0=[...g0,"indexConfiguration","indexState","indexEntries"];class _0 extends XI{constructor(e,t){super(),this.ht=e,this.currentSequenceNumber=t}}function Ei(n,e){const t=Xe(n);return po.M(t.ht,e)}function v_(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function jc(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function oC(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Dn{constructor(e,t){this.comparator=e,this.root=t||Ni.EMPTY}insert(e,t){return new Dn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ni.BLACK,null,null))}remove(e){return new Dn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ni.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Eg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Eg(this.root,e,this.comparator,!1)}getReverseIterator(){return new Eg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Eg(this.root,e,this.comparator,!0)}}class Eg{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ni{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??Ni.RED,this.left=i??Ni.EMPTY,this.right=a??Ni.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new Ni(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===a?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ni.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return Ni.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ni.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ni.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw lt();const e=this.left.check();if(e!==this.right.check())throw lt();return e+(this.isRed()?0:1)}}Ni.EMPTY=null,Ni.RED=!0,Ni.BLACK=!1,Ni.EMPTY=new class{constructor(){this.size=0}get key(){throw lt()}get value(){throw lt()}get color(){throw lt()}get left(){throw lt()}get right(){throw lt()}copy(n,e,t,r,i){return this}insert(n,e,t){return new Ni(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ar{constructor(e){this.comparator=e,this.data=new Dn(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new y0(this.data.getIterator())}getIteratorFrom(e){return new y0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof ar)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new ar(this.comparator);return t.data=e,t}}class y0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function $c(n){return n.hasNext()?n.getNext():void 0}class ys{constructor(e){this.fields=e,e.sort(_r.comparator)}static empty(){return new ys([])}unionWith(e){let t=new ar(_r.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new ys(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return cf(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class w_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Yr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new w_("Invalid base64 string: "+i):i}}(e);return new Yr(t)}static fromUint8Array(e){const t=function(r){let i="";for(let a=0;a<r.length;++a)i+=String.fromCharCode(r[a]);return i}(e);return new Yr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ut(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Yr.EMPTY_BYTE_STRING=new Yr("");const v0=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ku(n){if(It(!!n),"string"==typeof n){let e=0;const t=v0.exec(n);if(It(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:yr(n.seconds),nanos:yr(n.nanos)}}function yr(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function ja(n){return"string"==typeof n?Yr.fromBase64String(n):Yr.fromUint8Array(n)}function Ig(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function E_(n){const e=n.mapValue.fields.__previous_value__;return Ig(e)?E_(e):e}function Cg(n){const e=ku(n.mapValue.fields.__local_write_time__.timestampValue);return new or(e.seconds,e.nanos)}class CS{constructor(e,t,r,i,a,c,h,g,v){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=c,this.autoDetectLongPolling=h,this.longPollingOptions=g,this.useFetchStreams=v}}class Hc{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Hc("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Hc&&e.projectId===this.projectId&&e.database===this.database}}const Ou={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},w0={nullValue:"NULL_VALUE"};function Lu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ig(n)?4:lC(n)?9007199254740991:10:lt()}function $a(n,e){if(n===e)return!0;const t=Lu(n);if(t!==Lu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Cg(n).isEqual(Cg(e));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const a=ku(r.timestampValue),c=ku(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return i=e,ja(n.bytesValue).isEqual(ja(i.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return yr(r.geoPointValue.latitude)===yr(i.geoPointValue.latitude)&&yr(r.geoPointValue.longitude)===yr(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return yr(r.integerValue)===yr(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const a=yr(r.doubleValue),c=yr(i.doubleValue);return a===c?wg(a)===wg(c):isNaN(a)&&isNaN(c)}return!1}(n,e);case 9:return cf(n.arrayValue.values||[],e.arrayValue.values||[],$a);case 10:return function(r,i){const a=r.mapValue.fields||{},c=i.mapValue.fields||{};if(v_(a)!==v_(c))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(void 0===c[h]||!$a(a[h],c[h])))return!1;return!0}(n,e);default:return lt()}var i}function Tg(n,e){return void 0!==(n.values||[]).find(t=>$a(t,e))}function od(n,e){if(n===e)return 0;const t=Lu(n),r=Lu(e);if(t!==r)return Ut(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ut(n.booleanValue,e.booleanValue);case 2:return function(i,a){const c=yr(i.integerValue||i.doubleValue),h=yr(a.integerValue||a.doubleValue);return c<h?-1:c>h?1:c===h?0:isNaN(c)?isNaN(h)?0:-1:1}(n,e);case 3:return aC(n.timestampValue,e.timestampValue);case 4:return aC(Cg(n),Cg(e));case 5:return Ut(n.stringValue,e.stringValue);case 6:return function(i,a){const c=ja(i),h=ja(a);return c.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(i,a){const c=i.split("/"),h=a.split("/");for(let g=0;g<c.length&&g<h.length;g++){const v=Ut(c[g],h[g]);if(0!==v)return v}return Ut(c.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,a){const c=Ut(yr(i.latitude),yr(a.latitude));return 0!==c?c:Ut(yr(i.longitude),yr(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,a){const c=i.values||[],h=a.values||[];for(let g=0;g<c.length&&g<h.length;++g){const v=od(c[g],h[g]);if(v)return v}return Ut(c.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,a){if(i===Ou.mapValue&&a===Ou.mapValue)return 0;if(i===Ou.mapValue)return 1;if(a===Ou.mapValue)return-1;const c=i.fields||{},h=Object.keys(c),g=a.fields||{},v=Object.keys(g);h.sort(),v.sort();for(let T=0;T<h.length&&T<v.length;++T){const S=Ut(h[T],v[T]);if(0!==S)return S;const M=od(c[h[T]],g[v[T]]);if(0!==M)return M}return Ut(h.length,v.length)}(n.mapValue,e.mapValue);default:throw lt()}}function aC(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return Ut(n,e);const t=ku(n),r=ku(e),i=Ut(t.seconds,r.seconds);return 0!==i?i:Ut(t.nanos,r.nanos)}function hf(n){return E0(n)}function E0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=ku(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?ja(n.bytesValue).toBase64():"referenceValue"in n?Ye.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",a=!0;for(const c of r.values||[])a?a=!1:i+=",",i+=E0(c);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let a="{",c=!0;for(const h of i)c?c=!1:a+=",",a+=`${h}:${E0(r.fields[h])}`;return a+"}"}(n.mapValue):lt();var e}function ad(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function I0(n){return!!n&&"integerValue"in n}function Dg(n){return!!n&&"arrayValue"in n}function uC(n){return!!n&&"nullValue"in n}function cC(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function C_(n){return!!n&&"mapValue"in n}function bg(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return jc(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=bg(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=bg(n.arrayValue.values[t]);return e}return Object.assign({},n)}function lC(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function Sg(n){return"nullValue"in n?w0:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ad(Hc.empty(),Ye.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:lt()}function dC(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ad(Hc.empty(),Ye.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Ou:lt()}function C0(n,e){const t=od(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function T0(n,e){const t=od(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Ii{constructor(e){this.value=e}static empty(){return new Ii({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!C_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=bg(t)}setAll(e){let t=_r.emptyPath(),r={},i=[];e.forEach((c,h)=>{if(!t.isImmediateParentOf(h)){const g=this.getFieldsMap(t);this.applyChanges(g,r,i),r={},i=[],t=h.popLast()}c?r[h.lastSegment()]=bg(c):i.push(h.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());C_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return $a(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];C_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){jc(t,(i,a)=>e[i]=a);for(const i of r)delete e[i]}clone(){return new Ii(bg(this.value))}}function D0(n){const e=[];return jc(n.fields,(t,r)=>{const i=new _r([t]);if(C_(r)){const a=D0(r.mapValue).fields;if(0===a.length)e.push(i);else for(const c of a)e.push(i.child(c))}else e.push(i)}),new ys(e)}class er{constructor(e,t,r,i,a,c,h){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=a,this.data=c,this.documentState=h}static newInvalidDocument(e){return new er(e,0,Ct.min(),Ct.min(),Ct.min(),Ii.empty(),0)}static newFoundDocument(e,t,r,i){return new er(e,1,t,Ct.min(),r,i,0)}static newNoDocument(e,t){return new er(e,2,t,Ct.min(),Ct.min(),Ii.empty(),0)}static newUnknownDocument(e,t){return new er(e,3,t,Ct.min(),Ct.min(),Ii.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ct.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ii.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ii.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ct.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof er&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new er(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class zc{constructor(e,t){this.position=e,this.inclusive=t}}function TS(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],c=n.position[i];if(r=a.field.isKeyField()?Ye.comparator(Ye.fromName(c.referenceValue),t.key):od(c,t.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function hC(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!$a(n.position[t],e.position[t]))return!1;return!0}class ff{constructor(e,t="asc"){this.field=e,this.dir=t}}function DS(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class fC{}class pn extends fC{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new bS(e,t,r):"array-contains"===t?new SS(e,r):"in"===t?new b0(e,r):"not-in"===t?new yC(e,r):"array-contains-any"===t?new S0(e,r):new pn(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new T_(e,r):new D_(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(od(t,this.value)):null!==t&&Lu(this.value)===Lu(t)&&this.matchesComparison(od(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return lt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class En extends fC{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new En(e,t)}matches(e){return pf(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(t=>t.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function pf(n){return"and"===n.op}function Ag(n){return"or"===n.op}function mo(n){return pC(n)&&pf(n)}function pC(n){for(const e of n.filters)if(e instanceof En)return!1;return!0}function Rg(n){if(n instanceof pn)return n.field.canonicalString()+n.op.toString()+hf(n.value);if(mo(n))return n.filters.map(e=>Rg(e)).join(",");{const e=n.filters.map(t=>Rg(t)).join(",");return`${n.op}(${e})`}}function gf(n,e){return n instanceof pn?(t=n,(r=e)instanceof pn&&t.op===r.op&&t.field.isEqual(r.field)&&$a(t.value,r.value)):n instanceof En?function(t,r){return r instanceof En&&t.op===r.op&&t.filters.length===r.filters.length&&t.filters.reduce((i,a,c)=>i&&gf(a,r.filters[c]),!0)}(n,e):void lt();var t,r}function gC(n,e){const t=n.filters.concat(e);return En.create(t,n.op)}function mC(n){return n instanceof pn?`${(e=n).field.canonicalString()} ${e.op} ${hf(e.value)}`:n instanceof En?function(e){return e.op.toString()+" {"+e.getFilters().map(mC).join(" ,")+"}"}(n):"Filter";var e}class bS extends pn{constructor(e,t,r){super(e,t,r),this.key=Ye.fromName(r.referenceValue)}matches(e){const t=Ye.comparator(e.key,this.key);return this.matchesComparison(t)}}class T_ extends pn{constructor(e,t){super(e,"in",t),this.keys=_C(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class D_ extends pn{constructor(e,t){super(e,"not-in",t),this.keys=_C(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function _C(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>Ye.fromName(r.referenceValue))}class SS extends pn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Dg(t)&&Tg(t.arrayValue,this.value)}}class b0 extends pn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Tg(this.value.arrayValue,t)}}class yC extends pn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Tg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Tg(this.value.arrayValue,t)}}class S0 extends pn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Dg(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Tg(this.value.arrayValue,r))}}class vC{constructor(e,t=null,r=[],i=[],a=null,c=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=c,this.endAt=h,this.dt=null}}function xg(n,e=null,t=[],r=[],i=null,a=null,c=null){return new vC(n,e,t,r,i,a,c)}function Fu(n){const e=Xe(n);if(null===e.dt){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Rg(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),sd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>hf(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>hf(r)).join(",")),e.dt=t}return e.dt}function mf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!DS(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!gf(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!hC(n.startAt,e.startAt)&&hC(n.endAt,e.endAt)}function _f(n){return Ye.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function yf(n,e){return n.filters.filter(t=>t instanceof pn&&t.field.isEqual(e))}function wC(n,e,t){let r=w0,i=!0;for(const a of yf(n,e)){let c=w0,h=!0;switch(a.op){case"<":case"<=":c=Sg(a.value);break;case"==":case"in":case">=":c=a.value;break;case">":c=a.value,h=!1;break;case"!=":case"not-in":c=w0}C0({value:r,inclusive:i},{value:c,inclusive:h})<0&&(r=c,i=h)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const c=t.position[a];C0({value:r,inclusive:i},{value:c,inclusive:t.inclusive})<0&&(r=c,i=t.inclusive);break}return{value:r,inclusive:i}}function EC(n,e,t){let r=Ou,i=!0;for(const a of yf(n,e)){let c=Ou,h=!0;switch(a.op){case">=":case">":c=dC(a.value),h=!1;break;case"==":case"in":case"<=":c=a.value;break;case"<":c=a.value,h=!1;break;case"!=":case"not-in":c=Ou}T0({value:r,inclusive:i},{value:c,inclusive:h})>0&&(r=c,i=h)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const c=t.position[a];T0({value:r,inclusive:i},{value:c,inclusive:t.inclusive})>0&&(r=c,i=t.inclusive);break}return{value:r,inclusive:i}}class Uu{constructor(e,t=null,r=[],i=[],a=null,c="F",h=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=c,this.startAt=h,this.endAt=g,this.wt=null,this._t=null}}function IC(n,e,t,r,i,a,c,h){return new Uu(n,e,t,r,i,a,c,h)}function ud(n){return new Uu(n)}function b_(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function S_(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function A_(n){for(const e of n.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function R_(n){return null!==n.collectionGroup}function Gc(n){const e=Xe(n);if(null===e.wt){e.wt=[];const t=A_(e),r=S_(e);if(null!==t&&null===r)t.isKeyField()||e.wt.push(new ff(t)),e.wt.push(new ff(_r.keyField(),"asc"));else{let i=!1;for(const a of e.explicitOrderBy)e.wt.push(a),a.field.isKeyField()&&(i=!0);if(!i){const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new ff(_r.keyField(),a))}}}return e.wt}function es(n){const e=Xe(n);if(!e._t)if("F"===e.limitType)e._t=xg(e.path,e.collectionGroup,Gc(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const a of Gc(e))t.push(new ff(a.field,"desc"===a.dir?"asc":"desc"));const r=e.endAt?new zc(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new zc(e.startAt.position,e.startAt.inclusive):null;e._t=xg(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e._t}function x_(n,e){e.getFirstInequalityField(),A_(n);const t=n.filters.concat([e]);return new Uu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Pg(n,e,t){return new Uu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ng(n,e){return mf(es(n),es(e))&&n.limitType===e.limitType}function A0(n){return`${Fu(es(n))}|lt:${n.limitType}`}function R0(n){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(r=>mC(r)).join(", ")}]`),sd(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(r=>{return`${(i=r).field.canonicalString()} (${i.dir})`;var i}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>hf(r)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>hf(r)).join(",")),`Target(${t})`}(es(n))}; limitType=${n.limitType})`}function ai(n,e){return e.isFoundDocument()&&function(t,r){const i=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):Ye.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(const i of Gc(t))if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(n,e)&&function(t,r){for(const i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(i,a,c){const h=TS(i,a,c);return i.inclusive?h<=0:h<0}(t.startAt,Gc(t),r)||t.endAt&&!function(i,a,c){const h=TS(i,a,c);return i.inclusive?h>=0:h>0}(t.endAt,Gc(t),r)));var t,r}function cd(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function CC(n){return(e,t)=>{let r=!1;for(const i of Gc(n)){const a=AS(i,e,t);if(0!==a)return a;r=r||i.field.isKeyField()}return 0}}function AS(n,e,t){const r=n.field.isKeyField()?Ye.comparator(e.key,t.key):function(i,a,c){const h=a.data.field(i),g=c.data.field(i);return null!==h&&null!==g?od(h,g):lt()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return lt()}}class Wc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,a]of r)if(this.equalsFn(i,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){jc(this.inner,(t,r)=>{for(const[i,a]of r)e(i,a)})}isEmpty(){return oC(this.inner)}size(){return this.innerSize}}const oN=new Dn(Ye.comparator);function ts(){return oN}const P_=new Dn(Ye.comparator);function Vu(...n){let e=P_;for(const t of n)e=e.insert(t.key,t);return e}function TC(n){let e=P_;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function _o(){return vf()}function DC(){return vf()}function vf(){return new Wc(n=>n.toString(),(n,e)=>n.isEqual(e))}const RS=new Dn(Ye.comparator),xS=new ar(Ye.comparator);function tn(...n){let e=xS;for(const t of n)e=e.add(t);return e}const x0=new ar(Ut);function N_(){return x0}function P0(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:wg(e)?"-0":e}}function Mg(n){return{integerValue:""+n}}function M_(n,e){return h0(e)?Mg(e):P0(n,e)}class N0{constructor(){this._=void 0}}function bC(n,e,t){return n instanceof Xo?function(r,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&Ig(i)&&(i=E_(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(t,e):n instanceof ld?k0(n,e):n instanceof Bu?NS(n,e):function(r,i){const a=M0(r,i),c=MS(a)+MS(r.gt);return I0(a)&&I0(r.gt)?Mg(c):P0(r.serializer,c)}(n,e)}function PS(n,e,t){return n instanceof ld?k0(n,e):n instanceof Bu?NS(n,e):t}function M0(n,e){return n instanceof wf?I0(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class Xo extends N0{}class ld extends N0{constructor(e){super(),this.elements=e}}function k0(n,e){const t=SC(e);for(const r of n.elements)t.some(i=>$a(i,r))||t.push(r);return{arrayValue:{values:t}}}class Bu extends N0{constructor(e){super(),this.elements=e}}function NS(n,e){let t=SC(e);for(const r of n.elements)t=t.filter(i=>!$a(i,r));return{arrayValue:{values:t}}}class wf extends N0{constructor(e,t){super(),this.serializer=e,this.gt=t}}function MS(n){return yr(n.integerValue||n.doubleValue)}function SC(n){return Dg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class kg{constructor(e,t){this.field=e,this.transform=t}}class AC{constructor(e,t){this.version=e,this.transformResults=t}}class tr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new tr}static exists(e){return new tr(void 0,e)}static updateTime(e){return new tr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function k_(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class Og{}function O0(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new Ef(n.key,tr.none()):new dd(n.key,n.data,tr.none());{const t=n.data,r=Ii.empty();let i=new ar(_r.comparator);for(let a of e.fields)if(!i.has(a)){let c=t.field(a);null===c&&a.length>1&&(a=a.popLast(),c=t.field(a)),null===c?r.delete(a):r.set(a,c),i=i.add(a)}return new Ha(n.key,r,new ys(i.toArray()),tr.none())}}function OS(n,e,t){n instanceof dd?function(r,i,a){const c=r.value.clone(),h=F0(r.fieldTransforms,i,a.transformResults);c.setAll(h),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(n,e,t):n instanceof Ha?function(r,i,a){if(!k_(r.precondition,i))return void i.convertToUnknownDocument(a.version);const c=F0(r.fieldTransforms,i,a.transformResults),h=i.data;h.setAll(L0(r)),h.setAll(c),i.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function Lg(n,e,t,r){return n instanceof dd?function(i,a,c,h){if(!k_(i.precondition,a))return c;const g=i.value.clone(),v=PC(i.fieldTransforms,h,a);return g.setAll(v),a.convertToFoundDocument(a.version,g).setHasLocalMutations(),null}(n,e,t,r):n instanceof Ha?function(i,a,c,h){if(!k_(i.precondition,a))return c;const g=PC(i.fieldTransforms,h,a),v=a.data;return v.setAll(L0(i)),v.setAll(g),a.convertToFoundDocument(a.version,v).setHasLocalMutations(),null===c?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(T=>T.field))}(n,e,t,r):(c=t,k_(n.precondition,a=e)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c);var a,c}function RC(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=M0(r.transform,i||null);null!=a&&(null===t&&(t=Ii.empty()),t.set(r.field,a))}return t||null}function xC(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&cf(t,r,(i,a)=>function kS(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof ld&&r instanceof ld||t instanceof Bu&&r instanceof Bu?cf(t.elements,r.elements,$a):t instanceof wf&&r instanceof wf?$a(t.gt,r.gt):t instanceof Xo&&r instanceof Xo);var t,r}(i,a))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}class dd extends Og{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ha extends Og{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function L0(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function F0(n,e,t){const r=new Map;It(n.length===t.length);for(let i=0;i<t.length;i++){const a=n[i],c=a.transform,h=e.data.field(a.field);r.set(a.field,PS(c,h,t[i]))}return r}function PC(n,e,t){const r=new Map;for(const i of n){const a=i.transform,c=t.data.field(i.field);r.set(i.field,bC(a,c,e))}return r}class Ef extends Og{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class NC extends Og{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class O_{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&OS(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Lg(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Lg(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=DC();return this.mutations.forEach(i=>{const a=e.get(i.key),c=a.overlayedDocument;let h=this.applyToLocalView(c,a.mutatedFields);h=t.has(i.key)?null:h;const g=O0(c,h);null!==g&&r.set(i.key,g),c.isValidDocument()||c.convertToNoDocument(Ct.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),tn())}isEqual(e){return this.batchId===e.batchId&&cf(this.mutations,e.mutations,(t,r)=>xC(t,r))&&cf(this.baseMutations,e.baseMutations,(t,r)=>xC(t,r))}}class MC{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){It(e.mutations.length===r.length);let i=RS;const a=e.mutations;for(let c=0;c<a.length;c++)i=i.insert(a[c].key,r[c].version);return new MC(e,t,r,i)}}class kC{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class uN{constructor(e,t){this.count=e,this.unchangedNames=t}}var ui,In;function LS(n){switch(n){default:return lt();case de.CANCELLED:case de.UNKNOWN:case de.DEADLINE_EXCEEDED:case de.RESOURCE_EXHAUSTED:case de.INTERNAL:case de.UNAVAILABLE:case de.UNAUTHENTICATED:return!1;case de.INVALID_ARGUMENT:case de.NOT_FOUND:case de.ALREADY_EXISTS:case de.PERMISSION_DENIED:case de.FAILED_PRECONDITION:case de.ABORTED:case de.OUT_OF_RANGE:case de.UNIMPLEMENTED:case de.DATA_LOSS:return!0}}function FS(n){if(void 0===n)return Zr("GRPC error has no .code"),de.UNKNOWN;switch(n){case ui.OK:return de.OK;case ui.CANCELLED:return de.CANCELLED;case ui.UNKNOWN:return de.UNKNOWN;case ui.DEADLINE_EXCEEDED:return de.DEADLINE_EXCEEDED;case ui.RESOURCE_EXHAUSTED:return de.RESOURCE_EXHAUSTED;case ui.INTERNAL:return de.INTERNAL;case ui.UNAVAILABLE:return de.UNAVAILABLE;case ui.UNAUTHENTICATED:return de.UNAUTHENTICATED;case ui.INVALID_ARGUMENT:return de.INVALID_ARGUMENT;case ui.NOT_FOUND:return de.NOT_FOUND;case ui.ALREADY_EXISTS:return de.ALREADY_EXISTS;case ui.PERMISSION_DENIED:return de.PERMISSION_DENIED;case ui.FAILED_PRECONDITION:return de.FAILED_PRECONDITION;case ui.ABORTED:return de.ABORTED;case ui.OUT_OF_RANGE:return de.OUT_OF_RANGE;case ui.UNIMPLEMENTED:return de.UNIMPLEMENTED;case ui.DATA_LOSS:return de.DATA_LOSS;default:return lt()}}(In=ui||(ui={}))[In.OK=0]="OK",In[In.CANCELLED=1]="CANCELLED",In[In.UNKNOWN=2]="UNKNOWN",In[In.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",In[In.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",In[In.NOT_FOUND=5]="NOT_FOUND",In[In.ALREADY_EXISTS=6]="ALREADY_EXISTS",In[In.PERMISSION_DENIED=7]="PERMISSION_DENIED",In[In.UNAUTHENTICATED=16]="UNAUTHENTICATED",In[In.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",In[In.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",In[In.ABORTED=10]="ABORTED",In[In.OUT_OF_RANGE=11]="OUT_OF_RANGE",In[In.UNIMPLEMENTED=12]="UNIMPLEMENTED",In[In.INTERNAL=13]="INTERNAL",In[In.UNAVAILABLE=14]="UNAVAILABLE",In[In.DATA_LOSS=15]="DATA_LOSS";class If{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return U0}static getOrCreateInstance(){return null===U0&&(U0=new If),U0}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let U0=null;function V0(){return new TextEncoder}const L_=new sf([4294967295,4294967295],0);function B0(n){const e=V0().encode(n),t=new Nt;return t.update(e),new Uint8Array(t.digest())}function j0(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new sf([t,r],0),new sf([i,a],0)]}class OC{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new hd(`Invalid padding: ${t}`);if(r<0)throw new hd(`Invalid hash count: ${r}`);if(e.length>0&&0===this.hashCount)throw new hd(`Invalid hash count: ${r}`);if(0===e.length&&0!==t)throw new hd(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=sf.fromNumber(this.It)}Et(e,t,r){let i=e.add(t.multiply(sf.fromNumber(r)));return 1===i.compare(L_)&&(i=new sf([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=B0(e),[r,i]=j0(t);for(let a=0;a<this.hashCount;a++){const c=this.Et(r,i,a);if(!this.At(c))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),c=new OC(a,i,t);return r.forEach(h=>c.insert(h)),c}insert(e){if(0===this.It)return;const t=B0(e),[r,i]=j0(t);for(let a=0;a<this.hashCount;a++){const c=this.Et(r,i,a);this.Rt(c)}}Rt(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class hd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Cf{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Fg.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Cf(Ct.min(),i,new Dn(Ut),ts(),tn())}}class Fg{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Fg(r,t,tn(),tn(),tn())}}class $0{constructor(e,t,r,i){this.Pt=e,this.removedTargetIds=t,this.key=r,this.bt=i}}class US{constructor(e,t){this.targetId=e,this.Vt=t}}class LC{constructor(e,t,r=Yr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class FC{constructor(){this.St=0,this.Dt=VS(),this.Ct=Yr.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=tn(),t=tn(),r=tn();return this.Dt.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:lt()}}),new Fg(this.Ct,this.xt,e,t,r)}Ft(){this.Nt=!1,this.Dt=VS()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class F_{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=ts(),this.zt=UC(),this.Wt=new Dn(Ut)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const r=this.Zt(t);switch(e.state){case 0:this.te(t)&&r.$t(e.resumeToken);break;case 1:r.Ut(),r.kt||r.Ft(),r.$t(e.resumeToken);break;case 2:r.Ut(),r.kt||this.removeTarget(t);break;case 3:this.te(t)&&(r.Kt(),r.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),r.$t(e.resumeToken));break;default:lt()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((r,i)=>{this.te(i)&&t(i)})}ne(e){var t;const r=e.targetId,i=e.Vt.count,a=this.se(r);if(a){const c=a.target;if(_f(c))if(0===i){const h=new Ye(c.path);this.Yt(r,h,er.newNoDocument(h,Ct.min()))}else It(1===i);else{const h=this.ie(r);if(h!==i){const g=this.re(e,h);0!==g&&(this.ee(r),this.Wt=this.Wt.insert(r,2===g?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(t=If.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(v,T,S){var M,$,Y,fe,ge,et;const it={localCacheCount:T,existenceFilterCount:S.count},Ze=S.unchangedNames;return Ze&&(it.bloomFilter={applied:0===v,hashCount:null!==(M=Ze?.hashCount)&&void 0!==M?M:0,bitmapLength:null!==(fe=null===(Y=null===($=Ze?.bits)||void 0===$?void 0:$.bitmap)||void 0===Y?void 0:Y.length)&&void 0!==fe?fe:0,padding:null!==(et=null===(ge=Ze?.bits)||void 0===ge?void 0:ge.padding)&&void 0!==et?et:0}),it}(g,h,e.Vt))}}}}re(e,t){const{unchangedNames:r,count:i}=e.Vt;if(!r||!r.bits)return 1;const{bits:{bitmap:a="",padding:c=0},hashCount:h=0}=r;let g,v;try{g=ja(a).toUint8Array()}catch(T){if(T instanceof w_)return ks("Decoding the base64 bloom filter in existence filter failed ("+T.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw T}try{v=new OC(g,c,h)}catch(T){return ks(T instanceof hd?"BloomFilter error: ":"Applying bloom filter failed: ",T),1}return 0===v.It?1:i!==t-this.oe(e.targetId,v)?2:0}oe(e,t){const r=this.Gt.getRemoteKeysForTarget(e);let i=0;return r.forEach(a=>{const c=this.Gt.ue(),h=`projects/${c.projectId}/databases/${c.database}/documents/${a.path.canonicalString()}`;t.vt(h)||(this.Yt(e,a,null),i++)}),i}ce(e){const t=new Map;this.Qt.forEach((a,c)=>{const h=this.se(c);if(h){if(a.current&&_f(h.target)){const g=new Ye(h.target.path);null!==this.jt.get(g)||this.ae(c,g)||this.Yt(c,g,er.newNoDocument(g,e))}a.Mt&&(t.set(c,a.Ot()),a.Ft())}});let r=tn();this.zt.forEach((a,c)=>{let h=!0;c.forEachWhile(g=>{const v=this.se(g);return!v||"TargetPurposeLimboResolution"===v.purpose||(h=!1,!1)}),h&&(r=r.add(a))}),this.jt.forEach((a,c)=>c.setReadTime(e));const i=new Cf(e,t,this.Wt,this.jt,r);return this.jt=ts(),this.zt=UC(),this.Wt=new Dn(Ut),i}Jt(e,t){if(!this.te(e))return;const r=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,r),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,r){if(!this.te(e))return;const i=this.Zt(e);this.ae(e,t)?i.Bt(t,1):i.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),r&&(this.jt=this.jt.insert(t,r))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new FC,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new ar(Ut),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||be("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new FC),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function UC(){return new Dn(Ye.comparator)}function VS(){return new Dn(Ye.comparator)}const cN={asc:"ASCENDING",desc:"DESCENDING"},lN={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},BS={and:"AND",or:"OR"};class jS{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function H0(n,e){return n.useProto3Json||sd(e)?e:{value:e}}function Ug(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function VC(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function BC(n,e){return Ug(n,e.toTimestamp())}function Nr(n){return It(!!n),Ct.fromTimestamp(function(e){const t=ku(e);return new or(t.seconds,t.nanos)}(n))}function jC(n,e){return(t=n,new yn(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function yo(n){const e=yn.fromString(n);return It(WS(e)),e}function Vg(n,e){return jC(n.databaseId,e.path)}function vo(n,e){const t=yo(e);if(t.get(1)!==n.databaseId.projectId)throw new Ne(de.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ne(de.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ye($C(t))}function z0(n,e){return jC(n.databaseId,e)}function $S(n){const e=yo(n);return 4===e.length?yn.emptyPath():$C(e)}function Gi(n){return new yn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function $C(n){return It(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function U_(n,e,t){return{name:Vg(n,e),fields:t.value.mapValue.fields}}function HC(n,e,t){const r=vo(n,e.name),i=Nr(e.updateTime),a=e.createTime?Nr(e.createTime):Ct.min(),c=new Ii({mapValue:{fields:e.fields}}),h=er.newFoundDocument(r,i,a,c);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function Tf(n,e){let t;if(e instanceof dd)t={update:U_(n,e.key,e.value)};else if(e instanceof Ef)t={delete:Vg(n,e.key)};else if(e instanceof Ha)t={update:U_(n,e.key,e.data),updateMask:GS(e.fieldMask)};else{if(!(e instanceof NC))return lt();t={verify:Vg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const c=a.transform;if(c instanceof Xo)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof ld)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Bu)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof wf)return{fieldPath:a.field.canonicalString(),increment:c.gt};throw lt()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:BC(n,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:lt()),t;var i}function V_(n,e){const t=e.currentDocument?void 0!==(i=e.currentDocument).updateTime?tr.updateTime(Nr(i.updateTime)):void 0!==i.exists?tr.exists(i.exists):tr.none():tr.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,c){let h=null;"setToServerValue"in c?(It("REQUEST_TIME"===c.setToServerValue),h=new Xo):"appendMissingElements"in c?h=new ld(c.appendMissingElements.values||[]):"removeAllFromArray"in c?h=new Bu(c.removeAllFromArray.values||[]):"increment"in c?h=new wf(a,c.increment):lt();const g=_r.fromServerFormat(c.fieldPath);return new kg(g,h)}(n,i)):[];var i;if(e.update){const i=vo(n,e.update.name),a=new Ii({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=new ys((e.updateMask.fieldPaths||[]).map(v=>_r.fromServerFormat(v)));return new Ha(i,a,c,t,r)}return new dd(i,a,t,r)}if(e.delete){const i=vo(n,e.delete);return new Ef(i,t)}if(e.verify){const i=vo(n,e.verify);return new NC(i,t)}return lt()}function W0(n,e){return{documents:[z0(n,e.path)]}}function B_(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=z0(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=z0(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(g){if(0!==g.length)return K0(En.create(g,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const a=function(g){if(0!==g.length)return g.map(v=>{return{field:$u((T=v).field),direction:q0(T.dir)};var T})}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const c=H0(n,e.limit);var h,g;return null!==c&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt={before:(h=e.startAt).inclusive,values:h.position}),e.endAt&&(t.structuredQuery.endAt={before:!(g=e.endAt).inclusive,values:g.position}),t}function zC(n){let e=$S(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){It(1===r);const T=t.from[0];T.allDescendants?i=T.collectionId:e=e.child(T.collectionId)}let a=[];t.where&&(a=function(T){const S=WC(T);return S instanceof En&&mo(S)?S.getFilters():[S]}(t.where));let c=[];t.orderBy&&(c=t.orderBy.map(T=>{return new ff(Kc((S=T).field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction));var S}));let h=null;t.limit&&(h=function(T){let S;return S="object"==typeof T?T.value:T,sd(S)?null:S}(t.limit));let g=null;var T;t.startAt&&(g=new zc((T=t.startAt).values||[],!!T.before));let v=null;return t.endAt&&(v=function(T){return new zc(T.values||[],!T.before)}(t.endAt)),IC(e,i,c,a,h,"F",g,v)}function WC(n){return void 0!==n.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Kc(e.unaryFilter.field);return pn.create(t,"==",{doubleValue:NaN});case"IS_NULL":const r=Kc(e.unaryFilter.field);return pn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Kc(e.unaryFilter.field);return pn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Kc(e.unaryFilter.field);return pn.create(a,"!=",{nullValue:"NULL_VALUE"});default:return lt()}}(n):void 0!==n.fieldFilter?pn.create(Kc((e=n).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return lt()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==n.compositeFilter?function(e){return En.create(e.compositeFilter.filters.map(t=>WC(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return lt()}}(e.compositeFilter.op))}(n):lt();var e}function q0(n){return cN[n]}function ju(n){return lN[n]}function qc(n){return BS[n]}function $u(n){return{fieldPath:n.canonicalString()}}function Kc(n){return _r.fromServerFormat(n.fieldPath)}function K0(n){return n instanceof pn?function(e){if("=="===e.op){if(cC(e.value))return{unaryFilter:{field:$u(e.field),op:"IS_NAN"}};if(uC(e.value))return{unaryFilter:{field:$u(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(cC(e.value))return{unaryFilter:{field:$u(e.field),op:"IS_NOT_NAN"}};if(uC(e.value))return{unaryFilter:{field:$u(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$u(e.field),op:ju(e.op),value:e.value}}}(n):n instanceof En?function(e){const t=e.getFilters().map(r=>K0(r));return 1===t.length?t[0]:{compositeFilter:{op:qc(e.op),filters:t}}}(n):lt()}function GS(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function WS(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class Hu{constructor(e,t,r,i,a=Ct.min(),c=Ct.min(),h=Yr.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=h,this.expectedCount=g}withSequenceNumber(e){return new Hu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Hu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Hu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Hu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class qC{constructor(e){this.fe=e}}function KC(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Bg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:Vg(i=n.fe,(a=e).key),fields:a.data.value.mapValue.fields,updateTime:Ug(i,a.version.toTimestamp()),createTime:Ug(i,a.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Df(e.version)};else{if(!e.isUnknownDocument())return lt();r.unknownDocument={path:t.path.toArray(),version:Df(e.version)}}var i,a;return r}function Bg(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Df(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Zc(n){const e=new or(n.seconds,n.nanoseconds);return Ct.fromTimestamp(e)}function fd(n,e){const t=(e.baseMutations||[]).map(a=>V_(n.fe,a));for(let a=0;a<e.mutations.length-1;++a)a+1<e.mutations.length&&void 0!==e.mutations[a+1].transform&&(e.mutations[a].updateTransforms=e.mutations[a+1].transform.fieldTransforms,e.mutations.splice(a+1,1),++a);const r=e.mutations.map(a=>V_(n.fe,a)),i=or.fromMillis(e.localWriteTimeMs);return new O_(e.batchId,i,t,r)}function bf(n){const e=Zc(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?Zc(n.lastLimboFreeSnapshotVersion):Ct.min();let r;var i;return void 0!==n.query.documents?(It(1===(i=n.query).documents.length),r=es(ud($S(i.documents[0])))):r=es(zC(n.query)),new Hu(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Yr.fromBase64String(n.resumeToken))}function KS(n,e){const t=Df(e.snapshotVersion),r=Df(e.lastLimboFreeSnapshotVersion);let i;i=_f(e.target)?W0(n.fe,e.target):B_(n.fe,e.target);const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Fu(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function jg(n){const e=zC({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?Pg(e,e.limit,"L"):e}function j_(n,e){return new kC(e.largestBatchId,V_(n.fe,e.overlayMutation))}function Z0(n,e){const t=e.path.lastSegment();return[n,Pi(e.path.popLast()),t]}function Y0(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Df(r.readTime),documentKey:Pi(r.documentKey.path),largestBatchId:r.largestBatchId}}class ZC{getBundleMetadata(e,t){return Q0(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:Zc(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return Q0(e).put({bundleId:(r=t).id,createTime:Df(Nr(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return $g(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:jg(i.bundledQuery),readTime:Zc(i.readTime)};var i})}saveNamedQuery(e,t){return $g(e).put({name:(r=t).name,readTime:Df(Nr(r.readTime)),bundledQuery:r.bundledQuery});var r}}function Q0(n){return Ei(n,"bundles")}function $g(n){return Ei(n,"namedQueries")}class pd{constructor(e,t){this.serializer=e,this.userId=t}static de(e,t){return new pd(e,t.uid||"")}getOverlay(e,t){return Sf(e).get(Z0(this.userId,t)).next(r=>r?j_(this.serializer,r):null)}getOverlays(e,t){const r=_o();return oe.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((a,c)=>{const h=new kC(t,c);i.push(this.we(e,h))}),oe.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(c=>i.add(Pi(c.getCollectionPath())));const a=[];return i.forEach(c=>{const h=IDBKeyRange.bound([this.userId,c,r],[this.userId,c,r+1],!1,!0);a.push(Sf(e).J("collectionPathOverlayIndex",h))}),oe.waitFor(a)}getOverlaysForCollection(e,t,r){const i=_o(),a=Pi(t),c=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Sf(e).j("collectionPathOverlayIndex",c).next(h=>{for(const g of h){const v=j_(this.serializer,g);i.set(v.getKey(),v)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const a=_o();let c;const h=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Sf(e).X({index:"collectionGroupOverlayIndex",range:h},(g,v,T)=>{const S=j_(this.serializer,v);a.size()<i||S.largestBatchId===c?(a.set(S.getKey(),S),c=S.largestBatchId):T.done()}).next(()=>a)}we(e,t){return Sf(e).put(function(r,i,a){const[c,h,g]=Z0(i,a.mutation.key);return{userId:i,collectionPath:h,documentId:g,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Tf(r.fe,a.mutation)}}(this.serializer,this.userId,t))}}function Sf(n){return Ei(n,"documentOverlays")}class gd{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(yr(e.integerValue));else if("doubleValue"in e){const r=yr(e.doubleValue);isNaN(r)?this.ye(t,13):(this.ye(t,15),wg(r)?t.pe(0):t.pe(r))}else if("timestampValue"in e){const r=e.timestampValue;this.ye(t,20),"string"==typeof r?t.Ie(r):(t.Ie(`${r.seconds||""}`),t.pe(r.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(ja(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.ye(t,45),t.pe(r.latitude||0),t.pe(r.longitude||0)}else"mapValue"in e?lC(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):lt()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const r=e.fields||{};this.ye(t,55);for(const i of Object.keys(r))this.Te(i,t),this.me(r[i],t)}Pe(e,t){const r=e.values||[];this.ye(t,50);for(const i of r)this.me(i,t)}ve(e,t){this.ye(t,37),Ye.fromName(e).path.forEach(r=>{this.ye(t,60),this.be(r,t)})}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}function ZS(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function YS(n){const e=64-function(t){let r=0;for(let i=0;i<8;++i){const a=ZS(255&t[i]);if(r+=a,8!==a)break}return r}(n);return Math.ceil(e/8)}gd.Ve=new gd;class dN{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Se(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.De(r.value),r=t.next();this.Ce()}xe(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ne(r.value),r=t.next();this.ke()}Me(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.De(r);else if(r<2048)this.De(960|r>>>6),this.De(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.De(480|r>>>12),this.De(128|63&r>>>6),this.De(128|63&r);else{const i=t.codePointAt(0);this.De(240|i>>>18),this.De(128|63&i>>>12),this.De(128|63&i>>>6),this.De(128|63&i)}}this.Ce()}$e(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ne(r);else if(r<2048)this.Ne(960|r>>>6),this.Ne(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ne(480|r>>>12),this.Ne(128|63&r>>>6),this.Ne(128|63&r);else{const i=t.codePointAt(0);this.Ne(240|i>>>18),this.Ne(128|63&i>>>12),this.Ne(128|63&i>>>6),this.Ne(128|63&i)}}this.ke()}Oe(e){const t=this.Fe(e),r=YS(t);this.Be(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Le(e){const t=this.Fe(e),r=YS(t);this.Be(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}qe(){this.Ue(255),this.Ue(255)}Ke(){this.Ge(255),this.Ge(255)}reset(){this.position=0}seed(e){this.Be(e.length),this.buffer.set(e,this.position),this.position+=e.length}Qe(){return this.buffer.slice(0,this.position)}Fe(e){const t=function(i){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,i,!1),new Uint8Array(a.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}De(e){const t=255&e;0===t?(this.Ue(0),this.Ue(255)):255===t?(this.Ue(255),this.Ue(0)):this.Ue(t)}Ne(e){const t=255&e;0===t?(this.Ge(0),this.Ge(255)):255===t?(this.Ge(255),this.Ge(0)):this.Ge(e)}Ce(){this.Ue(0),this.Ue(1)}ke(){this.Ge(0),this.Ge(1)}Ue(e){this.Be(1),this.buffer[this.position++]=e}Ge(e){this.Be(1),this.buffer[this.position++]=~e}Be(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class hN{constructor(e){this.je=e}Ae(e){this.je.Se(e)}Ie(e){this.je.Me(e)}pe(e){this.je.Oe(e)}ge(){this.je.qe()}}class YC{constructor(e){this.je=e}Ae(e){this.je.xe(e)}Ie(e){this.je.$e(e)}pe(e){this.je.Le(e)}ge(){this.je.Ke()}}class Hg{constructor(){this.je=new dN,this.ze=new hN(this.je),this.We=new YC(this.je)}seed(e){this.je.seed(e)}He(e){return 0===e?this.ze:this.We}Qe(){return this.je.Qe()}reset(){this.je.reset()}}class md{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Je(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new md(this.indexId,this.documentKey,this.arrayValue,r)}}function Yc(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=QS(n.arrayValue,e.arrayValue),0!==t?t:(t=QS(n.directionalValue,e.directionalValue),0!==t?t:Ye.comparator(n.documentKey,e.documentKey)))}function QS(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class fN{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ye=e.orderBy,this.Xe=[];for(const t of e.filters){const r=t;r.isInequality()?this.Ze=r:this.Xe.push(r)}}tn(e){It(e.collectionGroup===this.collectionId);const t=qI(e);if(void 0!==t&&!this.en(t))return!1;const r=df(e);let i=new Set,a=0,c=0;for(;a<r.length&&this.en(r[a]);++a)i=i.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(void 0!==this.Ze){if(!i.has(this.Ze.field.canonicalString())){const h=r[a];if(!this.nn(this.Ze,h)||!this.sn(this.Ye[c++],h))return!1}++a}for(;a<r.length;++a)if(c>=this.Ye.length||!this.sn(this.Ye[c++],r[a]))return!1;return!0}en(e){for(const t of this.Xe)if(this.nn(t,e))return!0;return!1}nn(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function XS(n){var e,t;if(It(n instanceof pn||n instanceof En),n instanceof pn){if(n instanceof b0){const i=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(a=>pn.create(n.field,"==",a)))||[];return En.create(i,"or")}return n}const r=n.filters.map(i=>XS(i));return En.create(r,n.op)}function pN(n){if(0===n.getFilters().length)return[];const e=J0(XS(n));return It(zg(e)),QC(e)||X0(e)?[e]:e.getFilters()}function QC(n){return n instanceof pn}function X0(n){return n instanceof En&&mo(n)}function zg(n){return QC(n)||X0(n)||function(e){if(e instanceof En&&Ag(e)){for(const t of e.getFilters())if(!QC(t)&&!X0(t))return!1;return!0}return!1}(n)}function J0(n){if(It(n instanceof pn||n instanceof En),n instanceof pn)return n;if(1===n.filters.length)return J0(n.filters[0]);const e=n.filters.map(r=>J0(r));let t=En.create(e,n.op);return t=za(t),zg(t)?t:(It(t instanceof En),It(pf(t)),It(t.filters.length>1),t.filters.reduce((r,i)=>ew(r,i)))}function ew(n,e){let t;return It(n instanceof pn||n instanceof En),It(e instanceof pn||e instanceof En),t=n instanceof pn?e instanceof pn?En.create([n,e],"and"):tw(n,e):e instanceof pn?tw(e,n):function(r,i){if(It(r.filters.length>0&&i.filters.length>0),pf(r)&&pf(i))return gC(r,i.getFilters());const a=Ag(r)?r:i,c=Ag(r)?i:r,h=a.filters.map(g=>ew(g,c));return En.create(h,"or")}(n,e),za(t)}function tw(n,e){if(pf(e))return gC(e,n.getFilters());{const t=e.filters.map(r=>ew(n,r));return En.create(t,"or")}}function za(n){if(It(n instanceof pn||n instanceof En),n instanceof pn)return n;const e=n.getFilters();if(1===e.length)return za(e[0]);if(pC(n))return n;const t=e.map(i=>za(i)),r=[];return t.forEach(i=>{i instanceof pn?r.push(i):i instanceof En&&(i.op===n.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:En.create(r,n.op)}class XC{constructor(){this.rn=new Gg}addToCollectionParentIndex(e,t){return this.rn.add(t),oe.resolve()}getCollectionParents(e,t){return oe.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return oe.resolve()}deleteFieldIndex(e,t){return oe.resolve()}getDocumentsMatchingTarget(e,t){return oe.resolve(null)}getIndexType(e,t){return oe.resolve(0)}getFieldIndexes(e,t){return oe.resolve([])}getNextCollectionGroupToUpdate(e){return oe.resolve(null)}getMinOffset(e,t){return oe.resolve(_s.min())}getMinOffsetFromCollectionGroup(e,t){return oe.resolve(_s.min())}updateCollectionGroup(e,t,r){return oe.resolve()}updateIndexEntries(e,t){return oe.resolve()}}class Gg{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new ar(yn.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new ar(yn.comparator)).toArray()}}const Af=new Uint8Array(0);class JS{constructor(e,t){this.user=e,this.databaseId=t,this.on=new Gg,this.un=new Wc(r=>Fu(r),(r,i)=>mf(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.on.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.on.add(t)});const a={collectionId:r,parent:Pi(i)};return $_(e).put(a)}return oe.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[WI(t),""],!1,!0);return $_(e).j(i).next(a=>{for(const c of a){if(c.collectionId!==t)break;r.push(Ba(c.parent))}return r})}addFieldIndex(e,t){const r=yd(e),i={indexId:(c=t).indexId,collectionGroup:c.collectionGroup,fields:c.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])};var c;delete i.indexId;const a=r.add(i);if(t.indexState){const c=H_(e);return a.next(h=>{c.put(Y0(h,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const r=yd(e),i=H_(e),a=_d(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const r=_d(e);let i=!0;const a=new Map;return oe.forEach(this.cn(t),c=>this.an(e,c).next(h=>{i&&(i=!!h),a.set(c,h)})).next(()=>{if(i){let c=tn();const h=[];return oe.forEach(a,(g,v)=>{var T;be("IndexedDbIndexManager",`Using index ${T=g,`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(Ze=>`${Ze.fieldPath}:${Ze.kind}`).join(",")}`} to execute ${Fu(t)}`);const S=function(Ze,ht){const Bt=qI(ht);if(void 0===Bt)return null;for(const on of yf(Ze,Bt.fieldPath))switch(on.op){case"array-contains-any":return on.value.arrayValue.values||[];case"array-contains":return[on.value]}return null}(v,g),M=function(Ze,ht){const Bt=new Map;for(const on of df(ht))for(const Ci of yf(Ze,on.fieldPath))switch(Ci.op){case"==":case"in":Bt.set(on.fieldPath.canonicalString(),Ci.value);break;case"not-in":case"!=":return Bt.set(on.fieldPath.canonicalString(),Ci.value),Array.from(Bt.values())}return null}(v,g),$=function(Ze,ht){const Bt=[];let on=!0;for(const Ci of df(ht)){const na=0===Ci.kind?wC(Ze,Ci.fieldPath,Ze.startAt):EC(Ze,Ci.fieldPath,Ze.startAt);Bt.push(na.value),on&&(on=na.inclusive)}return new zc(Bt,on)}(v,g),Y=function(Ze,ht){const Bt=[];let on=!0;for(const Ci of df(ht)){const na=0===Ci.kind?EC(Ze,Ci.fieldPath,Ze.endAt):wC(Ze,Ci.fieldPath,Ze.endAt);Bt.push(na.value),on&&(on=na.inclusive)}return new zc(Bt,on)}(v,g),fe=this.hn(g,v,$),ge=this.hn(g,v,Y),et=this.ln(g,v,M),it=this.fn(g.indexId,S,fe,$.inclusive,ge,Y.inclusive,et);return oe.forEach(it,Ze=>r.H(Ze,t.limit).next(ht=>{ht.forEach(Bt=>{const on=Ye.fromSegments(Bt.documentKey);c.has(on)||(c=c.add(on),h.push(on))})}))}).next(()=>h)}return oe.resolve(null)})}cn(e){let t=this.un.get(e);return t||(t=0===e.filters.length?[e]:pN(En.create(e.filters,"and")).map(r=>xg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}fn(e,t,r,i,a,c,h){const g=(null!=t?t.length:1)*Math.max(r.length,a.length),v=g/(null!=t?t.length:1),T=[];for(let S=0;S<g;++S){const M=t?this.dn(t[S/v]):Af,$=this.wn(e,M,r[S%v],i),Y=this._n(e,M,a[S%v],c),fe=h.map(ge=>this.wn(e,M,ge,!0));T.push(...this.createRange($,Y,fe))}return T}wn(e,t,r,i){const a=new md(e,Ye.empty(),t,r);return i?a:a.Je()}_n(e,t,r,i){const a=new md(e,Ye.empty(),t,r);return i?a.Je():a}an(e,t){const r=new fN(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(a=>{let c=null;for(const h of a)r.tn(h)&&(!c||h.fields.length>c.fields.length)&&(c=h);return c})}getIndexType(e,t){let r=2;const i=this.cn(t);return oe.forEach(i,a=>this.an(e,a).next(c=>{c?0!==r&&c.fields.length<function(h){let g=new ar(_r.comparator),v=!1;for(const T of h.filters)for(const S of T.getFlattenedFilters())S.field.isKeyField()||("array-contains"===S.op||"array-contains-any"===S.op?v=!0:g=g.add(S.field));for(const T of h.orderBy)T.field.isKeyField()||(g=g.add(T.field));return g.size+(v?1:0)}(a)&&(r=1):r=0})).next(()=>null!==t.limit&&i.length>1&&2===r?1:r)}mn(e,t){const r=new Hg;for(const i of df(e)){const a=t.data.field(i.fieldPath);if(null==a)return null;const c=r.He(i.kind);gd.Ve._e(a,c)}return r.Qe()}dn(e){const t=new Hg;return gd.Ve._e(e,t.He(0)),t.Qe()}gn(e,t){const r=new Hg;return gd.Ve._e(ad(this.databaseId,t),r.He(function(i){const a=df(i);return 0===a.length?0:a[a.length-1].kind}(e))),r.Qe()}ln(e,t,r){if(null===r)return[];let i=[];i.push(new Hg);let a=0;for(const c of df(e)){const h=r[a++];for(const g of i)if(this.yn(t,c.fieldPath)&&Dg(h))i=this.pn(i,c,h);else{const v=g.He(c.kind);gd.Ve._e(h,v)}}return this.In(i)}hn(e,t,r){return this.ln(e,t,r.position)}In(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Qe();return t}pn(e,t,r){const i=[...e],a=[];for(const c of r.arrayValue.values||[])for(const h of i){const g=new Hg;g.seed(h.Qe()),gd.Ve._e(c,g.He(t.kind)),a.push(g)}return a}yn(e,t){return!!e.filters.find(r=>r instanceof pn&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=yd(e),i=H_(e);return(t?r.j("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.j()).next(a=>{const c=[];return oe.forEach(a,h=>i.get([h.indexId,this.uid]).next(g=>{c.push(function(v,T){const S=T?new Uc(T.sequenceNumber,new _s(Zc(T.readTime),new Ye(Ba(T.documentKey)),T.largestBatchId)):Uc.empty(),M=v.fields.map(([$,Y])=>new l0(_r.fromServerFormat($),Y));return new f_(v.indexId,v.collectionGroup,M,S)}(h,g))})).next(()=>c)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==a?a:Ut(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=yd(e),a=H_(e);return this.Tn(e).next(c=>i.j("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(h=>oe.forEach(h,g=>a.put(Y0(g.indexId,this.user,c,r)))))}updateIndexEntries(e,t){const r=new Map;return oe.forEach(t,(i,a)=>{const c=r.get(i.collectionGroup);return(c?oe.resolve(c):this.getFieldIndexes(e,i.collectionGroup)).next(h=>(r.set(i.collectionGroup,h),oe.forEach(h,g=>this.En(e,i,g).next(v=>{const T=this.An(a,g);return v.isEqual(T)?oe.resolve():this.vn(e,a,g,v,T)}))))})}Rn(e,t,r,i){return _d(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.gn(r,t.key),documentKey:t.key.path.toArray()})}Pn(e,t,r,i){return _d(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.gn(r,t.key),t.key.path.toArray()])}En(e,t,r){const i=_d(e);let a=new ar(Yc);return i.X({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.gn(r,t)])},(c,h)=>{a=a.add(new md(r.indexId,t,h.arrayValue,h.directionalValue))}).next(()=>a)}An(e,t){let r=new ar(Yc);const i=this.mn(t,e);if(null==i)return r;const a=qI(t);if(null!=a){const c=e.data.field(a.fieldPath);if(Dg(c))for(const h of c.arrayValue.values||[])r=r.add(new md(t.indexId,e.key,this.dn(h),i))}else r=r.add(new md(t.indexId,e.key,Af,i));return r}vn(e,t,r,i,a){be("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const c=[];return function(h,g,v,T,S){const M=h.getIterator(),$=g.getIterator();let Y=$c(M),fe=$c($);for(;Y||fe;){let ge=!1,et=!1;if(Y&&fe){const it=v(Y,fe);it<0?et=!0:it>0&&(ge=!0)}else null!=Y?et=!0:ge=!0;ge?(T(fe),fe=$c($)):et?(S(Y),Y=$c(M)):(Y=$c(M),fe=$c($))}}(i,a,Yc,h=>{c.push(this.Rn(e,t,r,h))},h=>{c.push(this.Pn(e,t,r,h))}),oe.waitFor(c)}Tn(e){let t=1;return H_(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,a)=>{a.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((c,h)=>Yc(c,h)).filter((c,h,g)=>!h||0!==Yc(c,g[h-1]));const i=[];i.push(e);for(const c of r){const h=Yc(c,e),g=Yc(c,t);if(0===h)i[0]=e.Je();else if(h>0&&g<0)i.push(c),i.push(c.Je());else if(g>0)break}i.push(t);const a=[];for(let c=0;c<i.length;c+=2){if(this.bn(i[c],i[c+1]))return[];a.push(IDBKeyRange.bound([i[c].indexId,this.uid,i[c].arrayValue,i[c].directionalValue,Af,[]],[i[c+1].indexId,this.uid,i[c+1].arrayValue,i[c+1].directionalValue,Af,[]]))}return a}bn(e,t){return Yc(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(eA)}getMinOffset(e,t){return oe.mapArray(this.cn(t),r=>this.an(e,r).next(i=>i||lt())).next(eA)}}function $_(n){return Ei(n,"collectionParents")}function _d(n){return Ei(n,"indexEntries")}function yd(n){return Ei(n,"indexConfiguration")}function H_(n){return Ei(n,"indexState")}function eA(n){It(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;id(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new _s(e.readTime,e.documentKey,t)}const tA={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ns{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new ns(e,ns.DEFAULT_COLLECTION_PERCENTILE,ns.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function nw(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),a=[],c=IDBKeyRange.only(t.batchId);let h=0;const g=r.X({range:c},(T,S,M)=>(h++,M.delete()));a.push(g.next(()=>{It(1===h)}));const v=[];for(const T of t.mutations){const S=f0(e,T.key.path,t.batchId);a.push(i.delete(S)),v.push(T.key)}return oe.waitFor(a).next(()=>v)}function z_(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw lt();e=n.noDocument}return JSON.stringify(e).length}ns.DEFAULT_COLLECTION_PERCENTILE=10,ns.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ns.DEFAULT=new ns(41943040,ns.DEFAULT_COLLECTION_PERCENTILE,ns.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ns.DISABLED=new ns(-1,0,0);class G_{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Vn={}}static de(e,t,r,i){It(""!==e.uid);const a=e.isAuthenticated()?e.uid:"";return new G_(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Qc(e).X({index:"userMutationsIndex",range:r},(i,a,c)=>{t=!1,c.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const a=vd(e),c=Qc(e);return c.add({}).next(h=>{It("number"==typeof h);const g=new O_(h,t,r,i),v=function(M,$,Y){const fe=Y.baseMutations.map(et=>Tf(M.fe,et)),ge=Y.mutations.map(et=>Tf(M.fe,et));return{userId:$,batchId:Y.batchId,localWriteTimeMs:Y.localWriteTime.toMillis(),baseMutations:fe,mutations:ge}}(this.serializer,this.userId,g),T=[];let S=new ar((M,$)=>Ut(M.canonicalString(),$.canonicalString()));for(const M of i){const $=f0(this.userId,M.key.path,h);S=S.add(M.key.path.popLast()),T.push(c.put(v)),T.push(a.put($,lS))}return S.forEach(M=>{T.push(this.indexManager.addToCollectionParentIndex(e,M))}),e.addOnCommittedListener(()=>{this.Vn[h]=g.keys()}),oe.waitFor(T).next(()=>g)})}lookupMutationBatch(e,t){return Qc(e).get(t).next(r=>r?(It(r.userId===this.userId),fd(this.serializer,r)):null)}Sn(e,t){return this.Vn[t]?oe.resolve(this.Vn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Vn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Qc(e).X({index:"userMutationsIndex",range:i},(c,h,g)=>{h.userId===this.userId&&(It(h.batchId>=r),a=fd(this.serializer,h)),g.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Qc(e).X({index:"userMutationsIndex",range:t,reverse:!0},(i,a,c)=>{r=a.batchId,c.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Qc(e).j("userMutationsIndex",t).next(r=>r.map(i=>fd(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=__(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return vd(e).X({range:i},(c,h,g)=>{const[v,T,S]=c,M=Ba(T);if(v===this.userId&&t.path.isEqual(M))return Qc(e).get(S).next($=>{if(!$)throw lt();It($.userId===this.userId),a.push(fd(this.serializer,$))});g.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ar(Ut);const i=[];return t.forEach(a=>{const c=__(this.userId,a.path),h=IDBKeyRange.lowerBound(c),g=vd(e).X({range:h},(v,T,S)=>{const[M,$,Y]=v,fe=Ba($);M===this.userId&&a.path.isEqual(fe)?r=r.add(Y):S.done()});i.push(g)}),oe.waitFor(i).next(()=>this.Dn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=__(this.userId,r),c=IDBKeyRange.lowerBound(a);let h=new ar(Ut);return vd(e).X({range:c},(g,v,T)=>{const[S,M,$]=g,Y=Ba(M);S===this.userId&&r.isPrefixOf(Y)?Y.length===i&&(h=h.add($)):T.done()}).next(()=>this.Dn(e,h))}Dn(e,t){const r=[],i=[];return t.forEach(a=>{i.push(Qc(e).get(a).next(c=>{if(null===c)throw lt();It(c.userId===this.userId),r.push(fd(this.serializer,c))}))}),oe.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return nw(e.ht,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Cn(t.batchId)}),oe.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Cn(e){delete this.Vn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return oe.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return vd(e).X({range:r},(a,c,h)=>{if(a[0]===this.userId){const g=Ba(a[1]);i.push(g)}else h.done()}).next(()=>{It(0===i.length)})})}containsKey(e,t){return JC(e,this.userId,t)}xn(e){return rw(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function JC(n,e,t){const r=__(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let c=!1;return vd(n).X({range:a,Y:!0},(h,g,v)=>{const[T,S,M]=h;T===e&&S===i&&(c=!0),v.done()}).next(()=>c)}function Qc(n){return Ei(n,"mutations")}function vd(n){return Ei(n,"documentMutations")}function rw(n){return Ei(n,"mutationQueues")}class Xc{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new Xc(0)}static Mn(){return new Xc(-1)}}class nA{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.$n(e).next(t=>{const r=new Xc(t.highestTargetId);return t.highestTargetId=r.next(),this.On(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.$n(e).next(t=>Ct.fromTimestamp(new or(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.$n(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.$n(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.On(e,i)))}addTargetData(e,t){return this.Fn(e,t).next(()=>this.$n(e).next(r=>(r.targetCount+=1,this.Bn(t,r),this.On(e,r))))}updateTargetData(e,t){return this.Fn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Rf(e).delete(t.targetId)).next(()=>this.$n(e)).next(r=>(It(r.targetCount>0),r.targetCount-=1,this.On(e,r)))}removeTargets(e,t,r){let i=0;const a=[];return Rf(e).X((c,h)=>{const g=bf(h);g.sequenceNumber<=t&&null===r.get(g.targetId)&&(i++,a.push(this.removeTargetData(e,g)))}).next(()=>oe.waitFor(a)).next(()=>i)}forEachTarget(e,t){return Rf(e).X((r,i)=>{const a=bf(i);t(a)})}$n(e){return iw(e).get("targetGlobalKey").next(t=>(It(null!==t),t))}On(e,t){return iw(e).put("targetGlobalKey",t)}Fn(e,t){return Rf(e).put(KS(this.serializer,t))}Bn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.$n(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Fu(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return Rf(e).X({range:i,index:"queryTargetsIndex"},(c,h,g)=>{const v=bf(h);mf(t,v.target)&&(a=v,g.done())}).next(()=>a)}addMatchingKeys(e,t,r){const i=[],a=Ga(e);return t.forEach(c=>{const h=Pi(c.path);i.push(a.put({targetId:r,path:h})),i.push(this.referenceDelegate.addReference(e,r,c))}),oe.waitFor(i)}removeMatchingKeys(e,t,r){const i=Ga(e);return oe.forEach(t,a=>{const c=Pi(a.path);return oe.waitFor([i.delete([r,c]),this.referenceDelegate.removeReference(e,r,a)])})}removeMatchingKeysForTargetId(e,t){const r=Ga(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Ga(e);let a=tn();return i.X({range:r,Y:!0},(c,h,g)=>{const v=Ba(c[1]),T=new Ye(v);a=a.add(T)}).next(()=>a)}containsKey(e,t){const r=Pi(t.path),i=IDBKeyRange.bound([r],[WI(r)],!1,!0);let a=0;return Ga(e).X({index:"documentTargetsIndex",Y:!0,range:i},([c,h],g,v)=>{0!==c&&(a++,v.done())}).next(()=>a>0)}le(e,t){return Rf(e).get(t).next(r=>r?bf(r):null)}}function Rf(n){return Ei(n,"targets")}function iw(n){return Ei(n,"targetGlobal")}function Ga(n){return Ei(n,"targetDocuments")}function rA([n,e],[t,r]){const i=Ut(n,t);return 0===i?Ut(e,r):i}class eT{constructor(e){this.Ln=e,this.buffer=new ar(rA),this.qn=0}Un(){return++this.qn}Kn(e){const t=[e,this.Un()];if(this.buffer.size<this.Ln)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();rA(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class W_{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Gn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Qn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return null!==this.Gn}Qn(e){var t=this;be("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,Ee.Z)(function*(){t.Gn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){go(r)?be("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield Vc(r)}yield t.Qn(3e5)}))}}class iA{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.zn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return oe.resolve(Os.ct);const r=new eT(t);return this.jn.forEachTarget(e,i=>r.Kn(i.sequenceNumber)).next(()=>this.jn.Wn(e,i=>r.Kn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(be("LruGarbageCollector","Garbage collection skipped; disabled"),oe.resolve(tA)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(be("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),tA):this.Hn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Hn(e,t){let r,i,a,c,h,g,v;const T=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(S=>(S>this.params.maximumSequenceNumbersToCollect?(be("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${S}`),i=this.params.maximumSequenceNumbersToCollect):i=S,c=Date.now(),this.nthSequenceNumber(e,i))).next(S=>(r=S,h=Date.now(),this.removeTargets(e,r,t))).next(S=>(a=S,g=Date.now(),this.removeOrphanedDocuments(e,r))).next(S=>(v=Date.now(),af()<=gs.in.DEBUG&&be("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${c-T}ms\n\tDetermined least recently used ${i} in `+(h-c)+`ms\n\tRemoved ${a} targets in `+(g-h)+`ms\n\tRemoved ${S} documents in `+(v-g)+`ms\nTotal Duration: ${v-T}ms`),oe.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:S})))}}class gN{constructor(e,t){this.db=e,this.garbageCollector=function tT(n,e){return new iA(n,e)}(this,t)}zn(e){const t=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Jn(e){let t=0;return this.Wn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Wn(e,t){return this.Yn(e,(r,i)=>t(i))}addReference(e,t,r){return sw(e,r)}removeReference(e,t,r){return sw(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return sw(e,t)}Xn(e,t){return function(r,i){let a=!1;return rw(r).Z(c=>JC(r,c,i).next(h=>(h&&(a=!0),oe.resolve(!h)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Yn(e,(c,h)=>{if(h<=t){const g=this.Xn(e,c).next(v=>{if(!v)return a++,r.getEntry(e,c).next(()=>(r.removeEntry(c,Ct.min()),Ga(e).delete([0,Pi(c.path)])))});i.push(g)}}).next(()=>oe.waitFor(i)).next(()=>r.apply(e)).next(()=>a)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return sw(e,t)}Yn(e,t){const r=Ga(e);let i,a=Os.ct;return r.X({index:"documentTargetsIndex"},([c,h],{path:g,sequenceNumber:v})=>{0===c?(a!==Os.ct&&t(new Ye(Ba(i)),a),a=v,i=g):a=Os.ct}).next(()=>{a!==Os.ct&&t(new Ye(Ba(i)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function sw(n,e){return Ga(n).put((r=n.currentSequenceNumber,{targetId:0,path:Pi(e.path),sequenceNumber:r}));var r}class nT{constructor(){this.changes=new Wc(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,er.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?oe.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class sA{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return xf(e).put(r)}removeEntry(e,t,r){return xf(e).delete(function(i,a){const c=i.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],Bg(a),c[c.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.Zn(e,r)))}getEntry(e,t){let r=er.newInvalidDocument(t);return xf(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(q_(t))},(i,a)=>{r=this.ts(t,a)}).next(()=>r)}es(e,t){let r={size:0,document:er.newInvalidDocument(t)};return xf(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(q_(t))},(i,a)=>{r={document:this.ts(t,a),size:z_(a)}}).next(()=>r)}getEntries(e,t){let r=ts();return this.ns(e,t,(i,a)=>{const c=this.ts(i,a);r=r.insert(i,c)}).next(()=>r)}ss(e,t){let r=ts(),i=new Dn(Ye.comparator);return this.ns(e,t,(a,c)=>{const h=this.ts(a,c);r=r.insert(a,h),i=i.insert(a,z_(c))}).next(()=>({documents:r,rs:i}))}ns(e,t,r){if(t.isEmpty())return oe.resolve();let i=new ar(aA);t.forEach(g=>i=i.add(g));const a=IDBKeyRange.bound(q_(i.first()),q_(i.last())),c=i.getIterator();let h=c.getNext();return xf(e).X({index:"documentKeyIndex",range:a},(g,v,T)=>{const S=Ye.fromSegments([...v.prefixPath,v.collectionGroup,v.documentId]);for(;h&&aA(h,S)<0;)r(h,null),h=c.getNext();h&&h.isEqual(S)&&(r(h,v),h=c.hasNext()?c.getNext():null),h?T.G(q_(h)):T.done()}).next(()=>{for(;h;)r(h,null),h=c.hasNext()?c.getNext():null})}getDocumentsMatchingQuery(e,t,r,i){const a=t.path,c=[a.popLast().toArray(),a.lastSegment(),Bg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xf(e).j(IDBKeyRange.bound(c,h,!0)).next(g=>{let v=ts();for(const T of g){const S=this.ts(Ye.fromSegments(T.prefixPath.concat(T.collectionGroup,T.documentId)),T);S.isFoundDocument()&&(ai(t,S)||i.has(S.key))&&(v=v.insert(S.key,S))}return v})}getAllFromCollectionGroup(e,t,r,i){let a=ts();const c=iT(t,r),h=iT(t,_s.max());return xf(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(c,h,!0)},(g,v,T)=>{const S=this.ts(Ye.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);a=a.insert(S.key,S),a.size===i&&T.done()}).next(()=>a)}newChangeBuffer(e){return new mN(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return oA(e).get("remoteDocumentGlobalKey").next(t=>(It(!!t),t))}Zn(e,t){return oA(e).put("remoteDocumentGlobalKey",t)}ts(e,t){if(t){const r=function qS(n,e){let t;if(e.document)t=HC(n.fe,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Ye.fromSegments(e.noDocument.path),i=Zc(e.noDocument.readTime);t=er.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return lt();{const r=Ye.fromSegments(e.unknownDocument.path),i=Zc(e.unknownDocument.version);t=er.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(r){const i=new or(r[0],r[1]);return Ct.fromTimestamp(i)}(e.readTime)),t}(this.serializer,t);if(!r.isNoDocument()||!r.version.isEqual(Ct.min()))return r}return er.newInvalidDocument(e)}}function rT(n){return new sA(n)}class mN extends nT{constructor(e,t){super(),this.os=e,this.trackRemovals=t,this.us=new Wc(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new ar((a,c)=>Ut(a.canonicalString(),c.canonicalString()));return this.changes.forEach((a,c)=>{const h=this.us.get(a);if(t.push(this.os.removeEntry(e,a,h.readTime)),c.isValidDocument()){const g=KC(this.os.serializer,c);i=i.add(a.path.popLast());const v=z_(g);r+=v-h.size,t.push(this.os.addEntry(e,a,g))}else if(r-=h.size,this.trackRemovals){const g=KC(this.os.serializer,c.convertToNoDocument(Ct.min()));t.push(this.os.addEntry(e,a,g))}}),i.forEach(a=>{t.push(this.os.indexManager.addToCollectionParentIndex(e,a))}),t.push(this.os.updateMetadata(e,r)),oe.waitFor(t)}getFromCache(e,t){return this.os.es(e,t).next(r=>(this.us.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.os.ss(e,t).next(({documents:r,rs:i})=>(i.forEach((a,c)=>{this.us.set(a,{size:c,readTime:r.get(a).readTime})}),r))}}function oA(n){return Ei(n,"remoteDocumentGlobal")}function xf(n){return Ei(n,"remoteDocumentsV14")}function q_(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function iT(n,e){const t=e.documentKey.path.toArray();return[n,Bg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function aA(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=Ut(t[a],r[a]),i)return i;return i=Ut(t.length,r.length),i||(i=Ut(t[t.length-2],r[r.length-2]),i||Ut(t[t.length-1],r[r.length-1]))}class _N{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class uA{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==r&&Lg(r.mutation,i,ys.empty(),or.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,tn()).next(()=>r))}getLocalViewOfDocuments(e,t,r=tn()){const i=_o();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(a=>{let c=Vu();return a.forEach((h,g)=>{c=c.insert(h,g.overlayedDocument)}),c}))}getOverlayedDocuments(e,t){const r=_o();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,tn()))}populateOverlays(e,t,r){const i=[];return r.forEach(a=>{t.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((c,h)=>{t.set(c,h)})})}computeViews(e,t,r,i){let a=ts();const c=vf(),h=vf();return t.forEach((g,v)=>{const T=r.get(v.key);i.has(v.key)&&(void 0===T||T.mutation instanceof Ha)?a=a.insert(v.key,v):void 0!==T?(c.set(v.key,T.mutation.getFieldMask()),Lg(T.mutation,v,T.mutation.getFieldMask(),or.now())):c.set(v.key,ys.empty())}),this.recalculateAndSaveOverlays(e,a).next(g=>(g.forEach((v,T)=>c.set(v,T)),t.forEach((v,T)=>{var S;return h.set(v,new _N(T,null!==(S=c.get(v))&&void 0!==S?S:null))}),h))}recalculateAndSaveOverlays(e,t){const r=vf();let i=new Dn((c,h)=>c-h),a=tn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(c=>{for(const h of c)h.keys().forEach(g=>{const v=t.get(g);if(null===v)return;let T=r.get(g)||ys.empty();T=h.applyToLocalView(v,T),r.set(g,T);const S=(i.get(h.batchId)||tn()).add(g);i=i.insert(h.batchId,S)})}).next(()=>{const c=[],h=i.getReverseIterator();for(;h.hasNext();){const g=h.getNext(),v=g.key,T=g.value,S=DC();T.forEach(M=>{if(!a.has(M)){const $=O0(t.get(M),r.get(M));null!==$&&S.set(M,$),a=a.add(M)}}),c.push(this.documentOverlayCache.saveOverlays(e,v,S))}return oe.waitFor(c)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return Ye.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):R_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r);var i}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(a=>{const c=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):oe.resolve(_o());let h=-1,g=a;return c.next(v=>oe.forEach(v,(T,S)=>(h<S.largestBatchId&&(h=S.largestBatchId),a.get(T)?oe.resolve():this.remoteDocumentCache.getEntry(e,T).next(M=>{g=g.insert(T,M)}))).next(()=>this.populateOverlays(e,v,a)).next(()=>this.computeViews(e,g,v,tn())).next(T=>({batchId:h,changes:TC(T)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ye(t)).next(r=>{let i=Vu();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const i=t.collectionGroup;let a=Vu();return this.indexManager.getCollectionParents(e,i).next(c=>oe.forEach(c,h=>{const g=(v=t,T=h.child(i),new Uu(T,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt));var v,T;return this.getDocumentsMatchingCollectionQuery(e,g,r).next(v=>{v.forEach((T,S)=>{a=a.insert(T,S)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i))).next(a=>{i.forEach((h,g)=>{const v=g.getKey();null===a.get(v)&&(a=a.insert(v,er.newInvalidDocument(v)))});let c=Vu();return a.forEach((h,g)=>{const v=i.get(h);void 0!==v&&Lg(v.mutation,g,ys.empty(),or.now()),ai(t,g)&&(c=c.insert(h,g))}),c})}}class yN{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return oe.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var r;return this.cs.set(t.id,{id:(r=t).id,version:r.version,createTime:Nr(r.createTime)}),oe.resolve()}getNamedQuery(e,t){return oe.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,{name:(r=t).name,query:jg(r.bundledQuery),readTime:Nr(r.readTime)}),oe.resolve();var r}}class vN{constructor(){this.overlays=new Dn(Ye.comparator),this.ls=new Map}getOverlay(e,t){return oe.resolve(this.overlays.get(t))}getOverlays(e,t){const r=_o();return oe.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,a)=>{this.we(e,t,a)}),oe.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.ls.get(r);return void 0!==i&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.ls.delete(r)),oe.resolve()}getOverlaysForCollection(e,t,r){const i=_o(),a=t.length+1,c=new Ye(t.child("")),h=this.overlays.getIteratorFrom(c);for(;h.hasNext();){const g=h.getNext().value,v=g.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===a&&g.largestBatchId>r&&i.set(g.getKey(),g)}return oe.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new Dn((v,T)=>v-T);const c=this.overlays.getIterator();for(;c.hasNext();){const v=c.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>r){let T=a.get(v.largestBatchId);null===T&&(T=_o(),a=a.insert(v.largestBatchId,T)),T.set(v.getKey(),v)}}const h=_o(),g=a.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach((v,T)=>h.set(v,T)),!(h.size()>=i)););return oe.resolve(h)}we(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const c=this.ls.get(i.largestBatchId).delete(r.key);this.ls.set(i.largestBatchId,c)}this.overlays=this.overlays.insert(r.key,new kC(t,r));let a=this.ls.get(t);void 0===a&&(a=tn(),this.ls.set(t,a)),this.ls.set(t,a.add(r.key))}}class sT{constructor(){this.fs=new ar(s.ds),this.ws=new ar(s._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const r=new s(e,t);this.fs=this.fs.add(r),this.ws=this.ws.add(r)}gs(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.ys(new s(e,t))}ps(e,t){e.forEach(r=>this.removeReference(r,t))}Is(e){const t=new Ye(new yn([])),r=new s(t,e),i=new s(t,e+1),a=[];return this.ws.forEachInRange([r,i],c=>{this.ys(c),a.push(c.key)}),a}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new Ye(new yn([])),r=new s(t,e),i=new s(t,e+1);let a=tn();return this.ws.forEachInRange([r,i],c=>{a=a.add(c.key)}),a}containsKey(e){const t=new s(e,0),r=this.fs.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class s{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return Ye.comparator(e.key,t.key)||Ut(e.As,t.As)}static _s(e,t){return Ut(e.As,t.As)||Ye.comparator(e.key,t.key)}}class o{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new ar(s.ds)}checkEmpty(e){return oe.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const a=this.vs;this.vs++;const c=new O_(a,t,r,i);this.mutationQueue.push(c);for(const h of i)this.Rs=this.Rs.add(new s(h.key,a)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return oe.resolve(c)}lookupMutationBatch(e,t){return oe.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.bs(t+1),a=i<0?0:i;return oe.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new s(t,0),i=new s(t,Number.POSITIVE_INFINITY),a=[];return this.Rs.forEachInRange([r,i],c=>{const h=this.Ps(c.As);a.push(h)}),oe.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ar(Ut);return t.forEach(i=>{const a=new s(i,0),c=new s(i,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([a,c],h=>{r=r.add(h.As)})}),oe.resolve(this.Vs(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;Ye.isDocumentKey(a)||(a=a.child(""));const c=new s(new Ye(a),0);let h=new ar(Ut);return this.Rs.forEachWhile(g=>{const v=g.key.path;return!!r.isPrefixOf(v)&&(v.length===i&&(h=h.add(g.As)),!0)},c),oe.resolve(this.Vs(h))}Vs(e){const t=[];return e.forEach(r=>{const i=this.Ps(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){It(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let r=this.Rs;return oe.forEach(t.mutations,i=>{const a=new s(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Rs=r})}Cn(e){}containsKey(e,t){const r=new s(t,0),i=this.Rs.firstAfterOrEqual(r);return oe.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return oe.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class u{constructor(e){this.Ds=e,this.docs=new Dn(Ye.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,c=this.Ds(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:c}),this.size+=c-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return oe.resolve(r?r.document.mutableCopy():er.newInvalidDocument(t))}getEntries(e,t){let r=ts();return t.forEach(i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():er.newInvalidDocument(i))}),oe.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let a=ts();const c=t.path,h=new Ye(c.child("")),g=this.docs.getIteratorFrom(h);for(;g.hasNext();){const{key:v,value:{document:T}}=g.getNext();if(!c.isPrefixOf(v.path))break;v.path.length>c.length+1||id(YI(T),r)<=0||(i.has(T.key)||ai(t,T))&&(a=a.insert(T.key,T.mutableCopy()))}return oe.resolve(a)}getAllFromCollectionGroup(e,t,r,i){lt()}Cs(e,t){return oe.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new l(this)}getSize(e){return oe.resolve(this.size)}}class l extends nT{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.os.addEntry(e,i)):this.os.removeEntry(r)}),oe.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class d{constructor(e){this.persistence=e,this.xs=new Wc(t=>Fu(t),mf),this.lastRemoteSnapshotVersion=Ct.min(),this.highestTargetId=0,this.Ns=0,this.ks=new sT,this.targetCount=0,this.Ms=Xc.kn()}forEachTarget(e,t){return this.xs.forEach((r,i)=>t(i)),oe.resolve()}getLastRemoteSnapshotVersion(e){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return oe.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Ns&&(this.Ns=t),oe.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new Xc(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,oe.resolve()}updateTargetData(e,t){return this.Fn(t),oe.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,oe.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.xs.forEach((c,h)=>{h.sequenceNumber<=t&&null===r.get(h.targetId)&&(this.xs.delete(c),a.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)}),oe.waitFor(a).next(()=>i)}getTargetCount(e){return oe.resolve(this.targetCount)}getTargetData(e,t){const r=this.xs.get(t)||null;return oe.resolve(r)}addMatchingKeys(e,t,r){return this.ks.gs(t,r),oe.resolve()}removeMatchingKeys(e,t,r){this.ks.ps(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach(c=>{a.push(i.markPotentiallyOrphaned(e,c))}),oe.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),oe.resolve()}getMatchingKeysForTargetId(e,t){const r=this.ks.Es(t);return oe.resolve(r)}containsKey(e,t){return oe.resolve(this.ks.containsKey(t))}}class p{constructor(e,t){this.$s={},this.overlays={},this.Os=new Os(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new d(this),this.indexManager=new XC,this.remoteDocumentCache=new u(r=>this.referenceDelegate.Ls(r)),this.serializer=new qC(t),this.qs=new yN(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new vN,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.$s[e.toKey()];return r||(r=new o(t,this.referenceDelegate),this.$s[e.toKey()]=r),r}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,r){be("MemoryPersistence","Starting transaction:",e);const i=new y(this.Os.next());return this.referenceDelegate.Us(),r(i).next(a=>this.referenceDelegate.Ks(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Gs(e,t){return oe.or(Object.values(this.$s).map(r=>()=>r.containsKey(e,t)))}}class y extends XI{constructor(e){super(),this.currentSequenceNumber=e}}class C{constructor(e){this.persistence=e,this.Qs=new sT,this.js=null}static zs(e){return new C(e)}get Ws(){if(this.js)return this.js;throw lt()}addReference(e,t,r){return this.Qs.addReference(r,t),this.Ws.delete(r.toString()),oe.resolve()}removeReference(e,t,r){return this.Qs.removeReference(r,t),this.Ws.add(r.toString()),oe.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),oe.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(i=>this.Ws.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(a=>this.Ws.add(a.toString()))}).next(()=>r.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.Ws,r=>{const i=Ye.fromPath(r);return this.Hs(e,i).next(a=>{a||t.removeEntry(i,Ct.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(r=>{r?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return oe.or([()=>oe.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class R{constructor(e){this.serializer=e}O(e,t,r,i){const a=new p_("createOrUpgrade",t);var h;r<1&&i>=1&&(e.createObjectStore("owner"),(h=e).createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",m_,{unique:!0}),h.createObjectStore("documentMutations"),P(e),function(h){h.createObjectStore("remoteDocuments")}(e));let c=oe.resolve();return r<3&&i>=3&&(0!==r&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),P(e)),c=c.next(()=>function(h){const g=h.store("targetGlobal"),v={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ct.min().toTimestamp(),targetCount:0};return g.put("targetGlobalKey",v)}(a))),r<4&&i>=4&&(0!==r&&(c=c.next(()=>function(h,g){return g.store("mutations").j().next(v=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",m_,{unique:!0});const T=g.store("mutations"),S=v.map(M=>T.put(M));return oe.waitFor(S)})}(e,a))),c=c.next(()=>{!function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(c=c.next(()=>this.Ys(a))),r<6&&i>=6&&(c=c.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Xs(a)))),r<7&&i>=7&&(c=c.next(()=>this.Zs(a))),r<8&&i>=8&&(c=c.next(()=>this.ti(e,a))),r<9&&i>=9&&(c=c.next(()=>{!function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(c=c.next(()=>this.ei(a))),r<11&&i>=11&&(c=c.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(c=c.next(()=>{!function(h){const g=h.createObjectStore("documentOverlays",{keyPath:iC});g.createIndex("collectionPathOverlayIndex",wS,{unique:!1}),g.createIndex("collectionGroupOverlayIndex",ES,{unique:!1})}(e)})),r<13&&i>=13&&(c=c.next(()=>function(h){const g=h.createObjectStore("remoteDocumentsV14",{keyPath:dS});g.createIndex("documentKeyIndex",hS),g.createIndex("collectionGroupIndex",fS)}(e)).next(()=>this.ni(e,a)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(c=c.next(()=>this.si(e,a))),r<15&&i>=15&&(c=c.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:nC}).createIndex("sequenceNumberIndex",rC,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:yS}).createIndex("documentKeyIndex",vS,{unique:!1})}(e))),c}Xs(e){let t=0;return e.store("remoteDocuments").X((r,i)=>{t+=z_(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Ys(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.j().next(i=>oe.forEach(i,a=>{const c=IDBKeyRange.bound([a.userId,-1],[a.userId,a.lastAcknowledgedBatchId]);return r.j("userMutationsIndex",c).next(h=>oe.forEach(h,g=>{It(g.userId===a.userId);const v=fd(this.serializer,g);return nw(e,a.userId,v).next(()=>{})}))}))}Zs(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const a=[];return r.X((c,h)=>{const g=new yn(c),v=[0,Pi(g)];a.push(t.get(v).next(T=>T?oe.resolve():t.put({targetId:0,path:Pi(g),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>oe.waitFor(a))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:_S});const r=t.store("collectionParents"),i=new Gg,a=c=>{if(i.add(c)){const h=c.lastSegment(),g=c.popLast();return r.put({collectionId:h,parent:Pi(g)})}};return t.store("remoteDocuments").X({Y:!0},(c,h)=>{const g=new yn(c);return a(g.popLast())}).next(()=>t.store("documentMutations").X({Y:!0},([c,h,g],v)=>{const T=Ba(h);return a(T.popLast())}))}ei(e){const t=e.store("targets");return t.X((r,i)=>{const a=bf(i),c=KS(this.serializer,a);return t.put(c)})}ni(e,t){const r=t.store("remoteDocuments"),i=[];return r.X((a,c)=>{const h=t.store("remoteDocumentsV14"),g=(v=c,v.document?new Ye(yn.fromString(v.document.name).popFirst(5)):v.noDocument?Ye.fromSegments(v.noDocument.path):v.unknownDocument?Ye.fromSegments(v.unknownDocument.path):lt()).path.toArray();var v;const T={prefixPath:g.slice(0,g.length-2),collectionGroup:g[g.length-2],documentId:g[g.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};i.push(h.put(T))}).next(()=>oe.waitFor(i))}si(e,t){const r=t.store("mutations"),i=rT(this.serializer),a=new p(C.zs,this.serializer.fe);return r.j().next(c=>{const h=new Map;return c.forEach(g=>{var v;let T=null!==(v=h.get(g.userId))&&void 0!==v?v:tn();fd(this.serializer,g).keys().forEach(S=>T=T.add(S)),h.set(g.userId,T)}),oe.forEach(h,(g,v)=>{const T=new wi(v),S=pd.de(this.serializer,T),M=a.getIndexManager(T),$=G_.de(T,this.serializer,M,a.referenceDelegate);return new uA(i,$,S,M).recalculateAndSaveOverlaysForDocumentKeys(new _0(t,Os.ct),g).next()})})}}function P(n){n.createObjectStore("targetDocuments",{keyPath:gS}).createIndex("documentTargetsIndex",mS,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",pS,{unique:!0}),n.createObjectStore("targetGlobal")}const j="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Q{constructor(e,t,r,i,a,c,h,g,v,T,S=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ii=a,this.window=c,this.document=h,this.ri=v,this.oi=T,this.ui=S,this.Os=null,this.Fs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.ai=null,this.hi=null,this.li=Number.NEGATIVE_INFINITY,this.fi=M=>Promise.resolve(),!Q.D())throw new Ne(de.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new gN(this,i),this.di=t+"main",this.serializer=new qC(g),this.wi=new po(this.di,this.ui,new R(this.serializer)),this.Bs=new nA(this.referenceDelegate,this.serializer),this.remoteDocumentCache=rT(this.serializer),this.qs=new ZC,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,!1===T&&Zr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ne(de.FAILED_PRECONDITION,j);return this.gi(),this.yi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Bs.getHighestSequenceNumber(e))}).then(e=>{this.Os=new Os(e,this.ri)}).then(()=>{this.Fs=!0}).catch(e=>(this.wi&&this.wi.close(),Promise.reject(e)))}Ii(e){var t=this;return this.fi=function(){var r=(0,Ee.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.wi.B(function(){var t=(0,Ee.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget((0,Ee.Z)(function*(){t.started&&(yield t.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Te(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ti(e).next(t=>{t||(this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Ei(e)).next(t=>this.isPrimary&&!t?this.Ai(e).next(()=>!1):!!t&&this.vi(e).next(()=>!0))).catch(e=>{if(go(e))return be("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return be("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ii.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Ti(e){return ne(e).get("owner").next(t=>oe.resolve(this.Ri(t)))}Pi(e){return Te(e).delete(this.clientId)}bi(){var e=this;return(0,Ee.Z)(function*(){if(e.isPrimary&&!e.Vi(e.li,18e5)){e.li=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=Ei(r,"clientMetadata");return i.j().next(a=>{const c=e.Si(a,18e5),h=a.filter(g=>-1===c.indexOf(g));return oe.forEach(h,g=>i.delete(g.clientId)).next(()=>h)})}).catch(()=>[]);if(e._i)for(const r of t)e._i.removeItem(e.Di(r.clientId))}})()}pi(){this.hi=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.bi()).then(()=>this.pi()))}Ri(e){return!!e&&e.ownerId===this.clientId}Ei(e){return this.oi?oe.resolve(!0):ne(e).get("owner").next(t=>{if(null!==t&&this.Vi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)){if(this.Ri(t)&&this.networkEnabled)return!0;if(!this.Ri(t)){if(!t.allowTabSynchronization)throw new Ne(de.FAILED_PRECONDITION,j);return!1}}return!(!this.networkEnabled||!this.inForeground)||Te(e).j().next(r=>void 0===this.Si(r,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(t=>(this.isPrimary!==t&&be("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,Ee.Z)(function*(){e.Fs=!1,e.xi(),e.hi&&(e.hi.cancel(),e.hi=null),e.Ni(),e.ki(),yield e.wi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new _0(t,Os.ct);return e.Ai(r).next(()=>e.Pi(r))}),e.wi.close(),e.Mi()})()}Si(e,t){return e.filter(r=>this.Vi(r.updateTimeMs,t)&&!this.Ci(r.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>Te(e).j().next(t=>this.Si(t,18e5).map(r=>r.clientId)))}get started(){return this.Fs}getMutationQueue(e,t){return G_.de(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new JS(e,this.serializer.fe.databaseId)}getDocumentOverlayCache(e){return pd.de(this.serializer,e)}getBundleCache(){return this.qs}runTransaction(e,t,r){be("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",a=15===(c=this.ui)?m0:14===c?g0:13===c?y_:12===c?p0:11===c?sC:void lt();var c;let h;return this.wi.runTransaction(e,i,a,g=>(h=new _0(g,this.Os?this.Os.next():Os.ct),"readwrite-primary"===t?this.Ti(h).next(v=>!!v||this.Ei(h)).next(v=>{if(!v)throw Zr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)),new Ne(de.FAILED_PRECONDITION,QI);return r(h)}).next(v=>this.vi(h).next(()=>v)):this.Oi(h).next(()=>r(h)))).then(g=>(h.raiseOnCommittedEvent(),g))}Oi(e){return ne(e).get("owner").next(t=>{if(null!==t&&this.Vi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)&&!this.Ri(t)&&!(this.oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ne(de.FAILED_PRECONDITION,j)})}vi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ne(e).put("owner",t)}static D(){return po.D()}Ai(e){const t=ne(e);return t.get("owner").next(r=>this.Ri(r)?(be("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):oe.resolve())}Vi(e,t){const r=Date.now();return!(e<r-t||e>r&&(Zr(`Detected an update time that is in the future: ${e} > ${r}`),1))}gi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ai=()=>{this.ii.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.mi()))},this.document.addEventListener("visibilitychange",this.ai),this.inForeground="visible"===this.document.visibilityState)}Ni(){this.ai&&(this.document.removeEventListener("visibilitychange",this.ai),this.ai=null)}yi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=()=>{this.xi();const t=/(?:Version|Mobile)\/1[456]/;(0,U.G6)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ii.enterRestrictedMode(!0),this.ii.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}ki(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Ci(e){var t;try{const r=null!==(null===(t=this._i)||void 0===t?void 0:t.getItem(this.Di(e)));return be("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Zr("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this._i)try{this._i.setItem(this.Di(this.clientId),String(Date.now()))}catch(e){Zr("Failed to set zombie client id.",e)}}Mi(){if(this._i)try{this._i.removeItem(this.Di(this.clientId))}catch{}}Di(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ne(n){return Ei(n,"owner")}function Te(n){return Ei(n,"clientMetadata")}function ze(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Qe{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Fi=r,this.Bi=i}static Li(e,t){let r=tn(),i=tn();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Qe(e,t.fromCache,r,i)}}class mt{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,r,i){return this.Ki(e,t).next(a=>a||this.Gi(e,t,i,r)).next(a=>a||this.Qi(e,t))}Ki(e,t){if(b_(t))return oe.resolve(null);let r=es(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=Pg(t,null,"F"),r=es(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const c=tn(...a);return this.Ui.getDocuments(e,c).next(h=>this.indexManager.getMinOffset(e,r).next(g=>{const v=this.ji(t,h);return this.zi(t,v,c,g.readTime)?this.Ki(e,Pg(t,null,"F")):this.Wi(e,v,t,g)}))})))}Gi(e,t,r,i){return b_(t)||i.isEqual(Ct.min())?this.Qi(e,t):this.Ui.getDocuments(e,r).next(a=>{const c=this.ji(t,a);return this.zi(t,c,r,i)?this.Qi(e,t):(af()<=gs.in.DEBUG&&be("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),R0(t)),this.Wi(e,c,t,ZI(i,-1)))})}ji(e,t){let r=new ar(CC(e));return t.forEach((i,a)=>{ai(e,a)&&(r=r.add(a))}),r}zi(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Qi(e,t){return af()<=gs.in.DEBUG&&be("QueryEngine","Using full collection scan to execute query:",R0(t)),this.Ui.getDocumentsMatchingQuery(e,t,_s.min())}Wi(e,t,r,i){return this.Ui.getDocumentsMatchingQuery(e,r,i).next(a=>(t.forEach(c=>{a=a.insert(c.key,c)}),a))}}class Lt{constructor(e,t,r,i){this.persistence=e,this.Hi=t,this.serializer=i,this.Ji=new Dn(Ut),this.Yi=new Wc(a=>Fu(a),mf),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(r)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new uA(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function Oe(n,e,t,r){return new Lt(n,e,t,r)}function qt(n,e){return Gn.apply(this,arguments)}function Gn(){return Gn=(0,Ee.Z)(function*(n,e){const t=Xe(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(a=>(i=a,t.tr(e),t.mutationQueue.getAllMutationBatches(r))).next(a=>{const c=[],h=[];let g=tn();for(const v of i){c.push(v.batchId);for(const T of v.mutations)g=g.add(T.key)}for(const v of a){h.push(v.batchId);for(const T of v.mutations)g=g.add(T.key)}return t.localDocuments.getDocuments(r,g).next(v=>({er:v,removedBatchIds:c,addedBatchIds:h}))})})}),Gn.apply(this,arguments)}function cA(n){const e=Xe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Bs.getLastRemoteSnapshotVersion(t))}function wN(n,e,t){let r=tn(),i=tn();return t.forEach(a=>r=r.add(a)),e.getEntries(n,r).next(a=>{let c=ts();return t.forEach((h,g)=>{const v=a.get(h);g.isFoundDocument()!==v.isFoundDocument()&&(i=i.add(h)),g.isNoDocument()&&g.version.isEqual(Ct.min())?(e.removeEntry(h,g.readTime),c=c.insert(h,g)):!v.isValidDocument()||g.version.compareTo(v.version)>0||0===g.version.compareTo(v.version)&&v.hasPendingWrites?(e.addEntry(g),c=c.insert(h,g)):be("LocalStore","Ignoring outdated watch update for ",h,". Current version:",v.version," Watch version:",g.version)}),{nr:c,sr:i}})}function bL(n,e){const t=Xe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function K_(n,e){const t=Xe(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Bs.getTargetData(r,e).next(a=>a?(i=a,oe.resolve(i)):t.Bs.allocateTargetId(r).next(c=>(i=new Hu(e,c,"TargetPurposeListen",r.currentSequenceNumber),t.Bs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.Ji.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ji=t.Ji.insert(r.targetId,r),t.Yi.set(e,r.targetId)),r})}function Z_(n,e,t){return lA.apply(this,arguments)}function lA(){return lA=(0,Ee.Z)(function*(n,e,t){const r=Xe(n),i=r.Ji.get(e),a=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",a,c=>r.persistence.referenceDelegate.removeTarget(c,i)))}catch(c){if(!go(c))throw c;be("LocalStore",`Failed to update sequence numbers for target ${e}: ${c}`)}r.Ji=r.Ji.remove(e),r.Yi.delete(i.target)}),lA.apply(this,arguments)}function oT(n,e,t){const r=Xe(n);let i=Ct.min(),a=tn();return r.persistence.runTransaction("Execute query","readonly",c=>function(h,g,v){const T=Xe(h),S=T.Yi.get(v);return void 0!==S?oe.resolve(T.Ji.get(S)):T.Bs.getTargetData(g,v)}(r,c,es(e)).next(h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(c,h.targetId).next(g=>{a=g})}).next(()=>r.Hi.getDocumentsMatchingQuery(c,e,t?i:Ct.min(),t?a:tn())).next(h=>(CN(r,cd(e),h),{documents:h,ir:a})))}function EN(n,e){const t=Xe(n),r=Xe(t.Bs),i=t.Ji.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",a=>r.le(a,e).next(c=>c?c.target:null))}function IN(n,e){const t=Xe(n),r=t.Xi.get(e)||Ct.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Zi.getAllFromCollectionGroup(i,e,ZI(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(CN(t,e,i),i))}function CN(n,e,t){let r=n.Xi.get(e)||Ct.min();t.forEach((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),n.Xi.set(e,r)}function dA(){return dA=(0,Ee.Z)(function*(n,e,t,r){const i=Xe(n);let a=tn(),c=ts();for(const v of t){const T=e.rr(v.metadata.name);v.document&&(a=a.add(T));const S=e.ur(v);S.setReadTime(e.cr(v.metadata.readTime)),c=c.insert(T,S)}const h=i.Zi.newChangeBuffer({trackRemovals:!0}),g=yield K_(i,(v=r,es(ud(yn.fromString(`__bundle__/docs/${v}`)))));var v;return i.persistence.runTransaction("Apply bundle documents","readwrite",v=>wN(v,h,c).next(T=>(h.apply(v),T)).next(T=>i.Bs.removeMatchingKeysForTargetId(v,g.targetId).next(()=>i.Bs.addMatchingKeys(v,a,g.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(v,T.nr,T.sr)).next(()=>T.nr)))}),dA.apply(this,arguments)}function AL(n,e){return hA.apply(this,arguments)}function hA(){return hA=(0,Ee.Z)(function*(n,e,t=tn()){const r=yield K_(n,es(jg(e.bundledQuery))),i=Xe(n);return i.persistence.runTransaction("Save named query","readwrite",a=>{const c=Nr(e.readTime);if(r.snapshotVersion.compareTo(c)>=0)return i.qs.saveNamedQuery(a,e);const h=r.withResumeToken(Yr.EMPTY_BYTE_STRING,c);return i.Ji=i.Ji.insert(h.targetId,h),i.Bs.updateTargetData(a,h).next(()=>i.Bs.removeMatchingKeysForTargetId(a,r.targetId)).next(()=>i.Bs.addMatchingKeys(a,t,r.targetId)).next(()=>i.qs.saveNamedQuery(a,e))})}),hA.apply(this,arguments)}function TN(n,e){return`firestore_clients_${n}_${e}`}function DN(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function fA(n,e){return`firestore_targets_${n}_${e}`}class aT{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static ar(e,t,r){const i=JSON.parse(r);let a,c="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return c&&i.error&&(c="string"==typeof i.error.message&&"string"==typeof i.error.code,c&&(a=new Ne(i.error.code,i.error.message))),c?new aT(e,t,i.state,a):(Zr("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ow{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static ar(e,t){const r=JSON.parse(t);let i,a="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return a&&r.error&&(a="string"==typeof r.error.message&&"string"==typeof r.error.code,a&&(i=new Ne(r.error.code,r.error.message))),a?new ow(e,r.state,i):(Zr("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class uT{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static ar(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,a=N_();for(let c=0;i&&c<r.activeTargetIds.length;++c)i=h0(r.activeTargetIds[c]),a=a.add(r.activeTargetIds[c]);return i?new uT(e,a):(Zr("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class pA{constructor(e,t){this.clientId=e,this.onlineState=t}static ar(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new pA(t.clientId,t.onlineState):(Zr("SharedClientState",`Failed to parse online state: ${e}`),null)}}class gA{constructor(){this.activeTargetIds=N_()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class mA{constructor(e,t,r,i,a){this.window=e,this.ii=t,this.persistenceKey=r,this.wr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.mr.bind(this),this.gr=new Dn(Ut),this.started=!1,this.yr=[];const c=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.pr=TN(this.persistenceKey,this.wr),this.Ir=`firestore_sequence_number_${this.persistenceKey}`,this.gr=this.gr.insert(this.wr,new gA),this.Tr=new RegExp(`^firestore_clients_${c}_([^_]*)$`),this.Er=new RegExp(`^firestore_mutations_${c}_(\\d+)(?:_(.*))?$`),this.Ar=new RegExp(`^firestore_targets_${c}_(\\d+)$`),this.vr=`firestore_online_state_${this.persistenceKey}`,this.Rr=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this._r)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,Ee.Z)(function*(){const t=yield e.syncEngine.$i();for(const i of t){if(i===e.wr)continue;const a=e.getItem(TN(e.persistenceKey,i));if(a){const c=uT.ar(i,a);c&&(e.gr=e.gr.insert(c.clientId,c))}}e.Pr();const r=e.storage.getItem(e.vr);if(r){const i=e.br(r);i&&e.Vr(i)}for(const i of e.yr)e.mr(i);e.yr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.Ir,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Sr(this.gr)}isActiveQueryTarget(e){let t=!1;return this.gr.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Dr(e,"pending")}updateMutationState(e,t,r){this.Dr(e,t,r),this.Cr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(fA(this.persistenceKey,e));if(r){const i=ow.ar(e,r);i&&(t=i.state)}}return this.Nr.lr(e),this.Pr(),t}removeLocalQueryTarget(e){this.Nr.dr(e),this.Pr()}isLocalQueryTarget(e){return this.Nr.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(fA(this.persistenceKey,e))}updateQueryState(e,t,r){this.kr(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Cr(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Mr(e)}notifyBundleLoaded(e){this.$r(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.pr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return be("SharedClientState","READ",e,t),t}setItem(e,t){be("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){be("SharedClientState","REMOVE",e),this.storage.removeItem(e)}mr(e){var t=this;const r=e;if(r.storageArea===this.storage){if(be("SharedClientState","EVENT",r.key,r.newValue),r.key===this.pr)return void Zr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable((0,Ee.Z)(function*(){if(t.started){if(null!==r.key)if(t.Tr.test(r.key)){if(null==r.newValue){const i=t.Or(r.key);return t.Fr(i,null)}{const i=t.Br(r.key,r.newValue);if(i)return t.Fr(i.clientId,i)}}else if(t.Er.test(r.key)){if(null!==r.newValue){const i=t.Lr(r.key,r.newValue);if(i)return t.qr(i)}}else if(t.Ar.test(r.key)){if(null!==r.newValue){const i=t.Ur(r.key,r.newValue);if(i)return t.Kr(i)}}else if(r.key===t.vr){if(null!==r.newValue){const i=t.br(r.newValue);if(i)return t.Vr(i)}}else if(r.key===t.Ir){const i=function(a){let c=Os.ct;if(null!=a)try{const h=JSON.parse(a);It("number"==typeof h),c=h}catch(h){Zr("SharedClientState","Failed to read sequence number from WebStorage",h)}return c}(r.newValue);i!==Os.ct&&t.sequenceNumberHandler(i)}else if(r.key===t.Rr){const i=t.Gr(r.newValue);yield Promise.all(i.map(a=>t.syncEngine.Qr(a)))}}else t.yr.push(r)}))}}get Nr(){return this.gr.get(this.wr)}Pr(){this.setItem(this.pr,this.Nr.hr())}Dr(e,t,r){const i=new aT(this.currentUser,e,t,r),a=DN(this.persistenceKey,this.currentUser,e);this.setItem(a,i.hr())}Cr(e){const t=DN(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Mr(e){this.storage.setItem(this.vr,JSON.stringify({clientId:this.wr,onlineState:e}))}kr(e,t,r){const i=fA(this.persistenceKey,e),a=new ow(e,t,r);this.setItem(i,a.hr())}$r(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Rr,t)}Or(e){const t=this.Tr.exec(e);return t?t[1]:null}Br(e,t){const r=this.Or(e);return uT.ar(r,t)}Lr(e,t){const r=this.Er.exec(e),i=Number(r[1]);return aT.ar(new wi(void 0!==r[2]?r[2]:null),i,t)}Ur(e,t){const r=this.Ar.exec(e),i=Number(r[1]);return ow.ar(i,t)}br(e){return pA.ar(e)}Gr(e){return JSON.parse(e)}qr(e){var t=this;return(0,Ee.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.jr(e.batchId,e.state,e.error);be("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Kr(e){return this.syncEngine.zr(e.targetId,e.state,e.error)}Fr(e,t){const r=t?this.gr.insert(e,t):this.gr.remove(e),i=this.Sr(this.gr),a=this.Sr(r),c=[],h=[];return a.forEach(g=>{i.has(g)||c.push(g)}),i.forEach(g=>{a.has(g)||h.push(g)}),this.syncEngine.Wr(c,h).then(()=>{this.gr=r})}Vr(e){this.gr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Sr(e){let t=N_();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class bN{constructor(){this.Hr=new gA,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,r){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new gA,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class RL{Yr(e){}shutdown(){}}class SN{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){be("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){be("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let cT=null;function _A(){return null===cT?cT=268435456+Math.round(2147483648*Math.random()):cT++,"0x"+cT.toString(16)}const xL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class PL{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const vs="WebChannelConnection";class NL extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.mo=(e.ssl?"https":"http")+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,r,i,a){const c=_A(),h=this.To(e,t);be("RestConnection",`Sending RPC '${e}' ${c}:`,h,r);const g={};return this.Eo(g,i,a),this.Ao(e,h,g,r).then(v=>(be("RestConnection",`Received RPC '${e}' ${c}: `,v),v),v=>{throw ks("RestConnection",`RPC '${e}' ${c} failed with error: `,v,"url: ",h,"request:",r),v})}vo(e,t,r,i,a,c){return this.Io(e,t,r,i,a)}Eo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Qo,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,a)=>e[a]=i),r&&r.headers.forEach((i,a)=>e[a]=i)}To(e,t){return`${this.mo}/v1/${t}:${xL[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,r,i){const a=_A();return new Promise((c,h)=>{const g=new iN;g.setWithCredentials(!0),g.listenOnce(rN.COMPLETE,()=>{try{switch(g.getLastErrorCode()){case Lc.NO_ERROR:const T=g.getResponseJson();be(vs,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(T)),c(T);break;case Lc.TIMEOUT:be(vs,`RPC '${e}' ${a} timed out`),h(new Ne(de.DEADLINE_EXCEEDED,"Request time out"));break;case Lc.HTTP_ERROR:const S=g.getStatus();if(be(vs,`RPC '${e}' ${a} failed with status:`,S,"response text:",g.getResponseText()),S>0){let M=g.getResponseJson();Array.isArray(M)&&(M=M[0]);const $=M?.error;if($&&$.status&&$.message){const Y=function(fe){const ge=fe.toLowerCase().replace(/_/g,"-");return Object.values(de).indexOf(ge)>=0?ge:de.UNKNOWN}($.status);h(new Ne(Y,$.message))}else h(new Ne(de.UNKNOWN,"Server responded with status "+g.getStatus()))}else h(new Ne(de.UNAVAILABLE,"Connection failed."));break;default:lt()}}finally{be(vs,`RPC '${e}' ${a} completed.`)}});const v=JSON.stringify(i);be(vs,`RPC '${e}' ${a} sending request:`,i),g.send(t,"POST",v,r,15)})}Ro(e,t,r){const i=_A(),a=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=Qb(),h=Xb(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;void 0!==v&&(g.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(g.xmlHttpFactory=new jI({})),this.Eo(g.initMessageHeaders,t,r),g.encodeInitMessageHeaders=!0;const T=a.join("");be(vs,`Creating RPC '${e}' stream ${i}: ${T}`,g);const S=c.createWebChannel(T,g);let M=!1,$=!1;const Y=new PL({ro:ge=>{$?be(vs,`Not sending because RPC '${e}' stream ${i} is closed:`,ge):(M||(be(vs,`Opening RPC '${e}' stream ${i} transport.`),S.open(),M=!0),be(vs,`RPC '${e}' stream ${i} sending:`,ge),S.send(ge))},oo:()=>S.close()}),fe=(ge,et,it)=>{ge.listen(et,Ze=>{try{it(Ze)}catch(ht){setTimeout(()=>{throw ht},0)}})};return fe(S,_g.EventType.OPEN,()=>{$||be(vs,`RPC '${e}' stream ${i} transport opened.`)}),fe(S,_g.EventType.CLOSE,()=>{$||($=!0,be(vs,`RPC '${e}' stream ${i} transport closed`),Y.wo())}),fe(S,_g.EventType.ERROR,ge=>{$||($=!0,ks(vs,`RPC '${e}' stream ${i} transport errored:`,ge),Y.wo(new Ne(de.UNAVAILABLE,"The operation could not be completed")))}),fe(S,_g.EventType.MESSAGE,ge=>{var et;if(!$){const it=ge.data[0];It(!!it);const ht=it.error||(null===(et=it[0])||void 0===et?void 0:et.error);if(ht){be(vs,`RPC '${e}' stream ${i} received error:`,ht);const Bt=ht.status;let on=function(na){const Ty=ui[na];if(void 0!==Ty)return FS(Ty)}(Bt),Ci=ht.message;void 0===on&&(on=de.INTERNAL,Ci="Unknown error status: "+Bt+" with message "+ht.message),$=!0,Y.wo(new Ne(on,Ci)),S.close()}else be(vs,`RPC '${e}' stream ${i} received:`,it),Y._o(it)}}),fe(h,u0.STAT_EVENT,ge=>{ge.stat===Jb.PROXY?be(vs,`RPC '${e}' stream ${i} detected buffering proxy`):ge.stat===Jb.NOPROXY&&be(vs,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{Y.fo()},0),Y}}function AN(){return typeof window<"u"?window:null}function lT(){return typeof document<"u"?document:null}function aw(n){return new jS(n,!0)}class yA{constructor(e,t,r=1e3,i=1.5,a=6e4){this.ii=e,this.timerId=t,this.Po=r,this.bo=i,this.Vo=a,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),r=Math.max(0,Date.now()-this.Co),i=Math.max(0,t-r);i>0&&be("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class RN{constructor(e,t,r,i,a,c,h,g){this.ii=e,this.$o=r,this.Oo=i,this.connection=a,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=h,this.listener=g,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new yA(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}stop(){var e=this;return(0,Ee.Z)(function*(){e.Uo()&&(yield e.close(0))})()}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}zo(){var e=this;return(0,Ee.Z)(function*(){if(e.Ko())return e.close(0)})()}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}close(e,t){var r=this;return(0,Ee.Z)(function*(){r.Ho(),r.Jo(),r.qo.cancel(),r.Fo++,4!==e?r.qo.reset():t&&t.code===de.RESOURCE_EXHAUSTED?(Zr(t.toString()),Zr("Using maximum backoff delay to prevent overloading the backend."),r.qo.xo()):t&&t.code===de.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Yo(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.ao(t)})()}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Fo===t&&this.Zo(r,i)},r=>{e(()=>{const i=new Ne(de.UNKNOWN,"Fetching auth token failed: "+r.message);return this.tu(i)})})}Zo(e,t){const r=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{r(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(i=>{r(()=>this.tu(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Go(){var e=this;this.state=5,this.qo.No((0,Ee.Z)(function*(){e.state=0,e.start()}))}tu(e){return be("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(be("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class ML extends RN{constructor(e,t,r,i,a,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,c),this.serializer=a}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function G0(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(g=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===g?1:"REMOVE"===g?2:"CURRENT"===g?3:"RESET"===g?4:lt(),i=e.targetChange.targetIds||[],a=function(g,v){return g.useProto3Json?(It(void 0===v||"string"==typeof v),Yr.fromBase64String(v||"")):(It(void 0===v||v instanceof Uint8Array),Yr.fromUint8Array(v||new Uint8Array))}(n,e.targetChange.resumeToken),c=e.targetChange.cause,h=c&&function(g){const v=void 0===g.code?de.UNKNOWN:FS(g.code);return new Ne(v,g.message||"")}(c);t=new LC(r,i,a,h||null)}else if("documentChange"in e){const r=e.documentChange,i=vo(n,r.document.name),a=Nr(r.document.updateTime),c=r.document.createTime?Nr(r.document.createTime):Ct.min(),h=new Ii({mapValue:{fields:r.document.fields}}),g=er.newFoundDocument(i,a,c,h);t=new $0(r.targetIds||[],r.removedTargetIds||[],g.key,g)}else if("documentDelete"in e){const r=e.documentDelete,i=vo(n,r.document),a=r.readTime?Nr(r.readTime):Ct.min(),c=er.newNoDocument(i,a);t=new $0([],r.removedTargetIds||[],c.key,c)}else if("documentRemove"in e){const r=e.documentRemove,i=vo(n,r.document);t=new $0([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return lt();{const r=e.filter,{count:i=0,unchangedNames:a}=r,c=new uN(i,a);t=new US(r.targetId,c)}}var g;return t}(this.serializer,e),r=function(i){if(!("targetChange"in i))return Ct.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Ct.min():a.readTime?Nr(a.readTime):Ct.min()}(e);return this.listener.nu(t,r)}su(e){const t={};t.database=Gi(this.serializer),t.addTarget=function(i,a){let c;const h=a.target;if(c=_f(h)?{documents:W0(i,h)}:{query:B_(i,h)},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=VC(i,a.resumeToken);const g=H0(i,a.expectedCount);null!==g&&(c.expectedCount=g)}else if(a.snapshotVersion.compareTo(Ct.min())>0){c.readTime=Ug(i,a.snapshotVersion.toTimestamp());const g=H0(i,a.expectedCount);null!==g&&(c.expectedCount=g)}return c}(this.serializer,e);const r=function GC(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return lt()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.Wo(t)}iu(e){const t={};t.database=Gi(this.serializer),t.removeTarget=e,this.Wo(t)}}class kL extends RN{constructor(e,t,r,i,a,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,c),this.serializer=a,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(It(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function zS(n,e){return n&&n.length>0?(It(void 0!==e),n.map(t=>function(r,i){let a=Nr(r.updateTime?r.updateTime:i);return a.isEqual(Ct.min())&&(a=Nr(i)),new AC(a,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=Nr(e.commitTime);return this.listener.cu(r,t)}return It(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=Gi(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Tf(this.serializer,r))};this.Wo(t)}}class OL extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new Ne(de.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Io(e,t,r,i,a)).catch(i=>{throw"FirebaseError"===i.name?(i.code===de.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ne(de.UNKNOWN,i.toString())})}vo(e,t,r,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.vo(e,t,r,a,c,i)).catch(a=>{throw"FirebaseError"===a.name?(a.code===de.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ne(de.UNKNOWN,a.toString())})}terminate(){this.lu=!0}}class FL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Zr(t),this.mu=!1):be("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class UL{constructor(e,t,r,i,a){var c=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=a,this.Pu.Yr(h=>{r.enqueueAndForget((0,Ee.Z)(function*(){var g;Pf(c)&&(be("RemoteStore","Restarting streams for network reachability change."),yield(g=(0,Ee.Z)(function*(v){const T=Xe(v);T.vu.add(4),yield Y_(T),T.bu.set("Unknown"),T.vu.delete(4),yield uw(T)}),function(v){return g.apply(this,arguments)})(c))}))}),this.bu=new FL(r,i)}}function uw(n){return wA.apply(this,arguments)}function wA(){return wA=(0,Ee.Z)(function*(n){if(Pf(n))for(const e of n.Ru)yield e(!0)}),wA.apply(this,arguments)}function Y_(n){return EA.apply(this,arguments)}function EA(){return EA=(0,Ee.Z)(function*(n){for(const e of n.Ru)yield e(!1)}),EA.apply(this,arguments)}function dT(n,e){const t=Xe(n);t.Au.has(e.targetId)||(t.Au.set(e.targetId,e),TA(t)?CA(t):X_(t).Ko()&&IA(t,e))}function cw(n,e){const t=Xe(n),r=X_(t);t.Au.delete(e),r.Ko()&&xN(t,e),0===t.Au.size&&(r.Ko()?r.jo():Pf(t)&&t.bu.set("Unknown"))}function IA(n,e){if(n.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ct.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}X_(n).su(e)}function xN(n,e){n.Vu.qt(e),X_(n).iu(e)}function CA(n){n.Vu=new F_({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),le:e=>n.Au.get(e)||null,ue:()=>n.datastore.serializer.databaseId}),X_(n).start(),n.bu.gu()}function TA(n){return Pf(n)&&!X_(n).Uo()&&n.Au.size>0}function Pf(n){return 0===Xe(n).vu.size}function PN(n){n.Vu=void 0}function VL(n){return DA.apply(this,arguments)}function DA(){return DA=(0,Ee.Z)(function*(n){n.Au.forEach((e,t)=>{IA(n,e)})}),DA.apply(this,arguments)}function BL(n,e){return bA.apply(this,arguments)}function bA(){return bA=(0,Ee.Z)(function*(n,e){PN(n),TA(n)?(n.bu.Iu(e),CA(n)):n.bu.set("Unknown")}),bA.apply(this,arguments)}function jL(n,e,t){return SA.apply(this,arguments)}function SA(){return SA=(0,Ee.Z)(function*(n,e,t){if(n.bu.set("Online"),e instanceof LC&&2===e.state&&e.cause)try{yield(r=(0,Ee.Z)(function*(i,a){const c=a.cause;for(const h of a.targetIds)i.Au.has(h)&&(yield i.remoteSyncer.rejectListen(h,c),i.Au.delete(h),i.Vu.removeTarget(h))}),function(i,a){return r.apply(this,arguments)})(n,e)}catch(r){be("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield hT(n,r)}else if(e instanceof $0?n.Vu.Ht(e):e instanceof US?n.Vu.ne(e):n.Vu.Xt(e),!t.isEqual(Ct.min()))try{const r=yield cA(n.localStore);t.compareTo(r)>=0&&(yield function(i,a){const c=i.Vu.ce(a);return c.targetChanges.forEach((h,g)=>{if(h.resumeToken.approximateByteSize()>0){const v=i.Au.get(g);v&&i.Au.set(g,v.withResumeToken(h.resumeToken,a))}}),c.targetMismatches.forEach((h,g)=>{const v=i.Au.get(h);if(!v)return;i.Au.set(h,v.withResumeToken(Yr.EMPTY_BYTE_STRING,v.snapshotVersion)),xN(i,h);const T=new Hu(v.target,h,g,v.sequenceNumber);IA(i,T)}),i.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(r){be("RemoteStore","Failed to raise snapshot:",r),yield hT(n,r)}var r}),SA.apply(this,arguments)}function hT(n,e,t){return AA.apply(this,arguments)}function AA(){return AA=(0,Ee.Z)(function*(n,e,t){if(!go(e))throw e;n.vu.add(1),yield Y_(n),n.bu.set("Offline"),t||(t=()=>cA(n.localStore)),n.asyncQueue.enqueueRetryable((0,Ee.Z)(function*(){be("RemoteStore","Retrying IndexedDB access"),yield t(),n.vu.delete(1),yield uw(n)}))}),AA.apply(this,arguments)}function NN(n,e){return e().catch(t=>hT(n,t,e))}function Q_(n){return RA.apply(this,arguments)}function RA(){return RA=(0,Ee.Z)(function*(n){const e=Xe(n),t=Nf(e);let r=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;$L(e);)try{const i=yield bL(e.localStore,r);if(null===i){0===e.Eu.length&&t.jo();break}r=i.batchId,HL(e,i)}catch(i){yield hT(e,i)}MN(e)&&kN(e)}),RA.apply(this,arguments)}function $L(n){return Pf(n)&&n.Eu.length<10}function HL(n,e){n.Eu.push(e);const t=Nf(n);t.Ko()&&t.ou&&t.uu(e.mutations)}function MN(n){return Pf(n)&&!Nf(n).Uo()&&n.Eu.length>0}function kN(n){Nf(n).start()}function zL(n){return xA.apply(this,arguments)}function xA(){return xA=(0,Ee.Z)(function*(n){Nf(n).hu()}),xA.apply(this,arguments)}function GL(n){return PA.apply(this,arguments)}function PA(){return PA=(0,Ee.Z)(function*(n){const e=Nf(n);for(const t of n.Eu)e.uu(t.mutations)}),PA.apply(this,arguments)}function WL(n,e,t){return NA.apply(this,arguments)}function NA(){return NA=(0,Ee.Z)(function*(n,e,t){const r=n.Eu.shift(),i=MC.from(r,e,t);yield NN(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Q_(n)}),NA.apply(this,arguments)}function qL(n,e){return MA.apply(this,arguments)}function MA(){return MA=(0,Ee.Z)(function*(n,e){var t;e&&Nf(n).ou&&(yield(t=(0,Ee.Z)(function*(r,i){if(LS(a=i.code)&&a!==de.ABORTED){const c=r.Eu.shift();Nf(r).Qo(),yield NN(r,()=>r.remoteSyncer.rejectFailedWrite(c.batchId,i)),yield Q_(r)}var a}),function(r,i){return t.apply(this,arguments)})(n,e)),MN(n)&&kN(n)}),MA.apply(this,arguments)}function ON(n,e){return kA.apply(this,arguments)}function kA(){return kA=(0,Ee.Z)(function*(n,e){const t=Xe(n);t.asyncQueue.verifyOperationInProgress(),be("RemoteStore","RemoteStore received new credentials");const r=Pf(t);t.vu.add(3),yield Y_(t),r&&t.bu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.vu.delete(3),yield uw(t)}),kA.apply(this,arguments)}function OA(n,e){return LA.apply(this,arguments)}function LA(){return LA=(0,Ee.Z)(function*(n,e){const t=Xe(n);e?(t.vu.delete(2),yield uw(t)):e||(t.vu.add(2),yield Y_(t),t.bu.set("Unknown"))}),LA.apply(this,arguments)}function X_(n){return n.Su||(n.Su=function(e,t,r){const i=Xe(e);return i.fu(),new ML(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{uo:VL.bind(null,n),ao:BL.bind(null,n),nu:jL.bind(null,n)}),n.Ru.push(function(){var e=(0,Ee.Z)(function*(t){t?(n.Su.Qo(),TA(n)?CA(n):n.bu.set("Unknown")):(yield n.Su.stop(),PN(n))});return function(t){return e.apply(this,arguments)}}())),n.Su}function Nf(n){return n.Du||(n.Du=function(e,t,r){const i=Xe(e);return i.fu(),new kL(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{uo:zL.bind(null,n),ao:qL.bind(null,n),au:GL.bind(null,n),cu:WL.bind(null,n)}),n.Ru.push(function(){var e=(0,Ee.Z)(function*(t){t?(n.Du.Qo(),yield Q_(n)):(yield n.Du.stop(),n.Eu.length>0&&(be("RemoteStore",`Stopping write stream with ${n.Eu.length} pending writes`),n.Eu=[]))});return function(t){return e.apply(this,arguments)}}())),n.Du}class FA{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new oi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(c=>{})}static createAndSchedule(e,t,r,i,a){const c=Date.now()+r,h=new FA(e,t,c,i,a);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ne(de.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function J_(n,e){if(Zr("AsyncQueue",`${e}: ${n}`),go(n))return new Ne(de.UNAVAILABLE,`${e}: ${n}`);throw n}class ey{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Ye.comparator(t.key,r.key):(t,r)=>Ye.comparator(t.key,r.key),this.keyedMap=Vu(),this.sortedSet=new Dn(this.comparator)}static emptySet(e){return new ey(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ey)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new ey;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class LN{constructor(){this.Cu=new Dn(Ye.comparator)}track(e){const t=e.doc.key,r=this.Cu.get(t);r?0!==e.type&&3===r.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==r.type?this.Cu=this.Cu.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.Cu=this.Cu.remove(t):1===e.type&&2===r.type?this.Cu=this.Cu.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):lt():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,r)=>{e.push(r)}),e}}class ty{constructor(e,t,r,i,a,c,h,g,v){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=c,this.syncStateChanged=h,this.excludesMetadataChanges=g,this.hasCachedResults=v}static fromInitialDocuments(e,t,r,i,a){const c=[];return t.forEach(h=>{c.push({type:0,doc:h})}),new ty(e,t,ey.emptySet(t),c,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ng(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class KL{constructor(){this.Nu=void 0,this.listeners=[]}}class ZL{constructor(){this.queries=new Wc(e=>A0(e),Ng),this.onlineState="Unknown",this.ku=new Set}}function UA(n,e){return VA.apply(this,arguments)}function VA(){return VA=(0,Ee.Z)(function*(n,e){const t=Xe(n),r=e.query;let i=!1,a=t.queries.get(r);if(a||(i=!0,a=new KL),i)try{a.Nu=yield t.onListen(r)}catch(c){const h=J_(c,`Initialization of query '${R0(e.query)}' failed`);return void e.onError(h)}t.queries.set(r,a),a.listeners.push(e),e.Mu(t.onlineState),a.Nu&&e.$u(a.Nu)&&$A(t)}),VA.apply(this,arguments)}function BA(n,e){return jA.apply(this,arguments)}function jA(){return jA=(0,Ee.Z)(function*(n,e){const t=Xe(n),r=e.query;let i=!1;const a=t.queries.get(r);if(a){const c=a.listeners.indexOf(e);c>=0&&(a.listeners.splice(c,1),i=0===a.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),jA.apply(this,arguments)}function YL(n,e){const t=Xe(n);let r=!1;for(const i of e){const c=t.queries.get(i.query);if(c){for(const h of c.listeners)h.$u(i)&&(r=!0);c.Nu=i}}r&&$A(t)}function QL(n,e,t){const r=Xe(n),i=r.queries.get(e);if(i)for(const a of i.listeners)a.onError(t);r.queries.delete(e)}function $A(n){n.ku.forEach(e=>{e.next()})}class HA{constructor(e,t,r){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=r||{}}$u(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new ty(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){return!e.fromCache||(!this.options.Ku||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Uu(e){e=ty.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class XL{constructor(e,t){this.Gu=e,this.byteLength=t}Qu(){return"metadata"in this.Gu}}class FN{constructor(e){this.serializer=e}rr(e){return vo(this.serializer,e)}ur(e){return e.metadata.exists?HC(this.serializer,e.document,!1):er.newNoDocument(this.rr(e.metadata.name),this.cr(e.metadata.readTime))}cr(e){return Nr(e)}}class JL{constructor(e,t,r){this.ju=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=UN(e)}zu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Gu.namedQuery)this.queries.push(e.Gu.namedQuery);else if(e.Gu.documentMetadata){this.documents.push({metadata:e.Gu.documentMetadata}),e.Gu.documentMetadata.exists||++t;const r=yn.fromString(e.Gu.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Gu.document&&(this.documents[this.documents.length-1].document=e.Gu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Wu(e){const t=new Map,r=new FN(this.serializer);for(const i of e)if(i.metadata.queries){const a=r.rr(i.metadata.name);for(const c of i.metadata.queries){const h=(t.get(c)||tn()).add(a);t.set(c,h)}}return t}complete(){var e=this;return(0,Ee.Z)(function*(){const t=yield function SL(n,e,t,r){return dA.apply(this,arguments)}(e.localStore,new FN(e.serializer),e.documents,e.ju.id),r=e.Wu(e.documents);for(const i of e.queries)yield AL(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,Hu:e.collectionGroups,Ju:t}})()}}function UN(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class VN{constructor(e){this.key=e}}class BN{constructor(e){this.key=e}}class jN{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=tn(),this.mutatedKeys=tn(),this.tc=CC(e),this.ec=new ey(this.tc)}get nc(){return this.Yu}sc(e,t){const r=t?t.ic:new LN,i=t?t.ec:this.ec;let a=t?t.mutatedKeys:this.mutatedKeys,c=i,h=!1;const g="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,v="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((T,S)=>{const M=i.get(T),$=ai(this.query,S)?S:null,Y=!!M&&this.mutatedKeys.has(M.key),fe=!!$&&($.hasLocalMutations||this.mutatedKeys.has($.key)&&$.hasCommittedMutations);let ge=!1;M&&$?M.data.isEqual($.data)?Y!==fe&&(r.track({type:3,doc:$}),ge=!0):this.rc(M,$)||(r.track({type:2,doc:$}),ge=!0,(g&&this.tc($,g)>0||v&&this.tc($,v)<0)&&(h=!0)):!M&&$?(r.track({type:0,doc:$}),ge=!0):M&&!$&&(r.track({type:1,doc:M}),ge=!0,(g||v)&&(h=!0)),ge&&($?(c=c.add($),a=fe?a.add(T):a.delete(T)):(c=c.delete(T),a=a.delete(T)))}),null!==this.query.limit)for(;c.size>this.query.limit;){const T="F"===this.query.limitType?c.last():c.first();c=c.delete(T.key),a=a.delete(T.key),r.track({type:1,doc:T})}return{ec:c,ic:r,zi:h,mutatedKeys:a}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const a=e.ic.xu();a.sort((v,T)=>function(S,M){const $=Y=>{switch(Y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return lt()}};return $(S)-$(M)}(v.type,T.type)||this.tc(v.doc,T.doc)),this.oc(r);const c=t?this.uc():[],h=0===this.Zu.size&&this.current?1:0,g=h!==this.Xu;return this.Xu=h,0!==a.length||g?{snapshot:new ty(this.query,e.ec,i,a,e.mutatedKeys,0===h,g,!1,!!r&&r.resumeToken.approximateByteSize()>0),cc:c}:{cc:c}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new LN,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(t=>this.Yu=this.Yu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Yu=this.Yu.delete(t)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=tn(),this.ec.forEach(r=>{this.ac(r.key)&&(this.Zu=this.Zu.add(r.key))});const t=[];return e.forEach(r=>{this.Zu.has(r)||t.push(new BN(r))}),this.Zu.forEach(r=>{e.has(r)||t.push(new VN(r))}),t}hc(e){this.Yu=e.ir,this.Zu=tn();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return ty.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class eF{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class tF{constructor(e){this.key=e,this.fc=!1}}class nF{constructor(e,t,r,i,a,c){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=c,this.dc={},this.wc=new Wc(h=>A0(h),Ng),this._c=new Map,this.mc=new Set,this.gc=new Dn(Ye.comparator),this.yc=new Map,this.Ic=new sT,this.Tc={},this.Ec=new Map,this.Ac=Xc.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function rF(n,e){return zA.apply(this,arguments)}function zA(){return zA=(0,Ee.Z)(function*(n,e){const t=fR(n);let r,i;const a=t.wc.get(e);if(a)r=a.targetId,t.sharedClientState.addLocalQueryTarget(r),i=a.view.lc();else{const c=yield K_(t.localStore,es(e)),h=t.sharedClientState.addLocalQueryTarget(c.targetId);r=c.targetId,i=yield GA(t,e,r,"current"===h,c.resumeToken),t.isPrimaryClient&&dT(t.remoteStore,c)}return i}),zA.apply(this,arguments)}function GA(n,e,t,r,i){return WA.apply(this,arguments)}function WA(){return WA=(0,Ee.Z)(function*(n,e,t,r,i){n.Rc=(S,M,$)=>{return(Y=(0,Ee.Z)(function*(fe,ge,et,it){let Ze=ge.view.sc(et);Ze.zi&&(Ze=yield oT(fe.localStore,ge.query,!1).then(({documents:on})=>ge.view.sc(on,Ze)));const ht=it&&it.targetChanges.get(ge.targetId),Bt=ge.view.applyChanges(Ze,fe.isPrimaryClient,ht);return nR(fe,ge.targetId,Bt.cc),Bt.snapshot}),function(fe,ge,et,it){return Y.apply(this,arguments)})(n,S,M,$);var Y};const a=yield oT(n.localStore,e,!0),c=new jN(e,a.ir),h=c.sc(a.documents),g=Fg.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,i),v=c.applyChanges(h,n.isPrimaryClient,g);nR(n,t,v.cc);const T=new eF(e,t,c);return n.wc.set(e,T),n._c.has(t)?n._c.get(t).push(e):n._c.set(t,[e]),v.snapshot}),WA.apply(this,arguments)}function iF(n,e){return qA.apply(this,arguments)}function qA(){return qA=(0,Ee.Z)(function*(n,e){const t=Xe(n),r=t.wc.get(e),i=t._c.get(r.targetId);if(i.length>1)return t._c.set(r.targetId,i.filter(a=>!Ng(a,e))),void t.wc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Z_(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),cw(t.remoteStore,r.targetId),ny(t,r.targetId)}).catch(Vc))):(ny(t,r.targetId),yield Z_(t.localStore,r.targetId,!0))}),qA.apply(this,arguments)}function KA(){return KA=(0,Ee.Z)(function*(n,e,t){const r=pR(n);try{const i=yield function(a,c){const h=Xe(a),g=or.now(),v=c.reduce((M,$)=>M.add($.key),tn());let T,S;return h.persistence.runTransaction("Locally write mutations","readwrite",M=>{let $=ts(),Y=tn();return h.Zi.getEntries(M,v).next(fe=>{$=fe,$.forEach((ge,et)=>{et.isValidDocument()||(Y=Y.add(ge))})}).next(()=>h.localDocuments.getOverlayedDocuments(M,$)).next(fe=>{T=fe;const ge=[];for(const et of c){const it=RC(et,T.get(et.key).overlayedDocument);null!=it&&ge.push(new Ha(et.key,it,D0(it.value.mapValue),tr.exists(!0)))}return h.mutationQueue.addMutationBatch(M,g,ge,c)}).next(fe=>{S=fe;const ge=fe.applyToLocalDocumentSet(T,Y);return h.documentOverlayCache.saveOverlays(M,fe.batchId,ge)})}).then(()=>({batchId:S.batchId,changes:TC(T)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,c,h){let g=a.Tc[a.currentUser.toKey()];g||(g=new Dn(Ut)),g=g.insert(c,h),a.Tc[a.currentUser.toKey()]=g}(r,i.batchId,t),yield wd(r,i.changes),yield Q_(r.remoteStore)}catch(i){const a=J_(i,"Failed to persist write");t.reject(a)}}),KA.apply(this,arguments)}function $N(n,e){return ZA.apply(this,arguments)}function ZA(){return ZA=(0,Ee.Z)(function*(n,e){const t=Xe(n);try{const r=yield function DL(n,e){const t=Xe(n),r=e.snapshotVersion;let i=t.Ji;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const c=t.Zi.newChangeBuffer({trackRemovals:!0});i=t.Ji;const h=[];e.targetChanges.forEach((T,S)=>{const M=i.get(S);if(!M)return;h.push(t.Bs.removeMatchingKeys(a,T.removedDocuments,S).next(()=>t.Bs.addMatchingKeys(a,T.addedDocuments,S)));let $=M.withSequenceNumber(a.currentSequenceNumber);var Y,fe,ge;null!==e.targetMismatches.get(S)?$=$.withResumeToken(Yr.EMPTY_BYTE_STRING,Ct.min()).withLastLimboFreeSnapshotVersion(Ct.min()):T.resumeToken.approximateByteSize()>0&&($=$.withResumeToken(T.resumeToken,r)),i=i.insert(S,$),fe=$,ge=T,(0===(Y=M).resumeToken.approximateByteSize()||fe.snapshotVersion.toMicroseconds()-Y.snapshotVersion.toMicroseconds()>=3e8||ge.addedDocuments.size+ge.modifiedDocuments.size+ge.removedDocuments.size>0)&&h.push(t.Bs.updateTargetData(a,$))});let g=ts(),v=tn();if(e.documentUpdates.forEach(T=>{e.resolvedLimboDocuments.has(T)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(a,T))}),h.push(wN(a,c,e.documentUpdates).next(T=>{g=T.nr,v=T.sr})),!r.isEqual(Ct.min())){const T=t.Bs.getLastRemoteSnapshotVersion(a).next(S=>t.Bs.setTargetsMetadata(a,a.currentSequenceNumber,r));h.push(T)}return oe.waitFor(h).next(()=>c.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,g,v)).next(()=>g)}).then(a=>(t.Ji=i,a))}(t.localStore,e);e.targetChanges.forEach((i,a)=>{const c=t.yc.get(a);c&&(It(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?c.fc=!0:i.modifiedDocuments.size>0?It(c.fc):i.removedDocuments.size>0&&(It(c.fc),c.fc=!1))}),yield wd(t,r,e)}catch(r){yield Vc(r)}}),ZA.apply(this,arguments)}function HN(n,e,t){const r=Xe(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.wc.forEach((a,c)=>{const h=c.view.Mu(e);h.snapshot&&i.push(h.snapshot)}),function(a,c){const h=Xe(a);h.onlineState=c;let g=!1;h.queries.forEach((v,T)=>{for(const S of T.listeners)S.Mu(c)&&(g=!0)}),g&&$A(h)}(r.eventManager,e),i.length&&r.dc.nu(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function oF(n,e,t){return YA.apply(this,arguments)}function YA(){return YA=(0,Ee.Z)(function*(n,e,t){const r=Xe(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.yc.get(e),a=i&&i.key;if(a){let c=new Dn(Ye.comparator);c=c.insert(a,er.newNoDocument(a,Ct.min()));const h=tn().add(a),g=new Cf(Ct.min(),new Map,new Dn(Ut),c,h);yield $N(r,g),r.gc=r.gc.remove(a),r.yc.delete(e),rR(r)}else yield Z_(r.localStore,e,!1).then(()=>ny(r,e,t)).catch(Vc)}),YA.apply(this,arguments)}function aF(n,e){return QA.apply(this,arguments)}function QA(){return QA=(0,Ee.Z)(function*(n,e){const t=Xe(n),r=e.batch.batchId;try{const i=yield function Br(n,e){const t=Xe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),a=t.Zi.newChangeBuffer({trackRemovals:!0});return function(c,h,g,v){const T=g.batch,S=T.keys();let M=oe.resolve();return S.forEach($=>{M=M.next(()=>v.getEntry(h,$)).next(Y=>{const fe=g.docVersions.get($);It(null!==fe),Y.version.compareTo(fe)<0&&(T.applyToRemoteDocument(Y,g),Y.isValidDocument()&&(Y.setReadTime(g.commitVersion),v.addEntry(Y)))})}),M.next(()=>c.mutationQueue.removeMutationBatch(h,T))}(t,r,e,a).next(()=>a.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let h=tn();for(let g=0;g<c.mutationResults.length;++g)c.mutationResults[g].transformResults.length>0&&(h=h.add(c.batch.mutations[g].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}(t.localStore,e);tR(t,r,null),eR(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield wd(t,i)}catch(i){yield Vc(i)}}),QA.apply(this,arguments)}function uF(n,e,t){return XA.apply(this,arguments)}function XA(){return XA=(0,Ee.Z)(function*(n,e,t){const r=Xe(n);try{const i=yield function(a,c){const h=Xe(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",g=>{let v;return h.mutationQueue.lookupMutationBatch(g,c).next(T=>(It(null!==T),v=T.keys(),h.mutationQueue.removeMutationBatch(g,T))).next(()=>h.mutationQueue.performConsistencyCheck(g)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(g,v,c)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,v)).next(()=>h.localDocuments.getDocuments(g,v))})}(r.localStore,e);tR(r,e,t),eR(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield wd(r,i)}catch(i){yield Vc(i)}}),XA.apply(this,arguments)}function JA(){return JA=(0,Ee.Z)(function*(n,e){const t=Xe(n);Pf(t.remoteStore)||be("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(a){const c=Xe(a);return c.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>c.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(-1===r)return void e.resolve();const i=t.Ec.get(r)||[];i.push(e),t.Ec.set(r,i)}catch(r){const i=J_(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),JA.apply(this,arguments)}function eR(n,e){(n.Ec.get(e)||[]).forEach(t=>{t.resolve()}),n.Ec.delete(e)}function tR(n,e,t){const r=Xe(n);let i=r.Tc[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.Tc[r.currentUser.toKey()]=i}}function ny(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n._c.get(e))n.wc.delete(r),t&&n.dc.Pc(r,t);n._c.delete(e),n.isPrimaryClient&&n.Ic.Is(e).forEach(r=>{n.Ic.containsKey(r)||zN(n,r)})}function zN(n,e){n.mc.delete(e.path.canonicalString());const t=n.gc.get(e);null!==t&&(cw(n.remoteStore,t),n.gc=n.gc.remove(e),n.yc.delete(t),rR(n))}function nR(n,e,t){for(const r of t)r instanceof VN?(n.Ic.addReference(r.key,e),lF(n,r)):r instanceof BN?(be("SyncEngine","Document no longer in limbo: "+r.key),n.Ic.removeReference(r.key,e),n.Ic.containsKey(r.key)||zN(n,r.key)):lt()}function lF(n,e){const t=e.key,r=t.path.canonicalString();n.gc.get(t)||n.mc.has(r)||(be("SyncEngine","New document in limbo: "+t),n.mc.add(r),rR(n))}function rR(n){for(;n.mc.size>0&&n.gc.size<n.maxConcurrentLimboResolutions;){const e=n.mc.values().next().value;n.mc.delete(e);const t=new Ye(yn.fromString(e)),r=n.Ac.next();n.yc.set(r,new tF(t)),n.gc=n.gc.insert(t,r),dT(n.remoteStore,new Hu(es(ud(t.path)),r,"TargetPurposeLimboResolution",Os.ct))}}function wd(n,e,t){return iR.apply(this,arguments)}function iR(){return iR=(0,Ee.Z)(function*(n,e,t){const r=Xe(n),i=[],a=[],c=[];var h;r.wc.isEmpty()||(r.wc.forEach((h,g)=>{c.push(r.Rc(g,e,t).then(v=>{if((v||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(g.targetId,v?.fromCache?"not-current":"current"),v){i.push(v);const T=Qe.Li(g.targetId,v);a.push(T)}}))}),yield Promise.all(c),r.dc.nu(i),yield(h=(0,Ee.Z)(function*(g,v){const T=Xe(g);try{yield T.persistence.runTransaction("notifyLocalViewChanges","readwrite",S=>oe.forEach(v,M=>oe.forEach(M.Fi,$=>T.persistence.referenceDelegate.addReference(S,M.targetId,$)).next(()=>oe.forEach(M.Bi,$=>T.persistence.referenceDelegate.removeReference(S,M.targetId,$)))))}catch(S){if(!go(S))throw S;be("LocalStore","Failed to update sequence numbers: "+S)}for(const S of v){const M=S.targetId;if(!S.fromCache){const $=T.Ji.get(M),fe=$.withLastLimboFreeSnapshotVersion($.snapshotVersion);T.Ji=T.Ji.insert(M,fe)}}}),function(g,v){return h.apply(this,arguments)})(r.localStore,a))}),iR.apply(this,arguments)}function dF(n,e){return sR.apply(this,arguments)}function sR(){return sR=(0,Ee.Z)(function*(n,e){const t=Xe(n);if(!t.currentUser.isEqual(e)){be("SyncEngine","User change. New user:",e.toKey());const r=yield qt(t.localStore,e);t.currentUser=e,(i=t).Ec.forEach(c=>{c.forEach(h=>{h.reject(new Ne(de.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.Ec.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield wd(t,r.er)}var i}),sR.apply(this,arguments)}function hF(n,e){const t=Xe(n),r=t.yc.get(e);if(r&&r.fc)return tn().add(r.key);{let i=tn();const a=t._c.get(e);if(!a)return i;for(const c of a){const h=t.wc.get(c);i=i.unionWith(h.view.nc)}return i}}function fF(n,e){return oR.apply(this,arguments)}function oR(){return oR=(0,Ee.Z)(function*(n,e){const t=Xe(n),r=yield oT(t.localStore,e.query,!0),i=e.view.hc(r);return t.isPrimaryClient&&nR(t,e.targetId,i.cc),i}),oR.apply(this,arguments)}function pF(n,e){return aR.apply(this,arguments)}function aR(){return aR=(0,Ee.Z)(function*(n,e){const t=Xe(n);return IN(t.localStore,e).then(r=>wd(t,r))}),aR.apply(this,arguments)}function gF(n,e,t,r){return uR.apply(this,arguments)}function uR(){return uR=(0,Ee.Z)(function*(n,e,t,r){const i=Xe(n),a=yield function(c,h){const g=Xe(c),v=Xe(g.mutationQueue);return g.persistence.runTransaction("Lookup mutation documents","readonly",T=>v.Sn(T,h).next(S=>S?g.localDocuments.getDocuments(T,S):oe.resolve(null)))}(i.localStore,e);var h;null!==a?("pending"===t?yield Q_(i.remoteStore):"acknowledged"===t||"rejected"===t?(tR(i,e,r||null),eR(i,e),h=e,Xe(Xe(i.localStore).mutationQueue).Cn(h)):lt(),yield wd(i,a)):be("SyncEngine","Cannot apply mutation batch with id: "+e)}),uR.apply(this,arguments)}function cR(){return cR=(0,Ee.Z)(function*(n,e){const t=Xe(n);if(fR(t),pR(t),!0===e&&!0!==t.vc){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield GN(t,r.toArray());t.vc=!0,yield OA(t.remoteStore,!0);for(const a of i)dT(t.remoteStore,a)}else if(!1===e&&!1!==t.vc){const r=[];let i=Promise.resolve();t._c.forEach((a,c)=>{t.sharedClientState.isLocalQueryTarget(c)?r.push(c):i=i.then(()=>(ny(t,c),Z_(t.localStore,c,!0))),cw(t.remoteStore,c)}),yield i,yield GN(t,r),function(a){const c=Xe(a);c.yc.forEach((h,g)=>{cw(c.remoteStore,g)}),c.Ic.Ts(),c.yc=new Map,c.gc=new Dn(Ye.comparator)}(t),t.vc=!1,yield OA(t.remoteStore,!1)}}),cR.apply(this,arguments)}function GN(n,e,t){return lR.apply(this,arguments)}function lR(){return lR=(0,Ee.Z)(function*(n,e,t){const r=Xe(n),i=[],a=[];for(const c of e){let h;const g=r._c.get(c);if(g&&0!==g.length){h=yield K_(r.localStore,es(g[0]));for(const v of g){const T=r.wc.get(v),S=yield fF(r,T);S.snapshot&&a.push(S.snapshot)}}else{const v=yield EN(r.localStore,c);h=yield K_(r.localStore,v),yield GA(r,WN(v),c,!1,h.resumeToken)}i.push(h)}return r.dc.nu(a),i}),lR.apply(this,arguments)}function WN(n){return IC(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function _F(n){const e=Xe(n);return Xe(Xe(e.localStore).persistence).$i()}function yF(n,e,t,r){return dR.apply(this,arguments)}function dR(){return dR=(0,Ee.Z)(function*(n,e,t,r){const i=Xe(n);if(i.vc)return void be("SyncEngine","Ignoring unexpected query state notification.");const a=i._c.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const c=yield IN(i.localStore,cd(a[0])),h=Cf.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,Yr.EMPTY_BYTE_STRING);yield wd(i,c,h);break}case"rejected":yield Z_(i.localStore,e,!0),ny(i,e,r);break;default:lt()}}),dR.apply(this,arguments)}function vF(n,e,t){return hR.apply(this,arguments)}function hR(){return hR=(0,Ee.Z)(function*(n,e,t){const r=fR(n);if(r.vc){for(const i of e){if(r._c.has(i)){be("SyncEngine","Adding an already active target "+i);continue}const a=yield EN(r.localStore,i),c=yield K_(r.localStore,a);yield GA(r,WN(a),c.targetId,!1,c.resumeToken),dT(r.remoteStore,c)}for(const i of t)r._c.has(i)&&(yield Z_(r.localStore,i,!1).then(()=>{cw(r.remoteStore,i),ny(r,i)}).catch(Vc))}}),hR.apply(this,arguments)}function fR(n){const e=Xe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=$N.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=hF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=oF.bind(null,e),e.dc.nu=YL.bind(null,e.eventManager),e.dc.Pc=QL.bind(null,e.eventManager),e}function pR(n){const e=Xe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=aF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=uF.bind(null,e),e}class lw{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,Ee.Z)(function*(){t.serializer=aw(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return Oe(this.persistence,new mt,e.initialUser,this.serializer)}createPersistence(e){return new p(C.zs,this.serializer)}createSharedClientState(e){return new bN}terminate(){var e=this;return(0,Ee.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class gR extends lw{constructor(e,t,r){super(),this.Vc=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,Ee.Z)(function*(){yield t().call(r,e),yield r.Vc.initialize(r,e),yield pR(r.Vc.syncEngine),yield Q_(r.Vc.remoteStore),yield r.persistence.Ii(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return Oe(this.persistence,new mt,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new W_(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const r=new eC(t,this.persistence);return new uS(e.asyncQueue,r)}createPersistence(e){const t=ze(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?ns.withCacheSize(this.cacheSizeBytes):ns.DEFAULT;return new Q(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,AN(),lT(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new bN}}class qN extends gR{constructor(e,t){super(e,t,!1),this.Vc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,Ee.Z)(function*(){yield t().call(r,e);const i=r.Vc.syncEngine;r.sharedClientState instanceof mA&&(r.sharedClientState.syncEngine={jr:gF.bind(null,i),zr:yF.bind(null,i),Wr:vF.bind(null,i),$i:_F.bind(null,i),Qr:pF.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.Ii(function(){var a=(0,Ee.Z)(function*(c){yield function mF(n,e){return cR.apply(this,arguments)}(r.Vc.syncEngine,c),r.gcScheduler&&(c&&!r.gcScheduler.started?r.gcScheduler.start():c||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(c&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():c||r.indexBackfillerScheduler.stop())});return function(c){return a.apply(this,arguments)}}())})()}createSharedClientState(e){const t=AN();if(!mA.D(t))throw new Ne(de.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=ze(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new mA(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class ry{initialize(e,t){var r=this;return(0,Ee.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>HN(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=dF.bind(null,r.syncEngine),yield OA(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new ZL}createDatastore(e){const t=aw(e.databaseInfo.databaseId),r=new NL(e.databaseInfo);return new OL(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,a=h=>HN(this.syncEngine,h,0),c=SN.D()?new SN:new RL,new UL(t,r,i,a,c);var t,r,i,a,c}createSyncEngine(e,t){return function(r,i,a,c,h,g,v){const T=new nF(r,i,a,c,h,g);return v&&(T.vc=!0),T}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,Ee.Z)(function*(t){const r=Xe(t);be("RemoteStore","RemoteStore shutting down."),r.vu.add(5),yield Y_(r),r.Pu.shutdown(),r.bu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function KN(n,e=10240){let t=0;return{read:()=>(0,Ee.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,Ee.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class fT{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Zr("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class IF{constructor(e,t){this.Cc=e,this.serializer=t,this.metadata=new oi,this.buffer=new Uint8Array,this.xc=new TextDecoder("utf-8"),this.Nc().then(r=>{r&&r.Qu()?this.metadata.resolve(r.Gu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.Gu)}`))},r=>this.metadata.reject(r))}close(){return this.Cc.cancel()}getMetadata(){var e=this;return(0,Ee.Z)(function*(){return e.metadata.promise})()}bc(){var e=this;return(0,Ee.Z)(function*(){return yield e.getMetadata(),e.Nc()})()}Nc(){var e=this;return(0,Ee.Z)(function*(){const t=yield e.kc();if(null===t)return null;const r=e.xc.decode(t),i=Number(r);isNaN(i)&&e.Mc(`length string (${r}) is not valid number`);const a=yield e.$c(i);return new XL(JSON.parse(a),t.length+i)})()}Oc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}kc(){var e=this;return(0,Ee.Z)(function*(){for(;e.Oc()<0&&!(yield e.Fc()););if(0===e.buffer.length)return null;const t=e.Oc();t<0&&e.Mc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}$c(e){var t=this;return(0,Ee.Z)(function*(){for(;t.buffer.length<e;)(yield t.Fc())&&t.Mc("Reached the end of bundle when more is expected.");const r=t.xc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Mc(e){throw this.Cc.cancel(),new Error(`Invalid bundle format: ${e}`)}Fc(){var e=this;return(0,Ee.Z)(function*(){const t=yield e.Cc.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class CF{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,Ee.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new Ne(de.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,Ee.Z)(function*(a,c){const h=Xe(a),g=Gi(h.serializer)+"/documents",v={documents:c.map($=>Vg(h.serializer,$))},T=yield h.vo("BatchGetDocuments",g,v,c.length),S=new Map;T.forEach($=>{const Y=function HS(n,e){return"found"in e?function(t,r){It(!!r.found);const i=vo(t,r.found.name),a=Nr(r.found.updateTime),c=r.found.createTime?Nr(r.found.createTime):Ct.min(),h=new Ii({mapValue:{fields:r.found.fields}});return er.newFoundDocument(i,a,c,h)}(n,e):"missing"in e?function(t,r){It(!!r.missing),It(!!r.readTime);const i=vo(t,r.missing),a=Nr(r.readTime);return er.newNoDocument(i,a)}(n,e):lt()}(h.serializer,$);S.set(Y.key.toString(),Y)});const M=[];return c.forEach($=>{const Y=S.get($.toString());It(!!Y),M.push(Y)}),M}),function(a,c){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ef(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,Ee.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const a=Ye.fromPath(i);e.mutations.push(new NC(a,e.precondition(a)))}),yield(r=(0,Ee.Z)(function*(i,a){const c=Xe(i),h=Gi(c.serializer)+"/documents",g={writes:a.map(v=>Tf(c.serializer,v))};yield c.Io("Commit",h,g)}),function(i,a){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw lt();t=Ct.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Ne(de.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ct.min())?tr.exists(!1):tr.updateTime(t):tr.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ct.min()))throw new Ne(de.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return tr.updateTime(t)}return tr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class TF{constructor(e,t,r,i,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=a,this.Bc=r.maxAttempts,this.qo=new yA(this.asyncQueue,"transaction_retry")}run(){this.Bc-=1,this.Lc()}Lc(){var e=this;this.qo.No((0,Ee.Z)(function*(){const t=new CF(e.datastore),r=e.qc(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(a=>{e.Uc(a)}))}).catch(i=>{e.Uc(i)})}))}qc(e){try{const t=this.updateFunction(e);return!sd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Uc(e){this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Lc(),Promise.resolve()))):this.deferred.reject(e)}Kc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!LS(t)}return!1}}class DF{constructor(e,t,r,i){var a=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=wi.UNAUTHENTICATED,this.clientId=uf.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var c=(0,Ee.Z)(function*(h){be("FirestoreClient","Received user=",h.uid),yield a.authCredentialListener(h),a.user=h});return function(h){return c.apply(this,arguments)}}()),this.appCheckCredentials.start(r,c=>(be("FirestoreClient","Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}getConfiguration(){var e=this;return(0,Ee.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ne(de.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new oi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,Ee.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=J_(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function pT(n,e){return mR.apply(this,arguments)}function mR(){return mR=(0,Ee.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),be("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,Ee.Z)(function*(a){r.isEqual(a)||(yield qt(e.localStore,a),r=a)});return function(a){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}),mR.apply(this,arguments)}function _R(n,e){return yR.apply(this,arguments)}function yR(){return yR=(0,Ee.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield vR(n);be("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>ON(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,a)=>ON(e.remoteStore,a)),n._onlineComponents=e}),yR.apply(this,arguments)}function ZN(n){return"FirebaseError"===n.name?n.code===de.FAILED_PRECONDITION||n.code===de.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code}function vR(n){return wR.apply(this,arguments)}function wR(){return wR=(0,Ee.Z)(function*(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){be("FirestoreClient","Using user provided OfflineComponentProvider");try{yield pT(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!ZN(t))throw t;ks("Error using user provided cache. Falling back to memory cache: "+t),yield pT(n,new lw)}}else be("FirestoreClient","Using default OfflineComponentProvider"),yield pT(n,new lw);return n._offlineComponents}),wR.apply(this,arguments)}function gT(n){return ER.apply(this,arguments)}function ER(){return ER=(0,Ee.Z)(function*(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(be("FirestoreClient","Using user provided OnlineComponentProvider"),yield _R(n,n._uninitializedComponentsProvider._online)):(be("FirestoreClient","Using default OnlineComponentProvider"),yield _R(n,new ry))),n._onlineComponents}),ER.apply(this,arguments)}function YN(n){return vR(n).then(e=>e.persistence)}function mT(n){return vR(n).then(e=>e.localStore)}function QN(n){return gT(n).then(e=>e.remoteStore)}function IR(n){return gT(n).then(e=>e.syncEngine)}function iy(n){return CR.apply(this,arguments)}function CR(){return CR=(0,Ee.Z)(function*(n){const e=yield gT(n),t=e.eventManager;return t.onListen=rF.bind(null,e.syncEngine),t.onUnlisten=iF.bind(null,e.syncEngine),t}),CR.apply(this,arguments)}function JN(n,e,t={}){const r=new oi;return n.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return function(i,a,c,h,g){const v=new fT({next:S=>{a.enqueueAndForget(()=>BA(i,T));const M=S.docs.has(c);!M&&S.fromCache?g.reject(new Ne(de.UNAVAILABLE,"Failed to get document because the client is offline.")):M&&S.fromCache&&h&&"server"===h.source?g.reject(new Ne(de.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(S)},error:S=>g.reject(S)}),T=new HA(ud(c.path),v,{includeMetadataChanges:!0,Ku:!0});return UA(i,T)}(yield iy(n),n.asyncQueue,e,t,r)})),r.promise}function eM(n,e,t={}){const r=new oi;return n.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return function(i,a,c,h,g){const v=new fT({next:S=>{a.enqueueAndForget(()=>BA(i,T)),S.fromCache&&"server"===h.source?g.reject(new Ne(de.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(S)},error:S=>g.reject(S)}),T=new HA(c,v,{includeMetadataChanges:!0,Ku:!0});return UA(i,T)}(yield iy(n),n.asyncQueue,e,t,r)})),r.promise}function tM(n){const e={};return void 0!==n.timeoutSeconds&&(e.timeoutSeconds=n.timeoutSeconds),e}const nM=new Map;function TR(n,e,t){if(!t)throw new Ne(de.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function rM(n,e,t,r){if(!0===e&&!0===r)throw new Ne(de.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function iM(n){if(!Ye.isDocumentKey(n))throw new Ne(de.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function sM(n){if(Ye.isDocumentKey(n))throw new Ne(de.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function _T(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":lt()}function wn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ne(de.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=_T(n);throw new Ne(de.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function oM(n,e){if(e<=0)throw new Ne(de.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class aM{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new Ne(de.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Ne(de.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}rM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=tM(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(i){if(void 0!==i.timeoutSeconds){if(isNaN(i.timeoutSeconds))throw new Ne(de.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ne(de.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ne(de.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class dw{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new aM({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Ne(de.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Ne(de.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new aM(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new yg;switch(t.type){case"firstParty":return new h_(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Ne(de.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=nM.get(e);t&&(be("ComponentProvider","Removing Datastore"),nM.delete(e),t.terminate())}(this),Promise.resolve()}}class vr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Jc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vr(this.firestore,e,this._key)}}class rs{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new rs(this.firestore,e,this._query)}}class Jc extends rs{constructor(e,t,r){super(e,t,ud(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vr(this.firestore,null,new Ye(e))}withConverter(e){return new Jc(this.firestore,e,this._path)}}function cM(n,e,...t){if(n=(0,U.m9)(n),TR("collection","path",e),n instanceof dw){const r=yn.fromString(e,...t);return sM(r),new Jc(n,null,r)}{if(!(n instanceof vr||n instanceof Jc))throw new Ne(de.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(yn.fromString(e,...t));return sM(r),new Jc(n.firestore,null,r)}}function yT(n,e,...t){if(n=(0,U.m9)(n),1===arguments.length&&(e=uf.A()),TR("doc","path",e),n instanceof dw){const r=yn.fromString(e,...t);return iM(r),new vr(n,null,new Ye(r))}{if(!(n instanceof vr||n instanceof Jc))throw new Ne(de.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(yn.fromString(e,...t));return iM(r),new vr(n.firestore,n instanceof Jc?n.converter:null,new Ye(r))}}function lM(n,e){return n=(0,U.m9)(n),e=(0,U.m9)(e),(n instanceof vr||n instanceof Jc)&&(e instanceof vr||e instanceof Jc)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function DR(n,e){return n=(0,U.m9)(n),e=(0,U.m9)(e),n instanceof rs&&e instanceof rs&&n.firestore===e.firestore&&Ng(n._query,e._query)&&n.converter===e.converter}class OF{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new yA(this,"async_queue_retry"),this.Xc=()=>{const t=lT();t&&be("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const e=lT();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=lT();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new oi;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}ea(){var e=this;return(0,Ee.Z)(function*(){if(0!==e.Qc.length){try{yield e.Qc[0](),e.Qc.shift(),e.qo.reset()}catch(t){if(!go(t))throw t;be("AsyncQueue","Operation failed with retryable error: "+t)}e.Qc.length>0&&e.qo.No(()=>e.ea())}})()}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(r=>{throw this.Wc=r,this.Hc=!1,Zr("INTERNAL UNHANDLED ERROR: ",function(a){let c=a.message||"";return a.stack&&(c=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),c}(r)),r}).then(r=>(this.Hc=!1,r))));return this.Gc=t,t}enqueueAfterDelay(e,t,r){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const i=FA.createAndSchedule(this,e,t,r,a=>this.na(a));return this.zc.push(i),i}Zc(){this.Wc&&lt()}verifyOperationInProgress(){}sa(){var e=this;return(0,Ee.Z)(function*(){let t;do{t=e.Gc,yield t}while(t!==e.Gc)})()}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function bR(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(n)}class LF{constructor(){this._progressObserver={},this._taskCompletionResolver=new oi,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class wr extends dw{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new OF,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||dM(this),this._firestoreClient.terminate()}}function ci(n){return n._firestoreClient||dM(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function dM(n){var e,t,r;const i=n._freezeSettings(),a=(h=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new CS(n._databaseId,h,n._persistenceKey,(v=i).host,v.ssl,v.experimentalForceLongPolling,v.experimentalAutoDetectLongPolling,tM(v.experimentalLongPollingOptions),v.useFetchStreams));var h,v;n._firestoreClient=new DF(n._authCredentials,n._appCheckCredentials,n._queue,a),null!==(t=i.cache)&&void 0!==t&&t._offlineComponentProvider&&null!==(r=i.cache)&&void 0!==r&&r._onlineComponentProvider&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}function hM(n,e,t){const r=new oi;return n.asyncQueue.enqueue((0,Ee.Z)(function*(){try{yield pT(n,t),yield _R(n,e),r.resolve()}catch(i){const a=i;if(!ZN(a))throw a;ks("Error enabling indexeddb cache. Falling back to memory cache: "+a),r.reject(a)}})).then(()=>r.promise)}function fM(n){if(n._initialized||n._terminated)throw new Ne(de.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class el{constructor(e){this._byteString=e}static fromBase64String(e){try{return new el(Yr.fromBase64String(e))}catch(t){throw new Ne(de.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new el(Yr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Ed{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Ne(de.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _r(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Wg{constructor(e){this._methodName=e}}class vT{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ne(de.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ne(de.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ut(this._lat,e._lat)||Ut(this._long,e._long)}}const qF=/^__.*__$/;class KF{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new Ha(e,this.data,this.fieldMask,t,this.fieldTransforms):new dd(e,this.data,t,this.fieldTransforms)}}class pM{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Ha(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function gM(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw lt()}}class wT{constructor(e,t,r,i,a,c){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===a&&this.ua(),this.fieldTransforms=a||[],this.fieldMask=c||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new wT(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:r,la:!1});return i.fa(e),i}da(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:r,la:!1});return i.ua(),i}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return CT(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(gM(this.ca)&&qF.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class ZF{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||aw(e)}ya(e,t,r,i=!1){return new wT({ca:e,methodName:t,ga:r,path:_r.emptyPath(),la:!1,ma:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function qg(n){const e=n._freezeSettings(),t=aw(n._databaseId);return new ZF(n._databaseId,!!e.ignoreUndefinedProperties,t)}function ET(n,e,t,r,i,a={}){const c=n.ya(a.merge||a.mergeFields?2:0,e,t,i);xR("Data must be an object, but it was:",c,r);const h=yM(r,c);let g,v;if(a.merge)g=new ys(c.fieldMask),v=c.fieldTransforms;else if(a.mergeFields){const T=[];for(const S of a.mergeFields){const M=pw(e,S,t);if(!c.contains(M))throw new Ne(de.INVALID_ARGUMENT,`Field '${M}' is specified in your field mask but missing from your input data.`);wM(T,M)||T.push(M)}g=new ys(T),v=c.fieldTransforms.filter(S=>g.covers(S.field))}else g=null,v=c.fieldTransforms;return new KF(new Ii(h),g,v)}class fw extends Wg{_toFieldTransform(e){if(2!==e.ca)throw e._a(1===e.ca?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof fw}}function mM(n,e,t){return new wT({ca:3,ga:e.settings.ga,methodName:n._methodName,la:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class SR extends Wg{_toFieldTransform(e){return new kg(e.path,new Xo)}isEqual(e){return e instanceof SR}}class YF extends Wg{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=mM(this,e,!0),r=this.pa.map(a=>Kg(a,t)),i=new ld(r);return new kg(e.path,i)}isEqual(e){return this===e}}class QF extends Wg{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=mM(this,e,!0),r=this.pa.map(a=>Kg(a,t)),i=new Bu(r);return new kg(e.path,i)}isEqual(e){return this===e}}class XF extends Wg{constructor(e,t){super(e),this.Ia=t}_toFieldTransform(e){const t=new wf(e.serializer,M_(e.serializer,this.Ia));return new kg(e.path,t)}isEqual(e){return this===e}}function AR(n,e,t,r){const i=n.ya(1,e,t);xR("Data must be an object, but it was:",i,r);const a=[],c=Ii.empty();jc(r,(g,v)=>{const T=IT(e,g,t);v=(0,U.m9)(v);const S=i.da(T);if(v instanceof fw)a.push(T);else{const M=Kg(v,S);null!=M&&(a.push(T),c.set(T,M))}});const h=new ys(a);return new pM(c,h,i.fieldTransforms)}function RR(n,e,t,r,i,a){const c=n.ya(1,e,t),h=[pw(e,r,t)],g=[i];if(a.length%2!=0)throw new Ne(de.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let M=0;M<a.length;M+=2)h.push(pw(e,a[M])),g.push(a[M+1]);const v=[],T=Ii.empty();for(let M=h.length-1;M>=0;--M)if(!wM(v,h[M])){const $=h[M];let Y=g[M];Y=(0,U.m9)(Y);const fe=c.da($);if(Y instanceof fw)v.push($);else{const ge=Kg(Y,fe);null!=ge&&(v.push($),T.set($,ge))}}const S=new ys(v);return new pM(T,S,c.fieldTransforms)}function _M(n,e,t,r=!1){return Kg(t,n.ya(r?4:3,e))}function Kg(n,e){if(vM(n=(0,U.m9)(n)))return xR("Unsupported field value:",e,n),yM(n,e);if(n instanceof Wg)return function(t,r){if(!gM(r.ca))throw r._a(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r._a(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.la&&4!==e.ca)throw e._a("Nested arrays are not supported");return function(t,r){const i=[];let a=0;for(const c of t){let h=Kg(c,r.wa(a));null==h&&(h={nullValue:"NULL_VALUE"}),i.push(h),a++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if(null===(t=(0,U.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return M_(r.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=or.fromDate(t);return{timestampValue:Ug(r.serializer,i)}}if(t instanceof or){const i=new or(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Ug(r.serializer,i)}}if(t instanceof vT)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof el)return{bytesValue:VC(r.serializer,t._byteString)};if(t instanceof vr){const i=r.databaseId,a=t.firestore._databaseId;if(!a.isEqual(i))throw r._a(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:jC(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r._a(`Unsupported field value: ${_T(t)}`)}(n,e)}function yM(n,e){const t={};return oC(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):jc(n,(r,i)=>{const a=Kg(i,e.ha(r));null!=a&&(t[r]=a)}),{mapValue:{fields:t}}}function vM(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof or||n instanceof vT||n instanceof el||n instanceof vr||n instanceof Wg)}function xR(n,e,t){if(!vM(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=_T(t);throw e._a("an object"===r?n+" a custom object":n+" "+r)}var r}function pw(n,e,t){if((e=(0,U.m9)(e))instanceof Ed)return e._internalPath;if("string"==typeof e)return IT(n,e);throw CT("Field path arguments must be of type string or ",n,!1,void 0,t)}const JF=new RegExp("[~\\*/\\[\\]]");function IT(n,e,t){if(e.search(JF)>=0)throw CT(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ed(...e.split("."))._internalPath}catch{throw CT(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function CT(n,e,t,r,i){const a=r&&!r.isEmpty(),c=void 0!==i;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let g="";return(a||c)&&(g+=" (found",a&&(g+=` in field ${r}`),c&&(g+=` in document ${i}`),g+=")"),new Ne(de.INVALID_ARGUMENT,h+n+g)}function wM(n,e){return n.some(t=>t.isEqual(e))}class gw{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new vr(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new e2(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(TT("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class e2 extends gw{data(){return super.data()}}function TT(n,e){return"string"==typeof e?IT(n,e):e instanceof Ed?e._internalPath:e._delegate._internalPath}function EM(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Ne(de.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class PR{}class mw extends PR{}function Mf(n,e,...t){let r=[];e instanceof PR&&r.push(e),r=r.concat(t),function(i){const a=i.filter(h=>h instanceof sy).length,c=i.filter(h=>h instanceof _w).length;if(a>1||a>0&&c>0)throw new Ne(de.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class _w extends mw{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new _w(e,t,r)}_apply(e){const t=this._parse(e);return DM(e._query,t),new rs(e.firestore,e.converter,x_(e._query,t))}_parse(e){const t=qg(e.firestore);return function(i,a,c,h,g,v,T){let S;if(g.isKeyField()){if("array-contains"===v||"array-contains-any"===v)throw new Ne(de.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if("in"===v||"not-in"===v){TM(T,v);const M=[];for(const $ of T)M.push(CM(h,i,$));S={arrayValue:{values:M}}}else S=CM(h,i,T)}else"in"!==v&&"not-in"!==v&&"array-contains-any"!==v||TM(T,v),S=_M(c,"where",T,"in"===v||"not-in"===v);return pn.create(g,v,S)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class sy extends PR{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new sy(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===t.length?t[0]:En.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(r,i){let a=r;const c=i.getFlattenedFilters();for(const h of c)DM(a,h),a=x_(a,h)}(e._query,t),new rs(e.firestore,e.converter,x_(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class NR extends mw{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new NR(e,t)}_apply(e){const t=function(r,i,a){if(null!==r.startAt)throw new Ne(de.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Ne(de.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const c=new ff(i,a);return function(h,g){if(null===S_(h)){const v=A_(h);null!==v&&bM(0,v,g.field)}}(r,c),c}(e._query,this._field,this._direction);return new rs(e.firestore,e.converter,function(r,i){const a=r.explicitOrderBy.concat([i]);return new Uu(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class DT extends mw{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new DT(e,t,r)}_apply(e){return new rs(e.firestore,e.converter,Pg(e._query,this._limit,this._limitType))}}class bT extends mw{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new bT(e,t,r)}_apply(e){const t=IM(e,this.type,this._docOrFields,this._inclusive);return new rs(e.firestore,e.converter,(i=t,new Uu((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}class ST extends mw{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new ST(e,t,r)}_apply(e){const t=IM(e,this.type,this._docOrFields,this._inclusive);return new rs(e.firestore,e.converter,(i=t,new Uu((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function IM(n,e,t,r){if(t[0]=(0,U.m9)(t[0]),t[0]instanceof gw)return function(i,a,c,h,g){if(!h)throw new Ne(de.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);const v=[];for(const T of Gc(i))if(T.field.isKeyField())v.push(ad(a,h.key));else{const S=h.data.field(T.field);if(Ig(S))throw new Ne(de.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+T.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===S){const M=T.field.canonicalString();throw new Ne(de.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${M}' (used as the orderBy) does not exist.`)}v.push(S)}return new zc(v,g)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=qg(n.firestore);return function(a,c,h,g,v,T){const S=a.explicitOrderBy;if(v.length>S.length)throw new Ne(de.INVALID_ARGUMENT,`Too many arguments provided to ${g}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const M=[];for(let $=0;$<v.length;$++){const Y=v[$];if(S[$].field.isKeyField()){if("string"!=typeof Y)throw new Ne(de.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${g}(), but got a ${typeof Y}`);if(!R_(a)&&-1!==Y.indexOf("/"))throw new Ne(de.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${g}() must be a plain document ID, but '${Y}' contains a slash.`);const fe=a.path.child(yn.fromString(Y));if(!Ye.isDocumentKey(fe))throw new Ne(de.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${g}() must result in a valid document path, but '${fe}' is not because it contains an odd number of segments.`);const ge=new Ye(fe);M.push(ad(c,ge))}else{const fe=_M(h,g,Y);M.push(fe)}}return new zc(M,T)}(n._query,n.firestore._databaseId,i,e,t,r)}}function CM(n,e,t){if("string"==typeof(t=(0,U.m9)(t))){if(""===t)throw new Ne(de.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!R_(e)&&-1!==t.indexOf("/"))throw new Ne(de.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(yn.fromString(t));if(!Ye.isDocumentKey(r))throw new Ne(de.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ad(n,new Ye(r))}if(t instanceof vr)return ad(n,t._key);throw new Ne(de.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${_T(t)}.`)}function TM(n,e){if(!Array.isArray(n)||0===n.length)throw new Ne(de.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function DM(n,e){if(e.isInequality()){const r=A_(n),i=e.field;if(null!==r&&!r.isEqual(i))throw new Ne(de.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${i.toString()}'`);const a=S_(n);null!==a&&bM(0,i,a)}const t=function(r,i){for(const a of r)for(const c of a.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new Ne(de.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function bM(n,e,t){if(!t.isEqual(e))throw new Ne(de.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class MR{convertValue(e,t="none"){switch(Lu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return yr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ja(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw lt()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return jc(e,(i,a)=>{r[i]=this.convertValue(a,t)}),r}convertGeoPoint(e){return new vT(yr(e.latitude),yr(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=E_(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Cg(e));default:return null}}convertTimestamp(e){const t=ku(e);return new or(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=yn.fromString(e);It(WS(r));const i=new Hc(r.get(1),r.get(3)),a=new Ye(r.popFirst(5));return i.isEqual(t)||Zr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function AT(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class c2 extends MR{constructor(e){super(),this.firestore=e}convertBytes(e){return new el(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vr(this.firestore,null,t)}}class Zg{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Id extends gw{constructor(e,t,r,i,a,c){super(e,t,r,i,c),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new yw(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(TT("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class yw extends Id{data(e={}){return super.data(e)}}class kf{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Zg(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new yw(this._firestore,this._userDataWriter,r.key,r,new Zg(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ne(de.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(c=>({type:"added",doc:new yw(r._firestore,r._userDataWriter,c.doc.key,c.doc,new Zg(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:a++}))}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(c=>i||3!==c.type).map(c=>{const h=new yw(r._firestore,r._userDataWriter,c.doc.key,c.doc,new Zg(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);let g=-1,v=-1;return 0!==c.type&&(g=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),1!==c.type&&(a=a.add(c.doc),v=a.indexOf(c.doc.key)),{type:d2(c.type),doc:h,oldIndex:g,newIndex:v}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function d2(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return lt()}}function AM(n,e){return n instanceof Id&&e instanceof Id?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof kf&&e instanceof kf&&n._firestore===e._firestore&&DR(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class Of extends MR{constructor(e){super(),this.firestore=e}convertBytes(e){return new el(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vr(this.firestore,null,t)}}function RM(n,e,t){n=wn(n,vr);const r=wn(n.firestore,wr),i=AT(n.converter,e,t);return oy(r,[ET(qg(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,tr.none())])}function xM(n,e,t,...r){n=wn(n,vr);const i=wn(n.firestore,wr),a=qg(i);let c;return c="string"==typeof(e=(0,U.m9)(e))||e instanceof Ed?RR(a,"updateDoc",n._key,e,t,r):AR(a,"updateDoc",n._key,e),oy(i,[c.toMutation(n._key,tr.exists(!0))])}function PM(n,...e){var t,r,i;n=(0,U.m9)(n);let a={includeMetadataChanges:!1},c=0;"object"!=typeof e[c]||bR(e[c])||(a=e[c],c++);const h={includeMetadataChanges:a.includeMetadataChanges};if(bR(e[c])){const S=e[c];e[c]=null===(t=S.next)||void 0===t?void 0:t.bind(S),e[c+1]=null===(r=S.error)||void 0===r?void 0:r.bind(S),e[c+2]=null===(i=S.complete)||void 0===i?void 0:i.bind(S)}let g,v,T;if(n instanceof vr)v=wn(n.firestore,wr),T=ud(n._key.path),g={next:S=>{e[c]&&e[c](kR(v,n,S))},error:e[c+1],complete:e[c+2]};else{const S=wn(n,rs);v=wn(S.firestore,wr),T=S._query;const M=new Of(v);g={next:$=>{e[c]&&e[c](new kf(v,M,S,$))},error:e[c+1],complete:e[c+2]},EM(n._query)}return function(S,M,$,Y){const fe=new fT(Y),ge=new HA(M,fe,$);return S.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return UA(yield iy(S),ge)})),()=>{fe.Dc(),S.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return BA(yield iy(S),ge)}))}}(ci(v),T,h,g)}function oy(n,e){return function(t,r){const i=new oi;return t.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return function sF(n,e,t){return KA.apply(this,arguments)}(yield IR(t),r,i)})),i.promise}(ci(n),e)}function kR(n,e,t){const r=t.docs.get(e._key),i=new Of(n);return new Id(n,i,e._key,r,new Zg(t.hasPendingWrites,t.fromCache),e.converter)}const R2={maxAttempts:5};class NM{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=qg(e)}set(e,t,r){this._verifyNotCommitted();const i=Lf(e,this._firestore),a=AT(i.converter,t,r),c=ET(this._dataReader,"WriteBatch.set",i._key,a,null!==i.converter,r);return this._mutations.push(c.toMutation(i._key,tr.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=Lf(e,this._firestore);let c;return c="string"==typeof(t=(0,U.m9)(t))||t instanceof Ed?RR(this._dataReader,"WriteBatch.update",a._key,t,r,i):AR(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(c.toMutation(a._key,tr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Lf(e,this._firestore);return this._mutations=this._mutations.concat(new Ef(t._key,tr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ne(de.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Lf(n,e){if((n=(0,U.m9)(n)).firestore!==e)throw new Ne(de.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class x2 extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=qg(e)}get(e){const t=Lf(e,this._firestore),r=new c2(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||1!==i.length)return lt();const a=i[0];if(a.isFoundDocument())return new gw(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new gw(this._firestore,r,t._key,null,t.converter);throw lt()})}set(e,t,r){const i=Lf(e,this._firestore),a=AT(i.converter,t,r),c=ET(this._dataReader,"Transaction.set",i._key,a,null!==i.converter,r);return this._transaction.set(i._key,c),this}update(e,t,r,...i){const a=Lf(e,this._firestore);let c;return c="string"==typeof(t=(0,U.m9)(t))||t instanceof Ed?RR(this._dataReader,"Transaction.update",a._key,t,r,i):AR(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,c),this}delete(e){const t=Lf(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Lf(e,this._firestore),r=new Of(this._firestore);return super.get(e).then(i=>new Id(this._firestore,r,t._key,i._document,new Zg(!1,!1),t.converter))}}!function(n,e=!0){Qo=Ai.SDK_VERSION,(0,Ai._registerComponent)(new uo.wA("firestore",(t,{instanceIdentifier:r,options:i})=>{const a=t.getProvider("app").getImmediate(),c=new wr(new tS(t.getProvider("auth-internal")),new GI(t.getProvider("app-check-internal")),function(h,g){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Ne(de.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Hc(h.options.projectId,g)}(a,r),a);return i=Object.assign({useFetchStreams:e},i),c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),(0,Ai.registerVersion)($I,"3.13.0",n),(0,Ai.registerVersion)($I,"3.13.0","esm2017")}();function OR(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ne("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function kM(){if(typeof Uint8Array>"u")throw new Ne("unimplemented","Uint8Arrays are not available in this environment.")}function OM(){if(!function IS(){return typeof atob<"u"}())throw new Ne("unimplemented","Blobs are unavailable in Firestore in this environment.")}class vw{constructor(e){this._delegate=e}static fromBase64String(e){return OM(),new vw(el.fromBase64String(e))}static fromUint8Array(e){return kM(),new vw(el.fromUint8Array(e))}toBase64(){return OM(),this._delegate.toBase64()}toUint8Array(){return kM(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function LR(n){return function V2(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class B2{enableIndexedDbPersistence(e,t){return function UF(n,e){fM(n=wn(n,wr));const t=ci(n);if(t._uninitializedComponentsProvider)throw new Ne(de.FAILED_PRECONDITION,"SDK cache is already specified.");ks("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=n._freezeSettings(),i=new ry;return hM(t,i,new gR(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function VF(n){fM(n=wn(n,wr));const e=ci(n);if(e._uninitializedComponentsProvider)throw new Ne(de.FAILED_PRECONDITION,"SDK cache is already specified.");ks("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),r=new ry;return hM(e,r,new qN(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function BF(n){if(n._initialized&&!n._terminated)throw new Ne(de.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new oi;return n._queue.enqueueAndForgetEvenWhileRestricted((0,Ee.Z)(function*(){try{yield(t=(0,Ee.Z)(function*(r){if(!po.D())return Promise.resolve();const i=r+"main";yield po.delete(i)}),function(r){return t.apply(this,arguments)})(ze(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class LM{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Hc||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&ks("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function uM(n,e,t,r={}){var i;const a=(n=wn(n,dw))._getSettings(),c=`${e}:${t}`;if("firestore.googleapis.com"!==a.host&&a.host!==c&&ks("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},a),{host:c,ssl:!1})),r.mockUserToken){let h,g;if("string"==typeof r.mockUserToken)h=r.mockUserToken,g=wi.MOCK_USER;else{h=(0,U.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const v=r.mockUserToken.sub||r.mockUserToken.user_id;if(!v)throw new Ne(de.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new wi(v)}n._authCredentials=new eS(new zI(h,g))}}(this._delegate,e,t,r)}enableNetwork(){return function $F(n){return function bF(n){return n.asyncQueue.enqueue((0,Ee.Z)(function*(){const e=yield YN(n),t=yield QN(n);return e.setNetworkEnabled(!0),function(r){const i=Xe(r);return i.vu.delete(0),uw(i)}(t)}))}(ci(n=wn(n,wr)))}(this._delegate)}disableNetwork(){return function HF(n){return function SF(n){return n.asyncQueue.enqueue((0,Ee.Z)(function*(){const e=yield YN(n),t=yield QN(n);return e.setNetworkEnabled(!1),(r=(0,Ee.Z)(function*(i){const a=Xe(i);a.vu.add(0),yield Y_(a),a.bu.set("Offline")}),function(i){return r.apply(this,arguments)})(t);var r}))}(ci(n=wn(n,wr)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,rM("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function jF(n){return function(e){const t=new oi;return e.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return function cF(n,e){return JA.apply(this,arguments)}(yield IR(e),t)})),t.promise}(ci(n=wn(n,wr)))}(this._delegate)}onSnapshotsInSync(e){return function w2(n,e){return function xF(n,e){const t=new fT(e);return n.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return r=yield iy(n),i=t,Xe(r).ku.add(i),void i.next();var r,i})),()=>{t.Dc(),n.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return r=yield iy(n),i=t,void Xe(r).ku.delete(i);var r,i}))}}(ci(n=wn(n,wr)),bR(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new Ne("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ay(this,cM(this._delegate,e))}catch(t){throw Ls(t,"collection()","Firestore.collection()")}}doc(e){try{return new Wa(this,yT(this._delegate,e))}catch(t){throw Ls(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Fs(this,function kF(n,e){if(n=wn(n,dw),TR("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Ne(de.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new rs(n,null,(t=e,new Uu(yn.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Ls(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function P2(n,e,t){n=wn(n,wr);const r=Object.assign(Object.assign({},R2),t);return function(i){if(i.maxAttempts<1)throw new Ne(de.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,a,c){const h=new oi;return i.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){const g=yield function XN(n){return gT(n).then(e=>e.datastore)}(i);new TF(i.asyncQueue,g,c,a,h).run()})),h.promise}(ci(n),i=>e(new x2(n,i)),r)}(this._delegate,t=>e(new FM(this,t)))}batch(){return ci(this._delegate),new UM(new NM(this._delegate,e=>oy(this._delegate,e)))}loadBundle(e){return function zF(n,e){const t=ci(n=wn(n,wr)),r=new LF;return function PF(n,e,t,r){const i=function(a,c){let h;return h="string"==typeof a?V0().encode(a):a,g=function(g,v){if(g instanceof Uint8Array)return KN(g,v);if(g instanceof ArrayBuffer)return KN(new Uint8Array(g),v);if(g instanceof ReadableStream)return g.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),new IF(g,c);var g}(t,aw(e));n.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){!function wF(n,e,t){const r=Xe(n);var i;(i=(0,Ee.Z)(function*(a,c,h){try{const g=yield c.getMetadata();if(yield function(M,$){const Y=Xe(M),fe=Nr($.createTime);return Y.persistence.runTransaction("hasNewerBundle","readonly",ge=>Y.qs.getBundleMetadata(ge,$.id)).then(ge=>!!ge&&ge.createTime.compareTo(fe)>=0)}(a.localStore,g))return yield c.close(),h._completeWith({taskState:"Success",documentsLoaded:(M=g).totalDocuments,bytesLoaded:M.totalBytes,totalDocuments:M.totalDocuments,totalBytes:M.totalBytes}),Promise.resolve(new Set);h._updateProgress(UN(g));const v=new JL(g,a.localStore,c.serializer);let T=yield c.bc();for(;T;){const M=yield v.zu(T);M&&h._updateProgress(M),T=yield c.bc()}const S=yield v.complete();return yield wd(a,S.Ju,void 0),yield function(M,$){const Y=Xe(M);return Y.persistence.runTransaction("Save bundle","readwrite",fe=>Y.qs.saveBundleMetadata(fe,$))}(a.localStore,g),h._completeWith(S.progress),Promise.resolve(S.Hu)}catch(g){return ks("SyncEngine",`Loading bundle failed with ${g}`),h._failWith(g),Promise.resolve(new Set)}var M}),function(a,c,h){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield IR(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function GF(n,e){return function NF(n,e){return n.asyncQueue.enqueue((0,Ee.Z)(function*(){return function(t,r){const i=Xe(t);return i.persistence.runTransaction("Get named query","readonly",a=>i.qs.getNamedQuery(a,r))}(yield mT(n),e)}))}(ci(n=wn(n,wr)),e).then(t=>t?new rs(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Fs(this,t):null)}}class RT extends MR{constructor(e){super(),this.firestore=e}convertBytes(e){return new vw(new el(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Wa.forKey(t,this.firestore,null)}}class FM{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new RT(e)}get(e){const t=Qg(e);return this._delegate.get(t).then(r=>new ww(this._firestore,new Id(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=Qg(e);return r?(OR("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=Qg(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=Qg(e);return this._delegate.delete(t),this}}class UM{constructor(e){this._delegate=e}set(e,t,r){const i=Qg(e);return r?(OR("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=Qg(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=Qg(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Yg{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new yw(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Ew(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Yg.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let a=i.get(t);return a||(a=new Yg(e,new RT(e),t),i.set(t,a)),a}}Yg.INSTANCES=new WeakMap;class Wa{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new RT(e)}static forPath(e,t,r){if(e.length%2!=0)throw new Ne("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Wa(t,new vr(t._delegate,r,new Ye(e)))}static forKey(e,t,r){return new Wa(t,new vr(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new ay(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ay(this.firestore,cM(this._delegate,e))}catch(t){throw Ls(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,U.m9)(e))instanceof vr&&lM(this._delegate,e)}set(e,t){t=OR("DocumentReference.set",t);try{return t?RM(this._delegate,e,t):RM(this._delegate,e)}catch(r){throw Ls(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?xM(this._delegate,e):xM(this._delegate,e,t,...r)}catch(i){throw Ls(i,"updateDoc()","DocumentReference.update()")}}delete(){return function y2(n){return oy(wn(n.firestore,wr),[new Ef(n._key,tr.none())])}(this._delegate)}onSnapshot(...e){const t=VM(e),r=BM(e,i=>new ww(this.firestore,new Id(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return PM(this._delegate,t,r)}get(e){let t;return t="cache"===e?.source?function f2(n){n=wn(n,vr);const e=wn(n.firestore,wr),t=ci(e),r=new Of(e);return function AF(n,e){const t=new oi;return n.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return(r=(0,Ee.Z)(function*(i,a,c){try{const h=yield function(g,v){const T=Xe(g);return T.persistence.runTransaction("read document","readonly",S=>T.localDocuments.getDocument(S,v))}(i,a);h.isFoundDocument()?c.resolve(h):h.isNoDocument()?c.resolve(null):c.reject(new Ne(de.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const g=J_(h,`Failed to get document '${a} from cache`);c.reject(g)}}),function(i,a,c){return r.apply(this,arguments)})(yield mT(n),e,t);var r})),t.promise}(t,n._key).then(i=>new Id(e,r,n._key,i,new Zg(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function p2(n){n=wn(n,vr);const e=wn(n.firestore,wr);return JN(ci(e),n._key,{source:"server"}).then(t=>kR(e,n,t))}(this._delegate):function h2(n){n=wn(n,vr);const e=wn(n.firestore,wr);return JN(ci(e),n._key).then(t=>kR(e,n,t))}(this._delegate),t.then(r=>new ww(this.firestore,new Id(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Wa(this.firestore,this._delegate.withConverter(e?Yg.getInstance(this.firestore,e):null))}}function Ls(n,e,t){return n.message=n.message.replace(e,t),n}function VM(n){for(const e of n)if("object"==typeof e&&!LR(e))return e;return{}}function BM(n,e){var t,r;let i;return i=LR(n[0])?n[0]:LR(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:a=>{i.next&&i.next(e(a))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class ww{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Wa(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return AM(this._delegate,e._delegate)}}class Ew extends ww{data(e){const t=this._delegate.data(e);return function HI(n,e){n||lt()}(void 0!==t),t}}class Fs{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new RT(e)}where(e,t,r){try{return new Fs(this.firestore,Mf(this._delegate,function t2(n,e,t){const r=e,i=TT("where",n);return _w._create(i,r,t)}(e,t,r)))}catch(i){throw Ls(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Fs(this.firestore,Mf(this._delegate,function n2(n,e="asc"){const t=e,r=TT("orderBy",n);return NR._create(r,t)}(e,t)))}catch(r){throw Ls(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Fs(this.firestore,Mf(this._delegate,function r2(n){return oM("limit",n),DT._create("limit",n,"F")}(e)))}catch(t){throw Ls(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Fs(this.firestore,Mf(this._delegate,function i2(n){return oM("limitToLast",n),DT._create("limitToLast",n,"L")}(e)))}catch(t){throw Ls(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Fs(this.firestore,Mf(this._delegate,function s2(...n){return bT._create("startAt",n,!0)}(...e)))}catch(t){throw Ls(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Fs(this.firestore,Mf(this._delegate,function o2(...n){return bT._create("startAfter",n,!1)}(...e)))}catch(t){throw Ls(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Fs(this.firestore,Mf(this._delegate,function a2(...n){return ST._create("endBefore",n,!1)}(...e)))}catch(t){throw Ls(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Fs(this.firestore,Mf(this._delegate,function u2(...n){return ST._create("endAt",n,!0)}(...e)))}catch(t){throw Ls(t,"endAt()","Query.endAt()")}}isEqual(e){return DR(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function m2(n){n=wn(n,rs);const e=wn(n.firestore,wr),t=ci(e),r=new Of(e);return function RF(n,e){const t=new oi;return n.asyncQueue.enqueueAndForget((0,Ee.Z)(function*(){return(r=(0,Ee.Z)(function*(i,a,c){try{const h=yield oT(i,a,!0),g=new jN(a,h.ir),v=g.sc(h.documents),T=g.applyChanges(v,!1);c.resolve(T.snapshot)}catch(h){const g=J_(h,`Failed to execute query '${a} against cache`);c.reject(g)}}),function(i,a,c){return r.apply(this,arguments)})(yield mT(n),e,t);var r})),t.promise}(t,n._query).then(i=>new kf(e,r,n,i))}(this._delegate):"server"===e?.source?function _2(n){n=wn(n,rs);const e=wn(n.firestore,wr),t=ci(e),r=new Of(e);return eM(t,n._query,{source:"server"}).then(i=>new kf(e,r,n,i))}(this._delegate):function g2(n){n=wn(n,rs);const e=wn(n.firestore,wr),t=ci(e),r=new Of(e);return EM(n._query),eM(t,n._query).then(i=>new kf(e,r,n,i))}(this._delegate),t.then(r=>new FR(this.firestore,new kf(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=VM(e),r=BM(e,i=>new FR(this.firestore,new kf(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return PM(this._delegate,t,r)}withConverter(e){return new Fs(this.firestore,this._delegate.withConverter(e?Yg.getInstance(this.firestore,e):null))}}class $2{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Ew(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class FR{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Fs(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Ew(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new $2(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Ew(this._firestore,r))})}isEqual(e){return AM(this._delegate,e._delegate)}}class ay extends Fs{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Wa(this.firestore,e):null}doc(e){try{return new Wa(this.firestore,void 0===e?yT(this._delegate):yT(this._delegate,e))}catch(t){throw Ls(t,"doc()","CollectionReference.doc()")}}add(e){return function v2(n,e){const t=wn(n.firestore,wr),r=yT(n),i=AT(n.converter,e);return oy(t,[ET(qg(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,tr.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new Wa(this.firestore,t))}isEqual(e){return lM(this._delegate,e._delegate)}withConverter(e){return new ay(this.firestore,this._delegate.withConverter(e?Yg.getInstance(this.firestore,e):null))}}function Qg(n){return wn(n,vr)}class UR{constructor(...e){this._delegate=new Ed(...e)}static documentId(){return new UR(_r.keyField().canonicalString())}isEqual(e){return(e=(0,U.m9)(e))instanceof Ed&&this._delegate._internalPath.isEqual(e._internalPath)}}class Xg{constructor(e){this._delegate=e}static serverTimestamp(){const e=function M2(){return new SR("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Xg(e)}static delete(){const e=function N2(){return new fw("deleteField")}();return e._methodName="FieldValue.delete",new Xg(e)}static arrayUnion(...e){const t=function k2(...n){return new YF("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new Xg(t)}static arrayRemove(...e){const t=function O2(...n){return new QF("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new Xg(t)}static increment(e){const t=function L2(n){return new XF("increment",n)}(e);return t._methodName="FieldValue.increment",new Xg(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const H2={Firestore:LM,GeoPoint:vT,Timestamp:or,Blob:vw,Transaction:FM,WriteBatch:UM,DocumentReference:Wa,DocumentSnapshot:ww,Query:Fs,QueryDocumentSnapshot:Ew,QuerySnapshot:FR,CollectionReference:ay,FieldPath:UR,FieldValue:Xg,setLogLevel:function j2(n){!function l_(n){Fc.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};!function G2(n){(function z2(n,e){n.INTERNAL.registerComponent(new uo.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},H2)))})(n,(e,t)=>new LM(e,t,new B2)),n.registerVersion("@firebase/firestore-compat","0.3.12")}(Fm.Z);var VR=B(6451),xT=B(5363),W2=B(6063);class q2 extends Yi.x{constructor(e=1/0,t=1/0,r=W2.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:a,_windowTime:c}=this;t||(r.push(e),!i&&r.push(a.now()+c)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,a=i.slice();for(let c=0;c<a.length&&!e.closed;c+=r?1:2)e.next(a[c]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,a=(i?1:2)*e;if(e<1/0&&a<r.length&&r.splice(0,r.length-a),!i){const c=t.now();let h=0;for(let g=1;g<r.length&&r[g]<=c;g+=2)h=g;h&&r.splice(0,h+1)}}}var jM=B(3099);function $M(n,e,t){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n):r=n??1/0,(0,jM.B)({connector:()=>new q2(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function HM(n,e){return(0,Ul.m)(e)?Mn(()=>n,e):Mn(()=>n)}var BR=B(9468);B(259);const $R=new Map,GM={activated:!1,tokenObservers:[]},X2={initialized:!1,enabled:!1};function Qr(n){return $R.get(n)||Object.assign({},GM)}function NT(){return X2}const HR="https://content-firebaseappcheck.googleapis.com/v1",nU="exchangeDebugToken",WM={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class iU{constructor(e,t,r,i,a){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,Ee.Z)(function*(){t.stop();try{t.pending=new U.BH,yield function sU(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new U.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const is=new U.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function zR(n){if(!Qr(n).activated)throw is.create("use-before-activation",{appName:n.name})}function OT(n,e){return WR.apply(this,arguments)}function WR(){return WR=(0,Ee.Z)(function*({url:n,body:e},t){const r={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){const S=yield i.getHeartbeatsHeader();S&&(r["X-Firebase-Client"]=S)}const a={method:"POST",body:JSON.stringify(e),headers:r};let c,h;try{c=yield fetch(n,a)}catch(S){throw is.create("fetch-network-error",{originalErrorMessage:S?.message})}if(200!==c.status)throw is.create("fetch-status-error",{httpStatus:c.status});try{h=yield c.json()}catch(S){throw is.create("fetch-parse-error",{originalErrorMessage:S?.message})}const g=h.ttl.match(/^([\d.]+)(s)$/);if(!g||!g[2]||isNaN(Number(g[1])))throw is.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${h.ttl}`});const v=1e3*Number(g[1]),T=Date.now();return{token:h.token,expireTimeMillis:T+v,issuedAtTimeMillis:T}}),WR.apply(this,arguments)}function qM(n,e){const{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${HR}/projects/${t}/apps/${r}:${nU}?key=${i}`,body:{debug_token:e}}}const cU="firebase-app-check-database",lU=1,Iw="firebase-app-check-store";let LT=null;function qR(){return qR=(0,Ee.Z)(function*(n,e){const r=(yield function ZM(){return LT||(LT=new Promise((n,e)=>{try{const t=indexedDB.open(cU,lU);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(is.create("storage-open",{originalErrorMessage:null===(i=r.target.error)||void 0===i?void 0:i.message}))},t.onupgradeneeded=r=>{0===r.oldVersion&&r.target.result.createObjectStore(Iw,{keyPath:"compositeKey"})}}catch(t){e(is.create("storage-open",{originalErrorMessage:t?.message}))}}),LT)}()).transaction(Iw,"readwrite"),a=r.objectStore(Iw).put({compositeKey:n,value:e});return new Promise((c,h)=>{a.onsuccess=g=>{c()},r.onerror=g=>{var v;h(is.create("storage-set",{originalErrorMessage:null===(v=g.target.error)||void 0===v?void 0:v.message}))}})}),qR.apply(this,arguments)}const Cw=new gs.Yd("@firebase/app-check");function YR(n,e){return(0,U.hl)()?function hU(n,e){return function YM(n,e){return qR.apply(this,arguments)}(function XM(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{Cw.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function XR(){return NT().enabled}function JR(){return ex.apply(this,arguments)}function ex(){return ex=(0,Ee.Z)(function*(){const n=NT();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),ex.apply(this,arguments)}const yU={error:"UNKNOWN_ERROR"};function vU(n){return U.US.encodeString(JSON.stringify(n),!1)}function FT(n){return tx.apply(this,arguments)}function tx(){return tx=(0,Ee.Z)(function*(n,e=!1){const t=n.app;zR(t);const r=Qr(t);let a,i=r.token;if(i&&!uy(i)&&(r.token=void 0,i=void 0),!i){const g=yield r.cachedTokenPromise;g&&(uy(g)?i=g:yield YR(t,void 0))}if(!e&&i&&uy(i))return{token:i.token};let h,c=!1;if(XR()){r.exchangeTokenPromise||(r.exchangeTokenPromise=OT(qM(t,yield JR()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),c=!0);const g=yield r.exchangeTokenPromise;return yield YR(t,g),r.token=g,{token:g.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),c=!0),i=yield Qr(t).exchangeTokenPromise}catch(g){"appCheck/throttled"===g.code?Cw.warn(g.message):Cw.error(g),a=g}return i?a?h=uy(i)?{token:i.token,internalError:a}:nk(a):(h={token:i.token},r.token=i,yield YR(t,i)):h=nk(a),c&&function tk(n,e){const t=Qr(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch{}}(t,h),h}),tx.apply(this,arguments)}function nx(){return nx=(0,Ee.Z)(function*(n){const e=n.app;zR(e);const{provider:t}=Qr(e);if(XR()){const r=yield JR(),{token:i}=yield OT(qM(e,r),n.heartbeatServiceProvider);return{token:i}}{const{token:r}=yield t.getToken();return{token:r}}}),nx.apply(this,arguments)}function ix(n,e){const t=Qr(n),r=t.tokenObservers.filter(i=>i.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function ek(n){const{app:e}=n,t=Qr(e);let r=t.tokenRefresher;r||(r=function wU(n){const{app:e}=n;return new iU((0,Ee.Z)(function*(){let r;if(r=Qr(e).token?yield FT(n,!0):yield FT(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const t=Qr(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},WM.RETRIAL_MIN_WAIT,WM.RETRIAL_MAX_WAIT)}(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function uy(n){return n.expireTimeMillis-Date.now()>0}function nk(n){return{token:vU(yU),error:n}}class EU{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=Qr(this.app);for(const t of e)ix(this.app,t.next);return Promise.resolve()}}const lk="app-check-internal";!function OU(){(0,Ai._registerComponent)(new uo.wA("app-check",n=>function IU(n,e){return new EU(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(lk).initialize()})),(0,Ai._registerComponent)(new uo.wA(lk,n=>function CU(n){return{getToken:e=>FT(n,e),getLimitedUseToken:()=>function JM(n){return nx.apply(this,arguments)}(n),addTokenListener:e=>function rx(n,e,t,r){const{app:i}=n,a=Qr(i);if(a.tokenObservers=[...a.tokenObservers,{next:t,error:r,type:e}],a.token&&uy(a.token)){const h=a.token;Promise.resolve().then(()=>{t({token:h.token}),ek(n)}).catch(()=>{})}a.cachedTokenPromise.then(()=>ek(n))}(n,"INTERNAL",e),removeTokenListener:e=>ix(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,Ai.registerVersion)("@firebase/app-check","0.8.0")}();class Tw{constructor(){return(0,vn.vb)("app-check")}}typeof window<"u"&&window;var VT=B(9260);const cx=new _.OlP("angularfire2.auth.use-emulator"),lx=new _.OlP("angularfire2.auth.settings"),dx=new _.OlP("angularfire2.auth.tenant-id"),hx=new _.OlP("angularfire2.auth.langugage-code"),fx=new _.OlP("angularfire2.auth.use-device-language"),px=new _.OlP("angularfire.auth.persistence"),gx=(n,e,t,r,i,a,c,h)=>(0,si.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const g=e.runOutsideAngular(()=>n.auth());if(t&&g.useEmulator(...t),r&&(g.tenantId=r),g.languageCode=i,a&&g.useDeviceLanguage(),c)for(const[v,T]of Object.entries(c))g.settings[v]=T;return h&&g.setPersistence(h),g},[t,r,i,a,c,h]);let Dw=(()=>{class n{constructor(t,r,i,a,c,h,g,v,T,S,M,$){const Y=new Yi.x,fe=ut(void 0).pipe((0,xT.Q)(c.outsideAngular),Mn(()=>a.runOutsideAngular(()=>Promise.resolve().then(B.bind(B,9568)))),(0,yt.U)(()=>(0,si.on)(t,a,r)),(0,yt.U)(ge=>gx(ge,a,h,v,T,S,g,M)),$M({bufferSize:1,refCount:!1}));if(aa(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=ut(null);else{fe.pipe(Xi()).subscribe();const et=fe.pipe(Mn(ht=>ht.getRedirectResult().then(Bt=>Bt,()=>null)),vn.iC,$M({bufferSize:1,refCount:!1})),it=fe.pipe(Mn(ht=>new ii.y(Bt=>({unsubscribe:a.runOutsideAngular(()=>ht.onAuthStateChanged(on=>Bt.next(on),on=>Bt.error(on),()=>Bt.complete()))})))),Ze=fe.pipe(Mn(ht=>new ii.y(Bt=>({unsubscribe:a.runOutsideAngular(()=>ht.onIdTokenChanged(on=>Bt.next(on),on=>Bt.error(on),()=>Bt.complete()))}))));this.authState=et.pipe(HM(it),(0,BR.R)(c.outsideAngular),(0,xT.Q)(c.insideAngular)),this.user=et.pipe(HM(Ze),(0,BR.R)(c.outsideAngular),(0,xT.Q)(c.insideAngular)),this.idToken=this.user.pipe(Mn(ht=>ht?(0,ln.D)(ht.getIdToken()):ut(null))),this.idTokenResult=this.user.pipe(Mn(ht=>ht?(0,ln.D)(ht.getIdTokenResult()):ut(null))),this.credential=(0,VR.T)(et,Y,this.authState.pipe(Vi(ht=>!ht))).pipe((0,yt.U)(ht=>ht?.user?ht:null),(0,BR.R)(c.outsideAngular),(0,xT.Q)(c.insideAngular))}return(0,si.pX)(this,fe,a,{spy:{apply:(ge,et,it)=>{(ge.startsWith("signIn")||ge.startsWith("createUser"))&&it.then(Ze=>Y.next(Ze))}}})}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(si.Dh),_.LFG(si.xv,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(vn.HU),_.LFG(cx,8),_.LFG(lx,8),_.LFG(dx,8),_.LFG(hx,8),_.LFG(fx,8),_.LFG(px,8),_.LFG(Tw,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),jU=(()=>{class n{constructor(){VT.Z.registerVersion("angularfire",vn.q4.full,"auth-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[Dw]}),n})();function hk(n,e){return function $U(n,e=Bp.z){return new ii.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}(n,e)}function mx(n,e){return hk(n,e).pipe((0,yt.U)(t=>({payload:t,type:"query"})))}function BT(n,e){return mx(n,e).pipe(Ia(void 0),jp(),(0,yt.U)(([t,r])=>{const i=r.payload.docChanges(),a=i.map(c=>({type:c.type,payload:c}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((c,h)=>{const g=i.find(T=>T.doc.ref.isEqual(c.ref)),v=t?.payload.docs.find(T=>T.ref.isEqual(c.ref));g&&JSON.stringify(g.doc.metadata)===JSON.stringify(c.metadata)||!g&&v&&JSON.stringify(v.metadata)===JSON.stringify(c.metadata)||a.push({type:"modified",payload:{oldIndex:h,newIndex:h,type:"modified",doc:c}})}),a}))}function fk(n,e,t){return BT(n,t).pipe(Ta((r,i)=>function zU(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function GU(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return _x(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return _x(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return _x(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(a=>a.payload),e),[]),fv(),(0,yt.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function _x(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function pk(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class gk{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=BT(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,yt.U)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(Ia(void 0),jp(),Vi(([r,i])=>i.length>0||!r),(0,yt.U)(([r,i])=>i),vn.iC)}auditTrail(e){return this.stateChanges(e).pipe(Ta((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=pk(e);return fk(this.query,t,this.afs.schedulers.outsideAngular).pipe(vn.iC)}valueChanges(e={}){return mx(this.query,this.afs.schedulers.outsideAngular).pipe((0,yt.U)(t=>t.payload.docs.map(r=>e.idField?Object.assign(Object.assign({},r.data()),{[e.idField]:r.id}):r.data())),vn.iC)}get(e){return(0,ln.D)(this.query.get(e)).pipe(vn.iC)}add(e){return this.ref.add(e)}doc(e){return new mk(this.ref.doc(e),this.afs)}}class mk{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:a}=vk(r,t);return new gk(i,a,this.afs)}snapshotChanges(){return function HU(n,e){return hk(n,e).pipe(Ia(void 0),jp(),(0,yt.U)(([t,r])=>r.exists?t?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(vn.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,yt.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,ln.D)(this.ref.get(e)).pipe(vn.iC)}}class WU{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?BT(this.query,this.afs.schedulers.outsideAngular).pipe((0,yt.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),Vi(t=>t.length>0),vn.iC):BT(this.query,this.afs.schedulers.outsideAngular).pipe(vn.iC)}auditTrail(e){return this.stateChanges(e).pipe(Ta((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=pk(e);return fk(this.query,t,this.afs.schedulers.outsideAngular).pipe(vn.iC)}valueChanges(e={}){return mx(this.query,this.afs.schedulers.outsideAngular).pipe((0,yt.U)(r=>r.payload.docs.map(i=>e.idField?Object.assign({[e.idField]:i.id},i.data()):i.data())),vn.iC)}get(e){return(0,ln.D)(this.query.get(e)).pipe(vn.iC)}}const _k=new _.OlP("angularfire2.enableFirestorePersistence"),yk=new _.OlP("angularfire2.firestore.persistenceSettings"),qU=new _.OlP("angularfire2.firestore.settings"),KU=new _.OlP("angularfire2.firestore.use-emulator");function vk(n,e=(t=>t)){return{query:e(n),ref:n}}let wk=(()=>{class n{constructor(t,r,i,a,c,h,g,v,T,S,M,$,Y,fe,ge,et,it){this.schedulers=g;const Ze=(0,si.on)(t,h,r),ht=T;S&&gx(Ze,h,M,Y,fe,ge,$,et),[this.firestore,this.persistenceEnabled$]=(0,si.cc)(`${Ze.name}.firestore`,"AngularFirestore",Ze.name,()=>{const Bt=h.runOutsideAngular(()=>Ze.firestore());if(a&&Bt.settings(a),ht&&Bt.useEmulator(...ht),i&&!aa(c)){const on=()=>{try{return(0,ln.D)(Bt.enablePersistence(v||void 0).then(()=>!0,()=>!1))}catch(Ci){return typeof console<"u"&&console.warn(Ci),ut(!1)}};return[Bt,h.runOutsideAngular(on)]}return[Bt,ut(!1)]},[a,ht,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:a,query:c}=vk(i,r),h=this.schedulers.ngZone.run(()=>a);return new gk(h,c,this)}collectionGroup(t,r){const i=r||(c=>c),a=this.firestore.collectionGroup(t);return new WU(i(a),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new mk(i,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(si.Dh),_.LFG(si.xv,8),_.LFG(_k,8),_.LFG(qU,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(vn.HU),_.LFG(yk,8),_.LFG(KU,8),_.LFG(Dw,8),_.LFG(cx,8),_.LFG(lx,8),_.LFG(dx,8),_.LFG(hx,8),_.LFG(fx,8),_.LFG(px,8),_.LFG(Tw,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),ZU=(()=>{class n{constructor(){VT.Z.registerVersion("angularfire",vn.q4.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:_k,useValue:!0},{provide:yk,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[wk]}),n})(),Jg=(()=>{class n{constructor(t,r,i,a){this.afs=t,this.angAuth=r,this.router=i,this.ngZone=a,this.angAuth.authState.subscribe(c=>{c?(this.userData=c,localStorage.setItem("user",JSON.stringify(this.userData)),JSON.parse(localStorage.getItem("user"))):(localStorage.setItem("user","null"),JSON.parse(localStorage.getItem("user")))})}SignIn(t,r){return this.angAuth.signInWithEmailAndPassword(t,r).then(i=>{this.SetUserData(i.user),this.angAuth.authState.subscribe(a=>{a&&this.router.navigate(["dashboard"])})}).catch(i=>{window.alert(i.message)})}SignUp(t,r){return this.angAuth.createUserWithEmailAndPassword(t,r).then(i=>{this.SendVerificationMail(),this.SetUserData(i.user)})}SendVerificationMail(){return this.angAuth.currentUser.then(t=>t.sendEmailVerification()).then(()=>{this.router.navigate(["verify-email-address"])})}ForgotPassword(t){return this.angAuth.sendPasswordResetEmail(t).then(()=>{window.alert("password reset email sent, check your box")}).catch(r=>{window.alert(r)})}get isLoggedIn(){const t=JSON.parse(localStorage.getItem("user"));return null!==t&&!1!==t.emailVerified}GoogleAuth(){return this.AuthLogin(new hv.V).then(t=>{this.router.navigate(["dashboard"])})}AuthLogin(t){return this.angAuth.signInWithPopup(t).then(r=>{this.router.navigate(["dashboard"]),this.SetUserData(r.user)}).catch(r=>{window.alert(r)})}SetUserData(t){return this.afs.doc(`users/${t.user_id}`).set({uid:t.uid,email:t.email,displayName:t.displayName,photoURL:t.photoURL,emailVerified:t.emailVerified},{merge:!0})}SignOut(){return this.angAuth.signOut().then(()=>{localStorage.removeItem("user"),this.router.navigate(["sign-in"])})}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(wk),_.LFG(Dw),_.LFG(ji),_.LFG(_.R0b))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),YU=(()=>{class n{constructor(t){this.authService=t}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(Jg))},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-sign-in"]],decls:27,vars:0,consts:[[1,"displayTable",2,"position","absolute","left","620px","top","170px"],[1,"displayTableCell"],[1,"authBlock"],[1,"formGroup"],["type","text","placeholder","Username","required","",1,"formControl"],["userName",""],["type","password","placeholder","Password","required","",1,"formControl"],["userPassword",""],["type","button","value","Log in",1,"btn","btnPrimary",2,"border","solid 1px",3,"click"],["type","button",1,"btn","googleBtn",2,"border","solid 1px","width","200px",3,"click"],[1,"fab","fa-google-plus-g"],[1,"forgotPassword"],["routerLink","/forgot-password",2,"text-decoration","none"],[1,"redirectToLogin"],["routerLink","/register-user",1,"redirect",2,"text-decoration","none"],["routerLink","/register-user",1,"redirect"]],template:function(t,r){if(1&t){const i=_.EpF();_.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),_._uU(4,"Sign In"),_.qZA(),_.TgZ(5,"div",3),_._UZ(6,"input",4,5),_.qZA(),_.TgZ(8,"div",3),_._UZ(9,"input",6,7),_.qZA(),_.TgZ(11,"div",3)(12,"input",8),_.NdJ("click",function(){_.CHM(i);const c=_.MAs(7),h=_.MAs(10);return _.KtG(r.authService.SignIn(c.value,h.value))}),_.qZA()(),_.TgZ(13,"div",3)(14,"button",9),_.NdJ("click",function(){return r.authService.GoogleAuth()}),_._UZ(15,"i",10),_._uU(16," Log in with Google "),_.qZA()(),_.TgZ(17,"div",11)(18,"a",12)(19,"span"),_._uU(20,"Forgot Password ?"),_.qZA()()()(),_.TgZ(21,"div",13)(22,"a",14)(23,"span"),_._uU(24,"Don't have an account?"),_.TgZ(25,"span",15),_._uU(26," Sign Up"),_.qZA()()()()()()}},dependencies:[Wl],styles:[".formGroup[_ngcontent-%COMP%]{width:200px}input[_ngcontent-%COMP%]{width:200px;height:40px;margin-bottom:20px}.forgotPassword[_ngcontent-%COMP%], .redirectToLogin[_ngcontent-%COMP%]{position:relative;top:10px}"]}),n})(),QU=(()=>{class n{constructor(t){this.authService=t}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(Jg))},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-sign-up"]],decls:23,vars:0,consts:[[1,"displayTable",2,"position","absolute","left","620px","top","170px"],[1,"displayTableCell"],[1,"authBlock"],[1,"formGroup"],["type","email","placeholder","Email Address","required","",1,"formControl"],["userEmail",""],["type","password","placeholder","Password","required","",1,"formControl"],["userPwd",""],["type","button","value","Sign Up",1,"btn","btnPrimary",2,"border","solid 1px",3,"click"],["type","button",1,"btn","googleBtn",2,"border","solid 1px","width","200px",3,"click"],[1,"fab","fa-google-plus-g"],[1,"redirectToLogin"],["routerLink","/sign-in",2,"text-decoration","none"],[1,"redirect"]],template:function(t,r){if(1&t){const i=_.EpF();_.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),_._uU(4,"Sign Up"),_.qZA(),_.TgZ(5,"div",3),_._UZ(6,"input",4,5),_.qZA(),_.TgZ(8,"div",3),_._UZ(9,"input",6,7),_.qZA(),_.TgZ(11,"div",3)(12,"input",8),_.NdJ("click",function(){_.CHM(i);const c=_.MAs(7),h=_.MAs(10);return _.KtG(r.authService.SignUp(c.value,h.value))}),_.qZA()(),_.TgZ(13,"div",3)(14,"button",9),_.NdJ("click",function(){return r.authService.GoogleAuth()}),_._UZ(15,"i",10),_._uU(16," Continue with Google "),_.qZA()()(),_.TgZ(17,"div",11)(18,"a",12)(19,"span"),_._uU(20,"Already have an account? "),_.TgZ(21,"span",13),_._uU(22,"Log In"),_.qZA()()()()()()}},dependencies:[Wl],styles:[".formGroup[_ngcontent-%COMP%]{width:200px}input[_ngcontent-%COMP%]{width:200px;height:40px;margin-bottom:20px}.forgotPassword[_ngcontent-%COMP%], .redirectToLogin[_ngcontent-%COMP%]{position:relative;top:10px}"]}),n})();function XU(n,e){if(1&n&&(_.TgZ(0,"div",3)(1,"div",16)(2,"div",17),_._UZ(3,"img",18),_.TgZ(4,"div",19)(5,"h1"),_._uU(6,"Hello: "),_.TgZ(7,"strong"),_._uU(8),_.qZA()(),_.TgZ(9,"p"),_._uU(10,"User ID: "),_.TgZ(11,"strong"),_._uU(12),_.qZA()(),_.TgZ(13,"p"),_._uU(14,"Email: "),_.TgZ(15,"strong"),_._uU(16),_.qZA()(),_.TgZ(17,"p"),_._uU(18,"Email Verified: "),_.TgZ(19,"strong"),_._uU(20),_.qZA()()()()()()),2&n){const t=e.ngIf;_.xp6(3),_.s9C("src",t.photoURL?t.photoURL:"/assets/dummy-user.png",_.LSH),_.s9C("alt",t.displayName),_.xp6(5),_.Oqu(t.displayName?t.displayName:"User"),_.xp6(4),_.Oqu(t.uid),_.xp6(4),_.Oqu(t.email),_.xp6(4),_.Oqu(t.emailVerified)}}let JU=(()=>{class n{constructor(t){this.authService=t}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(Jg))},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-dashboard"]],decls:19,vars:1,consts:[["href","",2,"text-decoration","none","position","relative","top","20px",3,"click"],[1,"fas","fa-sign-out-alt"],[1,"container-fluid",2,"position","absolute","top","100px"],[1,"row"],[1,"col-md-2","d-md-block","bg-light","sidebar",2,"position","relative"],["src","assets/avatar.jpg","alt","positronX.io Logo",1,"brand-logo",2,"width","230px","height","250px"],[1,"sidebar-sticky"],[1,"nav","flex-column"],[1,"nav-item"],[1,"nav-link","active"],[1,"fas","fa-user"],["role","main",1,"col-md-9","ml-sm-auto","col-lg-10","px-4"],[1,"inner-adjust"],[1,"pt-3","pb-2","mb-3","border-bottom"],[1,"h2"],["class","row",4,"ngIf"],[1,"col-md-12"],[1,"media"],[1,"align-self-start","mr-5","img-thumbnail","rounded-circle",3,"src","alt"],[1,"media-body"]],template:function(t,r){1&t&&(_.TgZ(0,"a",0),_.NdJ("click",function(){return r.authService.SignOut()}),_._UZ(1,"i",1),_._uU(2,"Log out "),_.qZA(),_.TgZ(3,"div",2)(4,"div",3)(5,"nav",4),_._UZ(6,"img",5),_.TgZ(7,"div",6)(8,"ul",7)(9,"li",8)(10,"a",9),_._UZ(11,"i",10),_._uU(12,"User Profile "),_.qZA()()()()(),_.TgZ(13,"main",11)(14,"div",12)(15,"div",13)(16,"h1",14),_._uU(17,"User Profile"),_.qZA()(),_.YNc(18,XU,21,6,"div",15),_.qZA()()()()),2&t&&(_.xp6(18),_.Q6J("ngIf",r.authService.userData))},dependencies:[$s]}),n})(),eV=(()=>{class n{constructor(t){this.authService=t}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(Jg))},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-forgot-password"]],decls:18,vars:0,consts:[[1,"displayTable"],[1,"displayTableCell"],[1,"authBlock"],[1,"text-center",2,"position","relative","right","100px"],[1,"formGroup"],["type","email","placeholder","Email Address","required","",1,"formControl"],["passwordResetEmail",""],["type","submit","value","Reset Password",1,"btn","btnPrimary",2,"width","200px","border","solid 1px",3,"click"],[1,"redirectToLogin"],["routerLink","/sign-in",2,"text-decoration","none"],[1,"redirect"]],template:function(t,r){if(1&t){const i=_.EpF();_.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),_._uU(4,"Reset Password"),_.qZA(),_.TgZ(5,"p",3),_._uU(6,"Please enter your email address to request a password reset."),_.qZA(),_.TgZ(7,"div",4),_._UZ(8,"input",5,6),_.qZA(),_.TgZ(10,"div",4)(11,"input",7),_.NdJ("click",function(){_.CHM(i);const c=_.MAs(9);return _.KtG(r.authService.ForgotPassword(c.value))}),_.qZA()()(),_.TgZ(12,"div",8)(13,"a",9)(14,"span"),_._uU(15,"Go back to ? "),_.TgZ(16,"span",10),_._uU(17,"Log In"),_.qZA()()()()()()}},dependencies:[Wl],styles:[".displayTable[_ngcontent-%COMP%]{position:absolute;left:620px;top:170px}.formGroup[_ngcontent-%COMP%]{width:200px}input[_ngcontent-%COMP%]{width:200px;height:40px;margin-bottom:20px}.forgotPassword[_ngcontent-%COMP%], .redirectToLogin[_ngcontent-%COMP%]{position:relative;top:10px}"]}),n})();function tV(n,e){if(1&n&&(_.TgZ(0,"div",4)(1,"p",9),_._uU(2,"We have sent a confirmation email to "),_.TgZ(3,"strong"),_._uU(4),_.qZA(),_._uU(5,"."),_.qZA(),_.TgZ(6,"p",9),_._uU(7,"Please check your email and click on the link to verfiy your email address."),_.qZA()()),2&n){const t=e.ngIf;_.xp6(4),_.Oqu(t.email)}}const nV=[{path:"",redirectTo:"sign-in",pathMatch:"full"},{path:"sign-in",component:YU},{path:"register-user",component:QU},{path:"dashboard",component:JU,canActivate:[(()=>{class n{constructor(t,r){this.authService=t,this.router=r}canActivate(t,r){return!0!==this.authService.isLoggedIn&&this.router.navigate(["sign-in"]),!0}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Jg),_.LFG(ji))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()]},{path:"forgot-password",component:eV},{path:"verify-email-address",component:(()=>{class n{constructor(t){this.authService=t}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(Jg))},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-verify-email"]],decls:15,vars:1,consts:[[1,"displayTable"],[1,"displayTableCell"],[1,"authBlock"],["class","formGroup",4,"ngIf"],[1,"formGroup"],["type","button",1,"btn","btnPrimary",3,"click"],[1,"fas","fa-redo-alt"],[1,"redirectToLogin"],["routerLink","/sign-in",1,"redirect"],[1,"text-center"]],template:function(t,r){1&t&&(_.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),_._uU(4,"Thank You for Registering"),_.qZA(),_.YNc(5,tV,8,1,"div",3),_.TgZ(6,"div",4)(7,"button",5),_.NdJ("click",function(){return r.authService.SendVerificationMail()}),_._UZ(8,"i",6),_._uU(9," Resend Verification Email "),_.qZA()()(),_.TgZ(10,"div",7)(11,"span"),_._uU(12,"Go back to?"),_.TgZ(13,"span",8),_._uU(14," Sign in"),_.qZA()()()()()),2&t&&(_.xp6(5),_.Q6J("ngIf",r.authService.userData))},dependencies:[$s,Wl]}),n})()}];let rV=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({imports:[bb.forRoot(nV),bb]}),n})(),iV=(()=>{class n{constructor(){this.title="UserAuthentication"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(t,r){1&t&&_._UZ(0,"router-outlet")},dependencies:[Uy]}),n})();const Ek="firebasestorage.googleapis.com",Ik="storageBucket";class jr extends U.ZR{constructor(e,t,r=0){super(yx(e),`Firebase Storage: ${t} (${yx(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,jr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return yx(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var ur=(()=>(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(ur||(ur={})),ur))();function yx(n){return"storage/"+n}function vx(){return new jr(ur.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function Ck(){return new jr(ur.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Tk(){return new jr(ur.CANCELED,"User canceled the upload/download.")}function Dk(){return new jr(ur.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function cy(n){return new jr(ur.INVALID_ARGUMENT,n)}function bk(){return new jr(ur.APP_DELETED,"The Firebase app was deleted.")}function Sk(n){return new jr(ur.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function bw(n,e){return new jr(ur.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Sw(n){throw new jr(ur.INTERNAL_ERROR,"Internal error: "+n)}class ws{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=ws.makeFromUrl(e,t)}catch{return new ws(e,"")}if(""===r.path)return r;throw function gV(n){return new jr(ur.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)",h=new RegExp("^gs://"+i+"(/(.*))?$","i");function v(ht){ht.path_=decodeURIComponent(ht.path)}const S=t.replace(/[.]/g,"\\."),Ze=[{regex:h,indices:{bucket:1,path:3},postModify:function a(ht){"/"===ht.path.charAt(ht.path.length-1)&&(ht.path_=ht.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${S}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:v},{regex:new RegExp(`^https?://${t===Ek?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:v}];for(let ht=0;ht<Ze.length;ht++){const Bt=Ze[ht],on=Bt.regex.exec(e);if(on){let na=on[Bt.indices.path];na||(na=""),r=new ws(on[Bt.indices.bucket],na),Bt.postModify(r);break}}if(null==r)throw function pV(n){return new jr(ur.INVALID_URL,"Invalid URL '"+n+"'.")}(e);return r}}class wV{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function jT(n){return"string"==typeof n||n instanceof String}function Ak(n){return wx()&&n instanceof Blob}function wx(){return typeof Blob<"u"&&!(0,U.UG)()}function Ex(n,e,t,r){if(r<e)throw cy(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw cy(`Invalid value for '${n}'. Expected ${t} or less.`)}function Cd(n,e,t){let r=e;return null==t&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function Rk(n){const e=encodeURIComponent;let t="?";for(const r in n)n.hasOwnProperty(r)&&(t=t+(e(r)+"=")+e(n[r])+"&");return t=t.slice(0,-1),t}var Ff=(()=>(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"}(Ff||(Ff={})),Ff))();function xk(n,e){const t=n>=500&&n<600,i=-1!==[408,429].indexOf(n),a=-1!==e.indexOf(n);return t||i||a}class bV{constructor(e,t,r,i,a,c,h,g,v,T,S,M=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=c,this.callback_=h,this.errorCallback_=g,this.timeout_=v,this.progressCallback_=T,this.connectionFactory_=S,this.retry=M,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(($,Y)=>{this.resolve_=$,this.reject_=Y,this.start_()})}start_(){const t=(r,i)=>{const a=this.resolve_,c=this.reject_,h=i.connection;if(i.wasSuccessCode)try{const g=this.callback_(h,h.getResponse());!function CV(n){return void 0!==n}(g)?a():a(g)}catch(g){c(g)}else if(null!==h){const g=vx();g.serverResponse=h.getErrorText(),c(this.errorCallback_?this.errorCallback_(h,g):g)}else c(i.canceled?this.appDelete_?bk():Tk():Ck())};this.canceled_?t(0,new $T(!1,null,!0)):this.backoffId_=function EV(n,e,t){let r=1,i=null,a=null,c=!1,h=0;function g(){return 2===h}let v=!1;function T(...ge){v||(v=!0,e.apply(null,ge))}function S(ge){i=setTimeout(()=>{i=null,n($,g())},ge)}function M(){a&&clearTimeout(a)}function $(ge,...et){if(v)return void M();if(ge)return M(),void T.call(null,ge,...et);if(g()||c)return M(),void T.call(null,ge,...et);let Ze;r<64&&(r*=2),1===h?(h=2,Ze=0):Ze=1e3*(r+Math.random()),S(Ze)}let Y=!1;function fe(ge){Y||(Y=!0,M(),!v&&(null!==i?(ge||(h=2),clearTimeout(i),S(0)):ge||(h=1)))}return S(0),a=setTimeout(()=>{c=!0,fe(!0)},t),fe}((r,i)=>{if(i)return void r(!1,new $T(!1,null,!0));const a=this.connectionFactory_();this.pendingConnection_=a;const c=h=>{null!==this.progressCallback_&&this.progressCallback_(h.loaded,h.lengthComputable?h.total:-1)};null!==this.progressCallback_&&a.addUploadProgressListener(c),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&a.removeUploadProgressListener(c),this.pendingConnection_=null;const h=a.getErrorCode()===Ff.NO_ERROR,g=a.getStatus();if(!h||xk(g,this.additionalRetryCodes_)&&this.retry){const T=a.getErrorCode()===Ff.ABORT;return void r(!1,new $T(!1,null,T))}const v=-1!==this.successCodes_.indexOf(g);r(!0,new $T(v,a))})},t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function IV(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class $T{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function MV(...n){const e=function NV(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==e){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}if(wx())return new Blob(n);throw new jr(ur.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const Jo={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Ix{constructor(e,t){this.data=e,this.contentType=t||null}}function Cx(n,e){switch(n){case Jo.RAW:return new Ix(Pk(e));case Jo.BASE64:case Jo.BASE64URL:return new Ix(Nk(n,e));case Jo.DATA_URL:return new Ix(function FV(n){const e=new Mk(n);return e.base64?Nk(Jo.BASE64,e.rest):function LV(n){let e;try{e=decodeURIComponent(n)}catch{throw bw(Jo.DATA_URL,"Malformed data URL.")}return Pk(e)}(e.rest)}(e),function UV(n){return new Mk(n).contentType}(e))}throw vx()}function Pk(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?t<n.length-1&&56320==(64512&n.charCodeAt(t+1))?(r=65536|(1023&r)<<10|1023&n.charCodeAt(++t),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function Nk(n,e){switch(n){case Jo.BASE64:{const i=-1!==e.indexOf("-"),a=-1!==e.indexOf("_");if(i||a)throw bw(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Jo.BASE64URL:{const i=-1!==e.indexOf("+"),a=-1!==e.indexOf("/");if(i||a)throw bw(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=function OV(n){if(typeof atob>"u")throw function vV(n){return new jr(ur.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(n)}(e)}catch(i){throw i.message.includes("polyfill")?i:bw(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class Mk{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw bw(Jo.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function VV(n,e){return n.length>=e.length&&n.substring(n.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class tl{constructor(e,t){let r=0,i="";Ak(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(Ak(this.data_)){const i=function kV(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}(this.data_,e,t);return null===i?null:new tl(i)}{const r=new Uint8Array(this.data_.buffer,e,t-e);return new tl(r,!0)}}static getBlob(...e){if(wx()){const t=e.map(r=>r instanceof tl?r.data_:r);return new tl(MV.apply(null,t))}{const t=e.map(c=>jT(c)?Cx(Jo.RAW,c).data:c.data_);let r=0;t.forEach(c=>{r+=c.byteLength});const i=new Uint8Array(r);let a=0;return t.forEach(c=>{for(let h=0;h<c.length;h++)i[a++]=c[h]}),new tl(i,!0)}}uploadData(){return this.data_}}function Tx(n){let e;try{e=JSON.parse(n)}catch{return null}return function DV(n){return"object"==typeof n&&!Array.isArray(n)}(e)?e:null}function kk(n){const e=n.lastIndexOf("/",n.length-2);return-1===e?n:n.slice(e+1)}function $V(n,e){return e}class Us{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||$V}}let HT=null;function Aw(){if(HT)return HT;const n=[];n.push(new Us("bucket")),n.push(new Us("generation")),n.push(new Us("metageneration")),n.push(new Us("name","fullPath",!0));const t=new Us("name");t.xform=function e(a,c){return function HV(n){return!jT(n)||n.length<2?n:kk(n)}(c)},n.push(t);const i=new Us("size");return i.xform=function r(a,c){return void 0!==c?Number(c):c},n.push(i),n.push(new Us("timeCreated")),n.push(new Us("updated")),n.push(new Us("md5Hash",null,!0)),n.push(new Us("cacheControl",null,!0)),n.push(new Us("contentDisposition",null,!0)),n.push(new Us("contentEncoding",null,!0)),n.push(new Us("contentLanguage",null,!0)),n.push(new Us("contentType",null,!0)),n.push(new Us("metadata","customMetadata",!0)),HT=n,HT}function Ok(n,e,t){const r=Tx(e);return null===r?null:function GV(n,e,t){const r={type:"file"},i=t.length;for(let a=0;a<i;a++){const c=t[a];r[c.local]=c.xform(r,e[c.server])}return function zV(n,e){Object.defineProperty(n,"ref",{get:function t(){const a=new ws(n.bucket,n.fullPath);return e._makeStorageReference(a)}})}(r,n),r}(n,r,t)}function Dx(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const a=e[i];a.writable&&(t[a.server]=n[a.local])}return JSON.stringify(t)}const Lk="prefixes",Fk="items";class nl{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function rl(n){if(!n)throw vx()}function zT(n,e){return function t(r,i){const a=Ok(n,i,e);return rl(null!==a),a}}function ly(n){return function e(t,r){let i;return i=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?function hV(){return new jr(ur.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function dV(){return new jr(ur.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===t.getStatus()?function lV(n){return new jr(ur.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===t.getStatus()?function fV(n){return new jr(ur.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}(n.path):r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}}function Rw(n){const e=ly(n);return function t(r,i){let a=e(r,i);return 404===r.getStatus()&&(a=function cV(n){return new jr(ur.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}(n.path)),a.serverResponse=i.serverResponse,a}}function Uk(n,e,t){const i=Cd(e.fullServerUrl(),n.host,n._protocol),c=n.maxOperationRetryTime,h=new nl(i,"GET",zT(n,t),c);return h.errorHandler=Rw(e),h}function QV(n,e,t,r,i){const a={};a.prefix=e.isRoot?"":e.path+"/",t&&t.length>0&&(a.delimiter=t),r&&(a.pageToken=r),i&&(a.maxResults=i);const h=Cd(e.bucketOnlyServerUrl(),n.host,n._protocol),v=n.maxOperationRetryTime,T=new nl(h,"GET",function ZV(n,e){return function t(r,i){const a=function KV(n,e,t){const r=Tx(t);return null===r?null:function qV(n,e,t){const r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[Lk])for(const i of t[Lk]){const a=i.replace(/\/$/,""),c=n._makeStorageReference(new ws(e,a));r.prefixes.push(c)}if(t[Fk])for(const i of t[Fk]){const a=n._makeStorageReference(new ws(e,i.name));r.items.push(a)}return r}(n,e,r)}(n,e,i);return rl(null!==a),a}}(n,e.bucket),v);return T.urlParams=a,T.errorHandler=ly(e),T}function Bk(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=function tB(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}class GT{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}}function bx(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{rl(!1)}return rl(!!t&&-1!==(e||["active"]).indexOf(t)),t}const sB={STATE_CHANGED:"state_changed"},Vs={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Sx(n){switch(n){case"running":case"pausing":case"canceling":return Vs.RUNNING;case"paused":return Vs.PAUSED;case"success":return Vs.SUCCESS;case"canceled":return Vs.CANCELED;default:return Vs.ERROR}}class oB{constructor(e,t,r){if(function TV(n){return"function"==typeof n}(e)||null!=t||null!=r)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{const a=e;this.next=a.next,this.error=a.error,this.complete=a.complete}}}function dy(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}let Hk=null;class aB{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ff.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ff.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ff.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw Sw("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(const a in i)i.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,i[a].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Sw("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Sw("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Sw("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Sw("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class uB extends aB{initXhr(){this.xhr_.responseType="text"}}function zu(){return Hk?Hk():new uB}class zk{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=Aw(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(ur.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const a=this.isExponentialBackoffExpired();if(xk(i.status,[])){if(!a)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();i=Ck()}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(ur.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,a)=>{this._resolve=i,this._reject=a,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const r=function nB(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),c=Bk(e,r,i),h={name:c.fullPath},g=Cd(a,n.host,n._protocol),T={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":c.contentType,"Content-Type":"application/json; charset=utf-8"},S=Dx(c,t),Y=new nl(g,"POST",function $(fe){let ge;bx(fe);try{ge=fe.getResponseHeader("X-Goog-Upload-URL")}catch{rl(!1)}return rl(jT(ge)),ge},n.maxUploadRetryTime);return Y.urlParams=h,Y.headers=T,Y.body=S,Y.errorHandler=ly(e),Y}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,zu,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const i=function rB(n,e,t,r){const g=new nl(t,"POST",function a(v){const T=bx(v,["active","final"]);let S=null;try{S=v.getResponseHeader("X-Goog-Upload-Size-Received")}catch{rl(!1)}S||rl(!1);const M=Number(S);return rl(!isNaN(M)),new GT(M,r.size(),"final"===T)},n.maxUploadRetryTime);return g.headers={"X-Goog-Upload-Command":"query"},g.errorHandler=ly(e),g}(this._ref.storage,this._ref._location,e,this._blob),a=this._ref.storage._makeRequest(i,zu,t,r);this._request=a,a.getPromise().then(c=>{this._request=void 0,this._updateProgress(c.current),this._needToFetchStatus=!1,c.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,t=new GT(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,a)=>{let c;try{c=function iB(n,e,t,r,i,a,c,h){const g=new GT(0,0);if(c?(g.current=c.current,g.total=c.total):(g.current=0,g.total=r.size()),r.size()!==g.total)throw function _V(){return new jr(ur.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const v=g.total-g.current;let T=v;i>0&&(T=Math.min(T,i));const S=g.current;let $="";$=0===T?"finalize":v===T?"upload, finalize":"upload";const Y={"X-Goog-Upload-Command":$,"X-Goog-Upload-Offset":`${g.current}`},fe=r.slice(S,S+T);if(null===fe)throw Dk();const Ze=new nl(t,"POST",function ge(ht,Bt){const on=bx(ht,["active","final"]),Ci=g.current+T,na=r.size();let Ty;return Ty="final"===on?zT(e,a)(ht,Bt):null,new GT(Ci,na,"final"===on,Ty)},e.maxUploadRetryTime);return Ze.headers=Y,Ze.body=fe.uploadData(),Ze.progressCallback=h||null,Ze.errorHandler=ly(n),Ze}(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(g){return this._error=g,void this._transition("error")}const h=this._ref.storage._makeRequest(c,zu,i,a,!1);this._request=h,h.getPromise().then(g=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(g.current),g.finalized?(this._metadata=g.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=Uk(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,zu,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=function jk(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),c={"X-Goog-Upload-Protocol":"multipart"},g=function h(){let Ze="";for(let ht=0;ht<2;ht++)Ze+=Math.random().toString().slice(2);return Ze}();c["Content-Type"]="multipart/related; boundary="+g;const v=Bk(e,r,i),T=Dx(v,t),$=tl.getBlob("--"+g+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+T+"\r\n--"+g+"\r\nContent-Type: "+v.contentType+"\r\n\r\n",r,"\r\n--"+g+"--");if(null===$)throw Dk();const Y={name:v.fullPath},fe=Cd(a,n.host,n._protocol),et=n.maxUploadRetryTime,it=new nl(fe,"POST",zT(n,t),et);return it.urlParams=Y,it.headers=c,it.body=$.uploadData(),it.errorHandler=ly(e),it}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,zu,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=Tk(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=Sx(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){const a=new oB(t||void 0,r||void 0,i||void 0);return this._addObserver(a),()=>{this._removeObserver(a)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(Sx(this._state)){case Vs.SUCCESS:dy(this._resolve.bind(null,this.snapshot))();break;case Vs.CANCELED:case Vs.ERROR:dy(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Sx(this._state)){case Vs.RUNNING:case Vs.PAUSED:e.next&&dy(e.next.bind(e,this.snapshot))();break;case Vs.SUCCESS:e.complete&&dy(e.complete.bind(e))();break;default:e.error&&dy(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class em{constructor(e,t){this._service=e,this._location=t instanceof ws?t:ws.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new em(e,t)}get root(){const e=new ws(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return kk(this._location.path)}get storage(){return this._service}get parent(){const e=function BV(n){if(0===n.length)return null;const e=n.lastIndexOf("/");return-1===e?"":n.slice(0,e)}(this._location.path);if(null===e)return null;const t=new ws(this._location.bucket,e);return new em(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw Sk(e)}}function Wk(n,e,t){return Ax.apply(this,arguments)}function Ax(){return Ax=(0,Ee.Z)(function*(n,e,t){const i=yield qk(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),null!=i.nextPageToken&&(yield Wk(n,e,i.nextPageToken))}),Ax.apply(this,arguments)}function qk(n,e){null!=e&&"number"==typeof e.maxResults&&Ex("options.maxResults",1,1e3,e.maxResults);const t=e||{},r=QV(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,zu)}function wB(n){n._throwIfRoot("getDownloadURL");const e=function XV(n,e,t){const i=Cd(e.fullServerUrl(),n.host,n._protocol),c=n.maxOperationRetryTime,h=new nl(i,"GET",function YV(n,e){return function t(r,i){const a=Ok(n,i,e);return rl(null!==a),function WV(n,e,t,r){const i=Tx(e);if(null===i||!jT(i.downloadTokens))return null;const a=i.downloadTokens;if(0===a.length)return null;const c=encodeURIComponent;return a.split(",").map(v=>{const S=n.fullPath;return Cd("/b/"+c(n.bucket)+"/o/"+c(S),t,r)+Rk({alt:"media",token:v})})[0]}(a,i,n.host,n._protocol)}}(n,t),c);return h.errorHandler=Rw(e),h}(n.storage,n._location,Aw());return n.storage.makeRequestWithTokens(e,zu).then(t=>{if(null===t)throw function yV(){return new jr(ur.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return t})}function Kk(n,e){const t=function jV(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return 0===n.length?t:n+"/"+t}(n._location.path,e),r=new ws(n._location.bucket,t);return new em(n.storage,r)}function Zk(n,e){if(n instanceof Rx){const t=n;if(null==t._bucket)throw function mV(){return new jr(ur.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Ik+"' property when initializing the app?")}();const r=new em(t,t._bucket);return null!=e?Zk(r,e):r}return void 0!==e?Kk(n,e):n}function TB(n,e){if(e&&function IB(n){return/^[A-Za-z]+:\/\//.test(n)}(e)){if(n instanceof Rx)return function CB(n,e){return new em(n,e)}(n,e);throw cy("To use ref(service, url), the first argument must be a Storage instance.")}return Zk(n,e)}function Yk(n,e){const t=e?.[Ik];return null==t?null:ws.makeFromBucketSpec(t,n)}class Rx{constructor(e,t,r,i,a){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=a,this._bucket=null,this._host=Ek,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?ws.makeFromBucketSpec(i,this._host):Yk(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?ws.makeFromBucketSpec(this._url,e):Yk(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ex("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ex("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,Ee.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const t=e._authProvider.getImmediate({optional:!0});if(t){const r=yield t.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,Ee.Z)(function*(){const t=e._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new em(this,e)}_makeRequest(e,t,r,i,a=!0){if(this._deleted)return new wV(bk());{const c=function PV(n,e,t,r,i,a,c=!0){const h=Rk(n.urlParams),g=n.url+h,v=Object.assign({},n.headers);return function RV(n,e){e&&(n["X-Firebase-GMPID"]=e)}(v,e),function SV(n,e){null!==e&&e.length>0&&(n.Authorization="Firebase "+e)}(v,t),function AV(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(v,a),function xV(n,e){null!==e&&(n["X-Firebase-AppCheck"]=e)}(v,r),new bV(g,n.method,v,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,c)}(e,this._appId,r,i,t,this._firebaseVersion,a);return this._requests.add(c),c.getPromise().then(()=>this._requests.delete(c),()=>this._requests.delete(c)),c}}makeRequestWithTokens(e,t){var r=this;return(0,Ee.Z)(function*(){const[i,a]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,t,i,a).getPromise()})()}}const Qk="@firebase/storage";function eO(n,e){return TB(n=(0,U.m9)(n),e)}function kB(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Rx(t,r,i,e,Ai.SDK_VERSION)}!function OB(){(0,Ai._registerComponent)(new uo.wA("storage",kB,"PUBLIC").setMultipleInstances(!0)),(0,Ai.registerVersion)(Qk,"0.11.2",""),(0,Ai.registerVersion)(Qk,"0.11.2","esm2017")}();class WT{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class nO{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new WT(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new WT(r,this,this._ref))},t)}on(e,t,r,i){let a;return t&&(a="function"==typeof t?c=>t(new WT(c,this,this._ref)):{next:t.next?c=>t.next(new WT(c,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,a,r||void 0,i||void 0)}}class rO{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Td(e,this._service))}get items(){return this._delegate.items.map(e=>new Td(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class Td{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function MB(n,e){return Kk(n,e)}(this._delegate,e);return new Td(t,this.storage)}get root(){return new Td(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new Td(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new nO(function bB(n,e,t){return function gB(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new zk(n,new tl(e),t)}(n=(0,U.m9)(n),e,t)}(this._delegate,e,t),this)}putString(e,t=Jo.RAW,r){this._throwIfRoot("putString");const i=Cx(t,e),a=Object.assign({},r);return null==a.contentType&&null!=i.contentType&&(a.contentType=i.contentType),new nO(new zk(this._delegate,new tl(i.data,!0),a),this)}listAll(){return function xB(n){return function _B(n){const e={prefixes:[],items:[]};return Wk(n,e).then(()=>e)}(n=(0,U.m9)(n))}(this._delegate).then(e=>new rO(e,this.storage))}list(e){return function RB(n,e){return qk(n=(0,U.m9)(n),e)}(this._delegate,e||void 0).then(t=>new rO(t,this.storage))}getMetadata(){return function SB(n){return function yB(n){n._throwIfRoot("getMetadata");const e=Uk(n.storage,n._location,Aw());return n.storage.makeRequestWithTokens(e,zu)}(n=(0,U.m9)(n))}(this._delegate)}updateMetadata(e){return function AB(n,e){return function vB(n,e){n._throwIfRoot("updateMetadata");const t=function JV(n,e,t,r){const a=Cd(e.fullServerUrl(),n.host,n._protocol),h=Dx(t,r),v=n.maxOperationRetryTime,T=new nl(a,"PATCH",zT(n,r),v);return T.headers={"Content-Type":"application/json; charset=utf-8"},T.body=h,T.errorHandler=Rw(e),T}(n.storage,n._location,e,Aw());return n.storage.makeRequestWithTokens(t,zu)}(n=(0,U.m9)(n),e)}(this._delegate,e)}getDownloadURL(){return function PB(n){return wB(n=(0,U.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function NB(n){return function EB(n){n._throwIfRoot("deleteObject");const e=function eB(n,e){const r=Cd(e.fullServerUrl(),n.host,n._protocol),h=new nl(r,"DELETE",function c(g,v){},n.maxOperationRetryTime);return h.successCodes=[200,204],h.errorHandler=Rw(e),h}(n.storage,n._location);return n.storage.makeRequestWithTokens(e,zu)}(n=(0,U.m9)(n))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw Sk(e)}}class iO{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(sO(e))throw cy("ref() expected a child path but got a URL, use refFromURL instead.");return new Td(eO(this._delegate,e),this)}refFromURL(e){if(!sO(e))throw cy("refFromURL() expected a full URL but got a child path, use ref() instead.");try{ws.makeFromUrl(e,this._delegate.host)}catch{throw cy("refFromUrl() expected a valid full URL but got an invalid one.")}return new Td(eO(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){!function tO(n,e,t,r={}){!function DB(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken="string"==typeof i?i:(0,U.Sg)(i,n.app.options.projectId))}(n,e,t,r)}(this._delegate,e,t,r)}}function sO(n){return/^[A-Za-z]+:\/\//.test(n)}function VB(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new iO(t,r)}function oO(n){const e=function jB(n){return new ii.y(e=>{const t=c=>e.next(c);t(n.snapshot);const a=n.on("state_changed",t);return n.then(c=>{t(c),e.complete()},c=>{t(n.snapshot),(c=>{e.error(c)})(c)}),function(){a()}}).pipe(function sV(n,e=Bp.z){return(0,Sr.e)((t,r)=>{let i=null,a=null,c=null;const h=()=>{if(i){i.unsubscribe(),i=null;const v=a;a=null,r.next(v)}};function g(){const v=c+n,T=e.now();if(T<v)return i=this.schedule(void 0,v-T),void r.add(i);h()}t.subscribe((0,mr.x)(r,v=>{a=v,c=e.now(),i||(i=e.schedule(g,n),r.add(i))},()=>{h(),r.complete()},void 0,()=>{a=i=null}))})}(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>e,percentageChanges:()=>e.pipe((0,yt.U)(t=>t.bytesTransferred/t.totalBytes*100))}}function qT(n){return{getDownloadURL:()=>ut(void 0).pipe(vn.fc,Mn(()=>n.getDownloadURL()),vn.iC),getMetadata:()=>ut(void 0).pipe(vn.fc,Mn(()=>n.getMetadata()),vn.iC),delete:()=>(0,ln.D)(n.delete()),child:e=>qT(n.child(e)),updateMetadata:e=>(0,ln.D)(n.updateMetadata(e)),put:(e,t)=>oO(n.put(e,t)),putString:(e,t,r)=>oO(n.putString(e,t,r)),list:e=>(0,ln.D)(n.list(e)),listAll:()=>(0,ln.D)(n.listAll())}}!function BB(n){const e={TaskState:Vs,TaskEvent:sB,StringFormat:Jo,Storage:iO,Reference:Td};n.INTERNAL.registerComponent(new uo.wA("storage-compat",VB,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.3.2")}(Fm.Z);const $B=new _.OlP("angularfire2.storageBucket"),HB=new _.OlP("angularfire2.storage.maxUploadRetryTime"),zB=new _.OlP("angularfire2.storage.maxOperationRetryTime"),GB=new _.OlP("angularfire2.storage.use-emulator");let WB=(()=>{class n{constructor(t,r,i,a,c,h,g,v,T,S){const M=(0,si.on)(t,c,r);this.storage=(0,si.cc)(`${M.name}.storage.${i}`,"AngularFireStorage",M.name,()=>{const $=c.runOutsideAngular(()=>M.storage(i||void 0)),Y=T;return Y&&$.useEmulator(...Y),g&&$.setMaxUploadRetryTime(g),v&&$.setMaxOperationRetryTime(v),$},[g,v])}ref(t){return qT(this.storage.ref(t))}refFromURL(t){return qT(this.storage.refFromURL(t))}upload(t,r,i){return qT(this.storage.ref(t)).put(r,i)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(si.Dh),_.LFG(si.xv,8),_.LFG($B,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(vn.HU),_.LFG(HB,8),_.LFG(zB,8),_.LFG(GB,8),_.LFG(Tw,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),qB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({}),n})(),KB=(()=>{class n{constructor(){VT.Z.registerVersion("angularfire",vn.q4.full,"gcs-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[WB],imports:[qB]}),n})();var ZB=B(5032);const aO="@firebase/database";let xx="";function cO(n){xx=n}class XB{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,U.Wl)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,U.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class JB{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,U.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const lO=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new XB(e)}}catch{}return new JB},tm=lO("localStorage"),Px=lO("sessionStorage"),hy=new gs.Yd("@firebase/database"),dO=function(){let n=1;return function(){return n++}}(),hO=function(n){const e=(0,U.dS)(n),t=new U.gQ;t.update(e);const r=t.digest();return U.US.encodeByteArray(r)},xw=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=xw.apply(null,r):e+="object"==typeof r?(0,U.Wl)(r):r,e+=" "}return e};let nm=null,fO=!0;const pO=function(n,e){(0,U.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(hy.logLevel=gs.in.VERBOSE,nm=hy.log.bind(hy),e&&Px.set("logging_enabled",!0)):"function"==typeof n?nm=n:(nm=null,Px.remove("logging_enabled"))},Wi=function(...n){if(!0===fO&&(fO=!1,null===nm&&!0===Px.get("logging_enabled")&&pO(!0)),nm){const e=xw.apply(null,n);nm(e)}},Pw=function(n){return function(...e){Wi(n,...e)}},Nx=function(...n){const e="FIREBASE INTERNAL ERROR: "+xw(...n);hy.error(e)},il=function(...n){const e=`FIREBASE FATAL ERROR: ${xw(...n)}`;throw hy.error(e),new Error(e)},Es=function(...n){const e="FIREBASE WARNING: "+xw(...n);hy.warn(e)},KT=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Uf="[MIN_NAME]",Dd="[MAX_NAME]",rm=function(n,e){if(n===e)return 0;if(n===Uf||e===Dd)return-1;if(e===Uf||n===Dd)return 1;{const t=_O(n),r=_O(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},nj=function(n,e){return n===e?0:n<e?-1:1},Nw=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,U.Wl)(e))},Mx=function(n){if("object"!=typeof n||null===n)return(0,U.Wl)(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=(0,U.Wl)(e[r]),t+=":",t+=Mx(n[e[r]]);return t+="}",t},gO=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)r.push(n.substring(i,i+e>t?t:i+e));return r};function qi(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const mO=function(n){(0,U.hu)(!KT(n),"Invalid JSON number");const r=1023;let i,a,c,h,g;0===n?(a=0,c=0,i=1/n==-1/0?1:0):(i=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(h=Math.min(Math.floor(Math.log(n)/Math.LN2),r),a=h+r,c=Math.round(n*Math.pow(2,52-h)-Math.pow(2,52))):(a=0,c=Math.round(n/Math.pow(2,-1074))));const v=[];for(g=52;g;g-=1)v.push(c%2?1:0),c=Math.floor(c/2);for(g=11;g;g-=1)v.push(a%2?1:0),a=Math.floor(a/2);v.push(i?1:0),v.reverse();const T=v.join("");let S="";for(g=0;g<64;g+=8){let M=parseInt(T.substr(g,8),2).toString(16);1===M.length&&(M="0"+M),S+=M}return S.toLowerCase()},oj=new RegExp("^-?(0*)\\d{1,10}$"),_O=function(n){if(oj.test(n)){const e=Number(n);if(e>=-2147483648&&e<=2147483647)return e}return null},fy=function(n){try{n()}catch(e){setTimeout(()=>{throw Es("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},cj=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Mw=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class lj{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Es(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class dj{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(Wi("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Es(e)}}let kw=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const IO=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,DO="websocket",bO="long_polling";class Ox{constructor(e,t,r,i,a=!1,c="",h=!1,g=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=c,this.includeNamespaceInQueryParams=h,this.isUsingEmulator=g,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=tm.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&tm.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function SO(n,e,t){let r;if((0,U.hu)("string"==typeof e,"typeof type must == string"),(0,U.hu)("object"==typeof t,"typeof params must == object"),e===DO)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==bO)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function hj(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const i=[];return qi(t,(a,c)=>{i.push(a+"="+c)}),r+i.join("&")}class fj{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,U.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,U.p$)(this.counters_)}}const Lx={},Fx={};function Ux(n){const e=n.toString();return Lx[e]||(Lx[e]=new fj),Lx[e]}class gj{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&fy(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Vf{constructor(e,t,r,i,a,c,h){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=c,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Pw(e),this.stats_=Ux(t),this.urlFn=g=>(this.appCheckToken&&(g.ac=this.appCheckToken),SO(t,bO,g))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new gj(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,U.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Vx((...a)=>{const[c,h,g,v,T]=a;if(this.incrementIncomingBytes_(a),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===c)this.id=h,this.password=g;else{if("close"!==c)throw new Error("Unrecognized command received: "+c);h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_()}},(...a)=>{const[c,h]=a;this.incrementIncomingBytes_(a),this.myPacketOrderer.handleResponse(c,h)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&IO.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Vf.forceAllow_=!0}static forceDisallow(){Vf.forceDisallow_=!0}static isAvailable(){return!((0,U.Yr)()||!Vf.forceAllow_&&(Vf.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,U.Wl)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=(0,U.h$)(t),i=gO(r,1840);for(let a=0;a<i.length;a++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[a]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,U.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,U.Wl)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Vx{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,U.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=dO(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=Vx.createIFrame_();let a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(a='<script>document.domain="'+document.domain+'";<\/script>');const c="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(c),this.myIFrame.doc.close()}catch(h){Wi("frame writing exception"),h.stack&&Wi(h.stack),Wi(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Wi("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const c=this.pendingSegs.shift();r=r+"&seg"+i+"="+c.seg+"&ts"+i+"="+c.ts+"&d"+i+"="+c.d,i++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,t){(0,U.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Wi("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let YT=null;typeof MozWebSocket<"u"?YT=MozWebSocket:typeof WebSocket<"u"&&(YT=WebSocket);let py=(()=>{class n{constructor(t,r,i,a,c,h,g){this.connId=t,this.applicationId=i,this.appCheckToken=a,this.authToken=c,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Pw(this.connId),this.stats_=Ux(r),this.connURL=n.connectionURL_(r,h,g,a,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,a,c){const h={v:"5"};return!(0,U.Yr)()&&typeof location<"u"&&location.hostname&&IO.test(location.hostname)&&(h.r="f"),r&&(h.s=r),i&&(h.ls=i),a&&(h.ac=a),c&&(h.p=c),SO(t,DO,h)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,tm.set("previous_websocket_failure",!0);try{let i;if((0,U.Yr)()){i={headers:{"User-Agent":`Firebase/5/${xx}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const c=process.env,h=0===this.connURL.indexOf("wss://")?c.HTTPS_PROXY||c.https_proxy:c.HTTP_PROXY||c.http_proxy;h&&(i.proxy={origin:h})}this.mySock=new YT(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const a=i.message||i.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const a=i.message||i.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&null!==YT&&!n.forceDisallow_}static previouslyFailed(){return tm.isInMemoryStorage||!0===tm.get("previous_websocket_failure")}markConnectionHealthy(){tm.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,U.cI)(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,U.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const r=(0,U.Wl)(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=gO(r,16384);i.length>1&&this.sendString_(String(i.length));for(let a=0;a<i.length;a++)this.sendString_(i[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),kO=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Vf,py]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const r=py&&py.isAvailable();let i=r&&!py.previouslyFailed();if(t.webSocketOnly&&(r||Es("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[py];else{const a=this.transports_=[];for(const c of n.ALL_TRANSPORTS)c&&c.isAvailable()&&a.push(c);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class jO{constructor(e,t,r,i,a,c,h,g,v,T){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=c,this.onReady_=h,this.onDisconnect_=g,this.onKill_=v,this.lastSessionId=T,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Pw("c:"+this.id+":"),this.transportManager_=new kO(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Mw(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Nw("t",e),r=Nw("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Nw("t",e),r=Nw("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Nw("t",e);if("d"in e){const r=e.d;if("h"===t){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?Nx("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Nx("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&Es("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Mw(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Mw(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(tm.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class $O{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class HO{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,U.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let a=0;a<i.length;a++)if(i[a].callback===t&&(!r||r===i[a].context))return void i.splice(a,1)}validateEventType_(e){(0,U.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class QT extends HO{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,U.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new QT}getInitialEvent(e){return(0,U.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const zO=32,GO=768;class kn{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Sn(){return new kn("")}function dn(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Bf(n){return n.pieces_.length-n.pieceNum_}function nr(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new kn(n.pieces_,e)}function jx(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Ow(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function WO(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new kn(e,0)}function Mr(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof kn)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new kn(t,0)}function hn(n){return n.pieceNum_>=n.pieces_.length}function Bs(n,e){const t=dn(n),r=dn(e);if(null===t)return e;if(t===r)return Bs(nr(n),nr(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function Fj(n,e){const t=Ow(n,0),r=Ow(e,0);for(let i=0;i<t.length&&i<r.length;i++){const a=rm(t[i],r[i]);if(0!==a)return a}return t.length===r.length?0:t.length<r.length?-1:1}function $x(n,e){if(Bf(n)!==Bf(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function qa(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Bf(n)>Bf(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class Uj{constructor(e,t){this.errorPrefix_=t,this.parts_=Ow(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,U.ug)(this.parts_[r]);qO(this)}}function qO(n){if(n.byteLength_>GO)throw new Error(n.errorPrefix_+"has a key path longer than "+GO+" bytes ("+n.byteLength_+").");if(n.parts_.length>zO)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+zO+") or object contains a cycle "+im(n))}function im(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class Hx extends HO{constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new Hx}getInitialEvent(e){return(0,U.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Lw=1e3;let JT,sm=(()=>{class n extends $O{constructor(t,r,i,a,c,h,g,v){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=a,this.onServerInfoUpdate_=c,this.authTokenProvider_=h,this.appCheckTokenProvider_=g,this.authOverride_=v,this.id=n.nextPersistentConnectionId_++,this.log_=Pw("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Lw,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,v&&!(0,U.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Hx.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&QT.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){const a=++this.requestNumber_,c={r:a,a:t,b:r};this.log_((0,U.Wl)(c)),(0,U.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(c),i&&(this.requestCBHash_[a]=i)}get(t){this.initConnection_();const r=new U.BH,a={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:h=>{const g=h.d;"ok"===h.s?r.resolve(g):r.reject(g)}};return this.outstandingGets_.push(a),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(t,r,i,a){this.initConnection_();const c=t._queryIdentifier,h=t._path.toString();this.log_("Listen called for "+h+" "+c),this.listens.has(h)||this.listens.set(h,new Map),(0,U.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,U.hu)(!this.listens.get(h).has(c),"listen() called twice for same path/queryId.");const g={onComplete:a,hashFn:r,query:t,tag:i};this.listens.get(h).set(c,g),this.connected_&&this.sendListen_(g)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){const r=t.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);const c={p:i};t.tag&&(c.q=r._queryObject,c.t=t.tag),c.h=t.hashFn(),this.sendRequest("q",c,g=>{const v=g.d,T=g.s;n.warnOnListenWarnings_(v,r),(this.listens.get(i)&&this.listens.get(i).get(a))===t&&(this.log_("listen response",g),"ok"!==T&&this.removeListen_(i,a),t.onComplete&&t.onComplete(T,v))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&(0,U.r3)(t,"w")){const i=(0,U.DV)(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const a='".indexOn": "'+r._queryParams.getIndex().toString()+'"',c=r._path.toString();Es(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${c} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,U.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=(0,U.w9)(t)?"auth":"gauth",i={cred:t};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,a=>{const c=a.s,h=a.d||"error";this.authToken_===t&&("ok"===c?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(c,h))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,i=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){const i=t._path.toString(),a=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+a),(0,U.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,a)&&this.connected_&&this.sendUnlisten_(i,a,t._queryObject,r)}sendUnlisten_(t,r,i,a){this.log_("Unlisten on "+t+" for "+r);const c={p:t};a&&(c.q=i,c.t=a),this.sendRequest("n",c)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,a){const c={p:r,d:i};this.log_("onDisconnect "+t,c),this.sendRequest(t,c,h=>{a&&setTimeout(()=>{a(h.s,h.d)},Math.floor(0))})}put(t,r,i,a){this.putInternal("p",t,r,i,a)}merge(t,r,i,a){this.putInternal("m",t,r,i,a)}putInternal(t,r,i,a,c){this.initConnection_();const h={p:r,d:i};void 0!==c&&(h.h=c),this.outstandingPuts_.push({action:t,request:h,onComplete:a}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,a=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,c=>{this.log_(r+" response",c),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),a&&a(c.s,c.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,U.Wl)(t));const r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):Nx("Unrecognized action received from server: "+(0,U.Wl)(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,U.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Lw,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Lw,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Lw),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,Ee.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),i=t.onReady_.bind(t),a=t.onRealtimeDisconnect_.bind(t),c=t.id+":"+n.nextConnectionId_++,h=t.lastSessionId;let g=!1,v=null;const T=function(){v?v.close():(g=!0,a())};t.realtime_={close:T,sendRequest:function($){(0,U.hu)(v,"sendRequest call when we're not connected not allowed."),v.sendRequest($)}};const M=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[$,Y]=yield Promise.all([t.authTokenProvider_.getToken(M),t.appCheckTokenProvider_.getToken(M)]);g?Wi("getToken() completed but was canceled"):(Wi("getToken() completed. Creating connection."),t.authToken_=$&&$.accessToken,t.appCheckToken_=Y&&Y.token,v=new jO(c,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,i,a,fe=>{Es(fe+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},h))}catch($){t.log_("Failed to get token: "+$),g||(t.repoInfo_.nodeAdmin&&Es($),T())}}})()}interrupt(t){Wi("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Wi("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,U.xb)(this.interruptReasons_)&&(this.reconnectDelay_=Lw,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;i=r?r.map(c=>Mx(c)).join("$"):"default";const a=this.removeListen_(t,i);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(t,r){const i=new kn(t).toString();let a;if(this.listens.has(i)){const c=this.listens.get(i);a=c.get(r),c.delete(r),0===c.size&&this.listens.delete(i)}else a=void 0;return a}onAuthRevoked_(t,r){Wi("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Wi("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";(0,U.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+r+"."+xx.replace(/\./g,"-")]=1,(0,U.uI)()?t["framework.cordova"]=1:(0,U.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=QT.getInstance().currentlyOnline();return(0,U.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class gn{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new gn(e,t)}}class XT{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new gn(Uf,e),i=new gn(Uf,t);return 0!==this.compare(r,i)}minPost(){return gn.MIN}}class YO extends XT{static get __EMPTY_NODE(){return JT}static set __EMPTY_NODE(e){JT=e}compare(e,t){return rm(e.name,t.name)}isDefinedOn(e){throw(0,U.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return gn.MIN}maxPost(){return new gn(Dd,JT)}makePost(e,t){return(0,U.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new gn(e,JT)}toString(){return".key"}}const sl=new YO;class eD{constructor(e,t,r,i,a=null){this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];let c=1;for(;!e.isEmpty();)if(c=t?r(e.key,t):1,i&&(c*=-1),c<0)e=this.isReverse_?e.left:e.right;else{if(0===c){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let Gx,Gu=(()=>{class n{constructor(t,r,i,a,c){this.key=t,this.value=r,this.color=i??n.RED,this.left=a??wo.EMPTY_NODE,this.right=c??wo.EMPTY_NODE}copy(t,r,i,a,c){return new n(t??this.key,r??this.value,i??this.color,a??this.left,c??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let a=this;const c=i(t,a.key);return a=c<0?a.copy(null,null,null,a.left.insert(t,r,i),null):0===c?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(t,r,i)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return wo.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,a;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(t,i.key)){if(i.right.isEmpty())return wo.EMPTY_NODE;a=i.right.min_(),i=i.copy(a.key,a.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class wo{constructor(e,t=wo.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new wo(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Gu.BLACK,null,null))}remove(e){return new wo(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Gu.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new eD(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new eD(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new eD(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new eD(this.root_,null,this.comparator_,!0,e)}}function Wj(n,e){return rm(n.name,e.name)}function zx(n,e){return rm(n,e)}wo.EMPTY_NODE=new class Gj{copy(e,t,r,i,a){return this}insert(e,t,r){return new Gu(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const QO=function(n){return"number"==typeof n?"number:"+mO(n):"string:"+n},XO=function(n){if(n.isLeafNode()){const e=n.val();(0,U.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,U.r3)(e,".sv"),"Priority must be a string or number.")}else(0,U.hu)(n===Gx||n.isEmpty(),"priority of unexpected type.");(0,U.hu)(n===Gx||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let JO,e1,t1,gy=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,(0,U.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),XO(this.priorityNode_)}static set __childrenNodeConstructor(t){JO=t}static get __childrenNodeConstructor(){return JO}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return hn(t)?this:".priority"===dn(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const i=dn(t);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,U.hu)(".priority"!==i||1===Bf(t),".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(nr(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+QO(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?mO(this.value_):this.value_,this.lazyHash_=hO(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,U.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,i=typeof this.value_,a=n.VALUE_TYPE_ORDER.indexOf(r),c=n.VALUE_TYPE_ORDER.indexOf(i);return(0,U.hu)(a>=0,"Unknown leaf type: "+r),(0,U.hu)(c>=0,"Unknown leaf type: "+i),a===c?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:c-a}withIndex(){return this}isIndexed(){return!0}equals(t){return t===this||!!t.isLeafNode()&&(this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_))}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const cr=new class Yj extends XT{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),a=r.compareTo(i);return 0===a?rm(e.name,t.name):a}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return gn.MIN}maxPost(){return new gn(Dd,new gy("[PRIORITY-POST]",t1))}makePost(e,t){const r=e1(e);return new gn(t,new gy("[PRIORITY-POST]",r))}toString(){return".priority"}},Qj=Math.log(2);class Xj{constructor(e){this.count=parseInt(Math.log(e+1)/Qj,10),this.current_=this.count-1;const i=(a=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const tD=function(n,e,t,r){n.sort(e);const i=function(g,v){const T=v-g;let S,M;if(0===T)return null;if(1===T)return S=n[g],M=t?t(S):S,new Gu(M,S.node,Gu.BLACK,null,null);{const $=parseInt(T/2,10)+g,Y=i(g,$),fe=i($+1,v);return S=n[$],M=t?t(S):S,new Gu(M,S.node,Gu.BLACK,Y,fe)}},h=function(g){let v=null,T=null,S=n.length;const M=function(Y,fe){const ge=S-Y,et=S;S-=Y;const it=i(ge+1,et),Ze=n[ge],ht=t?t(Ze):Ze;$(new Gu(ht,Ze.node,fe,null,it))},$=function(Y){v?(v.left=Y,v=Y):(T=Y,v=Y)};for(let Y=0;Y<g.count;++Y){const fe=g.nextBitIsOne(),ge=Math.pow(2,g.count-(Y+1));fe?M(ge,Gu.BLACK):(M(ge,Gu.BLACK),M(ge,Gu.RED))}return T}(new Xj(n.length));return new wo(r||e,h)};let Wx;const my={};class bd{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,U.hu)(my&&cr,"ChildrenNode.ts has not been loaded"),Wx=Wx||new bd({".priority":my},{".priority":cr}),Wx}get(e){const t=(0,U.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof wo?t:null}hasIndex(e){return(0,U.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,U.hu)(e!==sl,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const a=t.getIterator(gn.Wrap);let h,c=a.getNext();for(;c;)i=i||e.isDefinedOn(c.node),r.push(c),c=a.getNext();h=i?tD(r,e.getCompare()):my;const g=e.toString(),v=Object.assign({},this.indexSet_);v[g]=e;const T=Object.assign({},this.indexes_);return T[g]=h,new bd(T,v)}addToIndexes(e,t){const r=(0,U.UI)(this.indexes_,(i,a)=>{const c=(0,U.DV)(this.indexSet_,a);if((0,U.hu)(c,"Missing index implementation for "+a),i===my){if(c.isDefinedOn(e.node)){const h=[],g=t.getIterator(gn.Wrap);let v=g.getNext();for(;v;)v.name!==e.name&&h.push(v),v=g.getNext();return h.push(e),tD(h,c.getCompare())}return my}{const h=t.get(e.name);let g=i;return h&&(g=g.remove(new gn(e.name,h))),g.insert(e,e.node)}});return new bd(r,this.indexSet_)}removeFromIndexes(e,t){const r=(0,U.UI)(this.indexes_,i=>{if(i===my)return i;{const a=t.get(e.name);return a?i.remove(new gn(e.name,a)):i}});return new bd(r,this.indexSet_)}}let Fw,rn=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&XO(this.priorityNode_),this.children_.isEmpty()&&(0,U.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Fw||(Fw=new n(new wo(zx),null,bd.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Fw}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?Fw:r}}getChild(t){const r=dn(t);return null===r?this:this.getImmediateChild(r).getChild(nr(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if((0,U.hu)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const i=new gn(t,r);let a,c;r.isEmpty()?(a=this.children_.remove(t),c=this.indexMap_.removeFromIndexes(i,this.children_)):(a=this.children_.insert(t,r),c=this.indexMap_.addToIndexes(i,this.children_));const h=a.isEmpty()?Fw:this.priorityNode_;return new n(a,h,c)}}updateChild(t,r){const i=dn(t);if(null===i)return r;{(0,U.hu)(".priority"!==dn(t)||1===Bf(t),".priority must be the last token in a path");const a=this.getImmediateChild(i).updateChild(nr(t),r);return this.updateImmediateChild(i,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let i=0,a=0,c=!0;if(this.forEachChild(cr,(h,g)=>{r[h]=g.val(t),i++,c&&n.INTEGER_REGEXP_.test(h)?a=Math.max(a,Number(h)):c=!1}),!t&&c&&a<2*i){const h=[];for(const g in r)h[g]=r[g];return h}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+QO(this.getPriority().val())+":"),this.forEachChild(cr,(r,i)=>{const a=i.hash();""!==a&&(t+=":"+r+":"+a)}),this.lazyHash_=""===t?"":hO(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){const a=this.resolveIndex_(i);if(a){const c=a.getPredecessorKey(new gn(t,r));return c?c.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new gn(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new gn(r,this.children_.get(r)):null}forEachChild(t,r){const i=this.resolveIndex_(t);return i?i.inorderTraversal(a=>r(a.name,a.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,a=>a);{const a=this.children_.getIteratorFrom(t.name,gn.Wrap);let c=a.peek();for(;null!=c&&r.compare(c,t)<0;)a.getNext(),c=a.peek();return a}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,a=>a);{const a=this.children_.getReverseIteratorFrom(t.name,gn.Wrap);let c=a.peek();for(;null!=c&&r.compare(c,t)>0;)a.getNext(),c=a.peek();return a}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Uw?-1:0}withIndex(t){if(t===sl||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===sl||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(cr),a=r.getIterator(cr);let c=i.getNext(),h=a.getNext();for(;c&&h;){if(c.name!==h.name||!c.node.equals(h.node))return!1;c=i.getNext(),h=a.getNext()}return null===c&&null===h}return!1}return!1}}resolveIndex_(t){return t===sl?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const Uw=new class Jj extends rn{constructor(){super(new wo(zx),rn.EMPTY_NODE,bd.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return rn.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(gn,{MIN:{value:new gn(Uf,rn.EMPTY_NODE)},MAX:{value:new gn(Dd,Uw)}}),YO.__EMPTY_NODE=rn.EMPTY_NODE,gy.__childrenNodeConstructor=rn,function qj(n){Gx=n}(Uw),function Zj(n){t1=n}(Uw);const e$=!0;function $r(n,e=null){if(null===n)return rn.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,U.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new gy(n,$r(e));if(n instanceof Array||!e$){let t=rn.EMPTY_NODE;return qi(n,(r,i)=>{if((0,U.r3)(n,r)&&"."!==r.substring(0,1)){const a=$r(i);(a.isLeafNode()||!a.isEmpty())&&(t=t.updateImmediateChild(r,a))}}),t.updatePriority($r(e))}{const t=[];let r=!1;if(qi(n,(c,h)=>{if("."!==c.substring(0,1)){const g=$r(h);g.isEmpty()||(r=r||!g.getPriority().isEmpty(),t.push(new gn(c,g)))}}),0===t.length)return rn.EMPTY_NODE;const a=tD(t,Wj,c=>c.name,zx);if(r){const c=tD(t,cr.getCompare());return new rn(a,$r(e),new bd({".priority":c},{".priority":cr}))}return new rn(a,$r(e),bd.Default)}}!function Kj(n){e1=n}($r);class qx extends XT{constructor(e){super(),this.indexPath_=e,(0,U.hu)(!hn(e)&&".priority"!==dn(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),a=r.compareTo(i);return 0===a?rm(e.name,t.name):a}makePost(e,t){const r=$r(e),i=rn.EMPTY_NODE.updateChild(this.indexPath_,r);return new gn(t,i)}maxPost(){const e=rn.EMPTY_NODE.updateChild(this.indexPath_,Uw);return new gn(Dd,e)}toString(){return Ow(this.indexPath_,0).join("/")}}const Kx=new class t$ extends XT{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?rm(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return gn.MIN}maxPost(){return gn.MAX}makePost(e,t){const r=$r(e);return new gn(t,r)}toString(){return".value"}};function n1(n){return{type:"value",snapshotNode:n}}function _y(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Vw(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Bw(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class Zx{constructor(e){this.index_=e}updateChild(e,t,r,i,a,c){(0,U.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=e.getImmediateChild(t);return h.getChild(i).equals(r.getChild(i))&&h.isEmpty()===r.isEmpty()||(null!=c&&(r.isEmpty()?e.hasChild(t)?c.trackChildChange(Vw(t,h)):(0,U.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?c.trackChildChange(_y(t,r)):c.trackChildChange(Bw(t,r,h))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(cr,(i,a)=>{t.hasChild(i)||r.trackChildChange(Vw(i,a))}),t.isLeafNode()||t.forEachChild(cr,(i,a)=>{if(e.hasChild(i)){const c=e.getImmediateChild(i);c.equals(a)||r.trackChildChange(Bw(i,a,c))}else r.trackChildChange(_y(i,a))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?rn.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class jw{constructor(e){this.indexedFilter_=new Zx(e.getIndex()),this.index_=e.getIndex(),this.startPost_=jw.getStartPost_(e),this.endPost_=jw.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,a,c){return this.matches(new gn(t,r))||(r=rn.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,a,c)}updateFullNode(e,t,r){t.isLeafNode()&&(t=rn.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(rn.EMPTY_NODE);const a=this;return t.forEachChild(cr,(c,h)=>{a.matches(new gn(c,h))||(i=i.updateImmediateChild(c,rn.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class r${constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new jw(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,a,c){return this.rangedFilter_.matches(new gn(t,r))||(r=rn.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,a,c):this.fullLimitUpdateChild_(e,t,r,a,c)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=rn.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let a;i=rn.EMPTY_NODE.withIndex(this.index_),a=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let c=0;for(;a.hasNext()&&c<this.limit_;){const h=a.getNext();if(this.withinDirectionalStart(h)){if(!this.withinDirectionalEnd(h))break;i=i.updateImmediateChild(h.name,h.node),c++}}}else{let a;i=t.withIndex(this.index_),i=i.updatePriority(rn.EMPTY_NODE),a=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let c=0;for(;a.hasNext();){const h=a.getNext();c<this.limit_&&this.withinDirectionalStart(h)&&this.withinDirectionalEnd(h)?c++:i=i.updateImmediateChild(h.name,rn.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,a){let c;if(this.reverse_){const S=this.index_.getCompare();c=(M,$)=>S($,M)}else c=this.index_.getCompare();const h=e;(0,U.hu)(h.numChildren()===this.limit_,"");const g=new gn(t,r),v=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),T=this.rangedFilter_.matches(g);if(h.hasChild(t)){const S=h.getImmediateChild(t);let M=i.getChildAfterChild(this.index_,v,this.reverse_);for(;null!=M&&(M.name===t||h.hasChild(M.name));)M=i.getChildAfterChild(this.index_,M,this.reverse_);const $=null==M?1:c(M,g);if(T&&!r.isEmpty()&&$>=0)return a?.trackChildChange(Bw(t,r,S)),h.updateImmediateChild(t,r);{a?.trackChildChange(Vw(t,S));const fe=h.updateImmediateChild(t,rn.EMPTY_NODE);return null!=M&&this.rangedFilter_.matches(M)?(a?.trackChildChange(_y(M.name,M.node)),fe.updateImmediateChild(M.name,M.node)):fe}}return r.isEmpty()?e:T&&c(v,g)>=0?(null!=a&&(a.trackChildChange(Vw(v.name,v.node)),a.trackChildChange(_y(t,r))),h.updateImmediateChild(t,r).updateImmediateChild(v.name,rn.EMPTY_NODE)):e}}class nD{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=cr}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,U.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,U.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Uf}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,U.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,U.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Dd}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,U.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===cr}copy(){const e=new nD;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Yx(n,e,t){const r=n.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function Qx(n,e,t){const r=n.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function rD(n,e){const t=n.copy();return t.index_=e,t}function r1(n){const e={};if(n.isDefault())return e;let t;if(n.index_===cr?t="$priority":n.index_===Kx?t="$value":n.index_===sl?t="$key":((0,U.hu)(n.index_ instanceof qx,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,U.Wl)(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=(0,U.Wl)(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+(0,U.Wl)(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=(0,U.Wl)(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+(0,U.Wl)(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function i1(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==cr&&(e.i=n.index_.toString()),e}class iD extends $O{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Pw("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,U.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const a=e._path.toString();this.log_("Listen called for "+a+" "+e._queryIdentifier);const c=iD.getListenId_(e,r),h={};this.listens_[c]=h;const g=r1(e._queryParams);this.restRequest_(a+".json",g,(v,T)=>{let S=T;if(404===v&&(S=null,v=null),null===v&&this.onDataUpdate_(a,S,!1,r),(0,U.DV)(this.listens_,c)===h){let M;M=v?401===v?"permission_denied":"rest_error:"+v:"ok",i(M,null)}})}unlisten(e,t){const r=iD.getListenId_(e,t);delete this.listens_[r]}get(e){const t=r1(e._queryParams),r=e._path.toString(),i=new U.BH;return this.restRequest_(r+".json",t,(a,c)=>{let h=c;404===a&&(h=null,a=null),null===a?(this.onDataUpdate_(r,h,!1,null),i.resolve(h)):i.reject(new Error(h))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,a])=>{i&&i.accessToken&&(t.auth=i.accessToken),a&&a.token&&(t.ac=a.token);const c=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,U.xO)(t);this.log_("Sending REST request for "+c);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(r&&4===h.readyState){this.log_("REST Response for "+c+" received. status:",h.status,"response:",h.responseText);let g=null;if(h.status>=200&&h.status<300){try{g=(0,U.cI)(h.responseText)}catch{Es("Failed to parse JSON response for "+c+": "+h.responseText)}r(null,g)}else 401!==h.status&&404!==h.status&&Es("Got unsuccessful REST response for "+c+" Status: "+h.status),r(h.status);r=null}},h.open("GET",c,!0),h.send()})}}class c${constructor(){this.rootNode_=rn.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function sD(){return{value:null,children:new Map}}function yy(n,e,t){if(hn(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=dn(e);n.children.has(r)||n.children.set(r,sD()),yy(n.children.get(r),e=nr(e),t)}}function Xx(n,e){if(hn(e))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(cr,(r,i)=>{yy(n,new kn(r),i)}),Xx(n,e)}}if(n.children.size>0){const t=dn(e);return e=nr(e),n.children.has(t)&&Xx(n.children.get(t),e)&&n.children.delete(t),0===n.children.size}return!0}function Jx(n,e,t){null!==n.value?t(e,n.value):function l$(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,i)=>{Jx(i,new kn(e.toString()+"/"+r),t)})}class d${constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&qi(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}class p${constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new d$(e);const r=1e4+2e4*Math.random();Mw(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;qi(e,(i,a)=>{a>0&&(0,U.r3)(this.statsToReport_,i)&&(t[i]=a,r=!0)}),r&&this.server_.reportStats(t),Mw(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Ka=(()=>(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Ka||(Ka={})),Ka))();function nP(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class oD{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Ka.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(hn(this.path)){if(null!=this.affectedTree.value)return(0,U.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new kn(e));return new oD(Sn(),t,this.revert)}}return(0,U.hu)(dn(this.path)===e,"operationForChild called for unrelated child."),new oD(nr(this.path),this.affectedTree,this.revert)}}class $w{constructor(e,t){this.source=e,this.path=t,this.type=Ka.LISTEN_COMPLETE}operationForChild(e){return hn(this.path)?new $w(this.source,Sn()):new $w(this.source,nr(this.path))}}class om{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Ka.OVERWRITE}operationForChild(e){return hn(this.path)?new om(this.source,Sn(),this.snap.getImmediateChild(e)):new om(this.source,nr(this.path),this.snap)}}class vy{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Ka.MERGE}operationForChild(e){if(hn(this.path)){const t=this.children.subtree(new kn(e));return t.isEmpty()?null:t.value?new om(this.source,Sn(),t.value):new vy(this.source,Sn(),t)}return(0,U.hu)(dn(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new vy(this.source,nr(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class jf{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(hn(e))return this.isFullyInitialized()&&!this.filtered_;const t=dn(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class g${constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Hw(n,e,t,r,i,a){const c=r.filter(h=>h.type===t);c.sort((h,g)=>function y$(n,e,t){if(null==e.childName||null==t.childName)throw(0,U.g5)("Should only compare child_ events.");const r=new gn(e.childName,e.snapshotNode),i=new gn(t.childName,t.snapshotNode);return n.index_.compare(r,i)}(n,h,g)),c.forEach(h=>{const g=function _$(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,h,a);i.forEach(v=>{v.respondsTo(h.type)&&e.push(v.createEvent(g,n.query_))})})}function aD(n,e){return{eventCache:n,serverCache:e}}function zw(n,e,t,r){return aD(new jf(e,t,r),n.serverCache)}function o1(n,e,t,r){return aD(n.eventCache,new jf(e,t,r))}function uD(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function am(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let rP;class lr{constructor(e,t=(()=>(rP||(rP=new wo(nj)),rP))()){this.value=e,this.children=t}static fromObject(e){let t=new lr(null);return qi(e,(r,i)=>{t=t.set(new kn(r),i)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Sn(),value:this.value};if(hn(e))return null;{const r=dn(e),i=this.children.get(r);if(null!==i){const a=i.findRootMostMatchingPathAndValue(nr(e),t);return null!=a?{path:Mr(new kn(r),a.path),value:a.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(hn(e))return this;{const t=dn(e),r=this.children.get(t);return null!==r?r.subtree(nr(e)):new lr(null)}}set(e,t){if(hn(e))return new lr(t,this.children);{const r=dn(e),a=(this.children.get(r)||new lr(null)).set(nr(e),t),c=this.children.insert(r,a);return new lr(this.value,c)}}remove(e){if(hn(e))return this.children.isEmpty()?new lr(null):new lr(null,this.children);{const t=dn(e),r=this.children.get(t);if(r){const i=r.remove(nr(e));let a;return a=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&a.isEmpty()?new lr(null):new lr(this.value,a)}return this}}get(e){if(hn(e))return this.value;{const t=dn(e),r=this.children.get(t);return r?r.get(nr(e)):null}}setTree(e,t){if(hn(e))return t;{const r=dn(e),a=(this.children.get(r)||new lr(null)).setTree(nr(e),t);let c;return c=a.isEmpty()?this.children.remove(r):this.children.insert(r,a),new lr(this.value,c)}}fold(e){return this.fold_(Sn(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,a)=>{r[i]=a.fold_(Mr(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Sn(),t)}findOnPath_(e,t,r){const i=!!this.value&&r(t,this.value);if(i)return i;if(hn(e))return null;{const a=dn(e),c=this.children.get(a);return c?c.findOnPath_(nr(e),Mr(t,a),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Sn(),t)}foreachOnPath_(e,t,r){if(hn(e))return this;{this.value&&r(t,this.value);const i=dn(e),a=this.children.get(i);return a?a.foreachOnPath_(nr(e),Mr(t,i),r):new lr(null)}}foreach(e){this.foreach_(Sn(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Mr(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class Wu{constructor(e){this.writeTree_=e}static empty(){return new Wu(new lr(null))}}function Gw(n,e,t){if(hn(e))return new Wu(new lr(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let a=r.value;const c=Bs(i,e);return a=a.updateChild(c,t),new Wu(n.writeTree_.set(i,a))}{const i=new lr(t),a=n.writeTree_.setTree(e,i);return new Wu(a)}}}function iP(n,e,t){let r=n;return qi(t,(i,a)=>{r=Gw(r,Mr(e,i),a)}),r}function a1(n,e){if(hn(e))return Wu.empty();{const t=n.writeTree_.setTree(e,new lr(null));return new Wu(t)}}function sP(n,e){return null!=um(n,e)}function um(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(Bs(t.path,e)):null}function u1(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(cr,(r,i)=>{e.push(new gn(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new gn(r,i.value))}),e}function $f(n,e){if(hn(e))return n;{const t=um(n,e);return new Wu(null!=t?new lr(t):n.writeTree_.subtree(e))}}function oP(n){return n.writeTree_.isEmpty()}function wy(n,e){return c1(Sn(),n.writeTree_,e)}function c1(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,a)=>{".priority"===i?((0,U.hu)(null!==a.value,"Priority writes must always be leaf nodes"),r=a.value):t=c1(Mr(n,i),a,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(Mr(n,".priority"),r)),t}}function cD(n,e){return p1(e,n)}function T$(n,e){if(n.snap)return qa(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&qa(Mr(n.path,t),e))return!0;return!1}function b$(n){return n.visible}function l1(n,e,t){let r=Wu.empty();for(let i=0;i<n.length;++i){const a=n[i];if(e(a)){const c=a.path;let h;if(a.snap)qa(t,c)?(h=Bs(t,c),r=Gw(r,h,a.snap)):qa(c,t)&&(h=Bs(c,t),r=Gw(r,Sn(),a.snap.getChild(h)));else{if(!a.children)throw(0,U.g5)("WriteRecord should have .snap or .children");if(qa(t,c))h=Bs(t,c),r=iP(r,h,a.children);else if(qa(c,t))if(h=Bs(c,t),hn(h))r=iP(r,Sn(),a.children);else{const g=(0,U.DV)(a.children,dn(h));if(g){const v=g.getChild(nr(h));r=Gw(r,Sn(),v)}}}}}return r}function d1(n,e,t,r,i){if(r||i){const a=$f(n.visibleWrites,e);return!i&&oP(a)?t:i||null!=t||sP(a,Sn())?wy(l1(n.allWrites,function(v){return(v.visible||i)&&(!r||!~r.indexOf(v.writeId))&&(qa(v.path,e)||qa(e,v.path))},e),t||rn.EMPTY_NODE):null}{const a=um(n.visibleWrites,e);if(null!=a)return a;{const c=$f(n.visibleWrites,e);return oP(c)?t:null!=t||sP(c,Sn())?wy(c,t||rn.EMPTY_NODE):null}}}function lD(n,e,t,r){return d1(n.writeTree,n.treePath,e,t,r)}function aP(n,e){return function S$(n,e,t){let r=rn.EMPTY_NODE;const i=um(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(cr,(a,c)=>{r=r.updateImmediateChild(a,c)}),r;if(t){const a=$f(n.visibleWrites,e);return t.forEachChild(cr,(c,h)=>{const g=wy($f(a,new kn(c)),h);r=r.updateImmediateChild(c,g)}),u1(a).forEach(c=>{r=r.updateImmediateChild(c.name,c.node)}),r}return u1($f(n.visibleWrites,e)).forEach(c=>{r=r.updateImmediateChild(c.name,c.node)}),r}(n.writeTree,n.treePath,e)}function h1(n,e,t,r){return function A$(n,e,t,r,i){(0,U.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const a=Mr(e,t);if(sP(n.visibleWrites,a))return null;{const c=$f(n.visibleWrites,a);return oP(c)?i.getChild(t):wy(c,i.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function dD(n,e){return function x$(n,e){return um(n.visibleWrites,e)}(n.writeTree,Mr(n.treePath,e))}function uP(n,e,t){return function R$(n,e,t,r){const i=Mr(e,t),a=um(n.visibleWrites,i);return null!=a?a:r.isCompleteForChild(t)?wy($f(n.visibleWrites,i),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function f1(n,e){return p1(Mr(n.treePath,e),n.writeTree)}function p1(n,e){return{treePath:n,writeTree:e}}class k${constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;(0,U.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,U.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const a=i.type;if("child_added"===t&&"child_removed"===a)this.changeMap.set(r,Bw(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===a)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===a)this.changeMap.set(r,Vw(r,i.oldSnap));else if("child_changed"===t&&"child_added"===a)this.changeMap.set(r,_y(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==a)throw(0,U.g5)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,Bw(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const g1=new class O${getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class cP{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new jf(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return uP(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:am(this.viewCache_),a=function M$(n,e,t,r,i,a){return function P$(n,e,t,r,i,a,c){let h;const g=$f(n.visibleWrites,e),v=um(g,Sn());if(null!=v)h=v;else{if(null==t)return[];h=wy(g,t)}if(h=h.withIndex(c),h.isEmpty()||h.isLeafNode())return[];{const T=[],S=c.getCompare(),M=a?h.getReverseIteratorFrom(r,c):h.getIteratorFrom(r,c);let $=M.getNext();for(;$&&T.length<i;)0!==S($,r)&&T.push($),$=M.getNext();return T}}(n.writeTree,n.treePath,e,t,r,i,a)}(this.writes_,i,t,1,r,e);return 0===a.length?null:a[0]}}function m1(n,e,t,r,i,a){const c=e.eventCache;if(null!=dD(r,t))return e;{let h,g;if(hn(t))if((0,U.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const v=am(e),S=aP(r,v instanceof rn?v:rn.EMPTY_NODE);h=n.filter.updateFullNode(e.eventCache.getNode(),S,a)}else{const v=lD(r,am(e));h=n.filter.updateFullNode(e.eventCache.getNode(),v,a)}else{const v=dn(t);if(".priority"===v){(0,U.hu)(1===Bf(t),"Can't have a priority with additional path components");const T=c.getNode();g=e.serverCache.getNode();const S=h1(r,t,T,g);h=null!=S?n.filter.updatePriority(T,S):c.getNode()}else{const T=nr(t);let S;if(c.isCompleteForChild(v)){g=e.serverCache.getNode();const M=h1(r,t,c.getNode(),g);S=null!=M?c.getNode().getImmediateChild(v).updateChild(T,M):c.getNode().getImmediateChild(v)}else S=uP(r,v,e.serverCache);h=null!=S?n.filter.updateChild(c.getNode(),v,S,T,i,a):c.getNode()}}return zw(e,h,c.isFullyInitialized()||hn(t),n.filter.filtersNodes())}}function hD(n,e,t,r,i,a,c,h){const g=e.serverCache;let v;const T=c?n.filter:n.filter.getIndexedFilter();if(hn(t))v=T.updateFullNode(g.getNode(),r,null);else if(T.filtersNodes()&&!g.isFiltered()){const $=g.getNode().updateChild(t,r);v=T.updateFullNode(g.getNode(),$,null)}else{const $=dn(t);if(!g.isCompleteForPath(t)&&Bf(t)>1)return e;const Y=nr(t),ge=g.getNode().getImmediateChild($).updateChild(Y,r);v=".priority"===$?T.updatePriority(g.getNode(),ge):T.updateChild(g.getNode(),$,ge,Y,g1,null)}const S=o1(e,v,g.isFullyInitialized()||hn(t),T.filtersNodes());return m1(n,S,t,i,new cP(i,S,a),h)}function lP(n,e,t,r,i,a,c){const h=e.eventCache;let g,v;const T=new cP(i,e,a);if(hn(t))v=n.filter.updateFullNode(e.eventCache.getNode(),r,c),g=zw(e,v,!0,n.filter.filtersNodes());else{const S=dn(t);if(".priority"===S)v=n.filter.updatePriority(e.eventCache.getNode(),r),g=zw(e,v,h.isFullyInitialized(),h.isFiltered());else{const M=nr(t),$=h.getNode().getImmediateChild(S);let Y;if(hn(M))Y=r;else{const fe=T.getCompleteChild(S);Y=null!=fe?".priority"===jx(M)&&fe.getChild(WO(M)).isEmpty()?fe:fe.updateChild(M,r):rn.EMPTY_NODE}g=$.equals(Y)?e:zw(e,n.filter.updateChild(h.getNode(),S,Y,M,T,c),h.isFullyInitialized(),n.filter.filtersNodes())}}return g}function _1(n,e){return n.eventCache.isCompleteForChild(e)}function y1(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function dP(n,e,t,r,i,a,c,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let v,g=e;v=hn(t)?r:new lr(null).setTree(t,r);const T=e.serverCache.getNode();return v.children.inorderTraversal((S,M)=>{if(T.hasChild(S)){const Y=y1(0,e.serverCache.getNode().getImmediateChild(S),M);g=hD(n,g,new kn(S),Y,i,a,c,h)}}),v.children.inorderTraversal((S,M)=>{const $=!e.serverCache.isCompleteForChild(S)&&null===M.value;if(!T.hasChild(S)&&!$){const fe=y1(0,e.serverCache.getNode().getImmediateChild(S),M);g=hD(n,g,new kn(S),fe,i,a,c,h)}}),g}class z${constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new Zx(r.getIndex()),a=function i$(n){return n.loadsAllData()?new Zx(n.getIndex()):n.hasLimit()?new r$(n):new jw(n)}(r);this.processor_=function L$(n){return{filter:n}}(a);const c=t.serverCache,h=t.eventCache,g=i.updateFullNode(rn.EMPTY_NODE,c.getNode(),null),v=a.updateFullNode(rn.EMPTY_NODE,h.getNode(),null),T=new jf(g,c.isFullyInitialized(),i.filtersNodes()),S=new jf(v,h.isFullyInitialized(),a.filtersNodes());this.viewCache_=aD(S,T),this.eventGenerator_=new g$(this.query_)}get query(){return this.query_}}function q$(n,e){const t=am(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!hn(e)&&!t.getImmediateChild(dn(e)).isEmpty())?t.getChild(e):null}function v1(n){return 0===n.eventRegistrations_.length}function w1(n,e,t){const r=[];if(t){(0,U.hu)(null==e,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(a=>{const c=a.createCancelEvent(t,i);c&&r.push(c)})}if(e){let i=[];for(let a=0;a<n.eventRegistrations_.length;++a){const c=n.eventRegistrations_[a];if(c.matches(e)){if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(a+1));break}}else i.push(c)}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function E1(n,e,t,r){e.type===Ka.MERGE&&null!==e.source.queryId&&((0,U.hu)(am(n.viewCache_),"We should always have a full cache before handling merges"),(0,U.hu)(uD(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,a=function U$(n,e,t,r,i){const a=new k$;let c,h;if(t.type===Ka.OVERWRITE){const v=t;v.source.fromUser?c=lP(n,e,v.path,v.snap,r,i,a):((0,U.hu)(v.source.fromServer,"Unknown source."),h=v.source.tagged||e.serverCache.isFiltered()&&!hn(v.path),c=hD(n,e,v.path,v.snap,r,i,h,a))}else if(t.type===Ka.MERGE){const v=t;v.source.fromUser?c=function B$(n,e,t,r,i,a,c){let h=e;return r.foreach((g,v)=>{const T=Mr(t,g);_1(e,dn(T))&&(h=lP(n,h,T,v,i,a,c))}),r.foreach((g,v)=>{const T=Mr(t,g);_1(e,dn(T))||(h=lP(n,h,T,v,i,a,c))}),h}(n,e,v.path,v.children,r,i,a):((0,U.hu)(v.source.fromServer,"Unknown source."),h=v.source.tagged||e.serverCache.isFiltered(),c=dP(n,e,v.path,v.children,r,i,h,a))}else if(t.type===Ka.ACK_USER_WRITE){const v=t;c=v.revert?function H$(n,e,t,r,i,a){let c;if(null!=dD(r,t))return e;{const h=new cP(r,e,i),g=e.eventCache.getNode();let v;if(hn(t)||".priority"===dn(t)){let T;if(e.serverCache.isFullyInitialized())T=lD(r,am(e));else{const S=e.serverCache.getNode();(0,U.hu)(S instanceof rn,"serverChildren would be complete if leaf node"),T=aP(r,S)}v=n.filter.updateFullNode(g,T,a)}else{const T=dn(t);let S=uP(r,T,e.serverCache);null==S&&e.serverCache.isCompleteForChild(T)&&(S=g.getImmediateChild(T)),v=null!=S?n.filter.updateChild(g,T,S,nr(t),h,a):e.eventCache.getNode().hasChild(T)?n.filter.updateChild(g,T,rn.EMPTY_NODE,nr(t),h,a):g,v.isEmpty()&&e.serverCache.isFullyInitialized()&&(c=lD(r,am(e)),c.isLeafNode()&&(v=n.filter.updateFullNode(v,c,a)))}return c=e.serverCache.isFullyInitialized()||null!=dD(r,Sn()),zw(e,v,c,n.filter.filtersNodes())}}(n,e,v.path,r,i,a):function j$(n,e,t,r,i,a,c){if(null!=dD(i,t))return e;const h=e.serverCache.isFiltered(),g=e.serverCache;if(null!=r.value){if(hn(t)&&g.isFullyInitialized()||g.isCompleteForPath(t))return hD(n,e,t,g.getNode().getChild(t),i,a,h,c);if(hn(t)){let v=new lr(null);return g.getNode().forEachChild(sl,(T,S)=>{v=v.set(new kn(T),S)}),dP(n,e,t,v,i,a,h,c)}return e}{let v=new lr(null);return r.foreach((T,S)=>{const M=Mr(t,T);g.isCompleteForPath(M)&&(v=v.set(T,g.getNode().getChild(M)))}),dP(n,e,t,v,i,a,h,c)}}(n,e,v.path,v.affectedTree,r,i,a)}else{if(t.type!==Ka.LISTEN_COMPLETE)throw(0,U.g5)("Unknown operation type: "+t.type);c=function $$(n,e,t,r,i){const a=e.serverCache;return m1(n,o1(e,a.getNode(),a.isFullyInitialized()||hn(t),a.isFiltered()),t,r,g1,i)}(n,e,t.path,r,a)}const g=a.getChanges();return function V$(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=uD(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&t.push(n1(uD(e)))}}(e,c,g),{viewCache:c,changes:g}}(n.processor_,i,e,t,r);return function F$(n,e){(0,U.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,U.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,a.viewCache),(0,U.hu)(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=a.viewCache,I1(n,a.changes,a.viewCache.eventCache.getNode(),null)}function I1(n,e,t,r){return function m$(n,e,t,r){const i=[],a=[];return e.forEach(c=>{"child_changed"===c.type&&n.index_.indexedValueChanged(c.oldSnap,c.snapshotNode)&&a.push(function n$(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(c.childName,c.snapshotNode))}),Hw(n,i,"child_removed",e,r,t),Hw(n,i,"child_added",e,r,t),Hw(n,i,"child_moved",a,r,t),Hw(n,i,"child_changed",e,r,t),Hw(n,i,"value",e,r,t),i}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}let fD,gD;class C1{constructor(){this.views=new Map}}function hP(n,e,t,r){const i=e.source.queryId;if(null!==i){const a=n.views.get(i);return(0,U.hu)(null!=a,"SyncTree gave us an op for an invalid query."),E1(a,e,t,r)}{let a=[];for(const c of n.views.values())a=a.concat(E1(c,e,t,r));return a}}function T1(n,e,t,r,i){const c=n.views.get(e._queryIdentifier);if(!c){let h=lD(t,i?r:null),g=!1;h?g=!0:r instanceof rn?(h=aP(t,r),g=!1):(h=rn.EMPTY_NODE,g=!1);const v=aD(new jf(h,g,!1),new jf(r,i,!1));return new z$(e,v)}return c}function D1(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Hf(n,e){let t=null;for(const r of n.views.values())t=t||q$(r,e);return t}function b1(n,e){return e._queryParams.loadsAllData()?pD(n):n.views.get(e._queryIdentifier)}function S1(n,e){return null!=b1(n,e)}function zf(n){return null!=pD(n)}function pD(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let rH=1;class A1{constructor(e){this.listenProvider_=e,this.syncPointTree_=new lr(null),this.pendingWriteTree_=function N$(){return{visibleWrites:Wu.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function fP(n,e,t,r,i){return function w$(n,e,t,r,i){(0,U.hu)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Gw(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,i),i?Ey(n,new om({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function Gf(n,e,t=!1){const r=function I$(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function C$(n,e){const t=n.allWrites.findIndex(h=>h.writeId===e);(0,U.hu)(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,a=!1,c=n.allWrites.length-1;for(;i&&c>=0;){const h=n.allWrites[c];h.visible&&(c>=t&&T$(h,r.path)?i=!1:qa(r.path,h.path)&&(a=!0)),c--}return!!i&&(a?(function D$(n){n.visibleWrites=l1(n.allWrites,b$,Sn()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=a1(n.visibleWrites,r.path):qi(r.children,g=>{n.visibleWrites=a1(n.visibleWrites,Mr(r.path,g))}),!0))}(n.pendingWriteTree_,e)){let a=new lr(null);return null!=r.snap?a=a.set(Sn(),!0):qi(r.children,c=>{a=a.set(new kn(c),!0)}),Ey(n,new oD(r.path,a,t))}return[]}function Ww(n,e,t){return Ey(n,new om({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function mD(n,e,t,r,i=!1){const a=e._path,c=n.syncPointTree_.get(a);let h=[];if(c&&("default"===e._queryIdentifier||S1(c,e))){const g=function eH(n,e,t,r){const i=e._queryIdentifier,a=[];let c=[];const h=zf(n);if("default"===i)for(const[g,v]of n.views.entries())c=c.concat(w1(v,t,r)),v1(v)&&(n.views.delete(g),v.query._queryParams.loadsAllData()||a.push(v.query));else{const g=n.views.get(i);g&&(c=c.concat(w1(g,t,r)),v1(g)&&(n.views.delete(i),g.query._queryParams.loadsAllData()||a.push(g.query)))}return h&&!zf(n)&&a.push(new(function Q$(){return(0,U.hu)(fD,"Reference.ts has not been loaded"),fD}())(e._repo,e._path)),{removed:a,events:c}}(c,e,t,r);(function X$(n){return 0===n.views.size})(c)&&(n.syncPointTree_=n.syncPointTree_.remove(a));const v=g.removed;if(h=g.events,!i){const T=-1!==v.findIndex(M=>M._queryParams.loadsAllData()),S=n.syncPointTree_.findOnPath(a,(M,$)=>zf($));if(T&&!S){const M=n.syncPointTree_.subtree(a);if(!M.isEmpty()){const $=function lH(n){return n.fold((e,t,r)=>{if(t&&zf(t))return[pD(t)];{let i=[];return t&&(i=D1(t)),qi(r,(a,c)=>{i=i.concat(c)}),i}})}(M);for(let Y=0;Y<$.length;++Y){const fe=$[Y],ge=fe.query,et=N1(n,fe);n.listenProvider_.startListening(Kw(ge),qw(n,ge),et.hashFn,et.onComplete)}}}!S&&v.length>0&&!r&&(T?n.listenProvider_.stopListening(Kw(e),null):v.forEach(M=>{const $=n.queryToTagMap.get(yD(M));n.listenProvider_.stopListening(Kw(M),$)}))}!function dH(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=yD(r),a=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(a)}}}(n,v)}return h}function R1(n,e,t,r){const i=gP(n,r);if(null!=i){const a=mP(i),c=a.path,h=a.queryId,g=Bs(c,e);return _P(n,c,new om(nP(h),g,t))}return[]}function pP(n,e,t,r=!1){const i=e._path;let a=null,c=!1;n.syncPointTree_.foreachOnPath(i,(M,$)=>{const Y=Bs(M,i);a=a||Hf($,Y),c=c||zf($)});let g,h=n.syncPointTree_.get(i);h?(c=c||zf(h),a=a||Hf(h,Sn())):(h=new C1,n.syncPointTree_=n.syncPointTree_.set(i,h)),null!=a?g=!0:(g=!1,a=rn.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild(($,Y)=>{const fe=Hf(Y,Sn());fe&&(a=a.updateImmediateChild($,fe))}));const v=S1(h,e);if(!v&&!e._queryParams.loadsAllData()){const M=yD(e);(0,U.hu)(!n.queryToTagMap.has(M),"View does not exist, but we have a tag");const $=function hH(){return rH++}();n.queryToTagMap.set(M,$),n.tagToQueryMap.set($,M)}let S=function J$(n,e,t,r,i,a){const c=T1(n,e,r,i,a);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,c),function K$(n,e){n.eventRegistrations_.push(e)}(c,t),function Z$(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(cr,(a,c)=>{r.push(_y(a,c))}),t.isFullyInitialized()&&r.push(n1(t.getNode())),I1(n,r,t.getNode(),e)}(c,t)}(h,e,t,cD(n.pendingWriteTree_,i),a,g);if(!v&&!c&&!r){const M=b1(h,e);S=S.concat(function fH(n,e,t){const r=e._path,i=qw(n,e),a=N1(n,t),c=n.listenProvider_.startListening(Kw(e),i,a.hashFn,a.onComplete),h=n.syncPointTree_.subtree(r);if(i)(0,U.hu)(!zf(h.value),"If we're adding a query, it shouldn't be shadowed");else{const g=h.fold((v,T,S)=>{if(!hn(v)&&T&&zf(T))return[pD(T).query];{let M=[];return T&&(M=M.concat(D1(T).map($=>$.query))),qi(S,($,Y)=>{M=M.concat(Y)}),M}});for(let v=0;v<g.length;++v){const T=g[v];n.listenProvider_.stopListening(Kw(T),qw(n,T))}}return c}(n,e,M))}return S}function _D(n,e,t){const i=n.pendingWriteTree_,a=n.syncPointTree_.findOnPath(e,(c,h)=>{const v=Hf(h,Bs(c,e));if(v)return v});return d1(i,e,a,t,!0)}function Ey(n,e){return x1(e,n.syncPointTree_,null,cD(n.pendingWriteTree_,Sn()))}function x1(n,e,t,r){if(hn(n.path))return P1(n,e,t,r);{const i=e.get(Sn());null==t&&null!=i&&(t=Hf(i,Sn()));let a=[];const c=dn(n.path),h=n.operationForChild(c),g=e.children.get(c);if(g&&h){const v=t?t.getImmediateChild(c):null,T=f1(r,c);a=a.concat(x1(h,g,v,T))}return i&&(a=a.concat(hP(i,n,r,t))),a}}function P1(n,e,t,r){const i=e.get(Sn());null==t&&null!=i&&(t=Hf(i,Sn()));let a=[];return e.children.inorderTraversal((c,h)=>{const g=t?t.getImmediateChild(c):null,v=f1(r,c),T=n.operationForChild(c);T&&(a=a.concat(P1(T,h,g,v)))}),i&&(a=a.concat(hP(i,n,r,t))),a}function N1(n,e){const t=e.query,r=qw(n,t);return{hashFn:()=>(function G$(n){return n.viewCache_.serverCache.getNode()}(e)||rn.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function aH(n,e,t){const r=gP(n,t);if(r){const i=mP(r),a=i.path,c=i.queryId,h=Bs(a,e);return _P(n,a,new $w(nP(c),h))}return[]}(n,t._path,r):function oH(n,e){return Ey(n,new $w({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const a=function sj(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}(i,t);return mD(n,t,null,a)}}}}function qw(n,e){const t=yD(e);return n.queryToTagMap.get(t)}function yD(n){return n._path.toString()+"$"+n._queryIdentifier}function gP(n,e){return n.tagToQueryMap.get(e)}function mP(n){const e=n.indexOf("$");return(0,U.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new kn(n.substr(0,e))}}function _P(n,e,t){const r=n.syncPointTree_.get(e);return(0,U.hu)(r,"Missing sync point for query tag that we're tracking"),hP(r,t,cD(n.pendingWriteTree_,e),null)}function Kw(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function nH(){return(0,U.hu)(gD,"Reference.ts has not been loaded"),gD}())(n._repo,n._path):n}class yP{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new yP(t)}node(){return this.node_}}class vP{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Mr(this.path_,e);return new vP(this.syncTree_,t)}node(){return _D(this.syncTree_,this.path_)}}const pH=function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n},M1=function(n,e,t){return n&&"object"==typeof n?((0,U.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?gH(n[".sv"],e,t):"object"==typeof n[".sv"]?mH(n[".sv"],e):void(0,U.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},gH=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,U.hu)(!1,"Unexpected server value: "+n)},mH=function(n,e,t){n.hasOwnProperty("increment")||(0,U.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,U.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,U.hu)(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const c=i.getValue();return"number"!=typeof c?r:c+r},k1=function(n,e,t,r){return EP(e,new vP(t,n),r)},wP=function(n,e,t){return EP(n,new yP(e),t)};function EP(n,e,t){const r=n.getPriority().val(),i=M1(r,e.getImmediateChild(".priority"),t);let a;if(n.isLeafNode()){const c=n,h=M1(c.getValue(),e,t);return h!==c.getValue()||i!==c.getPriority().val()?new gy(h,$r(i)):n}{const c=n;return a=c,i!==c.getPriority().val()&&(a=a.updatePriority(new gy(i))),c.forEachChild(cr,(h,g)=>{const v=EP(g,e.getImmediateChild(h),t);v!==g&&(a=a.updateImmediateChild(h,v))}),a}}class IP{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function vD(n,e){let t=e instanceof kn?e:new kn(e),r=n,i=dn(t);for(;null!==i;){const a=(0,U.DV)(r.node.children,i)||{children:{},childCount:0};r=new IP(i,r,a),t=nr(t),i=dn(t)}return r}function cm(n){return n.node.value}function CP(n,e){n.node.value=e,TP(n)}function O1(n){return n.node.childCount>0}function wD(n,e){qi(n.node.children,(t,r)=>{e(new IP(t,n,r))})}function L1(n,e,t,r){t&&!r&&e(n),wD(n,i=>{L1(i,e,!0,r)}),t&&r&&e(n)}function Zw(n){return new kn(null===n.parent?n.name:Zw(n.parent)+"/"+n.name)}function TP(n){null!==n.parent&&function vH(n,e,t){const r=function _H(n){return void 0===cm(n)&&!O1(n)}(t),i=(0,U.r3)(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,TP(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,TP(n))}(n.parent,n.name,n)}const wH=/[\[\].#$\/\u0000-\u001F\u007F]/,EH=/[\[\].#$\u0000-\u001F\u007F]/,DP=10485760,ED=function(n){return"string"==typeof n&&0!==n.length&&!wH.test(n)},F1=function(n){return"string"==typeof n&&0!==n.length&&!EH.test(n)},Yw=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!KT(n)||n&&"object"==typeof n&&(0,U.r3)(n,".sv")},ol=function(n,e,t,r){r&&void 0===e||Qw((0,U.gK)(n,"value"),e,t)},Qw=function(n,e,t){const r=t instanceof kn?new Uj(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+im(r));if("function"==typeof e)throw new Error(n+"contains a function "+im(r)+" with contents = "+e.toString());if(KT(e))throw new Error(n+"contains "+e.toString()+" "+im(r));if("string"==typeof e&&e.length>DP/3&&(0,U.ug)(e)>DP)throw new Error(n+"contains a string greater than "+DP+" utf8 bytes "+im(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,a=!1;if(qi(e,(c,h)=>{if(".value"===c)i=!0;else if(".priority"!==c&&".sv"!==c&&(a=!0,!ED(c)))throw new Error(n+" contains an invalid key ("+c+") "+im(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function Vj(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,U.ug)(e),qO(n)})(r,c),Qw(n,h,r),function Bj(n){const e=n.parts_.pop();n.byteLength_-=(0,U.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),i&&a)throw new Error(n+' contains ".value" child '+im(r)+" in addition to actual children.")}},U1=function(n,e,t,r){if(r&&void 0===e)return;const i=(0,U.gK)(n,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const a=[];qi(e,(c,h)=>{const g=new kn(c);if(Qw(i,h,Mr(t,g)),".priority"===jx(g)&&!Yw(h))throw new Error(i+"contains an invalid value for '"+g.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(g)}),function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const a=Ow(r);for(let c=0;c<a.length;c++)if((".priority"!==a[c]||c!==a.length-1)&&!ED(a[c]))throw new Error(n+"contains an invalid key ("+a[c]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(Fj);let i=null;for(t=0;t<e.length;t++){if(r=e[t],null!==i&&qa(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,a)},bP=function(n,e,t){if(!t||void 0!==e){if(KT(e))throw new Error((0,U.gK)(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Yw(e))throw new Error((0,U.gK)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Xw=function(n,e,t,r){if(!(r&&void 0===t||ED(t)))throw new Error((0,U.gK)(n,e)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Jw=function(n,e,t,r){if(!(r&&void 0===t||F1(t)))throw new Error((0,U.gK)(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},TH=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Jw(n,e,t,r)},Za=function(n,e){if(".info"===dn(e))throw new Error(n+" failed = Can't modify data under /.info/")},V1=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!ED(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),F1(n)}(t))throw new Error((0,U.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class DH{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ID(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],a=i.getPath();null!==t&&!$x(a,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:a}),t.events.push(i)}t&&n.eventLists_.push(t)}function B1(n,e,t){ID(n,t),j1(n,r=>$x(r,e))}function ea(n,e,t){ID(n,t),j1(n,r=>qa(r,e)||qa(e,r))}function j1(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];i&&(e(i.path)?(bH(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function bH(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();nm&&Wi("event: "+t.toString()),fy(r)}}}const $1="repo_interrupt",SH=25;class AH{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new DH,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=sD(),this.transactionQueueTree_=new IP,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function H1(n){const t=n.infoData_.getNode(new kn(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function eE(n){return pH({timestamp:H1(n)})}function z1(n,e,t,r,i){n.dataUpdateCount++;const a=new kn(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let c=[];if(i)if(r){const g=(0,U.UI)(t,v=>$r(v));c=function uH(n,e,t,r){const i=gP(n,r);if(i){const a=mP(i),c=a.path,h=a.queryId,g=Bs(c,e),v=lr.fromObject(t);return _P(n,c,new vy(nP(h),g,v))}return[]}(n.serverSyncTree_,a,g,i)}else{const g=$r(t);c=R1(n.serverSyncTree_,a,g,i)}else if(r){const g=(0,U.UI)(t,v=>$r(v));c=function sH(n,e,t){const r=lr.fromObject(t);return Ey(n,new vy({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,a,g)}else{const g=$r(t);c=Ww(n.serverSyncTree_,a,g)}let h=a;c.length>0&&(h=Cy(n,a)),ea(n.eventQueue_,h,c)}function G1(n,e){SP(n,"connected",e),!1===e&&function MH(n){Iy(n,"onDisconnectEvents");const e=eE(n),t=sD();Jx(n.onDisconnect_,Sn(),(i,a)=>{const c=k1(i,a,n.serverSyncTree_,e);yy(t,i,c)});let r=[];Jx(t,Sn(),(i,a)=>{r=r.concat(Ww(n.serverSyncTree_,i,a));const c=PP(n,i);Cy(n,c)}),n.onDisconnect_=sD(),ea(n.eventQueue_,Sn(),r)}(n)}function SP(n,e,t){const r=new kn("/.info/"+e),i=$r(t);n.infoData_.updateSnapshot(r,i);const a=Ww(n.infoSyncTree_,r,i);ea(n.eventQueue_,r,a)}function CD(n){return n.nextWriteId_++}function AP(n,e,t,r,i){Iy(n,"set",{path:e.toString(),value:t,priority:r});const a=eE(n),c=$r(t,r),h=_D(n.serverSyncTree_,e),g=wP(c,h,a),v=CD(n),T=fP(n.serverSyncTree_,e,g,v,!0);ID(n.eventQueue_,T),n.server_.put(e.toString(),c.val(!0),(M,$)=>{const Y="ok"===M;Y||Es("set at "+e+" failed: "+M);const fe=Gf(n.serverSyncTree_,v,!Y);ea(n.eventQueue_,e,fe),Wf(0,i,M,$)});const S=PP(n,e);Cy(n,S),ea(n.eventQueue_,S,[])}function kH(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{"ok"===r&&Xx(n.onDisconnect_,e),Wf(0,t,r,i)})}function W1(n,e,t,r){const i=$r(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(a,c)=>{"ok"===a&&yy(n.onDisconnect_,e,i),Wf(0,r,a,c)})}function RP(n,e,t){let r;r=".info"===dn(e._path)?mD(n.infoSyncTree_,e,t):mD(n.serverSyncTree_,e,t),B1(n.eventQueue_,e._path,r)}function q1(n){n.persistentConnection_&&n.persistentConnection_.interrupt($1)}function Iy(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Wi(t,...e)}function Wf(n,e,t,r){e&&fy(()=>{if("ok"===t)e(null);else{const i=(t||"error").toUpperCase();let a=i;r&&(a+=": "+r);const c=new Error(a);c.code=i,e(c)}})}function xP(n,e,t){return _D(n.serverSyncTree_,e,t)||rn.EMPTY_NODE}function TD(n,e=n.transactionQueueTree_){if(e||DD(n,e),cm(e)){const t=Z1(n,e);(0,U.hu)(t.length>0,"Sending zero length transaction queue"),t.every(i=>0===i.status)&&function BH(n,e,t){const r=t.map(v=>v.currentWriteId),i=xP(n,e,r);let a=i;const c=i.hash();for(let v=0;v<t.length;v++){const T=t[v];(0,U.hu)(0===T.status,"tryToSendTransactionQueue_: items in queue should all be run."),T.status=1,T.retryCount++;const S=Bs(e,T.path);a=a.updateChild(S,T.currentOutputSnapshotRaw)}const h=a.val(!0),g=e;n.server_.put(g.toString(),h,v=>{Iy(n,"transaction put response",{path:g.toString(),status:v});let T=[];if("ok"===v){const S=[];for(let M=0;M<t.length;M++)t[M].status=2,T=T.concat(Gf(n.serverSyncTree_,t[M].currentWriteId)),t[M].onComplete&&S.push(()=>t[M].onComplete(null,!0,t[M].currentOutputSnapshotResolved)),t[M].unwatcher();DD(n,vD(n.transactionQueueTree_,e)),TD(n,n.transactionQueueTree_),ea(n.eventQueue_,e,T);for(let M=0;M<S.length;M++)fy(S[M])}else{if("datastale"===v)for(let S=0;S<t.length;S++)t[S].status=3===t[S].status?4:0;else{Es("transaction at "+g.toString()+" failed: "+v);for(let S=0;S<t.length;S++)t[S].status=4,t[S].abortReason=v}Cy(n,e)}},c)}(n,Zw(e),t)}else O1(e)&&wD(e,t=>{TD(n,t)})}function Cy(n,e){const t=K1(n,e),r=Zw(t);return function jH(n,e,t){if(0===e.length)return;const r=[];let i=[];const c=e.filter(h=>0===h.status).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const g=e[h],v=Bs(t,g.path);let S,T=!1;if((0,U.hu)(null!==v,"rerunTransactionsUnderNode_: relativePath should not be null."),4===g.status)T=!0,S=g.abortReason,i=i.concat(Gf(n.serverSyncTree_,g.currentWriteId,!0));else if(0===g.status)if(g.retryCount>=SH)T=!0,S="maxretry",i=i.concat(Gf(n.serverSyncTree_,g.currentWriteId,!0));else{const M=xP(n,g.path,c);g.currentInputSnapshot=M;const $=e[h].update(M.val());if(void 0!==$){Qw("transaction failed: Data returned ",$,g.path);let Y=$r($);"object"==typeof $&&null!=$&&(0,U.r3)($,".priority")||(Y=Y.updatePriority(M.getPriority()));const ge=g.currentWriteId,et=eE(n),it=wP(Y,M,et);g.currentOutputSnapshotRaw=Y,g.currentOutputSnapshotResolved=it,g.currentWriteId=CD(n),c.splice(c.indexOf(ge),1),i=i.concat(fP(n.serverSyncTree_,g.path,it,g.currentWriteId,g.applyLocally)),i=i.concat(Gf(n.serverSyncTree_,ge,!0))}else T=!0,S="nodata",i=i.concat(Gf(n.serverSyncTree_,g.currentWriteId,!0))}ea(n.eventQueue_,t,i),i=[],T&&(e[h].status=2,setTimeout(e[h].unwatcher,Math.floor(0)),e[h].onComplete&&r.push("nodata"===S?()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot):()=>e[h].onComplete(new Error(S),!1,null)))}DD(n,n.transactionQueueTree_);for(let h=0;h<r.length;h++)fy(r[h]);TD(n,n.transactionQueueTree_)}(n,Z1(n,t),r),r}function K1(n,e){let t,r=n.transactionQueueTree_;for(t=dn(e);null!==t&&void 0===cm(r);)r=vD(r,t),t=dn(e=nr(e));return r}function Z1(n,e){const t=[];return Y1(n,e,t),t.sort((r,i)=>r.order-i.order),t}function Y1(n,e,t){const r=cm(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);wD(e,i=>{Y1(n,i,t)})}function DD(n,e){const t=cm(e);if(t){let r=0;for(let i=0;i<t.length;i++)2!==t[i].status&&(t[r]=t[i],r++);t.length=r,CP(e,t.length>0?t:void 0)}wD(e,r=>{DD(n,r)})}function PP(n,e){const t=Zw(K1(n,e)),r=vD(n.transactionQueueTree_,e);return function yH(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{NP(n,i)}),NP(n,r),L1(r,i=>{NP(n,i)}),t}function NP(n,e){const t=cm(e);if(t){const r=[];let i=[],a=-1;for(let c=0;c<t.length;c++)3===t[c].status||(1===t[c].status?((0,U.hu)(a===c-1,"All SENT items should be at beginning of queue."),a=c,t[c].status=3,t[c].abortReason="set"):((0,U.hu)(0===t[c].status,"Unexpected transaction status in abort"),t[c].unwatcher(),i=i.concat(Gf(n.serverSyncTree_,t[c].currentWriteId,!0)),t[c].onComplete&&r.push(t[c].onComplete.bind(null,new Error("set"),!1,null))));-1===a?CP(e,void 0):t.length=a+1,ea(n.eventQueue_,Zw(e),i);for(let c=0;c<r.length;c++)fy(r[c])}}const MP=function(n,e){const t=zH(n),r=t.namespace;return"firebase.com"===t.domain&&il(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&il("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Es("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new Ox(t.host,t.secure,r,"ws"===t.scheme||"wss"===t.scheme,e,"",r!==t.subdomain),path:new kn(t.pathString)}},zH=function(n){let e="",t="",r="",i="",a="",c=!0,h="https",g=443;if("string"==typeof n){let v=n.indexOf("//");v>=0&&(h=n.substring(0,v-1),n=n.substring(v+2));let T=n.indexOf("/");-1===T&&(T=n.length);let S=n.indexOf("?");-1===S&&(S=n.length),e=n.substring(0,Math.min(T,S)),T<S&&(i=function $H(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}(n.substring(T,S)));const M=function HH(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Es(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,S)));v=e.indexOf(":"),v>=0?(c="https"===h||"wss"===h,g=parseInt(e.substring(v+1),10)):v=e.length;const $=e.slice(0,v);if("localhost"===$.toLowerCase())t="localhost";else if($.split(".").length<=2)t=$;else{const Y=e.indexOf(".");r=e.substring(0,Y).toLowerCase(),t=e.substring(Y+1),a=r}"ns"in M&&(a=M.ns)}return{host:e,port:g,domain:t,subdomain:r,secure:c,scheme:h,pathString:i,namespace:a}},Q1="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",GH=function(){let n=0;const e=[];return function(t){const r=t===n;let i;n=t;const a=new Array(8);for(i=7;i>=0;i--)a[i]=Q1.charAt(t%64),t=Math.floor(t/64);(0,U.hu)(0===t,"Cannot push at time == 0");let c=a.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)c+=Q1.charAt(e[i]);return(0,U.hu)(20===c.length,"nextPushId: Length should be 20."),c}}();class X1{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,U.Wl)(this.snapshot.exportVal())}}class J1{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class kP{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,U.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class eL{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new U.BH;return kH(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Za("OnDisconnect.remove",this._path);const e=new U.BH;return W1(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Za("OnDisconnect.set",this._path),ol("OnDisconnect.set",e,this._path,!1);const t=new U.BH;return W1(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Za("OnDisconnect.setWithPriority",this._path),ol("OnDisconnect.setWithPriority",e,this._path,!1),bP("OnDisconnect.setWithPriority",t,!1);const r=new U.BH;return function OH(n,e,t,r,i){const a=$r(t,r);n.server_.onDisconnectPut(e.toString(),a.val(!0),(c,h)=>{"ok"===c&&yy(n.onDisconnect_,e,a),Wf(0,i,c,h)})}(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Za("OnDisconnect.update",this._path),U1("OnDisconnect.update",e,this._path,!1);const t=new U.BH;return function LH(n,e,t,r){if((0,U.xb)(t))return Wi("onDisconnect().update() called with empty data.  Don't do anything."),void Wf(0,r,"ok",void 0);n.server_.onDisconnectMerge(e.toString(),t,(i,a)=>{"ok"===i&&qi(t,(c,h)=>{const g=$r(h);yy(n.onDisconnect_,Mr(e,c),g)}),Wf(0,r,i,a)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class Eo{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return hn(this._path)?null:jx(this._path)}get ref(){return new Ya(this._repo,this._path)}get _queryIdentifier(){const e=i1(this._queryParams),t=Mx(e);return"{}"===t?"default":t}get _queryObject(){return i1(this._queryParams)}isEqual(e){if(!((e=(0,U.m9)(e))instanceof Eo))return!1;const t=this._repo===e._repo,r=$x(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function Lj(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}function bD(n,e){if(!0===n._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function qf(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===sl){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Uf)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==Dd)throw new Error(r);if("string"!=typeof t)throw new Error(i)}}else if(n.getIndex()===cr){if(null!=e&&!Yw(e)||null!=t&&!Yw(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,U.hu)(n.getIndex()instanceof qx||n.getIndex()===Kx,"unknown index type."),null!=e&&"object"==typeof e||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function SD(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Ya extends Eo{constructor(e,t){super(e,t,new nD,!1)}get parent(){const e=WO(this._path);return null===e?null:new Ya(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class lm{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new kn(e),r=dm(this.ref,e);return new lm(this._node.getChild(t),r,cr)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new lm(i,dm(this.ref,r),cr)))}hasChild(e){const t=new kn(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function tL(n,e){return(n=(0,U.m9)(n))._checkNotDeleted("ref"),void 0!==e?dm(n._root,e):n._root}function nL(n,e){(n=(0,U.m9)(n))._checkNotDeleted("refFromURL");const t=MP(e,n._repo.repoInfo_.nodeAdmin);V1("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&il("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),tL(n,t.path.toString())}function dm(n,e){return null===dn((n=(0,U.m9)(n))._path)?TH("child","path",e,!1):Jw("child","path",e,!1),new Ya(n._repo,Mr(n._path,e))}function OP(n,e){n=(0,U.m9)(n),Za("set",n._path),ol("set",e,n._path,!1);const t=new U.BH;return AP(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function YH(n,e){U1("update",e,n._path,!1);const t=new U.BH;return function NH(n,e,t,r){Iy(n,"update",{path:e.toString(),value:t});let i=!0;const a=eE(n),c={};if(qi(t,(h,g)=>{i=!1,c[h]=k1(Mr(e,h),$r(g),n.serverSyncTree_,a)}),i)Wi("update() called with empty data.  Don't do anything."),Wf(0,r,"ok",void 0);else{const h=CD(n),g=function iH(n,e,t,r){!function E$(n,e,t,r){(0,U.hu)(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=iP(n.visibleWrites,e,t),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r);const i=lr.fromObject(t);return Ey(n,new vy({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,e,c,h);ID(n.eventQueue_,g),n.server_.merge(e.toString(),t,(v,T)=>{const S="ok"===v;S||Es("update at "+e+" failed: "+v);const M=Gf(n.serverSyncTree_,h,!S),$=M.length>0?Cy(n,e):e;ea(n.eventQueue_,$,M),Wf(0,r,v,T)}),qi(t,v=>{const T=PP(n,Mr(e,v));Cy(n,T)}),ea(n.eventQueue_,e,[])}}(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function QH(n){n=(0,U.m9)(n);const e=new kP(()=>{}),t=new tE(e);return function PH(n,e,t){const r=function cH(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(v,T)=>{const S=Bs(v,t);r=r||Hf(T,S)});let i=n.syncPointTree_.get(t);i?r=r||Hf(i,Sn()):(i=new C1,n.syncPointTree_=n.syncPointTree_.set(t,i));const a=null!=r,c=a?new jf(r,!0,!1):null;return function W$(n){return uD(n.viewCache_)}(T1(i,e,cD(n.pendingWriteTree_,e._path),a?c.getNode():rn.EMPTY_NODE,a))}(n.serverSyncTree_,e);return null!=r?Promise.resolve(r):n.server_.get(e).then(i=>{const a=$r(i).withIndex(e._queryParams.getIndex());let c;if(pP(n.serverSyncTree_,e,t,!0),e._queryParams.loadsAllData())c=Ww(n.serverSyncTree_,e._path,a);else{const h=qw(n.serverSyncTree_,e);c=R1(n.serverSyncTree_,e._path,a,h)}return ea(n.eventQueue_,e._path,c),mD(n.serverSyncTree_,e,t,null,!0),a},i=>(Iy(n,"get for query "+(0,U.Wl)(e)+" failed: "+i),Promise.reject(new Error(i))))}(n._repo,n,t).then(r=>new lm(r,new Ya(n._repo,n._path),n._queryParams.getIndex()))}class tE{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const r=t._queryParams.getIndex();return new X1("value",this,new lm(e.snapshotNode,new Ya(t._repo,t._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new J1(this,e,t):null}matches(e){return e instanceof tE&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class AD{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new J1(this,e,t):null}createEvent(e,t){(0,U.hu)(null!=e.childName,"Child events should have a childName.");const r=dm(new Ya(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new X1(e.type,this,new lm(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof AD&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function nE(n,e,t,r,i){let a;if("object"==typeof r&&(a=void 0,i=r),"function"==typeof r&&(a=r),i&&i.onlyOnce){const g=t,v=(T,S)=>{RP(n._repo,n,h),g(T,S)};v.userCallback=t.userCallback,v.context=t.context,t=v}const c=new kP(t,a||void 0),h="value"===e?new tE(c):new AD(e,c);return function FH(n,e,t){let r;r=".info"===dn(e._path)?pP(n.infoSyncTree_,e,t):pP(n.serverSyncTree_,e,t),B1(n.eventQueue_,e._path,r)}(n._repo,n,h),()=>RP(n._repo,n,h)}function LP(n,e,t,r){return nE(n,"value",e,t,r)}function rL(n,e,t,r){return nE(n,"child_added",e,t,r)}function iL(n,e,t,r){return nE(n,"child_changed",e,t,r)}function sL(n,e,t,r){return nE(n,"child_moved",e,t,r)}function oL(n,e,t,r){return nE(n,"child_removed",e,t,r)}function aL(n,e,t){let r=null;const i=t?new kP(t):null;"value"===e?r=new tE(i):e&&(r=new AD(e,i)),RP(n._repo,n,r)}class qu{}class uL extends qu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ol("endAt",this._value,e._path,!0);const t=Qx(e._queryParams,this._value,this._key);if(SD(t),qf(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Eo(e._repo,e._path,t,e._orderByCalled)}}class JH extends qu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ol("endBefore",this._value,e._path,!1);const t=function u$(n,e,t){let r;return r=Qx(n,e,n.index_===sl||t?t:Uf),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(SD(t),qf(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Eo(e._repo,e._path,t,e._orderByCalled)}}class cL extends qu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ol("startAt",this._value,e._path,!0);const t=Yx(e._queryParams,this._value,this._key);if(SD(t),qf(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Eo(e._repo,e._path,t,e._orderByCalled)}}class n4 extends qu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ol("startAfter",this._value,e._path,!1);const t=function a$(n,e,t){let r;return r=Yx(n,e,n.index_===sl||t?t:Dd),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(SD(t),qf(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Eo(e._repo,e._path,t,e._orderByCalled)}}class i4 extends qu{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Eo(e._repo,e._path,function s$(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}(e._queryParams,this._limit),e._orderByCalled)}}class o4 extends qu{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Eo(e._repo,e._path,function o$(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}(e._queryParams,this._limit),e._orderByCalled)}}class u4 extends qu{constructor(e){super(),this._path=e}_apply(e){bD(e,"orderByChild");const t=new kn(this._path);if(hn(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new qx(t),i=rD(e._queryParams,r);return qf(i),new Eo(e._repo,e._path,i,!0)}}class l4 extends qu{_apply(e){bD(e,"orderByKey");const t=rD(e._queryParams,sl);return qf(t),new Eo(e._repo,e._path,t,!0)}}class h4 extends qu{_apply(e){bD(e,"orderByPriority");const t=rD(e._queryParams,cr);return qf(t),new Eo(e._repo,e._path,t,!0)}}class p4 extends qu{_apply(e){bD(e,"orderByValue");const t=rD(e._queryParams,Kx);return qf(t),new Eo(e._repo,e._path,t,!0)}}class m4 extends qu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(ol("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new uL(this._value,this._key)._apply(new cL(this._value,this._key)._apply(e))}}function Ku(n,...e){let t=(0,U.m9)(n);for(const r of e)t=r._apply(t);return t}(function Y$(n){(0,U.hu)(!fD,"__referenceConstructor has already been defined"),fD=n})(Ya),function tH(n){(0,U.hu)(!gD,"__referenceConstructor has already been defined"),gD=n}(Ya);const y4="FIREBASE_DATABASE_EMULATOR_HOST",FP={};let lL=!1;function dL(n,e,t,r,i){let a=r||n.options.databaseURL;void 0===a&&(n.options.projectId||il("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Wi("Using default host for project ",n.options.projectId),a=`${n.options.projectId}-default-rtdb.firebaseio.com`);let g,v,c=MP(a,i),h=c.repoInfo;typeof process<"u"&&process.env&&(v=process.env[y4]),v?(g=!0,a=`http://${v}?ns=${h.namespace}`,c=MP(a,i),h=c.repoInfo):g=!c.repoInfo.secure;const T=i&&g?new kw(kw.OWNER):new dj(n.name,n.options,e);V1("Invalid Firebase Database URL",c),hn(c.path)||il("Database URL must point to the root of a Firebase Database (not including a child path).");const S=function E4(n,e,t,r){let i=FP[e.name];i||(i={},FP[e.name]=i);let a=i[n.toURLString()];return a&&il("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new AH(n,lL,t,r),i[n.toURLString()]=a,a}(h,n,T,new lj(n.name,t));return new C4(S,n)}class C4{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function RH(n,e,t){if(n.stats_=Ux(n.repoInfo_),n.forceRestClient_||cj())n.server_=new iD(n.repoInfo_,(r,i,a,c)=>{z1(n,r,i,a,c)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>G1(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,U.Wl)(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new sm(n.repoInfo_,e,(r,i,a,c)=>{z1(n,r,i,a,c)},r=>{G1(n,r)},r=>{!function xH(n,e){qi(e,(t,r)=>{SP(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function pj(n,e){const t=n.toString();return Fx[t]||(Fx[t]=e()),Fx[t]}(n.repoInfo_,()=>new p$(n.stats_,n.server_)),n.infoData_=new c$,n.infoSyncTree_=new A1({startListening:(r,i,a,c)=>{let h=[];const g=n.infoData_.getNode(r._path);return g.isEmpty()||(h=Ww(n.infoSyncTree_,r._path,g),setTimeout(()=>{c("ok")},0)),h},stopListening:()=>{}}),SP(n,"connected",!1),n.serverSyncTree_=new A1({startListening:(r,i,a,c)=>(n.server_.listen(r,a,i,(h,g)=>{const v=c(h,g);ea(n.eventQueue_,r._path,v)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ya(this._repo,Sn())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function w4(n,e){const t=FP[e];(!t||t[n.key]!==n)&&il(`Database ${e}(${n.repoInfo_}) has already been deleted.`),q1(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&il("Cannot call "+e+" on a deleted database.")}}function hL(){kO.IS_TRANSPORT_INITIALIZED&&Es("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function T4(){hL(),Vf.forceDisallow()}function D4(){hL(),py.forceDisallow(),Vf.forceAllow()}function A4(n,e){pO(n,e)}const x4={".sv":"timestamp"};class M4{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}sm.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},sm.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function R4(n){cO(Ai.SDK_VERSION),(0,Ai._registerComponent)(new uo.wA("database",(e,{instanceIdentifier:t})=>dL(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,Ai.registerVersion)(aO,"0.14.4",n),(0,Ai.registerVersion)(aO,"0.14.4","esm2017")}();const F4=new gs.Yd("@firebase/database-compat"),pL=function(n){F4.warn("FIREBASE WARNING: "+n)};class B4{constructor(e){this._delegate=e}cancel(e){(0,U.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,U.Wj)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){(0,U.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,U.Wj)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){(0,U.Dv)("OnDisconnect.set",1,2,arguments.length),(0,U.Wj)("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,U.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,U.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),a=>r(a)),i}update(e,t){if((0,U.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,pL("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,U.Wj)("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}}class j4{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,U.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class Kf{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,U.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,U.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,U.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,U.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,U.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),Jw("DataSnapshot.child","path",e,!1),new Kf(this._database,this._delegate.child(e))}hasChild(e){return(0,U.Dv)("DataSnapshot.hasChild",1,1,arguments.length),Jw("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,U.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,U.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,U.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new Kf(this._database,t)))}hasChildren(){return(0,U.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,U.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,U.Dv)("DataSnapshot.ref",0,0,arguments.length),new ta(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class ss{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var a;(0,U.Dv)("Query.on",2,4,arguments.length),(0,U.Wj)("Query.on","callback",t,!1);const c=ss.getCancelAndContextArgs_("Query.on",r,i),h=(v,T)=>{t.call(c.context,new Kf(this.database,v),T)};h.userCallback=t,h.context=c.context;const g=null===(a=c.cancel)||void 0===a?void 0:a.bind(c.context);switch(e){case"value":return LP(this._delegate,h,g),t;case"child_added":return rL(this._delegate,h,g),t;case"child_removed":return oL(this._delegate,h,g),t;case"child_changed":return iL(this._delegate,h,g),t;case"child_moved":return sL(this._delegate,h,g),t;default:throw new Error((0,U.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if((0,U.Dv)("Query.off",0,3,arguments.length),function(n,e,t){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,U.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,U.Wj)("Query.off","callback",t,!0),(0,U.lb)("Query.off","context",r,!0),t){const i=()=>{};i.userCallback=t,i.context=r,aL(this._delegate,e,i)}else aL(this._delegate,e)}get(){return QH(this._delegate).then(e=>new Kf(this.database,e))}once(e,t,r,i){(0,U.Dv)("Query.once",1,4,arguments.length),(0,U.Wj)("Query.once","callback",t,!0);const a=ss.getCancelAndContextArgs_("Query.once",r,i),c=new U.BH,h=(v,T)=>{const S=new Kf(this.database,v);t&&t.call(a.context,S,T),c.resolve(S)};h.userCallback=t,h.context=a.context;const g=v=>{a.cancel&&a.cancel.call(a.context,v),c.reject(v)};switch(e){case"value":LP(this._delegate,h,g,{onlyOnce:!0});break;case"child_added":rL(this._delegate,h,g,{onlyOnce:!0});break;case"child_removed":oL(this._delegate,h,g,{onlyOnce:!0});break;case"child_changed":iL(this._delegate,h,g,{onlyOnce:!0});break;case"child_moved":sL(this._delegate,h,g,{onlyOnce:!0});break;default:throw new Error((0,U.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return c.promise}limitToFirst(e){return(0,U.Dv)("Query.limitToFirst",1,1,arguments.length),new ss(this.database,Ku(this._delegate,function s4(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new i4(n)}(e)))}limitToLast(e){return(0,U.Dv)("Query.limitToLast",1,1,arguments.length),new ss(this.database,Ku(this._delegate,function a4(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new o4(n)}(e)))}orderByChild(e){return(0,U.Dv)("Query.orderByChild",1,1,arguments.length),new ss(this.database,Ku(this._delegate,function c4(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Jw("orderByChild","path",n,!1),new u4(n)}(e)))}orderByKey(){return(0,U.Dv)("Query.orderByKey",0,0,arguments.length),new ss(this.database,Ku(this._delegate,function d4(){return new l4}()))}orderByPriority(){return(0,U.Dv)("Query.orderByPriority",0,0,arguments.length),new ss(this.database,Ku(this._delegate,function f4(){return new h4}()))}orderByValue(){return(0,U.Dv)("Query.orderByValue",0,0,arguments.length),new ss(this.database,Ku(this._delegate,function g4(){return new p4}()))}startAt(e=null,t){return(0,U.Dv)("Query.startAt",0,2,arguments.length),new ss(this.database,Ku(this._delegate,function t4(n=null,e){return Xw("startAt","key",e,!0),new cL(n,e)}(e,t)))}startAfter(e=null,t){return(0,U.Dv)("Query.startAfter",0,2,arguments.length),new ss(this.database,Ku(this._delegate,function r4(n,e){return Xw("startAfter","key",e,!0),new n4(n,e)}(e,t)))}endAt(e=null,t){return(0,U.Dv)("Query.endAt",0,2,arguments.length),new ss(this.database,Ku(this._delegate,function XH(n,e){return Xw("endAt","key",e,!0),new uL(n,e)}(e,t)))}endBefore(e=null,t){return(0,U.Dv)("Query.endBefore",0,2,arguments.length),new ss(this.database,Ku(this._delegate,function e4(n,e){return Xw("endBefore","key",e,!0),new JH(n,e)}(e,t)))}equalTo(e,t){return(0,U.Dv)("Query.equalTo",1,2,arguments.length),new ss(this.database,Ku(this._delegate,function _4(n,e){return Xw("equalTo","key",e,!0),new m4(n,e)}(e,t)))}toString(){return(0,U.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,U.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,U.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof ss))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,(0,U.Wj)(e,"cancel",i.cancel,!0),i.context=r,(0,U.lb)(e,"context",i.context,!0);else if(t)if("object"==typeof t&&null!==t)i.context=t;else{if("function"!=typeof t)throw new Error((0,U.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=t}return i}get ref(){return new ta(this.database,new Ya(this._delegate._repo,this._delegate._path))}}class ta extends ss{constructor(e,t){super(e,new Eo(t._repo,t._path,new nD,!1)),this.database=e,this._delegate=t}getKey(){return(0,U.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,U.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new ta(this.database,dm(this._delegate,e))}getParent(){(0,U.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new ta(this.database,e):null}getRoot(){return(0,U.Dv)("Reference.root",0,0,arguments.length),new ta(this.database,this._delegate.root)}set(e,t){(0,U.Dv)("Reference.set",1,2,arguments.length),(0,U.Wj)("Reference.set","onComplete",t,!0);const r=OP(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if((0,U.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,pL("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Za("Reference.update",this._delegate._path),(0,U.Wj)("Reference.update","onComplete",t,!0);const r=YH(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,U.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,U.Wj)("Reference.setWithPriority","onComplete",r,!0);const i=function ZH(n,e,t){if(Za("setWithPriority",n._path),ol("setWithPriority",e,n._path,!1),bP("setWithPriority",t,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new U.BH;return AP(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,t);return r&&i.then(()=>r(null),a=>r(a)),i}remove(e){(0,U.Dv)("Reference.remove",0,1,arguments.length),(0,U.Wj)("Reference.remove","onComplete",e,!0);const t=function qH(n){return Za("remove",n._path),OP(n,null)}(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){(0,U.Dv)("Reference.transaction",1,3,arguments.length),(0,U.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,U.Wj)("Reference.transaction","onComplete",t,!0),function(n,e,t,r){if(void 0!==t&&"boolean"!=typeof t)throw new Error((0,U.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function k4(n,e,t){var r;if(n=(0,U.m9)(n),Za("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const i=null===(r=t?.applyLocally)||void 0===r||r,a=new U.BH,h=LP(n,()=>{});return function VH(n,e,t,r,i,a){Iy(n,"transaction on "+e);const c={path:e,update:t,onComplete:r,status:null,order:dO(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=xP(n,e,void 0);c.currentInputSnapshot=h;const g=c.update(h.val());if(void 0===g)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{Qw("transaction failed: Data returned ",g,c.path),c.status=0;const v=vD(n.transactionQueueTree_,e),T=cm(v)||[];let S;T.push(c),CP(v,T),"object"==typeof g&&null!==g&&(0,U.r3)(g,".priority")?(S=(0,U.DV)(g,".priority"),(0,U.hu)(Yw(S),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):S=(_D(n.serverSyncTree_,e)||rn.EMPTY_NODE).getPriority().val();const M=eE(n),$=$r(g,S),Y=wP($,h,M);c.currentOutputSnapshotRaw=$,c.currentOutputSnapshotResolved=Y,c.currentWriteId=CD(n);const fe=fP(n.serverSyncTree_,e,Y,c.currentWriteId,c.applyLocally);ea(n.eventQueue_,e,fe),TD(n,n.transactionQueueTree_)}}(n._repo,n._path,e,(g,v,T)=>{let S=null;g?a.reject(g):(S=new lm(T,new Ya(n._repo,n._path),cr),a.resolve(new M4(v,S)))},h,i),a.promise}(this._delegate,e,{applyLocally:r}).then(a=>new j4(a.committed,new Kf(this.database,a.snapshot)));return t&&i.then(a=>t(null,a.committed,a.snapshot),a=>t(a,!1,null)),i}setPriority(e,t){(0,U.Dv)("Reference.setPriority",1,2,arguments.length),(0,U.Wj)("Reference.setPriority","onComplete",t,!0);const r=function KH(n,e){n=(0,U.m9)(n),Za("setPriority",n._path),bP("setPriority",e,!1);const t=new U.BH;return AP(n._repo,Mr(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){(0,U.Dv)("Reference.push",0,2,arguments.length),(0,U.Wj)("Reference.push","onComplete",t,!0);const r=function WH(n,e){n=(0,U.m9)(n),Za("push",n._path),ol("push",e,n._path,!0);const t=H1(n._repo),r=GH(t),i=dm(n,r),a=dm(n,r);let c;return c=null!=e?OP(a,e).then(()=>a):Promise.resolve(a),i.then=c.then.bind(c),i.catch=c.then.bind(c,void 0),i}(this._delegate,e),i=r.then(c=>new ta(this.database,c));t&&i.then(()=>t(null),c=>t(c));const a=new ta(this.database,r);return a.then=i.then.bind(i),a.catch=i.catch.bind(i,void 0),a}onDisconnect(){return Za("Reference.onDisconnect",this._delegate._path),new B4(new eL(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class rE{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:T4,forceLongPolling:D4}}useEmulator(e,t,r={}){!function fL(n,e,t,r={}){(n=(0,U.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&il("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let a;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&il('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new kw(kw.OWNER);else if(r.mockUserToken){const c="string"==typeof r.mockUserToken?r.mockUserToken:(0,U.Sg)(r.mockUserToken,n.app.options.projectId);a=new kw(c)}!function v4(n,e,t,r){n.repoInfo_=new Ox(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}(i,e,t,a)}(this._delegate,e,t,r)}ref(e){if((0,U.Dv)("database.ref",0,1,arguments.length),e instanceof ta){const t=nL(this._delegate,e.toString());return new ta(this,t)}{const t=tL(this._delegate,e);return new ta(this,t)}}refFromURL(e){(0,U.Dv)("database.refFromURL",1,1,arguments.length);const r=nL(this._delegate,e);return new ta(this,r)}goOffline(){return(0,U.Dv)("database.goOffline",0,0,arguments.length),function b4(n){(n=(0,U.m9)(n))._checkNotDeleted("goOffline"),q1(n._repo)}(this._delegate)}goOnline(){return(0,U.Dv)("database.goOnline",0,0,arguments.length),function S4(n){(n=(0,U.m9)(n))._checkNotDeleted("goOnline"),function UH(n){n.persistentConnection_&&n.persistentConnection_.resume($1)}(n._repo)}(this._delegate)}}rE.ServerValue={TIMESTAMP:function P4(){return x4}(),increment:n=>function N4(n){return{".sv":{increment:n}}}(n)};var H4=Object.freeze({__proto__:null,initStandalone:function $4({app:n,url:e,version:t,customAuthImpl:r,namespace:i,nodeAdmin:a=!1}){cO(t);const c=new uo.zt("auth-internal",new uo.H0("database-standalone"));return c.setComponent(new uo.wA("auth-internal",()=>r,"PRIVATE")),{instance:new rE(dL(n,c,void 0,e,a),n),namespace:i}}});const z4=rE.ServerValue;function gL(n){return null==n}function mL(n){return"function"==typeof n.set}function _L(n,e){return mL(e)?e:n.ref(e)}function yL(n,e){if(function W4(n){return"string"==typeof n}(n))return e.stringCase();if(mL(n))return e.firebaseCase();if(function q4(n){return"function"==typeof n.exportVal}(n))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function iE(n,e,t="on",r=Bp.z){return new ii.y(i=>{let a=null;return a=n[t](e,(c,h)=>{r.schedule(()=>{i.next({snapshot:c,prevKey:h})}),"once"===t&&r.schedule(()=>i.complete())},c=>{r.schedule(()=>i.error(c))}),"on"===t?{unsubscribe(){null!=a&&n.off(e,a)}}:{unsubscribe(){}}}).pipe((0,yt.U)(i=>{const{snapshot:a,prevKey:c}=i;let h=null;return a.exists()&&(h=a.key),{type:e,payload:a,prevKey:c,key:h}}),(0,jM.B)())}function vL(n,e){const t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function Y4(n,e){const{payload:t,prevKey:r,key:i}=e,a=vL(n,i),c=function Z4(n,e){if(gL(e))return 0;{const t=vL(n,e);return-1===t?n.length:t+1}}(n,r);switch(e.type){case"value":if(e.payload&&e.payload.exists()){let h=null;e.payload.forEach(g=>{const v={payload:g,type:"value",prevKey:h,key:g.key};return h=g.key,n=[...n,v],!1})}return n;case"child_added":if(a>-1){const h=n[a-1];(h&&h.key||null)!==r&&(n=n.filter(g=>g.payload.key!==t.key)).splice(c,0,e)}else{if(null==r)return[e,...n];(n=n.slice()).splice(c,0,e)}return n;case"child_removed":return n.filter(h=>h.payload.key!==t.key);case"child_changed":return n.map(h=>h.payload.key===i?e:h);case"child_moved":if(a>-1){const h=n.splice(a,1)[0];return(n=n.slice()).splice(c,0,h),n}return n;default:return n}}function wL(n){return(gL(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function EL(n,e,t){return function K4(n,e,t){return iE(n,"value","once",t).pipe(Mn(r=>{const i=[ut(r)];return e.forEach(a=>i.push(iE(n,a,"on",t))),(0,VR.T)(...i).pipe(Ta(Y4,[]))}),fv())}(n,e=wL(e),t)}function IL(n,e,t){const r=(e=wL(e)).map(i=>iE(n,i,"on",t));return(0,VR.T)(...r)}function CL(n,e){return function(r,i){return yL(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function ez(n){return function(t){return t?yL(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function TL(n,e){return function(){return iE(n,"value","on",e)}}!function G4(n){n.INTERNAL.registerComponent(new uo.wA("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new rE(i,r)},"PUBLIC").setServiceProps({Reference:ta,Query:ss,Database:rE,DataSnapshot:Kf,enableLogging:A4,INTERNAL:H4,ServerValue:z4}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","0.3.4")}(Fm.Z);const rz=new _.OlP("angularfire2.realtimeDatabaseURL"),iz=new _.OlP("angularfire2.database.use-emulator");let sz=(()=>{class n{constructor(t,r,i,a,c,h,g,v,T,S,M,$,Y,fe,ge){this.schedulers=h;const et=g,it=(0,si.on)(t,c,r);v&&gx(it,c,T,M,$,Y,S,fe),this.database=(0,si.cc)(`${it.name}.database.${i}`,"AngularFireDatabase",it.name,()=>{const Ze=c.runOutsideAngular(()=>it.database(i||void 0));return et&&Ze.useEmulator(...et),Ze},[et])}list(t,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>_L(this.database,t));let a=i;return r&&(a=r(i)),function tz(n,e){const t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:CL(r,"update"),set:CL(r,"set"),push:i=>r.push(i),remove:ez(r),snapshotChanges:i=>EL(n,i,t).pipe(vn.iC),stateChanges:i=>IL(n,i,t).pipe(vn.iC),auditTrail:i=>function Q4(n,e,t){return function J4(n,e,t){return function X4(n,e){return iE(n,"value","on",e).pipe((0,yt.U)(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}(n,t).pipe(function YB(...n){const e=(0,Zi.jO)(n);return(0,Sr.e)((t,r)=>{const i=n.length,a=new Array(i);let c=n.map(()=>!1),h=!1;for(let g=0;g<i;g++)(0,Eu.Xf)(n[g]).subscribe((0,mr.x)(r,v=>{a[g]=v,!h&&!c[g]&&(c[g]=!0,(h=c.every(Vo.y))&&(c=null))},ZB.Z));t.subscribe((0,mr.x)(r,g=>{if(h){const v=[g,...a];r.next(e?e(...v):v)}}))})}(e),(0,yt.U)(([i,a])=>{const c=i.lastKeyToLoad,h=a.map(g=>g.key);return{actions:a,lastKeyToLoad:c,loadedKeys:h}}),function QB(n){return(0,Sr.e)((e,t)=>{let r=!1,i=0;e.subscribe((0,mr.x)(t,a=>(r||(r=!n(a,i++)))&&t.next(a)))})}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),(0,yt.U)(i=>i.actions))}(n,IL(n,e).pipe(Ta((i,a)=>[...i,a],[])),t)}(n,i,t).pipe(vn.iC),valueChanges:(i,a)=>EL(n,i,t).pipe((0,yt.U)(h=>h.map(g=>a&&a.idField?Object.assign(Object.assign({},g.payload.val()),{[a.idField]:g.key}):g.payload.val())),vn.iC)}}(a,this)}object(t){return function nz(n,e){return{query:n,snapshotChanges:()=>TL(n,e.schedulers.outsideAngular)().pipe(vn.iC),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>TL(n,e.schedulers.outsideAngular)().pipe(vn.iC,(0,yt.U)(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>_L(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(si.Dh),_.LFG(si.xv,8),_.LFG(rz,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(vn.HU),_.LFG(iz,8),_.LFG(Dw,8),_.LFG(cx,8),_.LFG(lx,8),_.LFG(dx,8),_.LFG(hx,8),_.LFG(fx,8),_.LFG(px,8),_.LFG(Tw,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),oz=(()=>{class n{constructor(){VT.Z.registerVersion("angularfire",vn.q4.full,"rtdb-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[sz]}),n})();const az={apiKey:"AIzaSyAESaJ2fczJ9ax8mY27QBTbCIF_2bZR-s4",authDomain:"userinterface-6f395.firebaseapp.com",projectId:"userinterface-6f395",storageBucket:"userinterface-6f395.appspot.com",messagingSenderId:"997611109334",appId:"1:997611109334:web:78fba8c45b9da6923c0277",measurementId:"G-7VML4X8QYW"};let uz=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n,bootstrap:[iV]}),n.\u0275inj=_.cJS({providers:[Jg],imports:[wa,rV,si.hO.initializeApp(az),jU,ZU,KB,oz]}),n})();ap().bootstrapModule(uz).catch(n=>console.error(n))},9751:(wt,Pe,B)=>{B.d(Pe,{y:()=>ve});var _=B(930),z=B(727),L=B(8822),re=B(9635),ue=B(2416),ce=B(576),Ce=B(2806);let ve=(()=>{class J{constructor(Re){Re&&(this._subscribe=Re)}lift(Re){const qe=new J;return qe.source=this,qe.operator=Re,qe}subscribe(Re,qe,ot){const we=function W(J){return J&&J instanceof _.Lv||function q(J){return J&&(0,ce.m)(J.next)&&(0,ce.m)(J.error)&&(0,ce.m)(J.complete)}(J)&&(0,z.Nn)(J)}(Re)?Re:new _.Hp(Re,qe,ot);return(0,Ce.x)(()=>{const{operator:Me,source:Le}=this;we.add(Me?Me.call(we,Le):Le?this._subscribe(we):this._trySubscribe(we))}),we}_trySubscribe(Re){try{return this._subscribe(Re)}catch(qe){Re.error(qe)}}forEach(Re,qe){return new(qe=Ie(qe))((ot,we)=>{const Me=new _.Hp({next:Le=>{try{Re(Le)}catch(je){we(je),Me.unsubscribe()}},error:we,complete:ot});this.subscribe(Me)})}_subscribe(Re){var qe;return null===(qe=this.source)||void 0===qe?void 0:qe.subscribe(Re)}[L.L](){return this}pipe(...Re){return(0,re.U)(Re)(this)}toPromise(Re){return new(Re=Ie(Re))((qe,ot)=>{let we;this.subscribe(Me=>we=Me,Me=>ot(Me),()=>qe(we))})}}return J.create=$e=>new J($e),J})();function Ie(J){var $e;return null!==($e=J??ue.v.Promise)&&void 0!==$e?$e:Promise}},7579:(wt,Pe,B)=>{B.d(Pe,{x:()=>Ce});var _=B(9751),z=B(727);const re=(0,B(3888).d)(Ie=>function(){Ie(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ue=B(8737),ce=B(2806);let Ce=(()=>{class Ie extends _.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(W){const J=new ve(this,this);return J.operator=W,J}_throwIfClosed(){if(this.closed)throw new re}next(W){(0,ce.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const J of this.currentObservers)J.next(W)}})}error(W){(0,ce.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=W;const{observers:J}=this;for(;J.length;)J.shift().error(W)}})}complete(){(0,ce.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:W}=this;for(;W.length;)W.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var W;return(null===(W=this.observers)||void 0===W?void 0:W.length)>0}_trySubscribe(W){return this._throwIfClosed(),super._trySubscribe(W)}_subscribe(W){return this._throwIfClosed(),this._checkFinalizedStatuses(W),this._innerSubscribe(W)}_innerSubscribe(W){const{hasError:J,isStopped:$e,observers:Re}=this;return J||$e?z.Lc:(this.currentObservers=null,Re.push(W),new z.w0(()=>{this.currentObservers=null,(0,ue.P)(Re,W)}))}_checkFinalizedStatuses(W){const{hasError:J,thrownError:$e,isStopped:Re}=this;J?W.error($e):Re&&W.complete()}asObservable(){const W=new _.y;return W.source=this,W}}return Ie.create=(q,W)=>new ve(q,W),Ie})();class ve extends Ce{constructor(q,W){super(),this.destination=q,this.source=W}next(q){var W,J;null===(J=null===(W=this.destination)||void 0===W?void 0:W.next)||void 0===J||J.call(W,q)}error(q){var W,J;null===(J=null===(W=this.destination)||void 0===W?void 0:W.error)||void 0===J||J.call(W,q)}complete(){var q,W;null===(W=null===(q=this.destination)||void 0===q?void 0:q.complete)||void 0===W||W.call(q)}_subscribe(q){var W,J;return null!==(J=null===(W=this.source)||void 0===W?void 0:W.subscribe(q))&&void 0!==J?J:z.Lc}}},930:(wt,Pe,B)=>{B.d(Pe,{Hp:()=>ot,Lv:()=>J});var _=B(576),z=B(727),L=B(2416),re=B(7849),ue=B(5032);const ce=Ie("C",void 0,void 0);function Ie(Ae,Se,ke){return{kind:Ae,value:Se,error:ke}}var q=B(3410),W=B(2806);class J extends z.w0{constructor(Se){super(),this.isStopped=!1,Se?(this.destination=Se,(0,z.Nn)(Se)&&Se.add(this)):this.destination=je}static create(Se,ke,He){return new ot(Se,ke,He)}next(Se){this.isStopped?Le(function ve(Ae){return Ie("N",Ae,void 0)}(Se),this):this._next(Se)}error(Se){this.isStopped?Le(function Ce(Ae){return Ie("E",void 0,Ae)}(Se),this):(this.isStopped=!0,this._error(Se))}complete(){this.isStopped?Le(ce,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Se){this.destination.next(Se)}_error(Se){try{this.destination.error(Se)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const $e=Function.prototype.bind;function Re(Ae,Se){return $e.call(Ae,Se)}class qe{constructor(Se){this.partialObserver=Se}next(Se){const{partialObserver:ke}=this;if(ke.next)try{ke.next(Se)}catch(He){we(He)}}error(Se){const{partialObserver:ke}=this;if(ke.error)try{ke.error(Se)}catch(He){we(He)}else we(Se)}complete(){const{partialObserver:Se}=this;if(Se.complete)try{Se.complete()}catch(ke){we(ke)}}}class ot extends J{constructor(Se,ke,He){let Fe;if(super(),(0,_.m)(Se)||!Se)Fe={next:Se??void 0,error:ke??void 0,complete:He??void 0};else{let ae;this&&L.v.useDeprecatedNextContext?(ae=Object.create(Se),ae.unsubscribe=()=>this.unsubscribe(),Fe={next:Se.next&&Re(Se.next,ae),error:Se.error&&Re(Se.error,ae),complete:Se.complete&&Re(Se.complete,ae)}):Fe=Se}this.destination=new qe(Fe)}}function we(Ae){L.v.useDeprecatedSynchronousErrorHandling?(0,W.O)(Ae):(0,re.h)(Ae)}function Le(Ae,Se){const{onStoppedNotification:ke}=L.v;ke&&q.z.setTimeout(()=>ke(Ae,Se))}const je={closed:!0,next:ue.Z,error:function Me(Ae){throw Ae},complete:ue.Z}},727:(wt,Pe,B)=>{B.d(Pe,{Lc:()=>ce,w0:()=>ue,Nn:()=>Ce});var _=B(576);const L=(0,B(3888).d)(Ie=>function(W){Ie(this),this.message=W?`${W.length} errors occurred during unsubscription:\n${W.map((J,$e)=>`${$e+1}) ${J.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=W});var re=B(8737);class ue{constructor(q){this.initialTeardown=q,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let q;if(!this.closed){this.closed=!0;const{_parentage:W}=this;if(W)if(this._parentage=null,Array.isArray(W))for(const Re of W)Re.remove(this);else W.remove(this);const{initialTeardown:J}=this;if((0,_.m)(J))try{J()}catch(Re){q=Re instanceof L?Re.errors:[Re]}const{_finalizers:$e}=this;if($e){this._finalizers=null;for(const Re of $e)try{ve(Re)}catch(qe){q=q??[],qe instanceof L?q=[...q,...qe.errors]:q.push(qe)}}if(q)throw new L(q)}}add(q){var W;if(q&&q!==this)if(this.closed)ve(q);else{if(q instanceof ue){if(q.closed||q._hasParent(this))return;q._addParent(this)}(this._finalizers=null!==(W=this._finalizers)&&void 0!==W?W:[]).push(q)}}_hasParent(q){const{_parentage:W}=this;return W===q||Array.isArray(W)&&W.includes(q)}_addParent(q){const{_parentage:W}=this;this._parentage=Array.isArray(W)?(W.push(q),W):W?[W,q]:q}_removeParent(q){const{_parentage:W}=this;W===q?this._parentage=null:Array.isArray(W)&&(0,re.P)(W,q)}remove(q){const{_finalizers:W}=this;W&&(0,re.P)(W,q),q instanceof ue&&q._removeParent(this)}}ue.EMPTY=(()=>{const Ie=new ue;return Ie.closed=!0,Ie})();const ce=ue.EMPTY;function Ce(Ie){return Ie instanceof ue||Ie&&"closed"in Ie&&(0,_.m)(Ie.remove)&&(0,_.m)(Ie.add)&&(0,_.m)(Ie.unsubscribe)}function ve(Ie){(0,_.m)(Ie)?Ie():Ie.unsubscribe()}},2416:(wt,Pe,B)=>{B.d(Pe,{v:()=>_});const _={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(wt,Pe,B)=>{B.d(Pe,{E:()=>z});const z=new(B(9751).y)(ue=>ue.complete())},8996:(wt,Pe,B)=>{B.d(Pe,{D:()=>Se});var _=B(8421),z=B(5363),L=B(9468),ce=B(9751),ve=B(2202),Ie=B(576),q=B(9672);function J(ke,He){if(!ke)throw new Error("Iterable cannot be null");return new ce.y(Fe=>{(0,q.f)(Fe,He,()=>{const ae=ke[Symbol.asyncIterator]();(0,q.f)(Fe,He,()=>{ae.next().then(tt=>{tt.done?Fe.complete():Fe.next(tt.value)})},0,!0)})})}var $e=B(3670),Re=B(8239),qe=B(1144),ot=B(6495),we=B(2206),Me=B(4532),Le=B(3260);function Se(ke,He){return He?function Ae(ke,He){if(null!=ke){if((0,$e.c)(ke))return function re(ke,He){return(0,_.Xf)(ke).pipe((0,L.R)(He),(0,z.Q)(He))}(ke,He);if((0,qe.z)(ke))return function Ce(ke,He){return new ce.y(Fe=>{let ae=0;return He.schedule(function(){ae===ke.length?Fe.complete():(Fe.next(ke[ae++]),Fe.closed||this.schedule())})})}(ke,He);if((0,Re.t)(ke))return function ue(ke,He){return(0,_.Xf)(ke).pipe((0,L.R)(He),(0,z.Q)(He))}(ke,He);if((0,we.D)(ke))return J(ke,He);if((0,ot.T)(ke))return function W(ke,He){return new ce.y(Fe=>{let ae;return(0,q.f)(Fe,He,()=>{ae=ke[ve.h](),(0,q.f)(Fe,He,()=>{let tt,St;try{({value:tt,done:St}=ae.next())}catch(st){return void Fe.error(st)}St?Fe.complete():Fe.next(tt)},0,!0)}),()=>(0,Ie.m)(ae?.return)&&ae.return()})}(ke,He);if((0,Le.L)(ke))return function je(ke,He){return J((0,Le.Q)(ke),He)}(ke,He)}throw(0,Me.z)(ke)}(ke,He):(0,_.Xf)(ke)}},8421:(wt,Pe,B)=>{B.d(Pe,{Xf:()=>$e});var _=B(7582),z=B(1144),L=B(8239),re=B(9751),ue=B(3670),ce=B(2206),Ce=B(4532),ve=B(6495),Ie=B(3260),q=B(576),W=B(7849),J=B(8822);function $e(Ae){if(Ae instanceof re.y)return Ae;if(null!=Ae){if((0,ue.c)(Ae))return function Re(Ae){return new re.y(Se=>{const ke=Ae[J.L]();if((0,q.m)(ke.subscribe))return ke.subscribe(Se);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Ae);if((0,z.z)(Ae))return function qe(Ae){return new re.y(Se=>{for(let ke=0;ke<Ae.length&&!Se.closed;ke++)Se.next(Ae[ke]);Se.complete()})}(Ae);if((0,L.t)(Ae))return function ot(Ae){return new re.y(Se=>{Ae.then(ke=>{Se.closed||(Se.next(ke),Se.complete())},ke=>Se.error(ke)).then(null,W.h)})}(Ae);if((0,ce.D)(Ae))return Me(Ae);if((0,ve.T)(Ae))return function we(Ae){return new re.y(Se=>{for(const ke of Ae)if(Se.next(ke),Se.closed)return;Se.complete()})}(Ae);if((0,Ie.L)(Ae))return function Le(Ae){return Me((0,Ie.Q)(Ae))}(Ae)}throw(0,Ce.z)(Ae)}function Me(Ae){return new re.y(Se=>{(function je(Ae,Se){var ke,He,Fe,ae;return(0,_.mG)(this,void 0,void 0,function*(){try{for(ke=(0,_.KL)(Ae);!(He=yield ke.next()).done;)if(Se.next(He.value),Se.closed)return}catch(tt){Fe={error:tt}}finally{try{He&&!He.done&&(ae=ke.return)&&(yield ae.call(ke))}finally{if(Fe)throw Fe.error}}Se.complete()})})(Ae,Se).catch(ke=>Se.error(ke))})}},6451:(wt,Pe,B)=>{B.d(Pe,{T:()=>ce});var _=B(8189),z=B(8421),L=B(515),re=B(7669),ue=B(8996);function ce(...Ce){const ve=(0,re.yG)(Ce),Ie=(0,re._6)(Ce,1/0),q=Ce;return q.length?1===q.length?(0,z.Xf)(q[0]):(0,_.J)(Ie)((0,ue.D)(q,ve)):L.E}},5403:(wt,Pe,B)=>{B.d(Pe,{x:()=>z});var _=B(930);function z(re,ue,ce,Ce,ve){return new L(re,ue,ce,Ce,ve)}class L extends _.Lv{constructor(ue,ce,Ce,ve,Ie,q){super(ue),this.onFinalize=Ie,this.shouldUnsubscribe=q,this._next=ce?function(W){try{ce(W)}catch(J){ue.error(J)}}:super._next,this._error=ve?function(W){try{ve(W)}catch(J){ue.error(J)}finally{this.unsubscribe()}}:super._error,this._complete=Ce?function(){try{Ce()}catch(W){ue.error(W)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var ue;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:ce}=this;super.unsubscribe(),!ce&&(null===(ue=this.onFinalize)||void 0===ue||ue.call(this))}}}},4004:(wt,Pe,B)=>{B.d(Pe,{U:()=>L});var _=B(4482),z=B(5403);function L(re,ue){return(0,_.e)((ce,Ce)=>{let ve=0;ce.subscribe((0,z.x)(Ce,Ie=>{Ce.next(re.call(ue,Ie,ve++))}))})}},8189:(wt,Pe,B)=>{B.d(Pe,{J:()=>L});var _=B(5577),z=B(4671);function L(re=1/0){return(0,_.z)(z.y,re)}},5577:(wt,Pe,B)=>{B.d(Pe,{z:()=>ve});var _=B(4004),z=B(8421),L=B(4482),re=B(9672),ue=B(5403),Ce=B(576);function ve(Ie,q,W=1/0){return(0,Ce.m)(q)?ve((J,$e)=>(0,_.U)((Re,qe)=>q(J,Re,$e,qe))((0,z.Xf)(Ie(J,$e))),W):("number"==typeof q&&(W=q),(0,L.e)((J,$e)=>function ce(Ie,q,W,J,$e,Re,qe,ot){const we=[];let Me=0,Le=0,je=!1;const Ae=()=>{je&&!we.length&&!Me&&q.complete()},Se=He=>Me<J?ke(He):we.push(He),ke=He=>{Re&&q.next(He),Me++;let Fe=!1;(0,z.Xf)(W(He,Le++)).subscribe((0,ue.x)(q,ae=>{$e?.(ae),Re?Se(ae):q.next(ae)},()=>{Fe=!0},void 0,()=>{if(Fe)try{for(Me--;we.length&&Me<J;){const ae=we.shift();qe?(0,re.f)(q,qe,()=>ke(ae)):ke(ae)}Ae()}catch(ae){q.error(ae)}}))};return Ie.subscribe((0,ue.x)(q,Se,()=>{je=!0,Ae()})),()=>{ot?.()}}(J,$e,Ie,W)))}},5363:(wt,Pe,B)=>{B.d(Pe,{Q:()=>re});var _=B(9672),z=B(4482),L=B(5403);function re(ue,ce=0){return(0,z.e)((Ce,ve)=>{Ce.subscribe((0,L.x)(ve,Ie=>(0,_.f)(ve,ue,()=>ve.next(Ie),ce),()=>(0,_.f)(ve,ue,()=>ve.complete(),ce),Ie=>(0,_.f)(ve,ue,()=>ve.error(Ie),ce)))})}},3099:(wt,Pe,B)=>{B.d(Pe,{B:()=>ue});var _=B(8421),z=B(7579),L=B(930),re=B(4482);function ue(Ce={}){const{connector:ve=(()=>new z.x),resetOnError:Ie=!0,resetOnComplete:q=!0,resetOnRefCountZero:W=!0}=Ce;return J=>{let $e,Re,qe,ot=0,we=!1,Me=!1;const Le=()=>{Re?.unsubscribe(),Re=void 0},je=()=>{Le(),$e=qe=void 0,we=Me=!1},Ae=()=>{const Se=$e;je(),Se?.unsubscribe()};return(0,re.e)((Se,ke)=>{ot++,!Me&&!we&&Le();const He=qe=qe??ve();ke.add(()=>{ot--,0===ot&&!Me&&!we&&(Re=ce(Ae,W))}),He.subscribe(ke),!$e&&ot>0&&($e=new L.Hp({next:Fe=>He.next(Fe),error:Fe=>{Me=!0,Le(),Re=ce(je,Ie,Fe),He.error(Fe)},complete:()=>{we=!0,Le(),Re=ce(je,q),He.complete()}}),(0,_.Xf)(Se).subscribe($e))})(J)}}function ce(Ce,ve,...Ie){if(!0===ve)return void Ce();if(!1===ve)return;const q=new L.Hp({next:()=>{q.unsubscribe(),Ce()}});return(0,_.Xf)(ve(...Ie)).subscribe(q)}},9468:(wt,Pe,B)=>{B.d(Pe,{R:()=>z});var _=B(4482);function z(L,re=0){return(0,_.e)((ue,ce)=>{ce.add(L.schedule(()=>ue.subscribe(ce),re))})}},8505:(wt,Pe,B)=>{B.d(Pe,{b:()=>ue});var _=B(576),z=B(4482),L=B(5403),re=B(4671);function ue(ce,Ce,ve){const Ie=(0,_.m)(ce)||Ce||ve?{next:ce,error:Ce,complete:ve}:ce;return Ie?(0,z.e)((q,W)=>{var J;null===(J=Ie.subscribe)||void 0===J||J.call(Ie);let $e=!0;q.subscribe((0,L.x)(W,Re=>{var qe;null===(qe=Ie.next)||void 0===qe||qe.call(Ie,Re),W.next(Re)},()=>{var Re;$e=!1,null===(Re=Ie.complete)||void 0===Re||Re.call(Ie),W.complete()},Re=>{var qe;$e=!1,null===(qe=Ie.error)||void 0===qe||qe.call(Ie,Re),W.error(Re)},()=>{var Re,qe;$e&&(null===(Re=Ie.unsubscribe)||void 0===Re||Re.call(Ie)),null===(qe=Ie.finalize)||void 0===qe||qe.call(Ie)}))}):re.y}},4408:(wt,Pe,B)=>{B.d(Pe,{o:()=>ue});var _=B(727);class z extends _.w0{constructor(Ce,ve){super()}schedule(Ce,ve=0){return this}}const L={setInterval(ce,Ce,...ve){const{delegate:Ie}=L;return Ie?.setInterval?Ie.setInterval(ce,Ce,...ve):setInterval(ce,Ce,...ve)},clearInterval(ce){const{delegate:Ce}=L;return(Ce?.clearInterval||clearInterval)(ce)},delegate:void 0};var re=B(8737);class ue extends z{constructor(Ce,ve){super(Ce,ve),this.scheduler=Ce,this.work=ve,this.pending=!1}schedule(Ce,ve=0){var Ie;if(this.closed)return this;this.state=Ce;const q=this.id,W=this.scheduler;return null!=q&&(this.id=this.recycleAsyncId(W,q,ve)),this.pending=!0,this.delay=ve,this.id=null!==(Ie=this.id)&&void 0!==Ie?Ie:this.requestAsyncId(W,this.id,ve),this}requestAsyncId(Ce,ve,Ie=0){return L.setInterval(Ce.flush.bind(Ce,this),Ie)}recycleAsyncId(Ce,ve,Ie=0){if(null!=Ie&&this.delay===Ie&&!1===this.pending)return ve;null!=ve&&L.clearInterval(ve)}execute(Ce,ve){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const Ie=this._execute(Ce,ve);if(Ie)return Ie;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(Ce,ve){let q,Ie=!1;try{this.work(Ce)}catch(W){Ie=!0,q=W||new Error("Scheduled action threw falsy error")}if(Ie)return this.unsubscribe(),q}unsubscribe(){if(!this.closed){const{id:Ce,scheduler:ve}=this,{actions:Ie}=ve;this.work=this.state=this.scheduler=null,this.pending=!1,(0,re.P)(Ie,this),null!=Ce&&(this.id=this.recycleAsyncId(ve,Ce,null)),this.delay=null,super.unsubscribe()}}}},7565:(wt,Pe,B)=>{B.d(Pe,{v:()=>L});var _=B(6063);class z{constructor(ue,ce=z.now){this.schedulerActionCtor=ue,this.now=ce}schedule(ue,ce=0,Ce){return new this.schedulerActionCtor(this,ue).schedule(Ce,ce)}}z.now=_.l.now;class L extends z{constructor(ue,ce=z.now){super(ue,ce),this.actions=[],this._active=!1}flush(ue){const{actions:ce}=this;if(this._active)return void ce.push(ue);let Ce;this._active=!0;do{if(Ce=ue.execute(ue.state,ue.delay))break}while(ue=ce.shift());if(this._active=!1,Ce){for(;ue=ce.shift();)ue.unsubscribe();throw Ce}}}},4986:(wt,Pe,B)=>{B.d(Pe,{z:()=>L});var _=B(4408);const L=new(B(7565).v)(_.o)},6063:(wt,Pe,B)=>{B.d(Pe,{l:()=>_});const _={now:()=>(_.delegate||Date).now(),delegate:void 0}},3410:(wt,Pe,B)=>{B.d(Pe,{z:()=>_});const _={setTimeout(z,L,...re){const{delegate:ue}=_;return ue?.setTimeout?ue.setTimeout(z,L,...re):setTimeout(z,L,...re)},clearTimeout(z){const{delegate:L}=_;return(L?.clearTimeout||clearTimeout)(z)},delegate:void 0}},2202:(wt,Pe,B)=>{B.d(Pe,{h:()=>z});const z=function _(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(wt,Pe,B)=>{B.d(Pe,{L:()=>_});const _="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(wt,Pe,B)=>{B.d(Pe,{_6:()=>ce,jO:()=>re,yG:()=>ue});var _=B(576);function L(Ce){return Ce[Ce.length-1]}function re(Ce){return(0,_.m)(L(Ce))?Ce.pop():void 0}function ue(Ce){return function z(Ce){return Ce&&(0,_.m)(Ce.schedule)}(L(Ce))?Ce.pop():void 0}function ce(Ce,ve){return"number"==typeof L(Ce)?Ce.pop():ve}},8737:(wt,Pe,B)=>{function _(z,L){if(z){const re=z.indexOf(L);0<=re&&z.splice(re,1)}}B.d(Pe,{P:()=>_})},3888:(wt,Pe,B)=>{function _(z){const re=z(ue=>{Error.call(ue),ue.stack=(new Error).stack});return re.prototype=Object.create(Error.prototype),re.prototype.constructor=re,re}B.d(Pe,{d:()=>_})},2806:(wt,Pe,B)=>{B.d(Pe,{O:()=>re,x:()=>L});var _=B(2416);let z=null;function L(ue){if(_.v.useDeprecatedSynchronousErrorHandling){const ce=!z;if(ce&&(z={errorThrown:!1,error:null}),ue(),ce){const{errorThrown:Ce,error:ve}=z;if(z=null,Ce)throw ve}}else ue()}function re(ue){_.v.useDeprecatedSynchronousErrorHandling&&z&&(z.errorThrown=!0,z.error=ue)}},9672:(wt,Pe,B)=>{function _(z,L,re,ue=0,ce=!1){const Ce=L.schedule(function(){re(),ce?z.add(this.schedule(null,ue)):this.unsubscribe()},ue);if(z.add(Ce),!ce)return Ce}B.d(Pe,{f:()=>_})},4671:(wt,Pe,B)=>{function _(z){return z}B.d(Pe,{y:()=>_})},1144:(wt,Pe,B)=>{B.d(Pe,{z:()=>_});const _=z=>z&&"number"==typeof z.length&&"function"!=typeof z},2206:(wt,Pe,B)=>{B.d(Pe,{D:()=>z});var _=B(576);function z(L){return Symbol.asyncIterator&&(0,_.m)(L?.[Symbol.asyncIterator])}},576:(wt,Pe,B)=>{function _(z){return"function"==typeof z}B.d(Pe,{m:()=>_})},3670:(wt,Pe,B)=>{B.d(Pe,{c:()=>L});var _=B(8822),z=B(576);function L(re){return(0,z.m)(re[_.L])}},6495:(wt,Pe,B)=>{B.d(Pe,{T:()=>L});var _=B(2202),z=B(576);function L(re){return(0,z.m)(re?.[_.h])}},8239:(wt,Pe,B)=>{B.d(Pe,{t:()=>z});var _=B(576);function z(L){return(0,_.m)(L?.then)}},3260:(wt,Pe,B)=>{B.d(Pe,{L:()=>re,Q:()=>L});var _=B(7582),z=B(576);function L(ue){return(0,_.FC)(this,arguments,function*(){const Ce=ue.getReader();try{for(;;){const{value:ve,done:Ie}=yield(0,_.qq)(Ce.read());if(Ie)return yield(0,_.qq)(void 0);yield yield(0,_.qq)(ve)}}finally{Ce.releaseLock()}})}function re(ue){return(0,z.m)(ue?.getReader)}},4482:(wt,Pe,B)=>{B.d(Pe,{A:()=>z,e:()=>L});var _=B(576);function z(re){return(0,_.m)(re?.lift)}function L(re){return ue=>{if(z(ue))return ue.lift(function(ce){try{return re(ce,this)}catch(Ce){this.error(Ce)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(wt,Pe,B)=>{function _(){}B.d(Pe,{Z:()=>_})},9635:(wt,Pe,B)=>{B.d(Pe,{U:()=>L,z:()=>z});var _=B(4671);function z(...re){return L(re)}function L(re){return 0===re.length?_.y:1===re.length?re[0]:function(ce){return re.reduce((Ce,ve)=>ve(Ce),ce)}}},7849:(wt,Pe,B)=>{B.d(Pe,{h:()=>L});var _=B(2416),z=B(3410);function L(re){z.z.setTimeout(()=>{const{onUnhandledError:ue}=_.v;if(!ue)throw re;ue(re)})}},4532:(wt,Pe,B)=>{function _(z){return new TypeError(`You provided ${null!==z&&"object"==typeof z?"an invalid object":`'${z}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}B.d(Pe,{z:()=>_})},4650:(wt,Pe,B)=>{B.d(Pe,{$8M:()=>gu,$WT:()=>Gr,$Z:()=>KE,AFp:()=>B0,AaK:()=>ve,CHM:()=>hl,CRH:()=>Gc,CZH:()=>L_,CqO:()=>Zh,D6c:()=>rT,EJc:()=>UC,EpF:()=>jv,F4k:()=>vI,FYo:()=>ev,FiY:()=>Uo,GfV:()=>AE,JOm:()=>At,KtG:()=>ou,LFG:()=>jt,LSH:()=>$y,Lbi:()=>Fg,Lck:()=>Ni,MAs:()=>Gm,MMx:()=>w_,NdJ:()=>Km,OlP:()=>an,Oqu:()=>nd,P3R:()=>vE,PXZ:()=>qC,Q6J:()=>Xp,QGY:()=>qm,Qsj:()=>eb,R0b:()=>Gi,RDi:()=>ND,Rgc:()=>gf,SBq:()=>Ph,Sil:()=>jS,Suo:()=>R_,TTD:()=>Od,TgZ:()=>Nc,X6Q:()=>ZS,XFs:()=>gt,Xpm:()=>$t,Xts:()=>zy,Y36:()=>Lh,YKP:()=>Eg,YNc:()=>Fv,Yjl:()=>en,Yz7:()=>ct,Z0I:()=>Rn,ZZ4:()=>Ga,_UZ:()=>Uv,_Vd:()=>xh,_c5:()=>nT,_uU:()=>Qv,aQg:()=>W_,c2e:()=>LC,cJS:()=>Tt,cg1:()=>u0,dDg:()=>zC,dqk:()=>cn,eFA:()=>Zc,eJc:()=>P_,eoX:()=>GC,f3M:()=>Fn,g9A:()=>Cf,h0i:()=>Dn,hGG:()=>sA,iGM:()=>S_,ifc:()=>F,ip1:()=>V0,jDz:()=>Yr,kL8:()=>jI,lG2:()=>xt,lqb:()=>Gl,lri:()=>W0,n5z:()=>Tl,oAB:()=>ie,q4F:()=>RE,qLn:()=>Mp,qZA:()=>eg,rWj:()=>B_,s9C:()=>Mu,sBO:()=>Hg,s_b:()=>D_,soG:()=>F_,tb:()=>K0,tp0:()=>yt,uIk:()=>zm,vHH:()=>we,vpe:()=>mo,wAp:()=>Nt,xp6:()=>BE,z2F:()=>$g,zSh:()=>Ac,zs3:()=>Mh});var _=B(7579),z=B(727),L=B(9751),re=B(6451),ue=B(3099);function ce(s){for(let o in s)if(s[o]===ce)return o;throw Error("Could not find renamed property on target object.")}function ve(s){if("string"==typeof s)return s;if(Array.isArray(s))return"["+s.map(ve).join(", ")+"]";if(null==s)return""+s;if(s.overriddenName)return`${s.overriddenName}`;if(s.name)return`${s.name}`;const o=s.toString();if(null==o)return""+o;const u=o.indexOf("\n");return-1===u?o:o.substring(0,u)}function Ie(s,o){return null==s||""===s?null===o?"":o:null==o||""===o?s:s+" "+o}const q=ce({__forward_ref__:ce});function W(s){return s.__forward_ref__=W,s.toString=function(){return ve(this())},s}function J(s){return $e(s)?s():s}function $e(s){return"function"==typeof s&&s.hasOwnProperty(q)&&s.__forward_ref__===W}function Re(s){return s&&!!s.\u0275providers}const ot="https://g.co/ng/security#xss";class we extends Error{constructor(o,u){super(Me(o,u)),this.code=o}}function Me(s,o){return`NG0${Math.abs(s)}${o?": "+o.trim():""}`}function Le(s){return"string"==typeof s?s:null==s?"":String(s)}function He(s,o){throw new we(-201,!1)}function ye(s,o){null==s&&function te(s,o,u,l){throw new Error(`ASSERTION ERROR: ${s}`+(null==l?"":` [Expected=> ${u} ${l} ${o} <=Actual]`))}(o,s,null,"!=")}function ct(s){return{token:s.token,providedIn:s.providedIn||null,factory:s.factory,value:void 0}}function Tt(s){return{providers:s.providers||[],imports:s.imports||[]}}function nn(s){return fn(s,On)||fn(s,Ti)}function Rn(s){return null!==nn(s)}function fn(s,o){return s.hasOwnProperty(o)?s[o]:null}function xn(s){return s&&(s.hasOwnProperty(ir)||s.hasOwnProperty(Bn))?s[ir]:null}const On=ce({\u0275prov:ce}),ir=ce({\u0275inj:ce}),Ti=ce({ngInjectableDef:ce}),Bn=ce({ngInjectorDef:ce});var gt=(()=>((gt=gt||{})[gt.Default=0]="Default",gt[gt.Host=1]="Host",gt[gt.Self=2]="Self",gt[gt.SkipSelf=4]="SkipSelf",gt[gt.Optional=8]="Optional",gt))();let jn;function Wn(s){const o=jn;return jn=s,o}function Hr(s,o,u){const l=nn(s);return l&&"root"==l.providedIn?void 0===l.value?l.value=l.factory():l.value:u&gt.Optional?null:void 0!==o?o:void He(ve(s))}const cn=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),qn={},kr="__NG_DI_FLAG__",Ln="ngTempTokenPath",Jr="ngTokenPath",$n=/\n/gm,dr="\u0275",Yt="__source";let Di;function Jt(s){const o=Di;return Di=s,o}function di(s,o=gt.Default){if(void 0===Di)throw new we(-203,!1);return null===Di?Hr(s,void 0,o):Di.get(s,o&gt.Optional?null:void 0,o)}function jt(s,o=gt.Default){return(function as(){return jn}()||di)(J(s),o)}function Fn(s,o=gt.Default){return jt(s,Or(o))}function Or(s){return typeof s>"u"||"number"==typeof s?s:0|(s.optional&&8)|(s.host&&1)|(s.self&&2)|(s.skipSelf&&4)}function Zn(s){const o=[];for(let u=0;u<s.length;u++){const l=J(s[u]);if(Array.isArray(l)){if(0===l.length)throw new we(900,!1);let d,p=gt.Default;for(let y=0;y<l.length;y++){const C=l[y],b=zr(C);"number"==typeof b?-1===b?d=C.token:p|=b:d=C}o.push(jt(d,p))}else o.push(jt(l))}return o}function ei(s,o){return s[kr]=o,s.prototype[kr]=o,s}function zr(s){return s[kr]}function H(s){return{toString:s}.toString()}var O=(()=>((O=O||{})[O.OnPush=0]="OnPush",O[O.Default=1]="Default",O))(),F=(()=>{return(s=F||(F={}))[s.Emulated=0]="Emulated",s[s.None=2]="None",s[s.ShadowDom=3]="ShadowDom",F;var s})();const N={},Z=[],De=ce({\u0275cmp:ce}),nt=ce({\u0275dir:ce}),Rt=ce({\u0275pipe:ce}),Dt=ce({\u0275mod:ce}),Qt=ce({\u0275fac:ce}),Pt=ce({__NG_ELEMENT_ID__:ce});let bn=0;function $t(s){return H(()=>{const o=Zu(s),u={...o,decls:s.decls,vars:s.vars,template:s.template,consts:s.consts||null,ngContentSelectors:s.ngContentSelectors,onPush:s.changeDetection===O.OnPush,directiveDefs:null,pipeDefs:null,dependencies:o.standalone&&s.dependencies||null,getStandaloneInjector:null,data:s.data||{},encapsulation:s.encapsulation||F.Emulated,id:"c"+bn++,styles:s.styles||Z,_:null,schemas:s.schemas||null,tView:null};Zf(u);const l=s.dependencies;return u.directiveDefs=Io(l,!1),u.pipeDefs=Io(l,!0),u})}function Cs(s){return vt(s)||mn(s)}function me(s){return null!==s}function ie(s){return H(()=>({type:s.type,bootstrap:s.bootstrap||Z,declarations:s.declarations||Z,imports:s.imports||Z,exports:s.exports||Z,transitiveCompileScopes:null,schemas:s.schemas||null,id:s.id||null}))}function _t(s,o){if(null==s)return N;const u={};for(const l in s)if(s.hasOwnProperty(l)){let d=s[l],p=d;Array.isArray(d)&&(p=d[1],d=d[0]),u[d]=l,o&&(o[d]=p)}return u}function xt(s){return H(()=>{const o=Zu(s);return Zf(o),o})}function en(s){return{type:s.type,name:s.name,factory:null,pure:!1!==s.pure,standalone:!0===s.standalone,onDestroy:s.type.prototype.ngOnDestroy||null}}function vt(s){return s[De]||null}function mn(s){return s[nt]||null}function sn(s){return s[Rt]||null}function Gr(s){const o=vt(s)||mn(s)||sn(s);return null!==o&&o.standalone}function Cr(s,o){const u=s[Dt]||null;if(!u&&!0===o)throw new Error(`Type ${ve(s)} does not have '\u0275mod' property.`);return u}function Zu(s){const o={};return{type:s.type,providersResolver:null,factory:null,hostBindings:s.hostBindings||null,hostVars:s.hostVars||0,hostAttrs:s.hostAttrs||null,contentQueries:s.contentQueries||null,declaredInputs:o,exportAs:s.exportAs||null,standalone:!0===s.standalone,selectors:s.selectors||Z,viewQuery:s.viewQuery||null,features:s.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:_t(s.inputs,o),outputs:_t(s.outputs)}}function Zf(s){s.features?.forEach(o=>o(s))}function Io(s,o){if(!s)return null;const u=o?sn:Cs;return()=>("function"==typeof s?s():s).map(l=>u(l)).filter(me)}const Tr=0,Je=1,Xt=2,Pn=3,_n=4,js=5,Dr=6,Qa=7,Hn=8,Xa=9,$s=10,zt=11,Yu=12,Mi=13,Ja=14,Hs=15,hr=16,Co=17,To=18,ki=19,ra=20,Wr=21,Cn=22,al=1,eu=2,ia=7,zs=8,Do=9,Lr=10;function ni(s){return Array.isArray(s)&&"object"==typeof s[al]}function Ki(s){return Array.isArray(s)&&!0===s[al]}function bo(s){return 0!=(4&s.flags)}function Qu(s){return s.componentOffset>-1}function tu(s){return 1==(1&s.flags)}function hi(s){return!!s.template}function Gs(s){return 0!=(256&s[Xt])}function Ts(s,o){return s.hasOwnProperty(Qt)?s[Qt]:null}class kd{constructor(o,u,l){this.previousValue=o,this.currentValue=u,this.firstChange=l}isFirstChange(){return this.firstChange}}function Od(){return Xu}function Xu(s){return s.type.prototype.ngOnChanges&&(s.setInput=qs),ep}function ep(){const s=Ju(this),o=s?.current;if(o){const u=s.previous;if(u===N)s.previous=o;else for(let l in o)u[l]=o[l];s.current=null,this.ngOnChanges(o)}}function qs(s,o,u,l){const d=this.declaredInputs[u],p=Ju(s)||function tp(s,o){return s[ul]=o}(s,{previous:N,current:null}),y=p.current||(p.current={}),C=p.previous,b=C[d];y[d]=new kd(b&&b.currentValue,o,C===N),s[l]=o}Od.ngInherit=!0;const ul="__ngSimpleChanges__";function Ju(s){return s[ul]||null}const Un=function(s,o,u){};function fr(s){for(;Array.isArray(s);)s=s[Tr];return s}function Fr(s,o){return fr(o[s.index])}function tc(s,o){return s.data[o]}function br(s,o){const u=o[s];return ni(u)?u:u[Tr]}function Ks(s){return 64==(64&s[Xt])}function Ds(s,o){return null==o?null:s[o]}function su(s){s[To]=0}function ca(s,o){s[js]+=o;let u=s,l=s[Pn];for(;null!==l&&(1===o&&1===u[js]||-1===o&&0===u[js]);)l[js]+=o,u=l,l=l[Pn]}const Mt={lFrame:uu(null),bindingsEnabled:!0};function Fd(){return Mt.bindingsEnabled}function _e(){return Mt.lFrame.lView}function Vt(){return Mt.lFrame.tView}function hl(s){return Mt.lFrame.contextLView=s,s[Hn]}function ou(s){return Mt.lFrame.contextLView=null,s}function Yn(){let s=Vd();for(;null!==s&&64===s.type;)s=s.parent;return s}function Vd(){return Mt.lFrame.currentTNode}function Li(s,o){const u=Mt.lFrame;u.currentTNode=s,u.isParent=o}function rc(){return Mt.lFrame.isParent}function bs(){return Mt.lFrame.bindingIndex++}function Hd(s,o){const u=Mt.lFrame;u.bindingIndex=u.bindingRootIndex=s,Qn(o)}function Qn(s){Mt.lFrame.currentDirectiveIndex=s}function au(){return Mt.lFrame.currentQueryIndex}function zd(s){Mt.lFrame.currentQueryIndex=s}function sc(s){const o=s[Je];return 2===o.type?o.declTNode:1===o.type?s[Dr]:null}function Gd(s,o,u){if(u&gt.SkipSelf){let d=o,p=s;for(;!(d=d.parent,null!==d||u&gt.Host||(d=sc(p),null===d||(p=p[Hs],10&d.type))););if(null===d)return!1;o=d,s=p}const l=Mt.lFrame=fl();return l.currentTNode=o,l.lView=s,!0}function ha(s){const o=fl(),u=s[Je];Mt.lFrame=o,o.currentTNode=u.firstChild,o.lView=s,o.tView=u,o.contextLView=s,o.bindingIndex=u.bindingStartIndex,o.inI18n=!1}function fl(){const s=Mt.lFrame,o=null===s?null:s.child;return null===o?uu(s):o}function uu(s){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:s,child:null,inI18n:!1};return null!==s&&(s.child=o),o}function pl(){const s=Mt.lFrame;return Mt.lFrame=s.parent,s.currentTNode=null,s.lView=null,s}const oc=pl;function Wd(){const s=pl();s.isParent=!0,s.tView=null,s.selectedIndex=-1,s.contextLView=null,s.elementDepthCount=0,s.currentDirectiveIndex=-1,s.currentNamespace=null,s.bindingRootIndex=-1,s.bindingIndex=-1,s.currentQueryIndex=0}function qr(){return Mt.lFrame.selectedIndex}function ls(s){Mt.lFrame.selectedIndex=s}function Nn(){const s=Mt.lFrame;return tc(s.tView,s.selectedIndex)}function ac(s,o){for(let u=o.directiveStart,l=o.directiveEnd;u<l;u++){const p=s.data[u].type.prototype,{ngAfterContentInit:y,ngAfterContentChecked:C,ngAfterViewInit:b,ngAfterViewChecked:R,ngOnDestroy:P}=p;y&&(s.contentHooks??(s.contentHooks=[])).push(-u,y),C&&((s.contentHooks??(s.contentHooks=[])).push(u,C),(s.contentCheckHooks??(s.contentCheckHooks=[])).push(u,C)),b&&(s.viewHooks??(s.viewHooks=[])).push(-u,b),R&&((s.viewHooks??(s.viewHooks=[])).push(u,R),(s.viewCheckHooks??(s.viewCheckHooks=[])).push(u,R)),null!=P&&(s.destroyHooks??(s.destroyHooks=[])).push(u,P)}}function _l(s,o,u){uc(s,o,3,u)}function Yd(s,o,u,l){(3&s[Xt])===u&&uc(s,o,u,l)}function Qd(s,o){let u=s[Xt];(3&u)===o&&(u&=2047,u+=1,s[Xt]=u)}function uc(s,o,u,l){const p=l??-1,y=o.length-1;let C=0;for(let b=void 0!==l?65535&s[To]:0;b<y;b++)if("number"==typeof o[b+1]){if(C=o[b],null!=l&&C>=l)break}else o[b]<0&&(s[To]+=65536),(C<p||-1==p)&&(pa(s,u,o,b),s[To]=(4294901760&s[To])+b+2),b++}function pa(s,o,u,l){const d=u[l]<0,p=u[l+1],C=s[d?-u[l]:u[l]];if(d){if(s[Xt]>>11<s[To]>>16&&(3&s[Xt])===o){s[Xt]+=2048,Un(4,C,p);try{p.call(C)}finally{Un(5,C,p)}}}else{Un(4,C,p);try{p.call(C)}finally{Un(5,C,p)}}}const cu=-1;class Ss{constructor(o,u,l){this.factory=o,this.resolving=!1,this.canSeeViewProviders=u,this.injectImpl=l}}function ga(s,o,u){let l=0;for(;l<u.length;){const d=u[l];if("number"==typeof d){if(0!==d)break;l++;const p=u[l++],y=u[l++],C=u[l++];s.setAttribute(o,y,C,p)}else{const p=d,y=u[++l];Qs(p)?s.setProperty(o,p,y):s.setAttribute(o,p,y),l++}}return l}function Jd(s){return 3===s||4===s||6===s}function Qs(s){return 64===s.charCodeAt(0)}function No(s,o){if(null!==o&&0!==o.length)if(null===s||0===s.length)s=o.slice();else{let u=-1;for(let l=0;l<o.length;l++){const d=o[l];"number"==typeof d?u=d:0===u||ma(s,u,d,null,-1===u||2===u?o[++l]:null)}}return s}function ma(s,o,u,l,d){let p=0,y=s.length;if(-1===o)y=-1;else for(;p<s.length;){const C=s[p++];if("number"==typeof C){if(C===o){y=-1;break}if(C>o){y=p-1;break}}}for(;p<s.length;){const C=s[p];if("number"==typeof C)break;if(C===u){if(null===l)return void(null!==d&&(s[p+1]=d));if(l===s[p+1])return void(s[p+2]=d)}p++,null!==l&&p++,null!==d&&p++}-1!==y&&(s.splice(y,0,o),p=y+1),s.splice(p++,0,u),null!==l&&s.splice(p++,0,l),null!==d&&s.splice(p++,0,d)}function Mo(s){return s!==cu}function _a(s){return 32767&s}function hu(s,o){let u=function du(s){return s>>16}(s),l=o;for(;u>0;)l=l[Hs],u--;return l}let vl=!0;function fu(s){const o=vl;return vl=s,o}const wl=255,dc=5;let El=0;const pi={};function Il(s,o){const u=th(s,o);if(-1!==u)return u;const l=o[Je];l.firstCreatePass&&(s.injectorIndex=o.length,ds(l.data,s),ds(o,null),ds(l.blueprint,null));const d=Xn(s,o),p=s.injectorIndex;if(Mo(d)){const y=_a(d),C=hu(d,o),b=C[Je].data;for(let R=0;R<8;R++)o[p+R]=C[y+R]|b[y+R]}return o[p+8]=d,p}function ds(s,o){s.push(0,0,0,0,0,0,0,0,o)}function th(s,o){return-1===s.injectorIndex||s.parent&&s.parent.injectorIndex===s.injectorIndex||null===o[s.injectorIndex+8]?-1:s.injectorIndex}function Xn(s,o){if(s.parent&&-1!==s.parent.injectorIndex)return s.parent.injectorIndex;let u=0,l=null,d=o;for(;null!==d;){if(l=ko(d),null===l)return cu;if(u++,d=d[Hs],-1!==l.injectorIndex)return l.injectorIndex|u<<16}return cu}function Xs(s,o,u){!function eh(s,o,u){let l;"string"==typeof u?l=u.charCodeAt(0)||0:u.hasOwnProperty(Pt)&&(l=u[Pt]),null==l&&(l=u[Pt]=El++);const d=l&wl;o.data[s+(d>>dc)]|=1<<d}(s,o,u)}function nh(s,o,u){if(u&gt.Optional||void 0!==s)return s;He()}function pu(s,o,u,l){if(u&gt.Optional&&void 0===l&&(l=null),!(u&(gt.Self|gt.Host))){const d=s[Xa],p=Wn(void 0);try{return d?d.get(o,l,u&gt.Optional):Hr(o,l,u&gt.Optional)}finally{Wn(p)}}return nh(l,0,u)}function rh(s,o,u,l=gt.Default,d){if(null!==s){if(1024&o[Xt]){const y=function ap(s,o,u,l,d){let p=s,y=o;for(;null!==p&&null!==y&&1024&y[Xt]&&!(256&y[Xt]);){const C=fc(p,y,u,l|gt.Self,pi);if(C!==pi)return C;let b=p.parent;if(!b){const R=y[Wr];if(R){const P=R.get(u,pi,l);if(P!==pi)return P}b=ko(y),y=y[Hs]}p=b}return d}(s,o,u,l,pi);if(y!==pi)return y}const p=fc(s,o,u,l,pi);if(p!==pi)return p}return pu(o,u,l,d)}function fc(s,o,u,l,d){const p=function op(s){if("string"==typeof s)return s.charCodeAt(0)||0;const o=s.hasOwnProperty(Pt)?s[Pt]:void 0;return"number"==typeof o?o>=0?o&wl:Cl:o}(u);if("function"==typeof p){if(!Gd(o,s,l))return l&gt.Host?nh(d,0,l):pu(o,u,l,d);try{const y=p(l);if(null!=y||l&gt.Optional)return y;He()}finally{oc()}}else if("number"==typeof p){let y=null,C=th(s,o),b=cu,R=l&gt.Host?o[hr][Dr]:null;for((-1===C||l&gt.SkipSelf)&&(b=-1===C?Xn(s,o):o[C+8],b!==cu&&pc(l,!1)?(y=o[Je],C=_a(b),o=hu(b,o)):C=-1);-1!==C;){const P=o[Je];if(Js(p,C,P.data)){const j=pr(C,o,u,y,l,R);if(j!==pi)return j}b=o[C+8],b!==cu&&pc(l,o[Je].data[C+8]===R)&&Js(p,C,o)?(y=P,C=_a(b),o=hu(b,o)):C=-1}}return d}function pr(s,o,u,l,d,p){const y=o[Je],C=y.data[s+8],P=ya(C,y,u,null==l?Qu(C)&&vl:l!=y&&0!=(3&C.type),d&gt.Host&&p===C);return null!==P?Vn(o,y,P,C):pi}function ya(s,o,u,l,d){const p=s.providerIndexes,y=o.data,C=1048575&p,b=s.directiveStart,P=p>>20,Q=d?C+P:s.directiveEnd;for(let ne=l?C:C+P;ne<Q;ne++){const Te=y[ne];if(ne<b&&u===Te||ne>=b&&Te.type===u)return ne}if(d){const ne=y[b];if(ne&&hi(ne)&&ne.type===u)return b}return null}function Vn(s,o,u,l){let d=s[u];const p=o.data;if(function vm(s){return s instanceof Ss}(d)){const y=d;y.resolving&&function Ae(s,o){const u=o?`. Dependency path: ${o.join(" > ")} > ${s}`:"";throw new we(-200,`Circular dependency in DI detected for ${s}${u}`)}(function je(s){return"function"==typeof s?s.name||s.toString():"object"==typeof s&&null!=s&&"function"==typeof s.type?s.type.name||s.type.toString():Le(s)}(p[u]));const C=fu(y.canSeeViewProviders);y.resolving=!0;const b=y.injectImpl?Wn(y.injectImpl):null;Gd(s,l,gt.Default);try{d=s[u]=y.factory(void 0,p,s,l),o.firstCreatePass&&u>=l.directiveStart&&function ym(s,o,u){const{ngOnChanges:l,ngOnInit:d,ngDoCheck:p}=o.type.prototype;if(l){const y=Xu(o);(u.preOrderHooks??(u.preOrderHooks=[])).push(s,y),(u.preOrderCheckHooks??(u.preOrderCheckHooks=[])).push(s,y)}d&&(u.preOrderHooks??(u.preOrderHooks=[])).push(0-s,d),p&&((u.preOrderHooks??(u.preOrderHooks=[])).push(s,p),(u.preOrderCheckHooks??(u.preOrderCheckHooks=[])).push(s,p))}(u,p[u],o)}finally{null!==b&&Wn(b),fu(C),y.resolving=!1,oc()}}return d}function Js(s,o,u){return!!(u[o+(s>>dc)]&1<<s)}function pc(s,o){return!(s&gt.Self||s&gt.Host&&o)}class va{constructor(o,u){this._tNode=o,this._lView=u}get(o,u,l){return rh(this._tNode,this._lView,o,Or(l),u)}}function Cl(){return new va(Yn(),_e())}function Tl(s){return H(()=>{const o=s.prototype.constructor,u=o[Qt]||eo(o),l=Object.prototype;let d=Object.getPrototypeOf(s.prototype).constructor;for(;d&&d!==l;){const p=d[Qt]||eo(d);if(p&&p!==u)return p;d=Object.getPrototypeOf(d)}return p=>new p})}function eo(s){return $e(s)?()=>{const o=eo(J(s));return o&&o()}:Ts(s)}function ko(s){const o=s[Je],u=o.type;return 2===u?o.declTNode:1===u?s[Dr]:null}function gu(s){return function hc(s,o){if("class"===o)return s.classes;if("style"===o)return s.styles;const u=s.attrs;if(u){const l=u.length;let d=0;for(;d<l;){const p=u[d];if(Jd(p))break;if(0===p)d+=2;else if("number"==typeof p)for(d++;d<l&&"string"==typeof u[d];)d++;else{if(p===o)return u[d+1];d+=2}}}return null}(Yn(),s)}const wa="__parameters__";function Lo(s,o,u){return H(()=>{const l=function ih(s){return function(...u){if(s){const l=s(...u);for(const d in l)this[d]=l[d]}}}(o);function d(...p){if(this instanceof d)return l.apply(this,p),this;const y=new d(...p);return C.annotation=y,C;function C(b,R,P){const j=b.hasOwnProperty(wa)?b[wa]:Object.defineProperty(b,wa,{value:[]})[wa];for(;j.length<=P;)j.push(null);return(j[P]=j[P]||[]).push(y),b}}return u&&(d.prototype=Object.create(u.prototype)),d.prototype.ngMetadataName=s,d.annotationCls=d,d})}class an{constructor(o,u){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof u?this.__NG_ELEMENT_ID__=u:void 0!==u&&(this.\u0275prov=ct({token:this,providedIn:u.providedIn||"root",factory:u.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function to(s,o){s.forEach(u=>Array.isArray(u)?to(u,o):o(u))}function xl(s,o,u){o>=s.length?s.push(u):s.splice(o,0,u)}function mu(s,o){return o>=s.length-1?s.pop():s.splice(o,1)[0]}const Uo=ei(Lo("Optional"),8),yt=ei(Lo("SkipSelf"),4);var At=(()=>((At=At||{})[At.Important=1]="Important",At[At.DashCase=2]="DashCase",At))();const ph=new Map;let Ji=0;const ee="__ngContext__";function se(s,o){ni(o)?(s[ee]=o[ra],function mh(s){ph.set(s[ra],s)}(o)):s[ee]=o}let fs;function ps(s,o){return fs(s,o)}function yh(s){const o=s[Pn];return Ki(o)?o[Pn]:o}function Su(s){return gp(s[Mi])}function Au(s){return gp(s[_n])}function gp(s){for(;null!==s&&!Ki(s);)s=s[_n];return s}function ba(s,o,u,l,d){if(null!=l){let p,y=!1;Ki(l)?p=l:ni(l)&&(y=!0,l=l[Tr]);const C=fr(l);0===s&&null!==u?null==d?mi(o,u,C):Wt(o,u,C,d||null,!0):1===s&&null!==u?Wt(o,u,C,d||null,!0):2===s?function xy(s,o,u){const l=Rs(s,o);l&&function Sa(s,o,u,l){s.removeChild(o,u,l)}(s,l,o,u)}(o,C,y):3===s&&o.destroyNode(C),null!=p&&function Ip(s,o,u,l,d){const p=u[ia];p!==fr(u)&&ba(o,s,l,p,d);for(let C=Lr;C<u.length;C++){const b=u[C];Ep(b[Je],b,s,o,l,p)}}(o,s,p,u,d)}}function _p(s,o,u){return s.createElement(o,u)}function I(s,o){const u=s[Do],l=u.indexOf(o),d=o[Pn];512&o[Xt]&&(o[Xt]&=-513,ca(d,-1)),u.splice(l,1)}function x(s,o){if(s.length<=Lr)return;const u=Lr+o,l=s[u];if(l){const d=l[Co];null!==d&&d!==s&&I(d,l),o>0&&(s[u-1][_n]=l[_n]);const p=mu(s,Lr+o);!function Em(s,o){Ep(s,o,o[zt],2,null,null),o[Tr]=null,o[Dr]=null}(l[Je],l);const y=p[ki];null!==y&&y.detachView(p[Je]),l[Pn]=null,l[_n]=null,l[Xt]&=-65}return l}function k(s,o){if(!(128&o[Xt])){const u=o[zt];u.destroyNode&&Ep(s,o,u,3,null,null),function w(s){let o=s[Mi];if(!o)return X(s[Je],s);for(;o;){let u=null;if(ni(o))u=o[Mi];else{const l=o[Lr];l&&(u=l)}if(!u){for(;o&&!o[_n]&&o!==s;)ni(o)&&X(o[Je],o),o=o[Pn];null===o&&(o=s),ni(o)&&X(o[Je],o),u=o&&o[_n]}o=u}}(o)}}function X(s,o){if(!(128&o[Xt])){o[Xt]&=-65,o[Xt]|=128,function Be(s,o){let u;if(null!=s&&null!=(u=s.destroyHooks))for(let l=0;l<u.length;l+=2){const d=o[u[l]];if(!(d instanceof Ss)){const p=u[l+1];if(Array.isArray(p))for(let y=0;y<p.length;y+=2){const C=d[p[y]],b=p[y+1];Un(4,C,b);try{b.call(C)}finally{Un(5,C,b)}}else{Un(4,d,p);try{p.call(d)}finally{Un(5,d,p)}}}}}(s,o),function he(s,o){const u=s.cleanup,l=o[Qa];let d=-1;if(null!==u)for(let p=0;p<u.length-1;p+=2)if("string"==typeof u[p]){const y=u[p+3];y>=0?l[d=y]():l[d=-y].unsubscribe(),p+=2}else{const y=l[d=u[p+1]];u[p].call(y)}if(null!==l){for(let p=d+1;p<l.length;p++)(0,l[p])();o[Qa]=null}}(s,o),1===o[Je].type&&o[zt].destroy();const u=o[Co];if(null!==u&&Ki(o[Pn])){u!==o[Pn]&&I(u,o);const l=o[ki];null!==l&&l.detachView(s)}!function E(s){ph.delete(s[ra])}(o)}}function Ke(s,o,u){return function Et(s,o,u){let l=o;for(;null!==l&&40&l.type;)l=(o=l).parent;if(null===l)return u[Tr];{const{componentOffset:d}=l;if(d>-1){const{encapsulation:p}=s.data[l.directiveStart+d];if(p===F.None||p===F.Emulated)return null}return Fr(l,u)}}(s,o.parent,u)}function Wt(s,o,u,l,d){s.insertBefore(o,u,l,d)}function mi(s,o,u){s.appendChild(o,u)}function $o(s,o,u,l,d){null!==l?Wt(s,o,u,l,d):mi(s,o,u)}function Rs(s,o){return s.parentNode(o)}let wh,My,Im,Aa=function $l(s,o,u){return 40&s.type?Fr(s,u):null};function Dc(s,o,u,l){const d=Ke(s,l,o),p=o[zt],C=function vh(s,o,u){return Aa(s,o,u)}(l.parent||o[Dr],l,o);if(null!=d)if(Array.isArray(u))for(let b=0;b<u.length;b++)$o(p,d,u[b],C,!1);else $o(p,d,u,C,!1);void 0!==wh&&wh(p,l,o,u,d)}function Ih(s,o){if(null!==o){const u=o.type;if(3&u)return Fr(o,s);if(4&u)return Ra(-1,s[o.index]);if(8&u){const l=o.child;if(null!==l)return Ih(s,l);{const d=s[o.index];return Ki(d)?Ra(-1,d):fr(d)}}if(32&u)return ps(o,s)()||fr(s[o.index]);{const l=bc(s,o);return null!==l?Array.isArray(l)?l[0]:Ih(yh(s[hr]),l):Ih(s,o.next)}}return null}function bc(s,o){return null!==o?s[hr][Dr].projection[o.projection]:null}function Ra(s,o){const u=Lr+s+1;if(u<o.length){const l=o[u],d=l[Je].firstChild;if(null!==d)return Ih(l,d)}return o[ia]}function wp(s,o,u,l,d,p,y){for(;null!=u;){const C=l[u.index],b=u.type;if(y&&0===o&&(C&&se(fr(C),l),u.flags|=2),32!=(32&u.flags))if(8&b)wp(s,o,u.child,l,d,p,!1),ba(o,s,d,C,p);else if(32&b){const R=ps(u,l);let P;for(;P=R();)ba(o,s,d,P,p);ba(o,s,d,C,p)}else 16&b?Py(s,o,l,u,d,p):ba(o,s,d,C,p);u=y?u.projectionNext:u.next}}function Ep(s,o,u,l,d,p){wp(u,l,s.firstChild,o,d,p,!1)}function Py(s,o,u,l,d,p){const y=u[hr],b=y[Dr].projection[l.projection];if(Array.isArray(b))for(let R=0;R<b.length;R++)ba(o,s,d,b[R],p);else wp(s,o,b,y[Pn],d,p,!0)}function Sc(s,o,u){""===u?s.removeAttribute(o,"class"):s.setAttribute(o,"class",u)}function Cp(s,o,u){const{mergedAttrs:l,classes:d,styles:p}=u;null!==l&&ga(s,o,l),null!==d&&Sc(s,o,d),null!==p&&function Ny(s,o,u){s.setAttribute(o,"style",u)}(s,o,p)}function ND(s){My=s}function uE(s){return function ky(){if(void 0===Im&&(Im=null,cn.trustedTypes))try{Im=cn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:s=>s,createScript:s=>s,createScriptURL:s=>s})}catch{}return Im}()?.createScriptURL(s)||s}class cE{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${ot})`}}function Pa(s){return s instanceof cE?s.changingThisBreaksApplicationSecurity:s}function xs(s,o){const u=function Th(s){return s instanceof cE&&s.getTypeName()||null}(s);if(null!=u&&u!==o){if("ResourceURL"===u&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${u} (see ${ot})`)}return u===o}const fE=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var xr=(()=>((xr=xr||{})[xr.NONE=0]="NONE",xr[xr.HTML=1]="HTML",xr[xr.STYLE=2]="STYLE",xr[xr.SCRIPT=3]="SCRIPT",xr[xr.URL=4]="URL",xr[xr.RESOURCE_URL=5]="RESOURCE_URL",xr))();function $y(s){const o=xp();return o?o.sanitize(xr.URL,s)||"":xs(s,"URL")?Pa(s):function bp(s){return(s=String(s)).match(fE)?s:"unsafe:"+s}(Le(s))}function Sm(s){const o=xp();if(o)return uE(o.sanitize(xr.RESOURCE_URL,s)||"");if(xs(s,"ResourceURL"))return uE(Pa(s));throw new we(904,!1)}function vE(s,o,u){return function GD(s,o){return"src"===o&&("embed"===s||"frame"===s||"iframe"===s||"media"===s||"script"===s)||"href"===o&&("base"===s||"link"===s)?Sm:$y}(o,u)(s)}function xp(){const s=_e();return s&&s[Yu]}const zy=new an("ENVIRONMENT_INITIALIZER"),zl=new an("INJECTOR",-1),bh=new an("INJECTOR_DEF_TYPES");class wE{get(o,u=qn){if(u===qn){const l=new Error(`NullInjectorError: No provider for ${ve(o)}!`);throw l.name="NullInjectorError",l}return u}}function Pp(...s){return{\u0275providers:Sh(0,s),\u0275fromNgModule:!0}}function Sh(s,...o){const u=[],l=new Set;let d;return to(o,p=>{const y=p;Gy(y,u,[],l)&&(d||(d=[]),d.push(y))}),void 0!==d&&EE(d,u),u}function EE(s,o){for(let u=0;u<s.length;u++){const{providers:d}=s[u];Wy(d,p=>{o.push(p)})}}function Gy(s,o,u,l){if(!(s=J(s)))return!1;let d=null,p=xn(s);const y=!p&&vt(s);if(p||y){if(y&&!y.standalone)return!1;d=s}else{const b=s.ngModule;if(p=xn(b),!p)return!1;d=b}const C=l.has(d);if(y){if(C)return!1;if(l.add(d),y.dependencies){const b="function"==typeof y.dependencies?y.dependencies():y.dependencies;for(const R of b)Gy(R,o,u,l)}}else{if(!p)return!1;{if(null!=p.imports&&!C){let R;l.add(d);try{to(p.imports,P=>{Gy(P,o,u,l)&&(R||(R=[]),R.push(P))})}finally{}void 0!==R&&EE(R,o)}if(!C){const R=Ts(d)||(()=>new d);o.push({provide:d,useFactory:R,deps:Z},{provide:bh,useValue:d,multi:!0},{provide:zy,useValue:()=>jt(d),multi:!0})}const b=p.providers;null==b||C||Wy(b,P=>{o.push(P)})}}return d!==s&&void 0!==s.providers}function Wy(s,o){for(let u of s)Re(u)&&(u=u.\u0275providers),Array.isArray(u)?Wy(u,o):o(u)}const qD=ce({provide:String,useValue:ce});function qy(s){return null!==s&&"object"==typeof s&&qD in s}function Ru(s){return"function"==typeof s}const Ac=new an("Set Injector scope."),Rm={},ZD={};let Ky;function xm(){return void 0===Ky&&(Ky=new wE),Ky}class Gl{}class CE extends Gl{get destroyed(){return this._destroyed}constructor(o,u,l,d){super(),this.parent=u,this.source=l,this.scopes=d,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Rh(o,y=>this.processProvider(y)),this.records.set(zl,Ah(void 0,this)),d.has("environment")&&this.records.set(Gl,Ah(void 0,this));const p=this.records.get(Ac);null!=p&&"string"==typeof p.value&&this.scopes.add(p.value),this.injectorDefTypes=new Set(this.get(bh.multi,Z,gt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const o of this._ngOnDestroyHooks)o.ngOnDestroy();for(const o of this._onDestroyHooks)o()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(o){this._onDestroyHooks.push(o)}runInContext(o){this.assertNotDestroyed();const u=Jt(this),l=Wn(void 0);try{return o()}finally{Jt(u),Wn(l)}}get(o,u=qn,l=gt.Default){this.assertNotDestroyed(),l=Or(l);const d=Jt(this),p=Wn(void 0);try{if(!(l&gt.SkipSelf)){let C=this.records.get(o);if(void 0===C){const b=function Xy(s){return"function"==typeof s||"object"==typeof s&&s instanceof an}(o)&&nn(o);C=b&&this.injectableDefInScope(b)?Ah(Zy(o),Rm):null,this.records.set(o,C)}if(null!=C)return this.hydrate(o,C)}return(l&gt.Self?xm():this.parent).get(o,u=l&gt.Optional&&u===qn?null:u)}catch(y){if("NullInjectorError"===y.name){if((y[Ln]=y[Ln]||[]).unshift(ve(o)),d)throw y;return function ti(s,o,u,l){const d=s[Ln];throw o[Yt]&&d.unshift(o[Yt]),s.message=function G(s,o,u,l=null){s=s&&"\n"===s.charAt(0)&&s.charAt(1)==dr?s.slice(2):s;let d=ve(o);if(Array.isArray(o))d=o.map(ve).join(" -> ");else if("object"==typeof o){let p=[];for(let y in o)if(o.hasOwnProperty(y)){let C=o[y];p.push(y+":"+("string"==typeof C?JSON.stringify(C):ve(C)))}d=`{${p.join(", ")}}`}return`${u}${l?"("+l+")":""}[${d}]: ${s.replace($n,"\n  ")}`}("\n"+s.message,d,u,l),s[Jr]=d,s[Ln]=null,s}(y,o,"R3InjectorError",this.source)}throw y}finally{Wn(p),Jt(d)}}resolveInjectorInitializers(){const o=Jt(this),u=Wn(void 0);try{const l=this.get(zy.multi,Z,gt.Self);for(const d of l)d()}finally{Jt(o),Wn(u)}}toString(){const o=[],u=this.records;for(const l of u.keys())o.push(ve(l));return`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new we(205,!1)}processProvider(o){let u=Ru(o=J(o))?o:J(o&&o.provide);const l=function QD(s){return qy(s)?Ah(void 0,s.useValue):Ah(function Yy(s,o,u){let l;if(Ru(s)){const d=J(s);return Ts(d)||Zy(d)}if(qy(s))l=()=>J(s.useValue);else if(function IE(s){return!(!s||!s.useFactory)}(s))l=()=>s.useFactory(...Zn(s.deps||[]));else if(function KD(s){return!(!s||!s.useExisting)}(s))l=()=>jt(J(s.useExisting));else{const d=J(s&&(s.useClass||s.provide));if(!function Qy(s){return!!s.deps}(s))return Ts(d)||Zy(d);l=()=>new d(...Zn(s.deps))}return l}(s),Rm)}(o);if(Ru(o)||!0!==o.multi)this.records.get(u);else{let d=this.records.get(u);d||(d=Ah(void 0,Rm,!0),d.factory=()=>Zn(d.multi),this.records.set(u,d)),u=o,d.multi.push(o)}this.records.set(u,l)}hydrate(o,u){return u.value===Rm&&(u.value=ZD,u.value=u.factory()),"object"==typeof u.value&&u.value&&function TE(s){return null!==s&&"object"==typeof s&&"function"==typeof s.ngOnDestroy}(u.value)&&this._ngOnDestroyHooks.add(u.value),u.value}injectableDefInScope(o){if(!o.providedIn)return!1;const u=J(o.providedIn);return"string"==typeof u?"any"===u||this.scopes.has(u):this.injectorDefTypes.has(u)}}function Zy(s){const o=nn(s),u=null!==o?o.factory:Ts(s);if(null!==u)return u;if(s instanceof an)throw new we(204,!1);if(s instanceof Function)return function YD(s){const o=s.length;if(o>0)throw function Ea(s,o){const u=[];for(let l=0;l<s;l++)u.push(o);return u}(o,"?"),new we(204,!1);const u=function rr(s){return s&&(s[On]||s[Ti])||null}(s);return null!==u?()=>u.factory(s):()=>new s}(s);throw new we(204,!1)}function Ah(s,o,u=!1){return{factory:s,value:o,multi:u?[]:void 0}}function Rh(s,o){for(const u of s)Array.isArray(u)?Rh(u,o):u&&Re(u)?Rh(u.\u0275providers,o):o(u)}class XD{}class DE{}class SE{resolveComponentFactory(o){throw function JD(s){const o=Error(`No component factory found for ${ve(s)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=s,o}(o)}}let xh=(()=>{class s{}return s.NULL=new SE,s})();function Pm(){return xu(Yn(),_e())}function xu(s,o){return new Ph(Fr(s,o))}let Ph=(()=>{class s{constructor(u){this.nativeElement=u}}return s.__NG_ELEMENT_ID__=Pm,s})();function Np(s){return s instanceof Ph?s.nativeElement:s}class ev{}let eb=(()=>{class s{}return s.__NG_ELEMENT_ID__=()=>function tb(){const s=_e(),u=br(Yn().index,s);return(ni(u)?u:s)[zt]}(),s})(),nb=(()=>{class s{}return s.\u0275prov=ct({token:s,providedIn:"root",factory:()=>null}),s})();class AE{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const RE=new AE("15.2.9"),Nm={},tv="ngOriginalError";function nv(s){return s[tv]}class Mp{constructor(){this._console=console}handleError(o){const u=this._findOriginalError(o);this._console.error("ERROR",o),u&&this._console.error("ORIGINAL ERROR",u)}_findOriginalError(o){let u=o&&nv(o);for(;u&&nv(u);)u=nv(u);return u||null}}function Na(s){return s instanceof Function?s():s}function OE(s,o,u){let l=s.length;for(;;){const d=s.indexOf(o,u);if(-1===d)return d;if(0===d||s.charCodeAt(d-1)<=32){const p=o.length;if(d+p===l||s.charCodeAt(d+p)<=32)return d}u=d+1}}const rv="ng-template";function iv(s,o,u){let l=0,d=!0;for(;l<s.length;){let p=s[l++];if("string"==typeof p&&d){const y=s[l++];if(u&&"class"===p&&-1!==OE(y.toLowerCase(),o,0))return!0}else{if(1===p){for(;l<s.length&&"string"==typeof(p=s[l++]);)if(p.toLowerCase()===o)return!0;return!1}"number"==typeof p&&(d=!1)}}return!1}function sv(s){return 4===s.type&&s.value!==rv}function Nh(s,o,u){return o===(4!==s.type||u?s.value:rv)}function ov(s,o,u){let l=4;const d=s.attrs||[],p=function FE(s){for(let o=0;o<s.length;o++)if(Jd(s[o]))return o;return s.length}(d);let y=!1;for(let C=0;C<o.length;C++){const b=o[C];if("number"!=typeof b){if(!y)if(4&l){if(l=2|1&l,""!==b&&!Nh(s,b,u)||""===b&&1===o.length){if(zo(l))return!1;y=!0}}else{const R=8&l?b:o[++C];if(8&l&&null!==s.attrs){if(!iv(s.attrs,R,u)){if(zo(l))return!1;y=!0}continue}const j=LE(8&l?"class":b,d,sv(s),u);if(-1===j){if(zo(l))return!1;y=!0;continue}if(""!==R){let Q;Q=j>p?"":d[j+1].toLowerCase();const ne=8&l?Q:null;if(ne&&-1!==OE(ne,R,0)||2&l&&R!==Q){if(zo(l))return!1;y=!0}}}}else{if(!y&&!zo(l)&&!zo(b))return!1;if(y&&zo(b))continue;y=!1,l=b|1&l}}return zo(l)||y}function zo(s){return 0==(1&s)}function LE(s,o,u,l){if(null===o)return-1;let d=0;if(l||!u){let p=!1;for(;d<o.length;){const y=o[d];if(y===s)return d;if(3===y||6===y)p=!0;else{if(1===y||2===y){let C=o[++d];for(;"string"==typeof C;)C=o[++d];continue}if(4===y)break;if(0===y){d+=4;continue}}d+=p?1:2}return-1}return function UE(s,o){let u=s.indexOf(4);if(u>-1)for(u++;u<s.length;){const l=s[u];if("number"==typeof l)return-1;if(l===o)return u;u++}return-1}(o,s)}function Op(s,o,u=!1){for(let l=0;l<o.length;l++)if(ov(s,o[l],u))return!0;return!1}function VE(s,o){return s?":not("+o.trim()+")":o}function lb(s){let o=s[0],u=1,l=2,d="",p=!1;for(;u<s.length;){let y=s[u];if("string"==typeof y)if(2&l){const C=s[++u];d+="["+y+(C.length>0?'="'+C+'"':"")+"]"}else 8&l?d+="."+y:4&l&&(d+=" "+y);else""!==d&&!zo(y)&&(o+=VE(p,d),d=""),l=y,p=p||!zo(l);u++}return""!==d&&(o+=VE(p,d)),o}const Ht={};function BE(s){jE(Vt(),_e(),qr()+s,!1)}function jE(s,o,u,l){if(!l)if(3==(3&o[Xt])){const p=s.preOrderCheckHooks;null!==p&&_l(o,p,u)}else{const p=s.preOrderHooks;null!==p&&Yd(o,p,0,u)}ls(u)}function HE(s,o=null,u=null,l){const d=av(s,o,u,l);return d.resolveInjectorInitializers(),d}function av(s,o=null,u=null,l,d=new Set){const p=[u||Z,Pp(s)];return l=l||("object"==typeof s?void 0:ve(s)),new CE(p,o||xm(),l||null,d)}let Mh=(()=>{class s{static create(u,l){if(Array.isArray(u))return HE({name:""},l,u,"");{const d=u.name??"";return HE({name:d},u.parent,u.providers,d)}}}return s.THROW_IF_NOT_FOUND=qn,s.NULL=new wE,s.\u0275prov=ct({token:s,providedIn:"any",factory:()=>jt(zl)}),s.__NG_ELEMENT_ID__=-1,s})();function Lh(s,o=gt.Default){const u=_e();return null===u?jt(s,o):rh(Yn(),u,J(s),o)}function KE(){throw new Error("invalid")}function ZE(s,o){const u=s.contentQueries;if(null!==u)for(let l=0;l<u.length;l+=2){const p=u[l+1];if(-1!==p){const y=s.data[p];zd(u[l]),y.contentQueries(2,o[p],p)}}}function Lm(s,o,u,l,d,p,y,C,b,R,P){const j=o.blueprint.slice();return j[Tr]=d,j[Xt]=76|l,(null!==P||s&&1024&s[Xt])&&(j[Xt]|=1024),su(j),j[Pn]=j[Hs]=s,j[Hn]=u,j[$s]=y||s&&s[$s],j[zt]=C||s&&s[zt],j[Yu]=b||s&&s[Yu]||null,j[Xa]=R||s&&s[Xa]||null,j[Dr]=p,j[ra]=function gh(){return Ji++}(),j[Wr]=P,j[hr]=2==o.type?s[hr]:j,j}function Vp(s,o,u,l,d){let p=s.data[o];if(null===p)p=function hv(s,o,u,l,d){const p=Vd(),y=rc(),b=s.data[o]=function Ee(s,o,u,l,d,p){return{type:u,index:l,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:d,attrs:p,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,y?p:p&&p.parent,u,o,l,d);return null===s.firstChild&&(s.firstChild=b),null!==p&&(y?null==p.child&&null!==b.parent&&(p.child=b):null===p.next&&(p.next=b,b.prev=p)),b}(s,o,u,l,d),function $d(){return Mt.lFrame.inI18n}()&&(p.flags|=32);else if(64&p.type){p.type=u,p.value=l,p.attrs=d;const y=function la(){const s=Mt.lFrame,o=s.currentTNode;return s.isParent?o:o.parent}();p.injectorIndex=null===y?-1:y.injectorIndex}return Li(p,!0),p}function U(s,o,u,l){if(0===u)return-1;const d=o.length;for(let p=0;p<u;p++)o.push(l),s.blueprint.push(l),s.data.push(null);return d}function Ai(s,o,u){ha(o);try{const l=s.viewQuery;null!==l&&qp(1,l,u);const d=s.template;null!==d&&uo(s,o,d,1,u),s.firstCreatePass&&(s.firstCreatePass=!1),s.staticContentQueries&&ZE(s,o),s.staticViewQueries&&qp(2,s.viewQuery,u);const p=s.components;null!==p&&function YE(s,o){for(let u=0;u<o.length;u++)rI(s,o[u])}(o,p)}catch(l){throw s.firstCreatePass&&(s.incompleteFirstPass=!0,s.firstCreatePass=!1),l}finally{o[Xt]&=-5,Wd()}}function gs(s,o,u,l){const d=o[Xt];if(128!=(128&d)){ha(o);try{su(o),function Ys(s){return Mt.lFrame.bindingIndex=s}(s.bindingStartIndex),null!==u&&uo(s,o,u,2,l);const y=3==(3&d);if(y){const R=s.preOrderCheckHooks;null!==R&&_l(o,R,null)}else{const R=s.preOrderHooks;null!==R&&Yd(o,R,0,null),Qd(o,0)}if(function Uh(s){for(let o=Su(s);null!==o;o=Au(o)){if(!o[eu])continue;const u=o[Do];for(let l=0;l<u.length;l++){const d=u[l];512&d[Xt]||ca(d[Pn],1),d[Xt]|=512}}}(o),function Nb(s){for(let o=Su(s);null!==o;o=Au(o))for(let u=Lr;u<o.length;u++){const l=o[u],d=l[Je];Ks(l)&&gs(d,l,d.template,l[Hn])}}(o),null!==s.contentQueries&&ZE(s,o),y){const R=s.contentCheckHooks;null!==R&&_l(o,R)}else{const R=s.contentHooks;null!==R&&Yd(o,R,1),Qd(o,1)}!function Sb(s,o){const u=s.hostBindingOpCodes;if(null!==u)try{for(let l=0;l<u.length;l++){const d=u[l];if(d<0)ls(~d);else{const p=d,y=u[++l],C=u[++l];Hd(y,p),C(2,o[p])}}}finally{ls(-1)}}(s,o);const C=s.components;null!==C&&function Ab(s,o){for(let u=0;u<o.length;u++)nI(s,o[u])}(o,C);const b=s.viewQuery;if(null!==b&&qp(2,b,l),y){const R=s.viewCheckHooks;null!==R&&_l(o,R)}else{const R=s.viewHooks;null!==R&&Yd(o,R,2),Qd(o,2)}!0===s.firstUpdatePass&&(s.firstUpdatePass=!1),o[Xt]&=-41,512&o[Xt]&&(o[Xt]&=-513,ca(o[Pn],-1))}finally{Wd()}}}function uo(s,o,u,l,d){const p=qr(),y=2&l;try{ls(-1),y&&o.length>Cn&&jE(s,o,Cn,!1),Un(y?2:0,d),u(l,d)}finally{ls(p),Un(y?3:1,d)}}function Bp(s,o,u){if(bo(o)){const d=o.directiveEnd;for(let p=o.directiveStart;p<d;p++){const y=s.data[p];y.contentQueries&&y.contentQueries(1,u[p],p)}}}function vn(s,o,u){Fd()&&(function $i(s,o,u,l){const d=u.directiveStart,p=u.directiveEnd;Qu(u)&&function Pb(s,o,u){const l=Fr(o,s),d=fv(u),p=s[$s],y=Wp(s,Lm(s,d,null,u.onPush?32:16,l,o,p,p.createRenderer(l,u),null,null,null));s[o.index]=y}(o,u,s.data[d+u.componentOffset]),s.firstCreatePass||Il(u,o),se(l,o);const y=u.initialInputs;for(let C=d;C<p;C++){const b=s.data[C],R=Vn(o,s,C,u);se(R,o),null!==y&&Ma(0,C-d,R,b,0,y),hi(b)&&(br(u.index,o)[Hn]=Vn(o,s,C,u))}}(s,o,u,Fr(u,o)),64==(64&u.flags)&&zp(s,o,u))}function jp(s,o,u=Fr){const l=o.localNames;if(null!==l){let d=o.index+1;for(let p=0;p<l.length;p+=2){const y=l[p+1],C=-1===y?u(o,s):s[y];s[d++]=C}}}function fv(s){const o=s.tView;return null===o||o.incompleteFirstPass?s.tView=pv(1,null,s.template,s.decls,s.vars,s.directiveDefs,s.pipeDefs,s.viewQuery,s.schemas,s.consts):o}function pv(s,o,u,l,d,p,y,C,b,R){const P=Cn+l,j=P+d,Q=function si(s,o){const u=[];for(let l=0;l<o;l++)u.push(l<s?null:Ht);return u}(P,j),ne="function"==typeof R?R():R;return Q[Je]={type:s,blueprint:Q,template:u,queries:null,viewQuery:C,declTNode:o,data:Q.slice().fill(null,P),bindingStartIndex:P,expandoStartIndex:j,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof p?p():p,pipeRegistry:"function"==typeof y?y():y,firstChild:null,schemas:b,consts:ne,incompleteFirstPass:!1}}function Fm(s,o,u,l){const d=vv(o);null===u?d.push(l):(d.push(u),s.firstCreatePass&&oI(s).push(l,d.length-1))}function QE(s,o,u,l){for(let d in s)if(s.hasOwnProperty(d)){u=null===u?{}:u;const p=s[d];null===l?co(u,o,d,p):l.hasOwnProperty(d)&&co(u,o,l[d],p)}return u}function co(s,o,u,l){s.hasOwnProperty(u)?s[u].push(o,l):s[u]=[o,l]}function bt(s,o,u,l,d,p,y,C){const b=Fr(o,u);let P,R=o.inputs;!C&&null!=R&&(P=R[l])?(Kl(s,u,P,l,d),Qu(o)&&function Um(s,o){const u=br(o,s);16&u[Xt]||(u[Xt]|=32)}(u,o.index)):3&o.type&&(l=function gv(s){return"class"===s?"className":"for"===s?"htmlFor":"formaction"===s?"formAction":"innerHtml"===s?"innerHTML":"readonly"===s?"readOnly":"tabindex"===s?"tabIndex":s}(l),d=null!=y?y(d,o.value||"",l):d,p.setProperty(b,l,d))}function Hp(s,o,u,l){if(Fd()){const d=null===l?null:{"":-1},p=function Rc(s,o){const u=s.directiveRegistry;let l=null,d=null;if(u)for(let p=0;p<u.length;p++){const y=u[p];if(Op(o,y.selectors,!1))if(l||(l=[]),hi(y))if(null!==y.findHostDirectiveDefs){const C=[];d=d||new Map,y.findHostDirectiveDefs(y,C,d),l.unshift(...C,y),mv(s,o,C.length)}else l.unshift(y),mv(s,o,0);else d=d||new Map,y.findHostDirectiveDefs?.(y,l,d),l.push(y)}return null===l?null:[l,d]}(s,u);let y,C;null===p?y=C=null:[y,C]=p,null!==y&&XE(s,o,u,y,d,C),d&&function JE(s,o,u){if(o){const l=s.localNames=[];for(let d=0;d<o.length;d+=2){const p=u[o[d+1]];if(null==p)throw new we(-301,!1);l.push(o[d],p)}}}(u,l,d)}u.mergedAttrs=No(u.mergedAttrs,u.attrs)}function XE(s,o,u,l,d,p){for(let R=0;R<l.length;R++)Xs(Il(u,o),s,l[R].type);!function eI(s,o,u){s.flags|=1,s.directiveStart=o,s.directiveEnd=o+u,s.providerIndexes=o}(u,s.data.length,l.length);for(let R=0;R<l.length;R++){const P=l[R];P.providersResolver&&P.providersResolver(P)}let y=!1,C=!1,b=U(s,o,l.length,null);for(let R=0;R<l.length;R++){const P=l[R];u.mergedAttrs=No(u.mergedAttrs,P.hostAttrs),Hi(s,u,o,b,P),_v(b,P,d),null!==P.contentQueries&&(u.flags|=4),(null!==P.hostBindings||null!==P.hostAttrs||0!==P.hostVars)&&(u.flags|=64);const j=P.type.prototype;!y&&(j.ngOnChanges||j.ngOnInit||j.ngDoCheck)&&((s.preOrderHooks??(s.preOrderHooks=[])).push(u.index),y=!0),!C&&(j.ngOnChanges||j.ngDoCheck)&&((s.preOrderCheckHooks??(s.preOrderCheckHooks=[])).push(u.index),C=!0),b++}!function rt(s,o,u){const d=o.directiveEnd,p=s.data,y=o.attrs,C=[];let b=null,R=null;for(let P=o.directiveStart;P<d;P++){const j=p[P],Q=u?u.get(j):null,Te=Q?Q.outputs:null;b=QE(j.inputs,P,b,Q?Q.inputs:null),R=QE(j.outputs,P,R,Te);const ze=null===b||null===y||sv(o)?null:yv(b,P,y);C.push(ze)}null!==b&&(b.hasOwnProperty("class")&&(o.flags|=8),b.hasOwnProperty("style")&&(o.flags|=16)),o.initialInputs=C,o.inputs=b,o.outputs=R}(s,u,p)}function zp(s,o,u){const l=u.directiveStart,d=u.directiveEnd,p=u.index,y=function mm(){return Mt.lFrame.currentDirectiveIndex}();try{ls(p);for(let C=l;C<d;C++){const b=s.data[C],R=o[C];Qn(C),(null!==b.hostBindings||0!==b.hostVars||null!==b.hostAttrs)&&_i(b,R)}}finally{ls(-1),Qn(y)}}function _i(s,o){null!==s.hostBindings&&s.hostBindings(1,o)}function mv(s,o,u){o.componentOffset=u,(s.components??(s.components=[])).push(o.index)}function _v(s,o,u){if(u){if(o.exportAs)for(let l=0;l<o.exportAs.length;l++)u[o.exportAs[l]]=s;hi(o)&&(u[""]=s)}}function Hi(s,o,u,l,d){s.data[l]=d;const p=d.factory||(d.factory=Ts(d.type)),y=new Ss(p,hi(d),Lh);s.blueprint[l]=y,u[l]=y,function Rb(s,o,u,l,d){const p=d.hostBindings;if(p){let y=s.hostBindingOpCodes;null===y&&(y=s.hostBindingOpCodes=[]);const C=~o.index;(function xb(s){let o=s.length;for(;o>0;){const u=s[--o];if("number"==typeof u&&u<0)return u}return 0})(y)!=C&&y.push(C),y.push(u,l,p)}}(s,o,l,U(s,u,d.hostVars,Ht),d)}function ms(s,o,u,l,d,p){const y=Fr(s,o);!function Fh(s,o,u,l,d,p,y){if(null==p)s.removeAttribute(o,d,u);else{const C=null==y?Le(p):y(p,l||"",d);s.setAttribute(o,d,C,u)}}(o[zt],y,p,s.value,u,l,d)}function Ma(s,o,u,l,d,p){const y=p[o];if(null!==y){const C=l.setInput;for(let b=0;b<y.length;){const R=y[b++],P=y[b++],j=y[b++];null!==C?l.setInput(u,j,R,P):u[P]=j}}}function yv(s,o,u){let l=null,d=0;for(;d<u.length;){const p=u[d];if(0!==p)if(5!==p){if("number"==typeof p)break;if(s.hasOwnProperty(p)){null===l&&(l=[]);const y=s[p];for(let C=0;C<y.length;C+=2)if(y[C]===o){l.push(p,y[C+1],u[d+1]);break}}d+=2}else d+=2;else d+=4}return l}function tI(s,o,u,l){return[s,!0,!1,o,null,0,l,u,null,null]}function nI(s,o){const u=br(o,s);if(Ks(u)){const l=u[Je];48&u[Xt]?gs(l,u,l.template,u[Hn]):u[js]>0&&Gp(u)}}function Gp(s){for(let l=Su(s);null!==l;l=Au(l))for(let d=Lr;d<l.length;d++){const p=l[d];if(Ks(p))if(512&p[Xt]){const y=p[Je];gs(y,p,y.template,p[Hn])}else p[js]>0&&Gp(p)}const u=s[Je].components;if(null!==u)for(let l=0;l<u.length;l++){const d=br(u[l],s);Ks(d)&&d[js]>0&&Gp(d)}}function rI(s,o){const u=br(o,s),l=u[Je];(function Mb(s,o){for(let u=o.length;u<s.blueprint.length;u++)o.push(s.blueprint[u])})(l,u),Ai(l,u,u[Hn])}function Wp(s,o){return s[Mi]?s[Ja][_n]=o:s[Mi]=o,s[Ja]=o,o}function Vh(s){for(;s;){s[Xt]|=32;const o=yh(s);if(Gs(s)&&!o)return s;s=o}return null}function Bh(s,o,u,l=!0){const d=o[$s];d.begin&&d.begin();try{gs(s,o,s.template,u)}catch(y){throw l&&aI(o,y),y}finally{d.end&&d.end()}}function qp(s,o,u){zd(0),o(s,u)}function vv(s){return s[Qa]||(s[Qa]=[])}function oI(s){return s.cleanup||(s.cleanup=[])}function aI(s,o){const u=s[Xa],l=u?u.get(Mp,null):null;l&&l.handleError(o)}function Kl(s,o,u,l,d){for(let p=0;p<u.length;){const y=u[p++],C=u[p++],b=o[y],R=s.data[y];null!==R.setInput?R.setInput(b,d,l,C):b[C]=d}}function Pu(s,o,u){const l=function xo(s,o){return fr(o[s])}(o,s);!function mp(s,o,u){s.setValue(o,u)}(s[zt],l,u)}function Vm(s,o,u){let l=u?s.styles:null,d=u?s.classes:null,p=0;if(null!==o)for(let y=0;y<o.length;y++){const C=o[y];"number"==typeof C?p=C:1==p?d=Ie(d,C):2==p&&(l=Ie(l,C+": "+o[++y]+";"))}u?s.styles=l:s.stylesWithoutHost=l,u?s.classes=d:s.classesWithoutHost=d}function Zl(s,o,u,l,d=!1){for(;null!==u;){const p=o[u.index];if(null!==p&&l.push(fr(p)),Ki(p))for(let C=Lr;C<p.length;C++){const b=p[C],R=b[Je].firstChild;null!==R&&Zl(b[Je],b,R,l)}const y=u.type;if(8&y)Zl(s,o,u.child,l);else if(32&y){const C=ps(u,o);let b;for(;b=C();)l.push(b)}else if(16&y){const C=bc(o,u);if(Array.isArray(C))l.push(...C);else{const b=yh(o[hr]);Zl(b[Je],b,C,l,!0)}}u=d?u.projectionNext:u.next}return l}class Yl{get rootNodes(){const o=this._lView,u=o[Je];return Zl(u,o,u.firstChild,[])}constructor(o,u){this._lView=o,this._cdRefInjectingView=u,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Hn]}set context(o){this._lView[Hn]=o}get destroyed(){return 128==(128&this._lView[Xt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[Pn];if(Ki(o)){const u=o[zs],l=u?u.indexOf(this):-1;l>-1&&(x(o,l),mu(u,l))}this._attachedToViewContainer=!1}k(this._lView[Je],this._lView)}onDestroy(o){Fm(this._lView[Je],this._lView,null,o)}markForCheck(){Vh(this._cdRefInjectingView||this._lView)}detach(){this._lView[Xt]&=-65}reattach(){this._lView[Xt]|=64}detectChanges(){Bh(this._lView[Je],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new we(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function yp(s,o){Ep(s,o,o[zt],2,null,null)}(this._lView[Je],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new we(902,!1);this._appRef=o}}class kb extends Yl{constructor(o){super(o),this._view=o}detectChanges(){const o=this._view;Bh(o[Je],o,o[Hn],!1)}checkNoChanges(){}get context(){return null}}class wv extends xh{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const u=vt(o);return new Ql(u,this.ngModule)}}function Ev(s){const o=[];for(let u in s)s.hasOwnProperty(u)&&o.push({propName:s[u],templateName:u});return o}class Bm{constructor(o,u){this.injector=o,this.parentInjector=u}get(o,u,l){l=Or(l);const d=this.injector.get(o,Nm,l);return d!==Nm||u===Nm?d:this.parentInjector.get(o,u,l)}}class Ql extends DE{get inputs(){return Ev(this.componentDef.inputs)}get outputs(){return Ev(this.componentDef.outputs)}constructor(o,u){super(),this.componentDef=o,this.ngModule=u,this.componentType=o.type,this.selector=function db(s){return s.map(lb).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!u}create(o,u,l,d){let p=(d=d||this.ngModule)instanceof Gl?d:d?.injector;p&&null!==this.componentDef.getStandaloneInjector&&(p=this.componentDef.getStandaloneInjector(p)||p);const y=p?new Bm(o,p):o,C=y.get(ev,null);if(null===C)throw new we(407,!1);const b=y.get(nb,null),R=C.createRenderer(null,this.componentDef),P=this.componentDef.selectors[0][0]||"div",j=l?function eN(s,o,u){return s.selectRootElement(o,u===F.ShadowDom)}(R,l,this.componentDef.encapsulation):_p(R,P,function uI(s){const o=s.toLowerCase();return"svg"===o?"svg":"math"===o?"math":null}(P)),Q=this.componentDef.onPush?288:272,ne=pv(0,null,null,1,0,null,null,null,null,null),Te=Lm(null,ne,null,Q,null,null,C,R,b,y,null);let ze,Qe;ha(Te);try{const mt=this.componentDef;let Lt,Oe=null;mt.findHostDirectiveDefs?(Lt=[],Oe=new Map,mt.findHostDirectiveDefs(mt,Lt,Oe),Lt.push(mt)):Lt=[mt];const qt=function Cv(s,o){const u=s[Je],l=Cn;return s[l]=o,Vp(u,l,2,"#host",null)}(Te,j),Gn=function lI(s,o,u,l,d,p,y,C){const b=d[Je];!function dI(s,o,u,l){for(const d of s)o.mergedAttrs=No(o.mergedAttrs,d.hostAttrs);null!==o.mergedAttrs&&(Vm(o,o.mergedAttrs,!0),null!==u&&Cp(l,u,o))}(l,s,o,y);const R=p.createRenderer(o,u),P=Lm(d,fv(u),null,u.onPush?32:16,d[s.index],s,p,R,C||null,null,null);return b.firstCreatePass&&mv(b,s,l.length-1),Wp(d,P),d[s.index]=P}(qt,j,mt,Lt,Te,C,R);Qe=tc(ne,Cn),j&&function hI(s,o,u,l){if(l)ga(s,u,["ng-version",RE.full]);else{const{attrs:d,classes:p}=function hb(s){const o=[],u=[];let l=1,d=2;for(;l<s.length;){let p=s[l];if("string"==typeof p)2===d?""!==p&&o.push(p,s[++l]):8===d&&u.push(p);else{if(!zo(d))break;d=p}l++}return{attrs:o,classes:u}}(o.selectors[0]);d&&ga(s,u,d),p&&p.length>0&&Sc(s,u,p.join(" "))}}(R,mt,j,l),void 0!==u&&function fI(s,o,u){const l=s.projection=[];for(let d=0;d<o.length;d++){const p=u[d];l.push(null!=p?Array.from(p):null)}}(Qe,this.ngContentSelectors,u),ze=function Ob(s,o,u,l,d,p){const y=Yn(),C=d[Je],b=Fr(y,d);XE(C,d,y,u,null,l);for(let P=0;P<u.length;P++)se(Vn(d,C,y.directiveStart+P,y),d);zp(C,d,y),b&&se(b,d);const R=Vn(d,C,y.directiveStart+y.componentOffset,y);if(s[Hn]=d[Hn]=R,null!==p)for(const P of p)P(R,o);return Bp(C,y,s),R}(Gn,mt,Lt,Oe,Te,[Tv]),Ai(ne,Te,null)}finally{Wd()}return new Iv(this.componentType,ze,xu(Qe,Te),Te,Qe)}}class Iv extends XD{constructor(o,u,l,d,p){super(),this.location=l,this._rootLView=d,this._tNode=p,this.instance=u,this.hostView=this.changeDetectorRef=new kb(d),this.componentType=o}setInput(o,u){const l=this._tNode.inputs;let d;if(null!==l&&(d=l[o])){const p=this._rootLView;Kl(p[Je],p,d,o,u),Vh(br(this._tNode.index,p))}}get injector(){return new va(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}function Tv(){const s=Yn();ac(_e()[Je],s)}function xc(s){return!!Pv(s)&&(Array.isArray(s)||!(s instanceof Map)&&Symbol.iterator in s)}function Pv(s){return null!==s&&("function"==typeof s||"object"==typeof s)}function xi(s,o,u){return!Object.is(s[o],u)&&(s[o]=u,!0)}function zm(s,o,u,l){const d=_e();return xi(d,bs(),o)&&(Vt(),ms(Nn(),d,s,o,u,l)),zm}function Nu(s,o,u,l){return xi(s,bs(),u)?o+Le(u)+l:Ht}function Fv(s,o,u,l,d,p,y,C){const b=_e(),R=Vt(),P=s+Cn,j=R.firstCreatePass?function yI(s,o,u,l,d,p,y,C,b){const R=o.consts,P=Vp(o,s,4,y||null,Ds(R,C));Hp(o,u,P,Ds(R,b)),ac(o,P);const j=P.tView=pv(2,P,l,d,p,o.directiveRegistry,o.pipeRegistry,null,o.schemas,R);return null!==o.queries&&(o.queries.template(o,P),j.queries=o.queries.embeddedTView(P)),P}(P,R,b,o,u,l,d,p,y):R.data[P];Li(j,!1);const Q=b[zt].createComment("");Dc(R,b,Q,j),se(Q,b),Wp(b,b[P]=tI(Q,b,Q,j)),tu(j)&&vn(R,b,j),null!=y&&jp(b,j,C)}function Gm(s){return function ri(s,o){return s[o]}(function jd(){return Mt.lFrame.contextLView}(),Cn+s)}function Xp(s,o,u){const l=_e();return xi(l,bs(),o)&&bt(Vt(),Nn(),l,s,o,l[zt],u,!1),Xp}function Jp(s,o,u,l,d){const y=d?"class":"style";Kl(s,u,o.inputs[y],y,l)}function Nc(s,o,u,l){const d=_e(),p=Vt(),y=Cn+s,C=d[zt],b=p.firstCreatePass?function Wm(s,o,u,l,d,p){const y=o.consts,b=Vp(o,s,2,l,Ds(y,d));return Hp(o,u,b,Ds(y,p)),null!==b.attrs&&Vm(b,b.attrs,!1),null!==b.mergedAttrs&&Vm(b,b.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,b),b}(y,p,d,o,u,l):p.data[y],R=d[y]=_p(C,o,function Zd(){return Mt.lFrame.currentNamespace}()),P=tu(b);return Li(b,!0),Cp(C,R,b),32!=(32&b.flags)&&Dc(p,d,R,b),0===function cl(){return Mt.lFrame.elementDepthCount}()&&se(R,d),function ll(){Mt.lFrame.elementDepthCount++}(),P&&(vn(p,d,b),Bp(p,b,d)),null!==l&&jp(d,b),Nc}function eg(){let s=Yn();rc()?function Bd(){Mt.lFrame.isParent=!1}():(s=s.parent,Li(s,!1));const o=s;!function dl(){Mt.lFrame.elementDepthCount--}();const u=Vt();return u.firstCreatePass&&(ac(u,s),bo(s)&&u.queries.elementEnd(s)),null!=o.classesWithoutHost&&function As(s){return 0!=(8&s.flags)}(o)&&Jp(u,o,_e(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function yl(s){return 0!=(16&s.flags)}(o)&&Jp(u,o,_e(),o.stylesWithoutHost,!1),eg}function Uv(s,o,u,l){return Nc(s,o,u,l),eg(),Uv}function jv(){return _e()}function qm(s){return!!s&&"function"==typeof s.then}function vI(s){return!!s&&"function"==typeof s.subscribe}const Zh=vI;function Km(s,o,u,l){const d=_e(),p=Vt(),y=Yn();return function Mc(s,o,u,l,d,p,y){const C=tu(l),R=s.firstCreatePass&&oI(s),P=o[Hn],j=vv(o);let Q=!0;if(3&l.type||y){const ze=Fr(l,o),Qe=y?y(ze):ze,mt=j.length,Lt=y?qt=>y(fr(qt[l.index])):l.index;let Oe=null;if(!y&&C&&(Oe=function rg(s,o,u,l){const d=s.cleanup;if(null!=d)for(let p=0;p<d.length-1;p+=2){const y=d[p];if(y===u&&d[p+1]===l){const C=o[Qa],b=d[p+2];return C.length>b?C[b]:null}"string"==typeof y&&(p+=2)}return null}(s,o,d,l.index)),null!==Oe)(Oe.__ngLastListenerFn__||Oe).__ngNextListenerFn__=p,Oe.__ngLastListenerFn__=p,Q=!1;else{p=wI(l,o,P,p,!1);const qt=u.listen(Qe,d,p);j.push(p,qt),R&&R.push(d,Lt,mt,mt+1)}}else p=wI(l,o,P,p,!1);const ne=l.outputs;let Te;if(Q&&null!==ne&&(Te=ne[d])){const ze=Te.length;if(ze)for(let Qe=0;Qe<ze;Qe+=2){const Gn=o[Te[Qe]][Te[Qe+1]].subscribe(p),Br=j.length;j.push(p,Gn),R&&R.push(d,l.index,Br,-(Br+1))}}}(p,d,d[zt],y,s,o,l),Km}function Zm(s,o,u,l){try{return Un(6,o,u),!1!==u(l)}catch(d){return aI(s,d),!1}finally{Un(7,o,u)}}function wI(s,o,u,l,d){return function p(y){if(y===Function)return l;Vh(s.componentOffset>-1?br(s.index,o):o);let b=Zm(o,u,l,y),R=p.__ngNextListenerFn__;for(;R;)b=Zm(o,u,R,y)&&b,R=R.__ngNextListenerFn__;return d&&!1===b&&(y.preventDefault(),y.returnValue=!1),b}}function Mu(s,o,u){return Wo(s,"",o,"",u),Mu}function Wo(s,o,u,l,d){const p=_e(),y=Nu(p,o,u,l);return y!==Ht&&bt(Vt(),Nn(),p,s,y,p[zt],d,!1),Wo}function Qv(s,o=""){const u=_e(),l=Vt(),d=s+Cn,p=l.firstCreatePass?Vp(l,d,1,o,null):l.data[d],y=u[d]=function Tc(s,o){return s.createText(o)}(u[zt],o);Dc(l,u,y,p),Li(p,!1)}function nd(s){return s_("",s,""),nd}function s_(s,o,u){const l=_e(),d=Nu(l,s,o,u);return d!==Ht&&Pu(l,qr(),d),s_}const fo=void 0;var Xb=["en",[["a","p"],["AM","PM"],fo],[["AM","PM"],fo,fo],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],fo,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],fo,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",fo,"{1} 'at' {0}",fo],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Qb(s){const u=Math.floor(Math.abs(s)),l=s.toString().replace(/^[^.]*\.?/,"").length;return 1===u&&0===l?1:5}];let Lc={};function u0(s){const o=function sf(s){return s.toLowerCase().replace(/_/g,"-")}(s);let u=_g(o);if(u)return u;const l=o.split("-")[0];if(u=_g(l),u)return u;if("en"===l)return Xb;throw new we(701,!1)}function jI(s){return u0(s)[Nt.PluralCase]}function _g(s){return s in Lc||(Lc[s]=cn.ng&&cn.ng.common&&cn.ng.common.locales&&cn.ng.common.locales[s]),Lc[s]}var Nt=(()=>((Nt=Nt||{})[Nt.LocaleId=0]="LocaleId",Nt[Nt.DayPeriodsFormat=1]="DayPeriodsFormat",Nt[Nt.DayPeriodsStandalone=2]="DayPeriodsStandalone",Nt[Nt.DaysFormat=3]="DaysFormat",Nt[Nt.DaysStandalone=4]="DaysStandalone",Nt[Nt.MonthsFormat=5]="MonthsFormat",Nt[Nt.MonthsStandalone=6]="MonthsStandalone",Nt[Nt.Eras=7]="Eras",Nt[Nt.FirstDayOfWeek=8]="FirstDayOfWeek",Nt[Nt.WeekendRange=9]="WeekendRange",Nt[Nt.DateFormat=10]="DateFormat",Nt[Nt.TimeFormat=11]="TimeFormat",Nt[Nt.DateTimeFormat=12]="DateTimeFormat",Nt[Nt.NumberSymbols=13]="NumberSymbols",Nt[Nt.NumberFormats=14]="NumberFormats",Nt[Nt.CurrencyCode=15]="CurrencyCode",Nt[Nt.CurrencySymbol=16]="CurrencySymbol",Nt[Nt.CurrencyName=17]="CurrencyName",Nt[Nt.Currencies=18]="Currencies",Nt[Nt.Directionality=19]="Directionality",Nt[Nt.PluralCase=20]="PluralCase",Nt[Nt.ExtraData=21]="ExtraData",Nt))();const Qo="en-US";let ks=Qo;class Dn{}class Eg{}function Ni(s,o){return new y0(s,o??null)}class y0 extends Dn{constructor(o,u){super(),this._parent=u,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new wv(this);const l=Cr(o);this._bootstrapComponents=Na(l.bootstrap),this._r3Injector=av(o,u,[{provide:Dn,useValue:this},{provide:xh,useValue:this.componentFactoryResolver}],ve(o),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(o)}get injector(){return this._r3Injector}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(u=>u()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class $c extends Eg{constructor(o){super(),this.moduleType=o}create(o){return new y0(this.moduleType,o)}}class ys extends Dn{constructor(o,u,l){super(),this.componentFactoryResolver=new wv(this),this.instance=null;const d=new CE([...o,{provide:Dn,useValue:this},{provide:xh,useValue:this.componentFactoryResolver}],u||xm(),l,new Set(["environment"]));this.injector=d,d.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(o){this.injector.onDestroy(o)}}function w_(s,o,u=null){return new ys(s,o,u).injector}let IS=(()=>{class s{constructor(u){this._injector=u,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(u){if(!u.standalone)return null;if(!this.cachedInjectors.has(u.id)){const l=Sh(0,u.type),d=l.length>0?w_([l],this._injector,`Standalone[${u.type.name}]`):null;this.cachedInjectors.set(u.id,d)}return this.cachedInjectors.get(u.id)}ngOnDestroy(){try{for(const u of this.cachedInjectors.values())null!==u&&u.destroy()}finally{this.cachedInjectors.clear()}}}return s.\u0275prov=ct({token:s,providedIn:"environment",factory:()=>new s(jt(Gl))}),s})();function Yr(s){s.getStandaloneInjector=o=>o.get(IS).getOrCreateStandaloneInjector(s)}function Ag(s){return o=>{setTimeout(s,void 0,o)}}const mo=class pf extends _.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,u,l){let d=o,p=u||(()=>null),y=l;if(o&&"object"==typeof o){const b=o;d=b.next?.bind(b),p=b.error?.bind(b),y=b.complete?.bind(b)}this.__isAsync&&(p=Ag(p),d&&(d=Ag(d)),y&&(y=Ag(y)));const C=super.subscribe({next:d,error:p,complete:y});return o instanceof z.w0&&o.add(C),C}};function pC(){return this._results[Symbol.iterator]()}class Rg{get changes(){return this._changes||(this._changes=new mo)}constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const u=Rg.prototype;u[Symbol.iterator]||(u[Symbol.iterator]=pC)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,u){return this._results.reduce(o,u)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,u){const l=this;l.dirty=!1;const d=function bi(s){return s.flat(Number.POSITIVE_INFINITY)}(o);(this._changesDetected=!function Rl(s,o,u){if(s.length!==o.length)return!1;for(let l=0;l<s.length;l++){let d=s[l],p=o[l];if(u&&(d=u(d),p=u(p)),p!==d)return!1}return!0}(l._results,d,u))&&(l._results=d,l.length=d.length,l.last=d[this.length-1],l.first=d[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let gf=(()=>{class s{}return s.__NG_ELEMENT_ID__=bS,s})();const gC=gf,mC=class extends gC{constructor(o,u,l){super(),this._declarationLView=o,this._declarationTContainer=u,this.elementRef=l}createEmbeddedView(o,u){const l=this._declarationTContainer.tView,d=Lm(this._declarationLView,l,o,16,null,l.declTNode,null,null,null,null,u||null);d[Co]=this._declarationLView[this._declarationTContainer.index];const y=this._declarationLView[ki];return null!==y&&(d[ki]=y.createEmbeddedView(l)),Ai(l,d,o),new Yl(d)}};function bS(){return T_(Yn(),_e())}function T_(s,o){return 4&s.type?new mC(o,s,xu(s,o)):null}let D_=(()=>{class s{}return s.__NG_ELEMENT_ID__=_C,s})();function _C(){return vC(Yn(),_e())}const SS=D_,b0=class extends SS{constructor(o,u,l){super(),this._lContainer=o,this._hostTNode=u,this._hostLView=l}get element(){return xu(this._hostTNode,this._hostLView)}get injector(){return new va(this._hostTNode,this._hostLView)}get parentInjector(){const o=Xn(this._hostTNode,this._hostLView);if(Mo(o)){const u=hu(o,this._hostLView),l=_a(o);return new va(u[Je].data[l+8],u)}return new va(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const u=yC(this._lContainer);return null!==u&&u[o]||null}get length(){return this._lContainer.length-Lr}createEmbeddedView(o,u,l){let d,p;"number"==typeof l?d=l:null!=l&&(d=l.index,p=l.injector);const y=o.createEmbeddedView(u||{},p);return this.insert(y,d),y}createComponent(o,u,l,d,p){const y=o&&!function _c(s){return"function"==typeof s}(o);let C;if(y)C=u;else{const j=u||{};C=j.index,l=j.injector,d=j.projectableNodes,p=j.environmentInjector||j.ngModuleRef}const b=y?o:new Ql(vt(o)),R=l||this.parentInjector;if(!p&&null==b.ngModule){const Q=(y?R:this.parentInjector).get(Gl,null);Q&&(p=Q)}const P=b.create(R,d,void 0,p);return this.insert(P.hostView,C),P}insert(o,u){const l=o._lView,d=l[Je];if(function Ld(s){return Ki(s[Pn])}(l)){const P=this.indexOf(o);if(-1!==P)this.detach(P);else{const j=l[Pn],Q=new b0(j,j[Dr],j[Pn]);Q.detach(Q.indexOf(o))}}const p=this._adjustIndex(u),y=this._lContainer;!function f(s,o,u,l){const d=Lr+l,p=u.length;l>0&&(u[d-1][_n]=o),l<p-Lr?(o[_n]=u[d],xl(u,Lr+l,o)):(u.push(o),o[_n]=null),o[Pn]=u;const y=o[Co];null!==y&&u!==y&&function m(s,o){const u=s[Do];o[hr]!==o[Pn][Pn][hr]&&(s[eu]=!0),null===u?s[Do]=[o]:u.push(o)}(y,o);const C=o[ki];null!==C&&C.insertView(s),o[Xt]|=64}(d,l,y,p);const C=Ra(p,y),b=l[zt],R=Rs(b,y[ia]);return null!==R&&function Ry(s,o,u,l,d,p){l[Tr]=d,l[Dr]=o,Ep(s,l,u,1,d,p)}(d,y[Dr],b,l,R,C),o.attachToViewContainerRef(),xl(S0(y),p,o),o}move(o,u){return this.insert(o,u)}indexOf(o){const u=yC(this._lContainer);return null!==u?u.indexOf(o):-1}remove(o){const u=this._adjustIndex(o,-1),l=x(this._lContainer,u);l&&(mu(S0(this._lContainer),u),k(l[Je],l))}detach(o){const u=this._adjustIndex(o,-1),l=x(this._lContainer,u);return l&&null!=mu(S0(this._lContainer),u)?new Yl(l):null}_adjustIndex(o,u=0){return o??this.length+u}};function yC(s){return s[zs]}function S0(s){return s[zs]||(s[zs]=[])}function vC(s,o){let u;const l=o[s.index];if(Ki(l))u=l;else{let d;if(8&s.type)d=fr(l);else{const p=o[zt];d=p.createComment("");const y=Fr(s,o);Wt(p,Rs(p,y),d,function vp(s,o){return s.nextSibling(o)}(p,y),!1)}o[s.index]=u=tI(l,o,d,s),Wp(o,u)}return new b0(u,s,o)}class xg{constructor(o){this.queryList=o,this.matches=null}clone(){return new xg(this.queryList)}setDirty(){this.queryList.setDirty()}}class Fu{constructor(o=[]){this.queries=o}createEmbeddedView(o){const u=o.queries;if(null!==u){const l=null!==o.contentQueries?o.contentQueries[0]:u.length,d=[];for(let p=0;p<l;p++){const y=u.getByIndex(p);d.push(this.queries[y.indexInDeclarationView].clone())}return new Fu(d)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let u=0;u<this.queries.length;u++)null!==A0(o,u).matches&&this.queries[u].setDirty()}}class mf{constructor(o,u,l=null){this.predicate=o,this.flags=u,this.read=l}}class _f{constructor(o=[]){this.queries=o}elementStart(o,u){for(let l=0;l<this.queries.length;l++)this.queries[l].elementStart(o,u)}elementEnd(o){for(let u=0;u<this.queries.length;u++)this.queries[u].elementEnd(o)}embeddedTView(o){let u=null;for(let l=0;l<this.length;l++){const d=null!==u?u.length:0,p=this.getByIndex(l).embeddedTView(o,d);p&&(p.indexInDeclarationView=l,null!==u?u.push(p):u=[p])}return null!==u?new _f(u):null}template(o,u){for(let l=0;l<this.queries.length;l++)this.queries[l].template(o,u)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class yf{constructor(o,u=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=u}elementStart(o,u){this.isApplyingToNode(u)&&this.matchTNode(o,u)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,u){this.elementStart(o,u)}embeddedTView(o,u){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,u),new yf(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const u=this._declarationNodeIndex;let l=o.parent;for(;null!==l&&8&l.type&&l.index!==u;)l=l.parent;return u===(null!==l?l.index:-1)}return this._appliesToNextNode}matchTNode(o,u){const l=this.metadata.predicate;if(Array.isArray(l))for(let d=0;d<l.length;d++){const p=l[d];this.matchTNodeWithReadOption(o,u,wC(u,p)),this.matchTNodeWithReadOption(o,u,ya(u,o,p,!1,!1))}else l===gf?4&u.type&&this.matchTNodeWithReadOption(o,u,-1):this.matchTNodeWithReadOption(o,u,ya(u,o,l,!1,!1))}matchTNodeWithReadOption(o,u,l){if(null!==l){const d=this.metadata.read;if(null!==d)if(d===Ph||d===D_||d===gf&&4&u.type)this.addMatch(u.index,-2);else{const p=ya(u,o,d,!1,!1);null!==p&&this.addMatch(u.index,p)}else this.addMatch(u.index,l)}}addMatch(o,u){null===this.matches?this.matches=[o,u]:this.matches.push(o,u)}}function wC(s,o){const u=s.localNames;if(null!==u)for(let l=0;l<u.length;l+=2)if(u[l]===o)return u[l+1];return null}function Uu(s,o,u,l){return-1===u?function EC(s,o){return 11&s.type?xu(s,o):4&s.type?T_(s,o):null}(o,s):-2===u?function IC(s,o,u){return u===Ph?xu(o,s):u===gf?T_(o,s):u===D_?vC(o,s):void 0}(s,o,l):Vn(s,s[Je],u,o)}function ud(s,o,u,l){const d=o[ki].queries[l];if(null===d.matches){const p=s.data,y=u.matches,C=[];for(let b=0;b<y.length;b+=2){const R=y[b];C.push(R<0?null:Uu(o,p[R],y[b+1],u.metadata.read))}d.matches=C}return d.matches}function b_(s,o,u,l){const d=s.queries.getByIndex(u),p=d.matches;if(null!==p){const y=ud(s,o,d,u);for(let C=0;C<p.length;C+=2){const b=p[C];if(b>0)l.push(y[C/2]);else{const R=p[C+1],P=o[-b];for(let j=Lr;j<P.length;j++){const Q=P[j];Q[Co]===Q[Pn]&&b_(Q[Je],Q,R,l)}if(null!==P[Do]){const j=P[Do];for(let Q=0;Q<j.length;Q++){const ne=j[Q];b_(ne[Je],ne,R,l)}}}}}return l}function S_(s){const o=_e(),u=Vt(),l=au();zd(l+1);const d=A0(u,l);if(s.dirty&&function iu(s){return 4==(4&s[Xt])}(o)===(2==(2&d.metadata.flags))){if(null===d.matches)s.reset([]);else{const p=d.crossesNgTemplate?b_(u,o,l,[]):ud(u,o,d,l);s.reset(p,Np),s.notifyOnChanges()}return!0}return!1}function R_(s,o,u,l){const d=Vt();if(d.firstCreatePass){const p=Yn();(function Pg(s,o,u){null===s.queries&&(s.queries=new _f),s.queries.track(new yf(o,u))})(d,new mf(o,u,l),p.index),function Ng(s,o){const u=s.contentQueries||(s.contentQueries=[]);o!==(u.length?u[u.length-1]:-1)&&u.push(s.queries.length-1,o)}(d,s),2==(2&u)&&(d.staticContentQueries=!0)}!function x_(s,o,u){const l=new Rg(4==(4&u));Fm(s,o,l,l.destroy),null===o[ki]&&(o[ki]=new Fu),o[ki].queries.push(new xg(l))}(d,_e(),u)}function Gc(){return function es(s,o){return s[ki].queries[o].queryList}(_e(),au())}function A0(s,o){return s.queries.getByIndex(o)}function P_(s){return!!Cr(s)}function If(...s){}const V0=new an("Application Initializer");let L_=(()=>{class s{constructor(u){this.appInits=u,this.resolve=If,this.reject=If,this.initialized=!1,this.done=!1,this.donePromise=new Promise((l,d)=>{this.resolve=l,this.reject=d})}runInitializers(){if(this.initialized)return;const u=[],l=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let d=0;d<this.appInits.length;d++){const p=this.appInits[d]();if(qm(p))u.push(p);else if(Zh(p)){const y=new Promise((C,b)=>{p.subscribe({complete:C,error:b})});u.push(y)}}Promise.all(u).then(()=>{l()}).catch(d=>{this.reject(d)}),0===u.length&&l(),this.initialized=!0}}return s.\u0275fac=function(u){return new(u||s)(jt(V0,8))},s.\u0275prov=ct({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const B0=new an("AppId",{providedIn:"root",factory:function j0(){return`${hd()}${hd()}${hd()}`}});function hd(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Cf=new an("Platform Initializer"),Fg=new an("Platform ID",{providedIn:"platform",factory:()=>"unknown"});let LC=(()=>{class s{log(u){console.log(u)}warn(u){console.warn(u)}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=ct({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();const F_=new an("LocaleId",{providedIn:"root",factory:()=>Fn(F_,gt.Optional|gt.SkipSelf)||function FC(){return typeof $localize<"u"&&$localize.locale||Qo}()}),UC=new an("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class BS{constructor(o,u){this.ngModuleFactory=o,this.componentFactories=u}}let jS=(()=>{class s{compileModuleSync(u){return new $c(u)}compileModuleAsync(u){return Promise.resolve(this.compileModuleSync(u))}compileModuleAndAllComponentsSync(u){const l=this.compileModuleSync(u),p=Na(Cr(u).declarations).reduce((y,C)=>{const b=vt(C);return b&&y.push(new Ql(b)),y},[]);return new BS(l,p)}compileModuleAndAllComponentsAsync(u){return Promise.resolve(this.compileModuleAndAllComponentsSync(u))}clearCache(){}clearCacheFor(u){}getModuleId(u){}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=ct({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const Vg=(()=>Promise.resolve(0))();function vo(s){typeof Zone>"u"?Vg.then(()=>{s&&s.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",s)}class Gi{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:u=!1,shouldCoalesceRunChangeDetection:l=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new mo(!1),this.onMicrotaskEmpty=new mo(!1),this.onStable=new mo(!1),this.onError=new mo(!1),typeof Zone>"u")throw new we(908,!1);Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!l&&u,d.shouldCoalesceRunChangeDetection=l,d.lastRequestAnimationFrameId=-1,d.nativeRequestAnimationFrame=function z0(){let s=cn.requestAnimationFrame,o=cn.cancelAnimationFrame;if(typeof Zone<"u"&&s&&o){const u=s[Zone.__symbol__("OriginalDelegate")];u&&(s=u);const l=o[Zone.__symbol__("OriginalDelegate")];l&&(o=l)}return{nativeRequestAnimationFrame:s,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function HS(s){const o=()=>{!function HC(s){s.isCheckStableRunning||-1!==s.lastRequestAnimationFrameId||(s.lastRequestAnimationFrameId=s.nativeRequestAnimationFrame.call(cn,()=>{s.fakeTopEventTask||(s.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{s.lastRequestAnimationFrameId=-1,G0(s),s.isCheckStableRunning=!0,U_(s),s.isCheckStableRunning=!1},void 0,()=>{},()=>{})),s.fakeTopEventTask.invoke()}),G0(s))}(s)};s._inner=s._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(u,l,d,p,y,C)=>{try{return Tf(s),u.invokeTask(d,p,y,C)}finally{(s.shouldCoalesceEventChangeDetection&&"eventTask"===p.type||s.shouldCoalesceRunChangeDetection)&&o(),V_(s)}},onInvoke:(u,l,d,p,y,C,b)=>{try{return Tf(s),u.invoke(d,p,y,C,b)}finally{s.shouldCoalesceRunChangeDetection&&o(),V_(s)}},onHasTask:(u,l,d,p)=>{u.hasTask(d,p),l===d&&("microTask"==p.change?(s._hasPendingMicrotasks=p.microTask,G0(s),U_(s)):"macroTask"==p.change&&(s.hasPendingMacrotasks=p.macroTask))},onHandleError:(u,l,d,p)=>(u.handleError(d,p),s.runOutsideAngular(()=>s.onError.emit(p)),!1)})}(d)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Gi.isInAngularZone())throw new we(909,!1)}static assertNotInAngularZone(){if(Gi.isInAngularZone())throw new we(909,!1)}run(o,u,l){return this._inner.run(o,u,l)}runTask(o,u,l,d){const p=this._inner,y=p.scheduleEventTask("NgZoneEvent: "+d,o,$C,If,If);try{return p.runTask(y,u,l)}finally{p.cancelTask(y)}}runGuarded(o,u,l){return this._inner.runGuarded(o,u,l)}runOutsideAngular(o){return this._outer.run(o)}}const $C={};function U_(s){if(0==s._nesting&&!s.hasPendingMicrotasks&&!s.isStable)try{s._nesting++,s.onMicrotaskEmpty.emit(null)}finally{if(s._nesting--,!s.hasPendingMicrotasks)try{s.runOutsideAngular(()=>s.onStable.emit(null))}finally{s.isStable=!0}}}function G0(s){s.hasPendingMicrotasks=!!(s._hasPendingMicrotasks||(s.shouldCoalesceEventChangeDetection||s.shouldCoalesceRunChangeDetection)&&-1!==s.lastRequestAnimationFrameId)}function Tf(s){s._nesting++,s.isStable&&(s.isStable=!1,s.onUnstable.emit(null))}function V_(s){s._nesting--,U_(s)}class zS{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new mo,this.onMicrotaskEmpty=new mo,this.onStable=new mo,this.onError=new mo}run(o,u,l){return o.apply(u,l)}runGuarded(o,u,l){return o.apply(u,l)}runOutsideAngular(o){return o()}runTask(o,u,l,d){return o.apply(u,l)}}const W0=new an(""),B_=new an("");let q0,zC=(()=>{class s{constructor(u,l,d){this._ngZone=u,this.registry=l,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,q0||(function WC(s){q0=s}(d),d.addToWindow(l)),this._watchAngularEvents(),u.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Gi.assertNotInAngularZone(),vo(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())vo(()=>{for(;0!==this._callbacks.length;){let u=this._callbacks.pop();clearTimeout(u.timeoutId),u.doneCb(this._didWork)}this._didWork=!1});else{let u=this.getPendingTasks();this._callbacks=this._callbacks.filter(l=>!l.updateCb||!l.updateCb(u)||(clearTimeout(l.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(u=>({source:u.source,creationLocation:u.creationLocation,data:u.data})):[]}addCallback(u,l,d){let p=-1;l&&l>0&&(p=setTimeout(()=>{this._callbacks=this._callbacks.filter(y=>y.timeoutId!==p),u(this._didWork,this.getPendingTasks())},l)),this._callbacks.push({doneCb:u,timeoutId:p,updateCb:d})}whenStable(u,l,d){if(d&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(u,l,d),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(u){this.registry.registerApplication(u,this)}unregisterApplication(u){this.registry.unregisterApplication(u)}findProviders(u,l,d){return[]}}return s.\u0275fac=function(u){return new(u||s)(jt(Gi),jt(GC),jt(B_))},s.\u0275prov=ct({token:s,factory:s.\u0275fac}),s})(),GC=(()=>{class s{constructor(){this._applications=new Map}registerApplication(u,l){this._applications.set(u,l)}unregisterApplication(u){this._applications.delete(u)}unregisterAllApplications(){this._applications.clear()}getTestability(u){return this._applications.get(u)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(u,l=!0){return q0?.findTestabilityInTree(this,u,l)??null}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=ct({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();const ju=!1;let qc=null;const $u=new an("AllowMultipleToken"),Kc=new an("PlatformDestroyListeners"),K0=new an("appBootstrapListener");class qC{constructor(o,u){this.name=o,this.token=u}}function Zc(s,o,u=[]){const l=`Platform: ${o}`,d=new an(l);return(p=[])=>{let y=jg();if(!y||y.injector.get($u,!1)){const C=[...u,...p,{provide:d,useValue:!0}];s?s(C):function qS(s){if(qc&&!qc.get($u,!1))throw new we(400,!1);qc=s;const o=s.get(j_);(function Bg(s){const o=s.get(Cf,null);o&&o.forEach(u=>u())})(s)}(function bf(s=[],o){return Mh.create({name:o,providers:[{provide:Ac,useValue:"platform"},{provide:Kc,useValue:new Set([()=>qc=null])},...s]})}(C,l))}return function fd(s){const o=jg();if(!o)throw new we(401,!1);return o}()}}function jg(){return qc?.get(j_)??null}let j_=(()=>{class s{constructor(u){this._injector=u,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(u,l){const d=function Y0(s,o){let u;return u="noop"===s?new zS:("zone.js"===s?void 0:s)||new Gi(o),u}(l?.ngZone,function Z0(s){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!s||!s.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!s||!s.ngZoneRunCoalescing)||!1}}(l)),p=[{provide:Gi,useValue:d}];return d.run(()=>{const y=Mh.create({providers:p,parent:this.injector,name:u.moduleType.name}),C=u.create(y),b=C.injector.get(Mp,null);if(!b)throw new we(402,!1);return d.runOutsideAngular(()=>{const R=d.onError.subscribe({next:P=>{b.handleError(P)}});C.onDestroy(()=>{pd(this._modules,C),R.unsubscribe()})}),function ZC(s,o,u){try{const l=u();return qm(l)?l.catch(d=>{throw o.runOutsideAngular(()=>s.handleError(d)),d}):l}catch(l){throw o.runOutsideAngular(()=>s.handleError(l)),l}}(b,d,()=>{const R=C.injector.get(L_);return R.runInitializers(),R.donePromise.then(()=>(function d_(s){ye(s,"Expected localeId to be defined"),"string"==typeof s&&(ks=s.toLowerCase().replace(/_/g,"-"))}(C.injector.get(F_,Qo)||Qo),this._moduleDoBootstrap(C),C))})})}bootstrapModule(u,l=[]){const d=Q0({},l);return function GS(s,o,u){const l=new $c(u);return Promise.resolve(l)}(0,0,u).then(p=>this.bootstrapModuleFactory(p,d))}_moduleDoBootstrap(u){const l=u.injector.get($g);if(u._bootstrapComponents.length>0)u._bootstrapComponents.forEach(d=>l.bootstrap(d));else{if(!u.instance.ngDoBootstrap)throw new we(-403,!1);u.instance.ngDoBootstrap(l)}this._modules.push(u)}onDestroy(u){this._destroyListeners.push(u)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new we(404,!1);this._modules.slice().forEach(l=>l.destroy()),this._destroyListeners.forEach(l=>l());const u=this._injector.get(Kc,null);u&&(u.forEach(l=>l()),u.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return s.\u0275fac=function(u){return new(u||s)(jt(Mh))},s.\u0275prov=ct({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();function Q0(s,o){return Array.isArray(o)?o.reduce(Q0,s):{...s,...o}}let $g=(()=>{class s{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(u,l,d){this._zone=u,this._injector=l,this._exceptionHandler=d,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const p=new L.y(C=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{C.next(this._stable),C.complete()})}),y=new L.y(C=>{let b;this._zone.runOutsideAngular(()=>{b=this._zone.onStable.subscribe(()=>{Gi.assertNotInAngularZone(),vo(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,C.next(!0))})})});const R=this._zone.onUnstable.subscribe(()=>{Gi.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{C.next(!1)}))});return()=>{b.unsubscribe(),R.unsubscribe()}});this.isStable=(0,re.T)(p,y.pipe((0,ue.B)()))}bootstrap(u,l){const d=u instanceof DE;if(!this._injector.get(L_).done){!d&&Gr(u);throw new we(405,ju)}let y;y=d?u:this._injector.get(xh).resolveComponentFactory(u),this.componentTypes.push(y.componentType);const C=function Hu(s){return s.isBoundToModule}(y)?void 0:this._injector.get(Dn),R=y.create(Mh.NULL,[],l||y.selector,C),P=R.location.nativeElement,j=R.injector.get(W0,null);return j?.registerApplication(P),R.onDestroy(()=>{this.detachView(R.hostView),pd(this.components,R),j?.unregisterApplication(P)}),this._loadComponent(R),R}tick(){if(this._runningTick)throw new we(101,!1);try{this._runningTick=!0;for(let u of this._views)u.detectChanges()}catch(u){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(u))}finally{this._runningTick=!1}}attachView(u){const l=u;this._views.push(l),l.attachToAppRef(this)}detachView(u){const l=u;pd(this._views,l),l.detachFromAppRef()}_loadComponent(u){this.attachView(u.hostView),this.tick(),this.components.push(u);const l=this._injector.get(K0,[]);l.push(...this._bootstrapListeners),l.forEach(d=>d(u))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(u=>u()),this._views.slice().forEach(u=>u.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(u){return this._destroyListeners.push(u),()=>pd(this._destroyListeners,u)}destroy(){if(this._destroyed)throw new we(406,!1);const u=this._injector;u.destroy&&!u.destroyed&&u.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return s.\u0275fac=function(u){return new(u||s)(jt(Gi),jt(Gl),jt(Mp))},s.\u0275prov=ct({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function pd(s,o){const u=s.indexOf(o);u>-1&&s.splice(u,1)}function ZS(){return!1}let Hg=(()=>{class s{}return s.__NG_ELEMENT_ID__=md,s})();function md(s){return function Yc(s,o,u){if(Qu(s)&&!u){const l=br(s.index,o);return new Yl(l,l)}return 47&s.type?new Yl(o[hr],o):null}(Yn(),_e(),16==(16&s))}class nw{constructor(){}supports(o){return xc(o)}create(o){return new G_(o)}}const z_=(s,o)=>o;class G_{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||z_}forEachItem(o){let u;for(u=this._itHead;null!==u;u=u._next)o(u)}forEachOperation(o){let u=this._itHead,l=this._removalsHead,d=0,p=null;for(;u||l;){const y=!l||u&&u.currentIndex<rw(l,d,p)?u:l,C=rw(y,d,p),b=y.currentIndex;if(y===l)d--,l=l._nextRemoved;else if(u=u._next,null==y.previousIndex)d++;else{p||(p=[]);const R=C-d,P=b-d;if(R!=P){for(let Q=0;Q<R;Q++){const ne=Q<p.length?p[Q]:p[Q]=0,Te=ne+Q;P<=Te&&Te<R&&(p[Q]=ne+1)}p[y.previousIndex]=P-R}}C!==b&&o(y,C,b)}}forEachPreviousItem(o){let u;for(u=this._previousItHead;null!==u;u=u._nextPrevious)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachMovedItem(o){let u;for(u=this._movesHead;null!==u;u=u._nextMoved)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}forEachIdentityChange(o){let u;for(u=this._identityChangesHead;null!==u;u=u._nextIdentityChange)o(u)}diff(o){if(null==o&&(o=[]),!xc(o))throw new we(900,!1);return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let d,p,y,u=this._itHead,l=!1;if(Array.isArray(o)){this.length=o.length;for(let C=0;C<this.length;C++)p=o[C],y=this._trackByFn(C,p),null!==u&&Object.is(u.trackById,y)?(l&&(u=this._verifyReinsertion(u,p,y,C)),Object.is(u.item,p)||this._addIdentityChange(u,p)):(u=this._mismatch(u,p,y,C),l=!0),u=u._next}else d=0,function _I(s,o){if(Array.isArray(s))for(let u=0;u<s.length;u++)o(s[u]);else{const u=s[Symbol.iterator]();let l;for(;!(l=u.next()).done;)o(l.value)}}(o,C=>{y=this._trackByFn(d,C),null!==u&&Object.is(u.trackById,y)?(l&&(u=this._verifyReinsertion(u,C,y,d)),Object.is(u.item,C)||this._addIdentityChange(u,C)):(u=this._mismatch(u,C,y,d),l=!0),u=u._next,d++}),this.length=d;return this._truncate(u),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,u,l,d){let p;return null===o?p=this._itTail:(p=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(l,null))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._reinsertAfter(o,p,d)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(l,d))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._moveAfter(o,p,d)):o=this._addAfter(new JC(u,l),p,d),o}_verifyReinsertion(o,u,l,d){let p=null===this._unlinkedRecords?null:this._unlinkedRecords.get(l,null);return null!==p?o=this._reinsertAfter(p,o._prev,d):o.currentIndex!=d&&(o.currentIndex=d,this._addToMoves(o,d)),o}_truncate(o){for(;null!==o;){const u=o._next;this._addToRemovals(this._unlink(o)),o=u}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,u,l){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const d=o._prevRemoved,p=o._nextRemoved;return null===d?this._removalsHead=p:d._nextRemoved=p,null===p?this._removalsTail=d:p._prevRemoved=d,this._insertAfter(o,u,l),this._addToMoves(o,l),o}_moveAfter(o,u,l){return this._unlink(o),this._insertAfter(o,u,l),this._addToMoves(o,l),o}_addAfter(o,u,l){return this._insertAfter(o,u,l),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,u,l){const d=null===u?this._itHead:u._next;return o._next=d,o._prev=u,null===d?this._itTail=o:d._prev=o,null===u?this._itHead=o:u._next=o,null===this._linkedRecords&&(this._linkedRecords=new vd),this._linkedRecords.put(o),o.currentIndex=l,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const u=o._prev,l=o._next;return null===u?this._itHead=l:u._next=l,null===l?this._itTail=u:l._prev=u,o}_addToMoves(o,u){return o.previousIndex===u||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new vd),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,u){return o.item=u,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class JC{constructor(o,u){this.item=o,this.trackById=u,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Qc{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,u){let l;for(l=this._head;null!==l;l=l._nextDup)if((null===u||u<=l.currentIndex)&&Object.is(l.trackById,o))return l;return null}remove(o){const u=o._prevDup,l=o._nextDup;return null===u?this._head=l:u._nextDup=l,null===l?this._tail=u:l._prevDup=u,null===this._head}}class vd{constructor(){this.map=new Map}put(o){const u=o.trackById;let l=this.map.get(u);l||(l=new Qc,this.map.set(u,l)),l.add(o)}get(o,u){const d=this.map.get(o);return d?d.get(o,u):null}remove(o){const u=o.trackById;return this.map.get(u).remove(o)&&this.map.delete(u),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function rw(s,o,u){const l=s.previousIndex;if(null===l)return l;let d=0;return u&&l<u.length&&(d=u[l]),l+o+d}class Xc{constructor(){}supports(o){return o instanceof Map||Pv(o)}create(){return new nA}}class nA{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let u;for(u=this._mapHead;null!==u;u=u._next)o(u)}forEachPreviousItem(o){let u;for(u=this._previousMapHead;null!==u;u=u._nextPrevious)o(u)}forEachChangedItem(o){let u;for(u=this._changesHead;null!==u;u=u._nextChanged)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}diff(o){if(o){if(!(o instanceof Map||Pv(o)))throw new we(900,!1)}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let u=this._mapHead;if(this._appendAfter=null,this._forEach(o,(l,d)=>{if(u&&u.key===d)this._maybeAddToChanges(u,l),this._appendAfter=u,u=u._next;else{const p=this._getOrCreateRecordForKey(d,l);u=this._insertBeforeOrAppend(u,p)}}),u){u._prev&&(u._prev._next=null),this._removalsHead=u;for(let l=u;null!==l;l=l._nextRemoved)l===this._mapHead&&(this._mapHead=null),this._records.delete(l.key),l._nextRemoved=l._next,l.previousValue=l.currentValue,l.currentValue=null,l._prev=null,l._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,u){if(o){const l=o._prev;return u._next=o,u._prev=l,o._prev=u,l&&(l._next=u),o===this._mapHead&&(this._mapHead=u),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=u,u._prev=this._appendAfter):this._mapHead=u,this._appendAfter=u,null}_getOrCreateRecordForKey(o,u){if(this._records.has(o)){const d=this._records.get(o);this._maybeAddToChanges(d,u);const p=d._prev,y=d._next;return p&&(p._next=y),y&&(y._prev=p),d._next=null,d._prev=null,d}const l=new Rf(o);return this._records.set(o,l),l.currentValue=u,this._addToAdditions(l),l}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,u){Object.is(u,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=u,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,u){o instanceof Map?o.forEach(u):Object.keys(o).forEach(l=>u(o[l],l))}}class Rf{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function iw(){return new Ga([new nw])}let Ga=(()=>{class s{constructor(u){this.factories=u}static create(u,l){if(null!=l){const d=l.factories.slice();u=u.concat(d)}return new s(u)}static extend(u){return{provide:s,useFactory:l=>s.create(u,l||iw()),deps:[[s,new yt,new Uo]]}}find(u){const l=this.factories.find(d=>d.supports(u));if(null!=l)return l;throw new we(901,!1)}}return s.\u0275prov=ct({token:s,providedIn:"root",factory:iw}),s})();function eT(){return new W_([new Xc])}let W_=(()=>{class s{constructor(u){this.factories=u}static create(u,l){if(l){const d=l.factories.slice();u=u.concat(d)}return new s(u)}static extend(u){return{provide:s,useFactory:l=>s.create(u,l||eT()),deps:[[s,new yt,new Uo]]}}find(u){const l=this.factories.find(d=>d.supports(u));if(l)return l;throw new we(901,!1)}}return s.\u0275prov=ct({token:s,providedIn:"root",factory:eT}),s})();const nT=Zc(null,"core",[]);let sA=(()=>{class s{constructor(u){}}return s.\u0275fac=function(u){return new(u||s)(jt($g))},s.\u0275mod=ie({type:s}),s.\u0275inj=Tt({}),s})();function rT(s){return"boolean"==typeof s?s:null!=s&&"false"!==s}},3942:(wt,Pe,B)=>{B.d(Pe,{Z:()=>qe});var _=B(2090),z=B(4859),L=B(6881),re=B(1877);class ue{constructor(we,Me){this._delegate=we,this.firebase=Me,(0,L._addComponent)(we,new z.wA("app-compat",()=>this,"PUBLIC")),this.container=we.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(we){this._delegate.automaticDataCollectionEnabled=we}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(we=>{this._delegate.checkDestroyed(),we()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,L.deleteApp)(this._delegate)))}_getService(we,Me=L._DEFAULT_ENTRY_NAME){var Le;this._delegate.checkDestroyed();const je=this._delegate.container.getProvider(we);return!je.isInitialized()&&"EXPLICIT"===(null===(Le=je.getComponent())||void 0===Le?void 0:Le.instantiationMode)&&je.initialize(),je.getImmediate({identifier:Me})}_removeServiceInstance(we,Me=L._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(we).clearInstance(Me)}_addComponent(we){(0,L._addComponent)(this._delegate,we)}_addOrOverwriteComponent(we){(0,L._addOrOverwriteComponent)(this._delegate,we)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Ce=new _.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),q=function Ie(){const ot=function ve(ot){const we={},Me={__esModule:!0,initializeApp:function Ae(Fe,ae={}){const tt=L.initializeApp(Fe,ae);if((0,_.r3)(we,tt.name))return we[tt.name];const St=new ot(tt,Me);return we[tt.name]=St,St},app:je,registerVersion:L.registerVersion,setLogLevel:L.setLogLevel,onLog:L.onLog,apps:null,SDK_VERSION:L.SDK_VERSION,INTERNAL:{registerComponent:function ke(Fe){const ae=Fe.name,tt=ae.replace("-compat","");if(L._registerComponent(Fe)&&"PUBLIC"===Fe.type){const St=(st=je())=>{if("function"!=typeof st[tt])throw Ce.create("invalid-app-argument",{appName:ae});return st[tt]()};void 0!==Fe.serviceProps&&(0,_.ZB)(St,Fe.serviceProps),Me[tt]=St,ot.prototype[tt]=function(...st){return this._getService.bind(this,ae).apply(this,Fe.multipleInstances?st:[])}}return"PUBLIC"===Fe.type?Me[tt]:null},removeApp:function Le(Fe){delete we[Fe]},useAsService:function He(Fe,ae){return"serverAuth"===ae?null:ae},modularAPIs:L}};function je(Fe){if(!(0,_.r3)(we,Fe=Fe||L._DEFAULT_ENTRY_NAME))throw Ce.create("no-app",{appName:Fe});return we[Fe]}return Me.default=Me,Object.defineProperty(Me,"apps",{get:function Se(){return Object.keys(we).map(Fe=>we[Fe])}}),je.App=ot,Me}(ue);return ot.INTERNAL=Object.assign(Object.assign({},ot.INTERNAL),{createFirebaseNamespace:Ie,extendNamespace:function we(Me){(0,_.ZB)(ot,Me)},createSubscribe:_.ne,ErrorFactory:_.LL,deepExtend:_.ZB}),ot}(),W=new re.Yd("@firebase/app-compat");if((0,_.jU)()&&void 0!==self.firebase){W.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const ot=self.firebase.SDK_VERSION;ot&&ot.indexOf("LITE")>=0&&W.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const qe=q;!function Re(ot){(0,L.registerVersion)("@firebase/app-compat","0.2.13",ot)}()},6881:(wt,Pe,B)=>{B.r(Pe),B.d(Pe,{FirebaseError:()=>re.ZR,SDK_VERSION:()=>Di,_DEFAULT_ENTRY_NAME:()=>Hr,_addComponent:()=>ft,_addOrOverwriteComponent:()=>Ft,_apps:()=>cn,_clearComponents:()=>Jr,_components:()=>Zt,_getProvider:()=>kr,_registerComponent:()=>qn,_removeServiceInstance:()=>Ln,deleteApp:()=>Kn,getApp:()=>di,getApps:()=>jt,initializeApp:()=>Jt,onLog:()=>Zn,registerVersion:()=>Or,setLogLevel:()=>ei});var _=B(5861),z=B(4859),L=B(1877),re=B(2090);const ue=(me,ie)=>ie.some(Ue=>me instanceof Ue);let ce,Ce;const q=new WeakMap,W=new WeakMap,J=new WeakMap,$e=new WeakMap,Re=new WeakMap;let we={get(me,ie,Ue){if(me instanceof IDBTransaction){if("done"===ie)return W.get(me);if("objectStoreNames"===ie)return me.objectStoreNames||J.get(me);if("store"===ie)return Ue.objectStoreNames[1]?void 0:Ue.objectStore(Ue.objectStoreNames[0])}return Ae(me[ie])},set:(me,ie,Ue)=>(me[ie]=Ue,!0),has:(me,ie)=>me instanceof IDBTransaction&&("done"===ie||"store"===ie)||ie in me};function je(me){return"function"==typeof me?function Le(me){return me!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Ie(){return Ce||(Ce=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(me)?function(...ie){return me.apply(Se(this),ie),Ae(q.get(this))}:function(...ie){return Ae(me.apply(Se(this),ie))}:function(ie,...Ue){const _t=me.call(Se(this),ie,...Ue);return J.set(_t,ie.sort?ie.sort():[ie]),Ae(_t)}}(me):(me instanceof IDBTransaction&&function ot(me){if(W.has(me))return;const ie=new Promise((Ue,_t)=>{const xt=()=>{me.removeEventListener("complete",en),me.removeEventListener("error",vt),me.removeEventListener("abort",vt)},en=()=>{Ue(),xt()},vt=()=>{_t(me.error||new DOMException("AbortError","AbortError")),xt()};me.addEventListener("complete",en),me.addEventListener("error",vt),me.addEventListener("abort",vt)});W.set(me,ie)}(me),ue(me,function ve(){return ce||(ce=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(me,we):me)}function Ae(me){if(me instanceof IDBRequest)return function qe(me){const ie=new Promise((Ue,_t)=>{const xt=()=>{me.removeEventListener("success",en),me.removeEventListener("error",vt)},en=()=>{Ue(Ae(me.result)),xt()},vt=()=>{_t(me.error),xt()};me.addEventListener("success",en),me.addEventListener("error",vt)});return ie.then(Ue=>{Ue instanceof IDBCursor&&q.set(Ue,me)}).catch(()=>{}),Re.set(ie,me),ie}(me);if($e.has(me))return $e.get(me);const ie=je(me);return ie!==me&&($e.set(me,ie),Re.set(ie,me)),ie}const Se=me=>Re.get(me),Fe=["get","getKey","getAll","getAllKeys","count"],ae=["put","add","delete","clear"],tt=new Map;function St(me,ie){if(!(me instanceof IDBDatabase)||ie in me||"string"!=typeof ie)return;if(tt.get(ie))return tt.get(ie);const Ue=ie.replace(/FromIndex$/,""),_t=ie!==Ue,xt=ae.includes(Ue);if(!(Ue in(_t?IDBIndex:IDBObjectStore).prototype)||!xt&&!Fe.includes(Ue))return;const en=function(){var vt=(0,_.Z)(function*(mn,...sn){const Gr=this.transaction(mn,xt?"readwrite":"readonly");let Cr=Gr.store;return _t&&(Cr=Cr.index(sn.shift())),(yield Promise.all([Cr[Ue](...sn),xt&&Gr.done]))[0]});return function(sn){return vt.apply(this,arguments)}}();return tt.set(ie,en),en}!function Me(me){we=me(we)}(me=>({...me,get:(ie,Ue,_t)=>St(ie,Ue)||me.get(ie,Ue,_t),has:(ie,Ue)=>!!St(ie,Ue)||me.has(ie,Ue)}));class st{constructor(ie){this.container=ie}getPlatformInfoString(){return this.container.getProviders().map(Ue=>{if(function Kt(me){return"VERSION"===me.getComponent()?.type}(Ue)){const _t=Ue.getImmediate();return`${_t.library}/${_t.version}`}return null}).filter(Ue=>Ue).join(" ")}}const dt="@firebase/app",Er=new L.Yd("@firebase/app"),Hr="[DEFAULT]",Xr={[dt]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},cn=new Map,Zt=new Map;function ft(me,ie){try{me.container.addComponent(ie)}catch(Ue){Er.debug(`Component ${ie.name} failed to register with FirebaseApp ${me.name}`,Ue)}}function Ft(me,ie){me.container.addOrOverwriteComponent(ie)}function qn(me){const ie=me.name;if(Zt.has(ie))return Er.debug(`There were multiple attempts to register component ${ie}.`),!1;Zt.set(ie,me);for(const Ue of cn.values())ft(Ue,me);return!0}function kr(me,ie){const Ue=me.container.getProvider("heartbeat").getImmediate({optional:!0});return Ue&&Ue.triggerHeartbeat(),me.container.getProvider(ie)}function Ln(me,ie,Ue=Hr){kr(me,ie).clearInstance(Ue)}function Jr(){Zt.clear()}const dr=new re.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Yt{constructor(ie,Ue,_t){this._isDeleted=!1,this._options=Object.assign({},ie),this._config=Object.assign({},Ue),this._name=Ue.name,this._automaticDataCollectionEnabled=Ue.automaticDataCollectionEnabled,this._container=_t,this.container.addComponent(new z.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(ie){this.checkDestroyed(),this._automaticDataCollectionEnabled=ie}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(ie){this._isDeleted=ie}checkDestroyed(){if(this.isDeleted)throw dr.create("app-deleted",{appName:this._name})}}const Di="9.23.0";function Jt(me,ie={}){let Ue=me;"object"!=typeof ie&&(ie={name:ie});const _t=Object.assign({name:Hr,automaticDataCollectionEnabled:!1},ie),xt=_t.name;if("string"!=typeof xt||!xt)throw dr.create("bad-app-name",{appName:String(xt)});if(Ue||(Ue=(0,re.aH)()),!Ue)throw dr.create("no-options");const en=cn.get(xt);if(en){if((0,re.vZ)(Ue,en.options)&&(0,re.vZ)(_t,en.config))return en;throw dr.create("duplicate-app",{appName:xt})}const vt=new z.H0(xt);for(const sn of Zt.values())vt.addComponent(sn);const mn=new Yt(Ue,_t,vt);return cn.set(xt,mn),mn}function di(me=Hr){const ie=cn.get(me);if(!ie&&me===Hr&&(0,re.aH)())return Jt();if(!ie)throw dr.create("no-app",{appName:me});return ie}function jt(){return Array.from(cn.values())}function Kn(me){return Fn.apply(this,arguments)}function Fn(){return(Fn=(0,_.Z)(function*(me){const ie=me.name;cn.has(ie)&&(cn.delete(ie),yield Promise.all(me.container.getProviders().map(Ue=>Ue.delete())),me.isDeleted=!0)})).apply(this,arguments)}function Or(me,ie,Ue){var _t;let xt=null!==(_t=Xr[me])&&void 0!==_t?_t:me;Ue&&(xt+=`-${Ue}`);const en=xt.match(/\s|\//),vt=ie.match(/\s|\//);if(en||vt){const mn=[`Unable to register library "${xt}" with version "${ie}":`];return en&&mn.push(`library name "${xt}" contains illegal characters (whitespace or "/")`),en&&vt&&mn.push("and"),vt&&mn.push(`version name "${ie}" contains illegal characters (whitespace or "/")`),void Er.warn(mn.join(" "))}qn(new z.wA(`${xt}-version`,()=>({library:xt,version:ie}),"VERSION"))}function Zn(me,ie){if(null!==me&&"function"!=typeof me)throw dr.create("invalid-log-argument");(0,L.Am)(me,ie)}function ei(me){(0,L.Ub)(me)}const zr="firebase-heartbeat-database",ti=1,G="firebase-heartbeat-store";let H=null;function O(){return H||(H=function ke(me,ie,{blocked:Ue,upgrade:_t,blocking:xt,terminated:en}={}){const vt=indexedDB.open(me,ie),mn=Ae(vt);return _t&&vt.addEventListener("upgradeneeded",sn=>{_t(Ae(vt.result),sn.oldVersion,sn.newVersion,Ae(vt.transaction),sn)}),Ue&&vt.addEventListener("blocked",sn=>Ue(sn.oldVersion,sn.newVersion,sn)),mn.then(sn=>{en&&sn.addEventListener("close",()=>en()),xt&&sn.addEventListener("versionchange",Gr=>xt(Gr.oldVersion,Gr.newVersion,Gr))}).catch(()=>{}),mn}(zr,ti,{upgrade:(me,ie)=>{0===ie&&me.createObjectStore(G)}}).catch(me=>{throw dr.create("idb-open",{originalErrorMessage:me.message})})),H}function N(){return(N=(0,_.Z)(function*(me){try{return yield(yield O()).transaction(G).objectStore(G).get(nt(me))}catch(ie){if(ie instanceof re.ZR)Er.warn(ie.message);else{const Ue=dr.create("idb-get",{originalErrorMessage:ie?.message});Er.warn(Ue.message)}}})).apply(this,arguments)}function Z(me,ie){return De.apply(this,arguments)}function De(){return(De=(0,_.Z)(function*(me,ie){try{const _t=(yield O()).transaction(G,"readwrite");yield _t.objectStore(G).put(ie,nt(me)),yield _t.done}catch(Ue){if(Ue instanceof re.ZR)Er.warn(Ue.message);else{const _t=dr.create("idb-set",{originalErrorMessage:Ue?.message});Er.warn(_t.message)}}})).apply(this,arguments)}function nt(me){return`${me.name}!${me.options.appId}`}class Qt{constructor(ie){this.container=ie,this._heartbeatsCache=null;const Ue=this.container.getProvider("app").getImmediate();this._storage=new $t(Ue),this._heartbeatsCachePromise=this._storage.read().then(_t=>(this._heartbeatsCache=_t,_t))}triggerHeartbeat(){var ie=this;return(0,_.Z)(function*(){const _t=ie.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),xt=Pt();if(null===ie._heartbeatsCache&&(ie._heartbeatsCache=yield ie._heartbeatsCachePromise),ie._heartbeatsCache.lastSentHeartbeatDate!==xt&&!ie._heartbeatsCache.heartbeats.some(en=>en.date===xt))return ie._heartbeatsCache.heartbeats.push({date:xt,agent:_t}),ie._heartbeatsCache.heartbeats=ie._heartbeatsCache.heartbeats.filter(en=>{const vt=new Date(en.date).valueOf();return Date.now()-vt<=2592e6}),ie._storage.overwrite(ie._heartbeatsCache)})()}getHeartbeatsHeader(){var ie=this;return(0,_.Z)(function*(){if(null===ie._heartbeatsCache&&(yield ie._heartbeatsCachePromise),null===ie._heartbeatsCache||0===ie._heartbeatsCache.heartbeats.length)return"";const Ue=Pt(),{heartbeatsToSend:_t,unsentEntries:xt}=function bn(me,ie=1024){const Ue=[];let _t=me.slice();for(const xt of me){const en=Ue.find(vt=>vt.agent===xt.agent);if(en){if(en.dates.push(xt.date),Ir(Ue)>ie){en.dates.pop();break}}else if(Ue.push({agent:xt.agent,dates:[xt.date]}),Ir(Ue)>ie){Ue.pop();break}_t=_t.slice(1)}return{heartbeatsToSend:Ue,unsentEntries:_t}}(ie._heartbeatsCache.heartbeats),en=(0,re.L)(JSON.stringify({version:2,heartbeats:_t}));return ie._heartbeatsCache.lastSentHeartbeatDate=Ue,xt.length>0?(ie._heartbeatsCache.heartbeats=xt,yield ie._storage.overwrite(ie._heartbeatsCache)):(ie._heartbeatsCache.heartbeats=[],ie._storage.overwrite(ie._heartbeatsCache)),en})()}}function Pt(){return(new Date).toISOString().substring(0,10)}class $t{constructor(ie){this.app=ie,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,_.Z)(function*(){return!!(0,re.hl)()&&(0,re.eu)().then(()=>!0).catch(()=>!1)})()}read(){var ie=this;return(0,_.Z)(function*(){return(yield ie._canUseIndexedDBPromise)&&(yield function F(me){return N.apply(this,arguments)}(ie.app))||{heartbeats:[]}})()}overwrite(ie){var Ue=this;return(0,_.Z)(function*(){var _t;if(yield Ue._canUseIndexedDBPromise){const en=yield Ue.read();return Z(Ue.app,{lastSentHeartbeatDate:null!==(_t=ie.lastSentHeartbeatDate)&&void 0!==_t?_t:en.lastSentHeartbeatDate,heartbeats:ie.heartbeats})}})()}add(ie){var Ue=this;return(0,_.Z)(function*(){var _t;if(yield Ue._canUseIndexedDBPromise){const en=yield Ue.read();return Z(Ue.app,{lastSentHeartbeatDate:null!==(_t=ie.lastSentHeartbeatDate)&&void 0!==_t?_t:en.lastSentHeartbeatDate,heartbeats:[...en.heartbeats,...ie.heartbeats]})}})()}}function Ir(me){return(0,re.L)(JSON.stringify({version:2,heartbeats:me})).length}!function Cs(me){qn(new z.wA("platform-logger",ie=>new st(ie),"PRIVATE")),qn(new z.wA("heartbeat",ie=>new Qt(ie),"PRIVATE")),Or(dt,"0.9.13",me),Or(dt,"0.9.13","esm2017"),Or("fire-js","")}("")},4859:(wt,Pe,B)=>{B.d(Pe,{H0:()=>ve,wA:()=>L,zt:()=>ue});var _=B(5861),z=B(2090);class L{constructor(q,W,J){this.name=q,this.instanceFactory=W,this.type=J,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(q){return this.instantiationMode=q,this}setMultipleInstances(q){return this.multipleInstances=q,this}setServiceProps(q){return this.serviceProps=q,this}setInstanceCreatedCallback(q){return this.onInstanceCreated=q,this}}const re="[DEFAULT]";class ue{constructor(q,W){this.name=q,this.container=W,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(q){const W=this.normalizeInstanceIdentifier(q);if(!this.instancesDeferred.has(W)){const J=new z.BH;if(this.instancesDeferred.set(W,J),this.isInitialized(W)||this.shouldAutoInitialize())try{const $e=this.getOrInitializeService({instanceIdentifier:W});$e&&J.resolve($e)}catch{}}return this.instancesDeferred.get(W).promise}getImmediate(q){var W;const J=this.normalizeInstanceIdentifier(q?.identifier),$e=null!==(W=q?.optional)&&void 0!==W&&W;if(!this.isInitialized(J)&&!this.shouldAutoInitialize()){if($e)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:J})}catch(Re){if($e)return null;throw Re}}getComponent(){return this.component}setComponent(q){if(q.name!==this.name)throw Error(`Mismatching Component ${q.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=q,this.shouldAutoInitialize()){if(function Ce(Ie){return"EAGER"===Ie.instantiationMode}(q))try{this.getOrInitializeService({instanceIdentifier:re})}catch{}for(const[W,J]of this.instancesDeferred.entries()){const $e=this.normalizeInstanceIdentifier(W);try{const Re=this.getOrInitializeService({instanceIdentifier:$e});J.resolve(Re)}catch{}}}}clearInstance(q=re){this.instancesDeferred.delete(q),this.instancesOptions.delete(q),this.instances.delete(q)}delete(){var q=this;return(0,_.Z)(function*(){const W=Array.from(q.instances.values());yield Promise.all([...W.filter(J=>"INTERNAL"in J).map(J=>J.INTERNAL.delete()),...W.filter(J=>"_delete"in J).map(J=>J._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(q=re){return this.instances.has(q)}getOptions(q=re){return this.instancesOptions.get(q)||{}}initialize(q={}){const{options:W={}}=q,J=this.normalizeInstanceIdentifier(q.instanceIdentifier);if(this.isInitialized(J))throw Error(`${this.name}(${J}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const $e=this.getOrInitializeService({instanceIdentifier:J,options:W});for(const[Re,qe]of this.instancesDeferred.entries())J===this.normalizeInstanceIdentifier(Re)&&qe.resolve($e);return $e}onInit(q,W){var J;const $e=this.normalizeInstanceIdentifier(W),Re=null!==(J=this.onInitCallbacks.get($e))&&void 0!==J?J:new Set;Re.add(q),this.onInitCallbacks.set($e,Re);const qe=this.instances.get($e);return qe&&q(qe,$e),()=>{Re.delete(q)}}invokeOnInitCallbacks(q,W){const J=this.onInitCallbacks.get(W);if(J)for(const $e of J)try{$e(q,W)}catch{}}getOrInitializeService({instanceIdentifier:q,options:W={}}){let J=this.instances.get(q);if(!J&&this.component&&(J=this.component.instanceFactory(this.container,{instanceIdentifier:(Ie=q,Ie===re?void 0:Ie),options:W}),this.instances.set(q,J),this.instancesOptions.set(q,W),this.invokeOnInitCallbacks(J,q),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,q,J)}catch{}var Ie;return J||null}normalizeInstanceIdentifier(q=re){return this.component?this.component.multipleInstances?q:re:q}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ve{constructor(q){this.name=q,this.providers=new Map}addComponent(q){const W=this.getProvider(q.name);if(W.isComponentSet())throw new Error(`Component ${q.name} has already been registered with ${this.name}`);W.setComponent(q)}addOrOverwriteComponent(q){this.getProvider(q.name).isComponentSet()&&this.providers.delete(q.name),this.addComponent(q)}getProvider(q){if(this.providers.has(q))return this.providers.get(q);const W=new ue(q,this);return this.providers.set(q,W),W}getProviders(){return Array.from(this.providers.values())}}},1877:(wt,Pe,B)=>{B.d(Pe,{Am:()=>Ie,Ub:()=>ve,Yd:()=>Ce,in:()=>z});const _=[];var z=(()=>{return(q=z||(z={}))[q.DEBUG=0]="DEBUG",q[q.VERBOSE=1]="VERBOSE",q[q.INFO=2]="INFO",q[q.WARN=3]="WARN",q[q.ERROR=4]="ERROR",q[q.SILENT=5]="SILENT",z;var q})();const L={debug:z.DEBUG,verbose:z.VERBOSE,info:z.INFO,warn:z.WARN,error:z.ERROR,silent:z.SILENT},re=z.INFO,ue={[z.DEBUG]:"log",[z.VERBOSE]:"log",[z.INFO]:"info",[z.WARN]:"warn",[z.ERROR]:"error"},ce=(q,W,...J)=>{if(W<q.logLevel)return;const $e=(new Date).toISOString(),Re=ue[W];if(!Re)throw new Error(`Attempted to log a message with an invalid logType (value: ${W})`);console[Re](`[${$e}]  ${q.name}:`,...J)};class Ce{constructor(W){this.name=W,this._logLevel=re,this._logHandler=ce,this._userLogHandler=null,_.push(this)}get logLevel(){return this._logLevel}set logLevel(W){if(!(W in z))throw new TypeError(`Invalid value "${W}" assigned to \`logLevel\``);this._logLevel=W}setLogLevel(W){this._logLevel="string"==typeof W?L[W]:W}get logHandler(){return this._logHandler}set logHandler(W){if("function"!=typeof W)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=W}get userLogHandler(){return this._userLogHandler}set userLogHandler(W){this._userLogHandler=W}debug(...W){this._userLogHandler&&this._userLogHandler(this,z.DEBUG,...W),this._logHandler(this,z.DEBUG,...W)}log(...W){this._userLogHandler&&this._userLogHandler(this,z.VERBOSE,...W),this._logHandler(this,z.VERBOSE,...W)}info(...W){this._userLogHandler&&this._userLogHandler(this,z.INFO,...W),this._logHandler(this,z.INFO,...W)}warn(...W){this._userLogHandler&&this._userLogHandler(this,z.WARN,...W),this._logHandler(this,z.WARN,...W)}error(...W){this._userLogHandler&&this._userLogHandler(this,z.ERROR,...W),this._logHandler(this,z.ERROR,...W)}}function ve(q){_.forEach(W=>{W.setLogLevel(q)})}function Ie(q,W){for(const J of _){let $e=null;W&&W.level&&($e=L[W.level]),J.userLogHandler=null===q?null:(Re,qe,...ot)=>{const we=ot.map(Me=>{if(null==Me)return null;if("string"==typeof Me)return Me;if("number"==typeof Me||"boolean"==typeof Me)return Me.toString();if(Me instanceof Error)return Me.message;try{return JSON.stringify(Me)}catch{return null}}).filter(Me=>Me).join(" ");qe>=($e??Re.logLevel)&&q({level:z[qe].toLowerCase(),message:we,args:ot,type:Re.name})}}}},259:(wt,Pe,B)=>{B.d(Pe,{C6:()=>_.getApps,Mq:()=>_.getApp});var _=B(6881);(0,_.registerVersion)("firebase","9.23.0","app")},9260:(wt,Pe,B)=>{B.d(Pe,{Z:()=>_.Z});var _=B(3942);_.Z.registerVersion("firebase","9.23.0","app-compat")},9568:(wt,Pe,B)=>{B.r(Pe);var _=B(5861),z=B(3942),L=B(1389),re=B(2090),Ce=(B(6881),B(1877),B(4859));function ve(){return window}const Ie=2e3;function W(){return W=(0,_.Z)(function*(O,F,N){var Z;const{BuildInfo:De}=ve();(0,L.as)(F.sessionId,"AuthEvent did not contain a session ID");const nt=yield function Me(O){return Le.apply(this,arguments)}(F.sessionId),Rt={};return(0,L.at)()?Rt.ibi=De.packageName:(0,L.au)()?Rt.apn=De.packageName:(0,L.av)(O,"operation-not-supported-in-this-environment"),De.displayName&&(Rt.appDisplayName=De.displayName),Rt.sessionId=nt,(0,L.aw)(O,N,F.type,void 0,null!==(Z=F.eventId)&&void 0!==Z?Z:void 0,Rt)}),W.apply(this,arguments)}function $e(){return($e=(0,_.Z)(function*(O){const{BuildInfo:F}=ve(),N={};(0,L.at)()?N.iosBundleId=F.packageName:(0,L.au)()?N.androidPackageName=F.packageName:(0,L.av)(O,"operation-not-supported-in-this-environment"),yield(0,L.ax)(O,N)})).apply(this,arguments)}function ot(){return(ot=(0,_.Z)(function*(O,F,N){const{cordova:Z}=ve();let De=()=>{};try{yield new Promise((nt,Rt)=>{let Dt=null;function Qt(){var $t;nt();const Ir=null===($t=Z.plugins.browsertab)||void 0===$t?void 0:$t.close;"function"==typeof Ir&&Ir(),"function"==typeof N?.close&&N.close()}function Pt(){Dt||(Dt=window.setTimeout(()=>{Rt((0,L.az)(O,"redirect-cancelled-by-user"))},Ie))}function bn(){"visible"===document?.visibilityState&&Pt()}F.addPassiveListener(Qt),document.addEventListener("resume",Pt,!1),(0,L.au)()&&document.addEventListener("visibilitychange",bn,!1),De=()=>{F.removePassiveListener(Qt),document.removeEventListener("resume",Pt,!1),document.removeEventListener("visibilitychange",bn,!1),Dt&&window.clearTimeout(Dt)}})}finally{De()}})).apply(this,arguments)}function Le(){return(Le=(0,_.Z)(function*(O){const F=function je(O){if((0,L.as)(/[0-9a-zA-Z]+/.test(O),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(O);const F=new ArrayBuffer(O.length),N=new Uint8Array(F);for(let Z=0;Z<O.length;Z++)N[Z]=O.charCodeAt(Z);return N}(O),N=yield crypto.subtle.digest("SHA-256",F);return Array.from(new Uint8Array(N)).map(De=>De.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}const Ae=20;class Se extends L.aB{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(F=>{this.resolveInialized=F})}addPassiveListener(F){this.passiveListeners.add(F)}removePassiveListener(F){this.passiveListeners.delete(F)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(F){return this.resolveInialized(),this.passiveListeners.forEach(N=>N(F)),super.onEvent(F)}initialized(){var F=this;return(0,_.Z)(function*(){yield F.initPromise})()}}function Fe(O){return ae.apply(this,arguments)}function ae(){return(ae=(0,_.Z)(function*(O){const F=yield st()._get(Kt(O));return F&&(yield st()._remove(Kt(O))),F})).apply(this,arguments)}function St(){const O=[],F="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let N=0;N<Ae;N++){const Z=Math.floor(Math.random()*F.length);O.push(F.charAt(Z))}return O.join("")}function st(){return(0,L.aC)(L.b)}function Kt(O){return(0,L.aD)("authEvent",O.config.apiKey,O.name)}function Er(O){if(!O?.includes("?"))return{};const[F,...N]=O.split("?");return(0,re.zd)(N.join("?"))}const le=class os{constructor(){this._redirectPersistence=L.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=L.aE,this._overrideRedirectResult=L.aF}_initialize(F){var N=this;return(0,_.Z)(function*(){const Z=F._key();let De=N.eventManagers.get(Z);return De||(De=new Se(F),N.eventManagers.set(Z,De),N.attachCallbackListeners(F,De)),De})()}_openPopup(F){(0,L.av)(F,"operation-not-supported-in-this-environment")}_openRedirect(F,N,Z,De){var nt=this;return(0,_.Z)(function*(){!function we(O){var F,N,Z,De,nt,Rt,Dt,Qt,Pt,bn;const $t=ve();(0,L.aA)("function"==typeof(null===(F=$t?.universalLinks)||void 0===F?void 0:F.subscribe),O,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,L.aA)(typeof(null===(N=$t?.BuildInfo)||void 0===N?void 0:N.packageName)<"u",O,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,L.aA)("function"==typeof(null===(nt=null===(De=null===(Z=$t?.cordova)||void 0===Z?void 0:Z.plugins)||void 0===De?void 0:De.browsertab)||void 0===nt?void 0:nt.openUrl),O,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,L.aA)("function"==typeof(null===(Qt=null===(Dt=null===(Rt=$t?.cordova)||void 0===Rt?void 0:Rt.plugins)||void 0===Dt?void 0:Dt.browsertab)||void 0===Qt?void 0:Qt.isAvailable),O,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,L.aA)("function"==typeof(null===(bn=null===(Pt=$t?.cordova)||void 0===Pt?void 0:Pt.InAppBrowser)||void 0===bn?void 0:bn.open),O,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(F);const Rt=yield nt._initialize(F);yield Rt.initialized(),Rt.resetRedirect(),(0,L.aG)(),yield nt._originValidation(F);const Dt=function ke(O,F,N=null){return{type:F,eventId:N,urlResponse:null,sessionId:St(),postBody:null,tenantId:O.tenantId,error:(0,L.az)(O,"no-auth-event")}}(F,Z,De);yield function He(O,F){return st()._set(Kt(O),F)}(F,Dt);const Qt=yield function q(O,F,N){return W.apply(this,arguments)}(F,Dt,N),Pt=yield function Re(O){const{cordova:F}=ve();return new Promise(N=>{F.plugins.browsertab.isAvailable(Z=>{let De=null;Z?F.plugins.browsertab.openUrl(O):De=F.InAppBrowser.open(O,(0,L.ay)()?"_blank":"_system","location=yes"),N(De)})})}(Qt);return function qe(O,F,N){return ot.apply(this,arguments)}(F,Rt,Pt)})()}_isIframeWebStorageSupported(F,N){throw new Error("Method not implemented.")}_originValidation(F){const N=F._key();return this.originValidationPromises[N]||(this.originValidationPromises[N]=function J(O){return $e.apply(this,arguments)}(F)),this.originValidationPromises[N]}attachCallbackListeners(F,N){const{universalLinks:Z,handleOpenURL:De,BuildInfo:nt}=ve(),Rt=setTimeout((0,_.Z)(function*(){yield Fe(F),N.onEvent(pe())}),500),Dt=function(){var bn=(0,_.Z)(function*($t){clearTimeout(Rt);const Ir=yield Fe(F);let Cs=null;Ir&&$t?.url&&(Cs=function tt(O,F){var N,Z;const De=function Is(O){const F=Er(O),N=F.link?decodeURIComponent(F.link):void 0,Z=Er(N).link,De=F.deep_link_id?decodeURIComponent(F.deep_link_id):void 0;return Er(De).link||De||Z||N||O}(F);if(De.includes("/__/auth/callback")){const nt=Er(De),Rt=nt.firebaseError?function dt(O){try{return JSON.parse(O)}catch{return null}}(decodeURIComponent(nt.firebaseError)):null,Dt=null===(Z=null===(N=Rt?.code)||void 0===N?void 0:N.split("auth/"))||void 0===Z?void 0:Z[1],Qt=Dt?(0,L.az)(Dt):null;return Qt?{type:O.type,eventId:O.eventId,tenantId:O.tenantId,error:Qt,urlResponse:null,sessionId:null,postBody:null}:{type:O.type,eventId:O.eventId,tenantId:O.tenantId,sessionId:O.sessionId,urlResponse:De,postBody:null}}return null}(Ir,$t.url)),N.onEvent(Cs||pe())});return function(Ir){return bn.apply(this,arguments)}}();typeof Z<"u"&&"function"==typeof Z.subscribe&&Z.subscribe(null,Dt);const Qt=De,Pt=`${nt.packageName.toLowerCase()}://`;ve().handleOpenURL=function(){var bn=(0,_.Z)(function*($t){if($t.toLowerCase().startsWith(Pt)&&Dt({url:$t}),"function"==typeof Qt)try{Qt($t)}catch(Ir){console.error(Ir)}});return function($t){return bn.apply(this,arguments)}}()}};function pe(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,L.az)("no-auth-event")}}const Ve=1e3;function at(){var O;return(null===(O=self?.location)||void 0===O?void 0:O.protocol)||null}function un(O=(0,re.z$)()){return!("file:"!==at()&&"ionic:"!==at()&&"capacitor:"!==at()||!O.toLowerCase().match(/iphone|ipad|ipod|android/))}function rr(){try{const O=self.localStorage,F=L.aL();if(O)return O.setItem(F,"1"),O.removeItem(F),!function fn(O=(0,re.z$)()){return function nn(){return(0,re.w1)()&&11===document?.documentMode}()||function Rn(O=(0,re.z$)()){return/Edge\/\d+/.test(O)}(O)}()||(0,re.hl)()}catch{return xn()&&(0,re.hl)()}return!1}function xn(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function On(){return(function ct(){return"http:"===at()||"https:"===at()}()||(0,re.ru)()||un())&&!function Tt(){return(0,re.b$)()||(0,re.UG)()}()&&rr()&&!xn()}function ir(){return un()&&typeof document<"u"}function Bn(){return(Bn=(0,_.Z)(function*(){return!!ir()&&new Promise(O=>{const F=setTimeout(()=>{O(!1)},Ve);document.addEventListener("deviceready",()=>{clearTimeout(F),O(!0)})})})).apply(this,arguments)}const jn={LOCAL:"local",NONE:"none",SESSION:"session"},as=L.aA,Wn="persistence";function Xr(O){return cn.apply(this,arguments)}function cn(){return(cn=(0,_.Z)(function*(O){yield O._initializationPromise;const F=ft(),N=L.aD(Wn,O.config.apiKey,O.name);F&&F.setItem(N,O._getPersistence())})).apply(this,arguments)}function ft(){var O;try{return(null===(O=function gt(){return typeof window<"u"?window:null}())||void 0===O?void 0:O.sessionStorage)||null}catch{return null}}const Ft=L.aA;class qn{constructor(){this.browserResolver=L.aC(L.k),this.cordovaResolver=L.aC(le),this.underlyingResolver=null,this._redirectPersistence=L.a,this._completeRedirectFn=L.aE,this._overrideRedirectResult=L.aF}_initialize(F){var N=this;return(0,_.Z)(function*(){return yield N.selectUnderlyingResolver(),N.assertedUnderlyingResolver._initialize(F)})()}_openPopup(F,N,Z,De){var nt=this;return(0,_.Z)(function*(){return yield nt.selectUnderlyingResolver(),nt.assertedUnderlyingResolver._openPopup(F,N,Z,De)})()}_openRedirect(F,N,Z,De){var nt=this;return(0,_.Z)(function*(){return yield nt.selectUnderlyingResolver(),nt.assertedUnderlyingResolver._openRedirect(F,N,Z,De)})()}_isIframeWebStorageSupported(F,N){this.assertedUnderlyingResolver._isIframeWebStorageSupported(F,N)}_originValidation(F){return this.assertedUnderlyingResolver._originValidation(F)}get _shouldInitProactively(){return ir()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Ft(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var F=this;return(0,_.Z)(function*(){if(F.underlyingResolver)return;const N=yield function Ti(){return Bn.apply(this,arguments)}();F.underlyingResolver=N?F.cordovaResolver:F.browserResolver})()}}function kr(O){return O.unwrap()}function Jr(O){return dr(O)}function dr(O){const{_tokenResponse:F}=O instanceof re.ZR?O.customData:O;if(!F)return null;if(!(O instanceof re.ZR)&&"temporaryProof"in F&&"phoneNumber"in F)return L.P.credentialFromResult(O);const N=F.providerId;if(!N||N===L.p.PASSWORD)return null;let Z;switch(N){case L.p.GOOGLE:Z=L.V;break;case L.p.FACEBOOK:Z=L.U;break;case L.p.GITHUB:Z=L.W;break;case L.p.TWITTER:Z=L.Z;break;default:const{oauthIdToken:De,oauthAccessToken:nt,oauthTokenSecret:Rt,pendingToken:Dt,nonce:Qt}=F;return nt||Rt||De||Dt?Dt?N.startsWith("saml.")?L.aO._create(N,Dt):L.L._fromParams({providerId:N,signInMethod:N,pendingToken:Dt,idToken:De,accessToken:nt}):new L.X(N).credential({idToken:De,accessToken:nt,rawNonce:Qt}):null}return O instanceof re.ZR?Z.credentialFromError(O):Z.credentialFromResult(O)}function Yt(O,F){return F.catch(N=>{throw N instanceof re.ZR&&function $n(O,F){var N;const Z=null===(N=F.customData)||void 0===N?void 0:N._tokenResponse;if("auth/multi-factor-auth-required"===F?.code)F.resolver=new di(O,L.aq(O,F));else if(Z){const De=dr(F),nt=F;De&&(nt.credential=De,nt.tenantId=Z.tenantId||void 0,nt.email=Z.email||void 0,nt.phoneNumber=Z.phoneNumber||void 0)}}(O,N),N}).then(N=>{const De=N.user;return{operationType:N.operationType,credential:Jr(N),additionalUserInfo:L.ao(N),user:jt.getOrCreate(De)}})}function Di(O,F){return Jt.apply(this,arguments)}function Jt(){return(Jt=(0,_.Z)(function*(O,F){const N=yield F;return{verificationId:N.verificationId,confirm:Z=>Yt(O,N.confirm(Z))}})).apply(this,arguments)}class di{constructor(F,N){this.resolver=N,this.auth=function Ln(O){return O.wrapped()}(F)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(F){return Yt(kr(this.auth),this.resolver.resolveSignIn(F))}}class jt{constructor(F){this._delegate=F,this.multiFactor=L.ar(F)}static getOrCreate(F){return jt.USER_MAP.has(F)||jt.USER_MAP.set(F,new jt(F)),jt.USER_MAP.get(F)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(F){return this._delegate.getIdTokenResult(F)}getIdToken(F){return this._delegate.getIdToken(F)}linkAndRetrieveDataWithCredential(F){return this.linkWithCredential(F)}linkWithCredential(F){var N=this;return(0,_.Z)(function*(){return Yt(N.auth,L.a0(N._delegate,F))})()}linkWithPhoneNumber(F,N){var Z=this;return(0,_.Z)(function*(){return Di(Z.auth,L.l(Z._delegate,F,N))})()}linkWithPopup(F){var N=this;return(0,_.Z)(function*(){return Yt(N.auth,L.d(N._delegate,F,qn))})()}linkWithRedirect(F){var N=this;return(0,_.Z)(function*(){return yield Xr(L.aH(N.auth)),L.g(N._delegate,F,qn)})()}reauthenticateAndRetrieveDataWithCredential(F){return this.reauthenticateWithCredential(F)}reauthenticateWithCredential(F){var N=this;return(0,_.Z)(function*(){return Yt(N.auth,L.a1(N._delegate,F))})()}reauthenticateWithPhoneNumber(F,N){return Di(this.auth,L.r(this._delegate,F,N))}reauthenticateWithPopup(F){return Yt(this.auth,L.e(this._delegate,F,qn))}reauthenticateWithRedirect(F){var N=this;return(0,_.Z)(function*(){return yield Xr(L.aH(N.auth)),L.h(N._delegate,F,qn)})()}sendEmailVerification(F){return L.ae(this._delegate,F)}unlink(F){var N=this;return(0,_.Z)(function*(){return yield L.an(N._delegate,F),N})()}updateEmail(F){return L.aj(this._delegate,F)}updatePassword(F){return L.ak(this._delegate,F)}updatePhoneNumber(F){return L.u(this._delegate,F)}updateProfile(F){return L.ai(this._delegate,F)}verifyBeforeUpdateEmail(F,N){return L.af(this._delegate,F,N)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}jt.USER_MAP=new WeakMap;const Kn=L.aA;let Fn=(()=>{class O{constructor(N,Z){if(this.app=N,Z.isInitialized())return this._delegate=Z.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:De}=N.options;Kn(De,"invalid-api-key",{appName:N.name}),Kn(De,"invalid-api-key",{appName:N.name});const nt=typeof window<"u"?qn:void 0;this._delegate=Z.initialize({options:{persistence:Zn(De,N.name),popupRedirectResolver:nt}}),this._delegate._updateErrorMap(L.D),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?jt.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(N){this._delegate.languageCode=N}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(N){this._delegate.tenantId=N}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(N,Z){L.I(this._delegate,N,Z)}applyActionCode(N){return L.a5(this._delegate,N)}checkActionCode(N){return L.a6(this._delegate,N)}confirmPasswordReset(N,Z){return L.a4(this._delegate,N,Z)}createUserWithEmailAndPassword(N,Z){var De=this;return(0,_.Z)(function*(){return Yt(De._delegate,L.a8(De._delegate,N,Z))})()}fetchProvidersForEmail(N){return this.fetchSignInMethodsForEmail(N)}fetchSignInMethodsForEmail(N){return L.ad(this._delegate,N)}isSignInWithEmailLink(N){return L.ab(this._delegate,N)}getRedirectResult(){var N=this;return(0,_.Z)(function*(){Kn(On(),N._delegate,"operation-not-supported-in-this-environment");const Z=yield L.j(N._delegate,qn);return Z?Yt(N._delegate,Promise.resolve(Z)):{credential:null,user:null}})()}addFrameworkForLogging(N){!function ye(O,F){(0,L.aH)(O)._logFramework(F)}(this._delegate,N)}onAuthStateChanged(N,Z,De){const{next:nt,error:Rt,complete:Dt}=Or(N,Z,De);return this._delegate.onAuthStateChanged(nt,Rt,Dt)}onIdTokenChanged(N,Z,De){const{next:nt,error:Rt,complete:Dt}=Or(N,Z,De);return this._delegate.onIdTokenChanged(nt,Rt,Dt)}sendSignInLinkToEmail(N,Z){return L.aa(this._delegate,N,Z)}sendPasswordResetEmail(N,Z){return L.a3(this._delegate,N,Z||void 0)}setPersistence(N){var Z=this;return(0,_.Z)(function*(){let De;switch(function Hr(O,F){as(Object.values(jn).includes(F),O,"invalid-persistence-type"),(0,re.b$)()?as(F!==jn.SESSION,O,"unsupported-persistence-type"):(0,re.UG)()?as(F===jn.NONE,O,"unsupported-persistence-type"):xn()?as(F===jn.NONE||F===jn.LOCAL&&(0,re.hl)(),O,"unsupported-persistence-type"):as(F===jn.NONE||rr(),O,"unsupported-persistence-type")}(Z._delegate,N),N){case jn.SESSION:De=L.a;break;case jn.LOCAL:De=(yield L.aC(L.i)._isAvailable())?L.i:L.b;break;case jn.NONE:De=L.N;break;default:return L.av("argument-error",{appName:Z._delegate.name})}return Z._delegate.setPersistence(De)})()}signInAndRetrieveDataWithCredential(N){return this.signInWithCredential(N)}signInAnonymously(){return Yt(this._delegate,L._(this._delegate))}signInWithCredential(N){return Yt(this._delegate,L.$(this._delegate,N))}signInWithCustomToken(N){return Yt(this._delegate,L.a2(this._delegate,N))}signInWithEmailAndPassword(N,Z){return Yt(this._delegate,L.a9(this._delegate,N,Z))}signInWithEmailLink(N,Z){return Yt(this._delegate,L.ac(this._delegate,N,Z))}signInWithPhoneNumber(N,Z){return Di(this._delegate,L.s(this._delegate,N,Z))}signInWithPopup(N){var Z=this;return(0,_.Z)(function*(){return Kn(On(),Z._delegate,"operation-not-supported-in-this-environment"),Yt(Z._delegate,L.c(Z._delegate,N,qn))})()}signInWithRedirect(N){var Z=this;return(0,_.Z)(function*(){return Kn(On(),Z._delegate,"operation-not-supported-in-this-environment"),yield Xr(Z._delegate),L.f(Z._delegate,N,qn)})()}updateCurrentUser(N){return this._delegate.updateCurrentUser(N)}verifyPasswordResetCode(N){return L.a7(this._delegate,N)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return O.Persistence=jn,O})();function Or(O,F,N){let Z=O;"function"!=typeof O&&({next:Z,error:F,complete:N}=O);const De=Z;return{next:Rt=>De(Rt&&jt.getOrCreate(Rt)),error:F,complete:N}}function Zn(O,F){const N=function Zt(O,F){const N=ft();if(!N)return[];const Z=L.aD(Wn,O,F);switch(N.getItem(Z)){case jn.NONE:return[L.N];case jn.LOCAL:return[L.i,L.a];case jn.SESSION:return[L.a];default:return[]}}(O,F);if(typeof self<"u"&&!N.includes(L.i)&&N.push(L.i),typeof window<"u")for(const Z of[L.b,L.a])N.includes(Z)||N.push(Z);return N.includes(L.N)||N.push(L.N),N}class ei{constructor(){this.providerId="phone",this._delegate=new L.P(kr(z.Z.auth()))}static credential(F,N){return L.P.credential(F,N)}verifyPhoneNumber(F,N){return this._delegate.verifyPhoneNumber(F,N)}unwrap(){return this._delegate}}ei.PHONE_SIGN_IN_METHOD=L.P.PHONE_SIGN_IN_METHOD,ei.PROVIDER_ID=L.P.PROVIDER_ID;const zr=L.aA;class ti{constructor(F,N,Z=z.Z.app()){var De;zr(null===(De=Z.options)||void 0===De?void 0:De.apiKey,"invalid-api-key",{appName:Z.name}),this._delegate=new L.R(F,N,Z.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function H(O){O.INTERNAL.registerComponent(new Ce.wA("auth-compat",F=>{const N=F.getProvider("app-compat").getImmediate(),Z=F.getProvider("auth");return new Fn(N,Z)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:L.A.EMAIL_SIGNIN,PASSWORD_RESET:L.A.PASSWORD_RESET,RECOVER_EMAIL:L.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:L.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:L.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:L.A.VERIFY_EMAIL}},EmailAuthProvider:L.Q,FacebookAuthProvider:L.U,GithubAuthProvider:L.W,GoogleAuthProvider:L.V,OAuthProvider:L.X,SAMLAuthProvider:L.Y,PhoneAuthProvider:ei,PhoneMultiFactorGenerator:L.m,RecaptchaVerifier:ti,TwitterAuthProvider:L.Z,Auth:Fn,AuthCredential:L.J,Error:re.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),O.registerVersion("@firebase/auth-compat","0.4.2")}(z.Z)},5861:(wt,Pe,B)=>{function _(L,re,ue,ce,Ce,ve,Ie){try{var q=L[ve](Ie),W=q.value}catch(J){return void ue(J)}q.done?re(W):Promise.resolve(W).then(ce,Ce)}function z(L){return function(){var re=this,ue=arguments;return new Promise(function(ce,Ce){var ve=L.apply(re,ue);function Ie(W){_(ve,ce,Ce,Ie,q,"next",W)}function q(W){_(ve,ce,Ce,Ie,q,"throw",W)}Ie(void 0)})}}B.d(Pe,{Z:()=>z})},7582:(wt,Pe,B)=>{function re(le,pe){var ye={};for(var te in le)Object.prototype.hasOwnProperty.call(le,te)&&pe.indexOf(te)<0&&(ye[te]=le[te]);if(null!=le&&"function"==typeof Object.getOwnPropertySymbols){var xe=0;for(te=Object.getOwnPropertySymbols(le);xe<te.length;xe++)pe.indexOf(te[xe])<0&&Object.prototype.propertyIsEnumerable.call(le,te[xe])&&(ye[te[xe]]=le[te[xe]])}return ye}function J(le,pe,ye,te){return new(ye||(ye=Promise))(function(Ve,at){function ct(nn){try{Tt(te.next(nn))}catch(Rn){at(Rn)}}function un(nn){try{Tt(te.throw(nn))}catch(Rn){at(Rn)}}function Tt(nn){nn.done?Ve(nn.value):function xe(Ve){return Ve instanceof ye?Ve:new ye(function(at){at(Ve)})}(nn.value).then(ct,un)}Tt((te=te.apply(le,pe||[])).next())})}function Ae(le){return this instanceof Ae?(this.v=le,this):new Ae(le)}function Se(le,pe,ye){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var xe,te=ye.apply(le,pe||[]),Ve=[];return xe={},at("next"),at("throw"),at("return"),xe[Symbol.asyncIterator]=function(){return this},xe;function at(fn){te[fn]&&(xe[fn]=function(rr){return new Promise(function(xn,On){Ve.push([fn,rr,xn,On])>1||ct(fn,rr)})})}function ct(fn,rr){try{!function un(fn){fn.value instanceof Ae?Promise.resolve(fn.value.v).then(Tt,nn):Rn(Ve[0][2],fn)}(te[fn](rr))}catch(xn){Rn(Ve[0][3],xn)}}function Tt(fn){ct("next",fn)}function nn(fn){ct("throw",fn)}function Rn(fn,rr){fn(rr),Ve.shift(),Ve.length&&ct(Ve[0][0],Ve[0][1])}}function He(le){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ye,pe=le[Symbol.asyncIterator];return pe?pe.call(le):(le=function ot(le){var pe="function"==typeof Symbol&&Symbol.iterator,ye=pe&&le[pe],te=0;if(ye)return ye.call(le);if(le&&"number"==typeof le.length)return{next:function(){return le&&te>=le.length&&(le=void 0),{value:le&&le[te++],done:!le}}};throw new TypeError(pe?"Object is not iterable.":"Symbol.iterator is not defined.")}(le),ye={},te("next"),te("throw"),te("return"),ye[Symbol.asyncIterator]=function(){return this},ye);function te(Ve){ye[Ve]=le[Ve]&&function(at){return new Promise(function(ct,un){!function xe(Ve,at,ct,un){Promise.resolve(un).then(function(Tt){Ve({value:Tt,done:ct})},at)}(ct,un,(at=le[Ve](at)).done,at.value)})}}}B.d(Pe,{FC:()=>Se,KL:()=>He,_T:()=>re,mG:()=>J,qq:()=>Ae}),"function"==typeof SuppressedError&&SuppressedError}},wt=>{wt(wt.s=1887)}]);